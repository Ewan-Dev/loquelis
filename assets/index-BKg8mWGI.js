var wi=(s,e)=>()=>(e||s((e={exports:{}}).exports,e),e.exports);var ah=wi((hh,$s)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function t(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(n){if(n.ep)return;n.ep=!0;const a=t(n);fetch(n.href,a)}})();const vn=!1;var es=Array.isArray,bi=Array.prototype.indexOf,Jr=Array.from,la=Object.defineProperty,xt=Object.getOwnPropertyDescriptor,ca=Object.getOwnPropertyDescriptors,ki=Object.prototype,Si=Array.prototype,Gr=Object.getPrototypeOf,pn=Object.isExtensible;function Gt(s){return typeof s=="function"}const Ve=()=>{};function Ei(s){return s()}function ws(s){for(var e=0;e<s.length;e++)s[e]()}const rt=2,ua=4,rr=8,nr=16,_t=32,ts=64,Ws=128,We=256,Hs=512,De=1024,lt=2048,Ot=4096,pt=8192,ar=16384,da=32768,Ts=65536,xi=1<<17,ha=1<<19,fa=1<<20,Ar=1<<21,ot=Symbol("$state"),va=Symbol("legacy props"),Ti=Symbol("");function pa(s){return s===this.v}function ga(s,e){return s!=s?e==e:s!==e||s!==null&&typeof s=="object"||typeof s=="function"}function Kr(s){return!ga(s,this.v)}function Oi(s){throw new Error("https://svelte.dev/e/effect_in_teardown")}function ji(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Ai(s){throw new Error("https://svelte.dev/e/effect_orphan")}function Pi(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Mi(s){throw new Error("https://svelte.dev/e/lifecycle_legacy_only")}function Ci(s){throw new Error("https://svelte.dev/e/props_invalid_value")}function Ii(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function $i(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Ri(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}let ss=!1,Di=!1;function Li(){ss=!0}const Yr=1,Qr=2,ma=4,qi=8,Ui=16,Ni=1,Bi=2,Fi=4,zi=8,Vi=16,Wi=4,Hi=1,Ji=2,qe=Symbol(),Gi="http://www.w3.org/1999/xhtml";function ir(s){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}let me=null;function gn(s){me=s}function Ee(s,e=!1,t){var r=me={p:me,c:null,d:!1,e:null,m:!1,s,x:null,l:null};ss&&!e&&(me.l={s:null,u:null,r1:[],r2:ks(!1)}),Xr(()=>{r.d=!0})}function xe(s){const e=me;if(e!==null){const i=e.e;if(i!==null){var t=_e,r=ye;e.e=null;try{for(var n=0;n<i.length;n++){var a=i[n];ct(a.effect),Ke(a.reaction),ns(a.fn)}}finally{ct(t),Ke(r)}}me=e.p,e.m=!0}return{}}function Os(){return!ss||me!==null&&me.l===null}function B(s){if(typeof s!="object"||s===null||ot in s)return s;const e=Gr(s);if(e!==ki&&e!==Si)return s;var t=new Map,r=es(s),n=A(0),a=ye,i=o=>{var l=ye;Ke(a);var c=o();return Ke(l),c};return r&&t.set("length",A(s.length)),new Proxy(s,{defineProperty(o,l,c){(!("value"in c)||c.configurable===!1||c.enumerable===!1||c.writable===!1)&&Ii();var u=t.get(l);return u===void 0?(u=i(()=>A(c.value)),t.set(l,u)):_(u,i(()=>B(c.value))),!0},deleteProperty(o,l){var c=t.get(l);if(c===void 0)l in o&&(t.set(l,i(()=>A(qe))),yr(n));else{if(r&&typeof l=="string"){var u=t.get("length"),h=Number(l);Number.isInteger(h)&&h<u.v&&_(u,h)}_(c,qe),yr(n)}return!0},get(o,l,c){var v;if(l===ot)return s;var u=t.get(l),h=l in o;if(u===void 0&&(!h||(v=xt(o,l))!=null&&v.writable)&&(u=i(()=>A(B(h?o[l]:qe))),t.set(l,u)),u!==void 0){var f=d(u);return f===qe?void 0:f}return Reflect.get(o,l,c)},getOwnPropertyDescriptor(o,l){var c=Reflect.getOwnPropertyDescriptor(o,l);if(c&&"value"in c){var u=t.get(l);u&&(c.value=d(u))}else if(c===void 0){var h=t.get(l),f=h==null?void 0:h.v;if(h!==void 0&&f!==qe)return{enumerable:!0,configurable:!0,value:f,writable:!0}}return c},has(o,l){var f;if(l===ot)return!0;var c=t.get(l),u=c!==void 0&&c.v!==qe||Reflect.has(o,l);if(c!==void 0||_e!==null&&(!u||(f=xt(o,l))!=null&&f.writable)){c===void 0&&(c=i(()=>A(u?B(o[l]):qe)),t.set(l,c));var h=d(c);if(h===qe)return!1}return u},set(o,l,c,u){var j;var h=t.get(l),f=l in o;if(r&&l==="length")for(var v=c;v<h.v;v+=1){var g=t.get(v+"");g!==void 0?_(g,qe):v in o&&(g=i(()=>A(qe)),t.set(v+"",g))}h===void 0?(!f||(j=xt(o,l))!=null&&j.writable)&&(h=i(()=>A(void 0)),_(h,i(()=>B(c))),t.set(l,h)):(f=h.v!==qe,_(h,i(()=>B(c))));var k=Reflect.getOwnPropertyDescriptor(o,l);if(k!=null&&k.set&&k.set.call(u,c),!f){if(r&&typeof l=="string"){var m=t.get("length"),P=Number(l);Number.isInteger(P)&&P>=m.v&&_(m,P+1)}yr(n)}return!0},ownKeys(o){d(n);var l=Reflect.ownKeys(o).filter(h=>{var f=t.get(h);return f===void 0||f.v!==qe});for(var[c,u]of t)u.v!==qe&&!(c in o)&&l.push(c);return l},setPrototypeOf(){$i()}})}function yr(s,e=1){_(s,s.v+e)}function mn(s){try{if(s!==null&&typeof s=="object"&&ot in s)return s[ot]}catch{}return s}function Ki(s,e){return Object.is(mn(s),mn(e))}function Qt(s){var e=rt|lt,t=ye!==null&&(ye.f&rt)!==0?ye:null;return _e===null||t!==null&&(t.f&We)!==0?e|=We:_e.f|=fa,{ctx:me,deps:null,effects:null,equals:pa,f:e,fn:s,reactions:null,rv:0,v:null,wv:0,parent:t??_e}}function Js(s){const e=Qt(s);return Ia(e),e}function Zr(s){const e=Qt(s);return e.equals=Kr,e}function _a(s){var e=s.effects;if(e!==null){s.effects=null;for(var t=0;t<e.length;t+=1)Tt(e[t])}}function Yi(s){for(var e=s.parent;e!==null;){if((e.f&rt)===0)return e;e=e.parent}return null}function ya(s){var e,t=_e;ct(Yi(s));try{_a(s),e=La(s)}finally{ct(t)}return e}function wa(s){var e=ya(s);if(s.equals(e)||(s.v=e,s.wv=Ra()),!as){var t=(Et||(s.f&We)!==0)&&s.deps!==null?Ot:De;Ye(s,t)}}const bs=new Map;function ks(s,e){var t={f:0,v:s,reactions:null,equals:pa,rv:0,wv:0};return t}function A(s,e){const t=ks(s);return Ia(t),t}function $t(s,e=!1){var r;const t=ks(s);return e||(t.equals=Kr),ss&&me!==null&&me.l!==null&&((r=me.l).s??(r.s=[])).push(t),t}function _(s,e,t=!1){ye!==null&&!at&&Os()&&(ye.f&(rt|nr))!==0&&!(Re!=null&&Re.includes(s))&&Ri();let r=t?B(e):e;return Pr(s,r)}function Pr(s,e){if(!s.equals(e)){var t=s.v;as?bs.set(s,e):bs.set(s,t),s.v=e,(s.f&rt)!==0&&((s.f&lt)!==0&&ya(s),Ye(s,(s.f&We)===0?De:Ot)),s.wv=Ra(),ka(s,lt),Os()&&_e!==null&&(_e.f&De)!==0&&(_e.f&(_t|ts))===0&&(Je===null?uo([s]):Je.push(s))}return e}function ba(s,e=1){var t=d(s),r=e===1?t++:t--;return _(s,t),r}function ka(s,e){var t=s.reactions;if(t!==null)for(var r=Os(),n=t.length,a=0;a<n;a++){var i=t[a],o=i.f;(o&lt)===0&&(!r&&i===_e||(Ye(i,e),(o&(De|We))!==0&&((o&rt)!==0?ka(i,Ot):hr(i))))}}function Qi(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}let Zi=!1;var _n,Sa,Ea,xa;function Xi(){if(_n===void 0){_n=window,Sa=/Firefox/.test(navigator.userAgent);var s=Element.prototype,e=Node.prototype,t=Text.prototype;Ea=xt(e,"firstChild").get,xa=xt(e,"nextSibling").get,pn(s)&&(s.__click=void 0,s.__className=void 0,s.__attributes=null,s.__style=void 0,s.__e=void 0),pn(t)&&(t.__t=void 0)}}function or(s=""){return document.createTextNode(s)}function Gs(s){return Ea.call(s)}function lr(s){return xa.call(s)}function w(s,e){return Gs(s)}function ke(s,e){{var t=Gs(s);return t instanceof Comment&&t.data===""?lr(t):t}}function y(s,e=1,t=!1){let r=s;for(;e--;)r=lr(r);return r}function eo(s){s.textContent=""}function Ta(s){_e===null&&ye===null&&Ai(),ye!==null&&(ye.f&We)!==0&&_e===null&&ji(),as&&Oi()}function to(s,e){var t=e.last;t===null?e.last=e.first=s:(t.next=s,s.prev=t,e.last=s)}function rs(s,e,t,r=!0){var n=_e,a={ctx:me,deps:null,nodes_start:null,nodes_end:null,f:s|lt,first:null,fn:e,last:null,next:null,parent:n,prev:null,teardown:null,transitions:null,wv:0};if(t)try{dr(a),a.f|=da}catch(l){throw Tt(a),l}else e!==null&&hr(a);var i=t&&a.deps===null&&a.first===null&&a.nodes_start===null&&a.teardown===null&&(a.f&(fa|Ws))===0;if(!i&&r&&(n!==null&&to(a,n),ye!==null&&(ye.f&rt)!==0)){var o=ye;(o.effects??(o.effects=[])).push(a)}return a}function Xr(s){const e=rs(rr,null,!1);return Ye(e,De),e.teardown=s,e}function Ce(s){Ta();var e=_e!==null&&(_e.f&_t)!==0&&me!==null&&!me.m;if(e){var t=me;(t.e??(t.e=[])).push({fn:s,effect:_e,reaction:ye})}else{var r=ns(s);return r}}function so(s){return Ta(),js(s)}function ro(s){const e=rs(ts,s,!0);return(t={})=>new Promise(r=>{t.outro?Ss(e,()=>{Tt(e),r(void 0)}):(Tt(e),r(void 0))})}function ns(s){return rs(ua,s,!1)}function no(s,e){var t=me,r={effect:null,ran:!1};t.l.r1.push(r),r.effect=js(()=>{s(),!r.ran&&(r.ran=!0,_(t.l.r2,!0),ut(e))})}function ao(){var s=me;js(()=>{if(d(s.l.r2)){for(var e of s.l.r1){var t=e.effect;(t.f&De)!==0&&Ye(t,Ot),is(t)&&dr(t),e.ran=!1}s.l.r2.v=!1}})}function js(s){return rs(rr,s,!0)}function fe(s,e=[],t=Qt){const r=e.map(t);return As(()=>s(...r.map(d)))}function As(s,e=0){return rs(rr|nr|e,s,!0)}function Zt(s,e=!0){return rs(rr|_t,s,!0,e)}function Oa(s){var e=s.teardown;if(e!==null){const t=as,r=ye;yn(!0),Ke(null);try{e.call(null)}finally{yn(t),Ke(r)}}}function ja(s,e=!1){var t=s.first;for(s.first=s.last=null;t!==null;){var r=t.next;(t.f&ts)!==0?t.parent=null:Tt(t,e),t=r}}function io(s){for(var e=s.first;e!==null;){var t=e.next;(e.f&_t)===0&&Tt(e),e=t}}function Tt(s,e=!0){var t=!1;(e||(s.f&ha)!==0)&&s.nodes_start!==null&&(oo(s.nodes_start,s.nodes_end),t=!0),ja(s,e&&!t),Xs(s,0),Ye(s,ar);var r=s.transitions;if(r!==null)for(const a of r)a.stop();Oa(s);var n=s.parent;n!==null&&n.first!==null&&Aa(s),s.next=s.prev=s.teardown=s.ctx=s.deps=s.fn=s.nodes_start=s.nodes_end=null}function oo(s,e){for(;s!==null;){var t=s===e?null:lr(s);s.remove(),s=t}}function Aa(s){var e=s.parent,t=s.prev,r=s.next;t!==null&&(t.next=r),r!==null&&(r.prev=t),e!==null&&(e.first===s&&(e.first=r),e.last===s&&(e.last=t))}function Ss(s,e){var t=[];en(s,t,!0),Pa(t,()=>{Tt(s),e&&e()})}function Pa(s,e){var t=s.length;if(t>0){var r=()=>--t||e();for(var n of s)n.out(r)}else e()}function en(s,e,t){if((s.f&pt)===0){if(s.f^=pt,s.transitions!==null)for(const i of s.transitions)(i.is_global||t)&&e.push(i);for(var r=s.first;r!==null;){var n=r.next,a=(r.f&Ts)!==0||(r.f&_t)!==0;en(r,e,a?t:!1),r=n}}}function Ks(s){Ma(s,!0)}function Ma(s,e){if((s.f&pt)!==0){s.f^=pt,(s.f&De)===0&&(s.f^=De),is(s)&&(Ye(s,lt),hr(s));for(var t=s.first;t!==null;){var r=t.next,n=(t.f&Ts)!==0||(t.f&_t)!==0;Ma(t,n?e:!1),t=r}if(s.transitions!==null)for(const a of s.transitions)(a.is_global||e)&&a.in()}}let Es=[],Mr=[];function Ca(){var s=Es;Es=[],ws(s)}function lo(){var s=Mr;Mr=[],ws(s)}function cr(s){Es.length===0&&queueMicrotask(Ca),Es.push(s)}function co(){Es.length>0&&Ca(),Mr.length>0&&lo()}let Vs=!1,Ys=!1,Qs=null,Rt=!1,as=!1;function yn(s){as=s}let ps=[],ye=null,at=!1;function Ke(s){ye=s}let _e=null;function ct(s){_e=s}let Re=null;function Ia(s){ye!==null&&ye.f&Ar&&(Re===null?Re=[s]:Re.push(s))}let $e=null,Fe=0,Je=null;function uo(s){Je=s}let $a=1,Zs=0,Et=!1;function Ra(){return++$a}function is(s){var h;var e=s.f;if((e&lt)!==0)return!0;if((e&Ot)!==0){var t=s.deps,r=(e&We)!==0;if(t!==null){var n,a,i=(e&Hs)!==0,o=r&&_e!==null&&!Et,l=t.length;if(i||o){var c=s,u=c.parent;for(n=0;n<l;n++)a=t[n],(i||!((h=a==null?void 0:a.reactions)!=null&&h.includes(c)))&&(a.reactions??(a.reactions=[])).push(c);i&&(c.f^=Hs),o&&u!==null&&(u.f&We)===0&&(c.f^=We)}for(n=0;n<l;n++)if(a=t[n],is(a)&&wa(a),a.wv>s.wv)return!0}(!r||_e!==null&&!Et)&&Ye(s,De)}return!1}function ho(s,e){for(var t=e;t!==null;){if((t.f&Ws)!==0)try{t.fn(s);return}catch{t.f^=Ws}t=t.parent}throw Vs=!1,s}function wn(s){return(s.f&ar)===0&&(s.parent===null||(s.parent.f&Ws)===0)}function ur(s,e,t,r){if(Vs){if(t===null&&(Vs=!1),wn(e))throw s;return}if(t!==null&&(Vs=!0),ho(s,e),wn(e))throw s}function Da(s,e,t=!0){var r=s.reactions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];Re!=null&&Re.includes(s)||((a.f&rt)!==0?Da(a,e,!1):e===a&&(t?Ye(a,lt):(a.f&De)!==0&&Ye(a,Ot),hr(a)))}}function La(s){var v;var e=$e,t=Fe,r=Je,n=ye,a=Et,i=Re,o=me,l=at,c=s.f;$e=null,Fe=0,Je=null,Et=(c&We)!==0&&(at||!Rt||ye===null),ye=(c&(_t|ts))===0?s:null,Re=null,gn(s.ctx),at=!1,Zs++,s.f|=Ar;try{var u=(0,s.fn)(),h=s.deps;if($e!==null){var f;if(Xs(s,Fe),h!==null&&Fe>0)for(h.length=Fe+$e.length,f=0;f<$e.length;f++)h[Fe+f]=$e[f];else s.deps=h=$e;if(!Et)for(f=Fe;f<h.length;f++)((v=h[f]).reactions??(v.reactions=[])).push(s)}else h!==null&&Fe<h.length&&(Xs(s,Fe),h.length=Fe);if(Os()&&Je!==null&&!at&&h!==null&&(s.f&(rt|Ot|lt))===0)for(f=0;f<Je.length;f++)Da(Je[f],s);return n!==null&&n!==s&&(Zs++,Je!==null&&(r===null?r=Je:r.push(...Je))),u}finally{$e=e,Fe=t,Je=r,ye=n,Et=a,Re=i,gn(o),at=l,s.f^=Ar}}function fo(s,e){let t=e.reactions;if(t!==null){var r=bi.call(t,s);if(r!==-1){var n=t.length-1;n===0?t=e.reactions=null:(t[r]=t[n],t.pop())}}t===null&&(e.f&rt)!==0&&($e===null||!$e.includes(e))&&(Ye(e,Ot),(e.f&(We|Hs))===0&&(e.f^=Hs),_a(e),Xs(e,0))}function Xs(s,e){var t=s.deps;if(t!==null)for(var r=e;r<t.length;r++)fo(s,t[r])}function dr(s){var e=s.f;if((e&ar)===0){Ye(s,De);var t=_e,r=me,n=Rt;_e=s,Rt=!0;try{(e&nr)!==0?io(s):ja(s),Oa(s);var a=La(s);s.teardown=typeof a=="function"?a:null,s.wv=$a;var i=s.deps,o;vn&&Di&&s.f&lt}catch(l){ur(l,s,t,r||s.ctx)}finally{Rt=n,_e=t}}}function vo(){try{Pi()}catch(s){if(Qs!==null)ur(s,Qs,null);else throw s}}function qa(){var s=Rt;try{var e=0;for(Rt=!0;ps.length>0;){e++>1e3&&vo();var t=ps,r=t.length;ps=[];for(var n=0;n<r;n++){var a=go(t[n]);po(a)}bs.clear()}}finally{Ys=!1,Rt=s,Qs=null}}function po(s){var e=s.length;if(e!==0)for(var t=0;t<e;t++){var r=s[t];if((r.f&(ar|pt))===0)try{is(r)&&(dr(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null?Aa(r):r.fn=null))}catch(n){ur(n,r,null,r.ctx)}}}function hr(s){Ys||(Ys=!0,queueMicrotask(qa));for(var e=Qs=s;e.parent!==null;){e=e.parent;var t=e.f;if((t&(ts|_t))!==0){if((t&De)===0)return;e.f^=De}}ps.push(e)}function go(s){for(var e=[],t=s;t!==null;){var r=t.f,n=(r&(_t|ts))!==0,a=n&&(r&De)!==0;if(!a&&(r&pt)===0){if((r&ua)!==0)e.push(t);else if(n)t.f^=De;else try{is(t)&&dr(t)}catch(l){ur(l,t,null,t.ctx)}var i=t.first;if(i!==null){t=i;continue}}var o=t.parent;for(t=t.next;t===null&&o!==null;)t=o.next,o=o.parent}return e}function mo(s){for(var e;;){if(co(),ps.length===0)return e;Ys=!0,qa()}}async function _o(){await Promise.resolve(),mo()}function d(s){var e=s.f,t=(e&rt)!==0;if(ye!==null&&!at){if(!(Re!=null&&Re.includes(s))){var r=ye.deps;s.rv<Zs&&(s.rv=Zs,$e===null&&r!==null&&r[Fe]===s?Fe++:$e===null?$e=[s]:(!Et||!$e.includes(s))&&$e.push(s))}}else if(t&&s.deps===null&&s.effects===null){var n=s,a=n.parent;a!==null&&(a.f&We)===0&&(n.f^=We)}return t&&(n=s,is(n)&&wa(n)),as&&bs.has(s)?bs.get(s):s.v}function ut(s){var e=at;try{return at=!0,s()}finally{at=e}}const yo=-7169;function Ye(s,e){s.f=s.f&yo|e}function Ua(s){if(!(typeof s!="object"||!s||s instanceof EventTarget)){if(ot in s)Cr(s);else if(!Array.isArray(s))for(let e in s){const t=s[e];typeof t=="object"&&t&&ot in t&&Cr(t)}}}function Cr(s,e=new Set){if(typeof s=="object"&&s!==null&&!(s instanceof EventTarget)&&!e.has(s)){e.add(s),s instanceof Date&&s.getTime();for(let r in s)try{Cr(s[r],e)}catch{}const t=Gr(s);if(t!==Object.prototype&&t!==Array.prototype&&t!==Map.prototype&&t!==Set.prototype&&t!==Date.prototype){const r=ca(t);for(let n in r){const a=r[n].get;if(a)try{a.call(s)}catch{}}}}}const wo=["touchstart","touchmove"];function bo(s){return wo.includes(s)}let bn=!1;function ko(){bn||(bn=!0,document.addEventListener("reset",s=>{Promise.resolve().then(()=>{var e;if(!s.defaultPrevented)for(const t of s.target.elements)(e=t.__on_r)==null||e.call(t)})},{capture:!0}))}function tn(s){var e=ye,t=_e;Ke(null),ct(null);try{return s()}finally{Ke(e),ct(t)}}function Na(s,e,t,r=t){s.addEventListener(e,()=>tn(t));const n=s.__on_r;n?s.__on_r=()=>{n(),r(!0)}:s.__on_r=()=>r(!0),ko()}const Ba=new Set,Ir=new Set;function So(s,e,t,r={}){function n(a){if(r.capture||fs.call(e,a),!a.cancelBubble)return tn(()=>t==null?void 0:t.call(this,a))}return s.startsWith("pointer")||s.startsWith("touch")||s==="wheel"?cr(()=>{e.addEventListener(s,n,r)}):e.addEventListener(s,n,r),n}function Ue(s,e,t,r,n){var a={capture:r,passive:n},i=So(s,e,t,a);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&Xr(()=>{e.removeEventListener(s,i,a)})}function os(s){for(var e=0;e<s.length;e++)Ba.add(s[e]);for(var t of Ir)t(s)}function fs(s){var j;var e=this,t=e.ownerDocument,r=s.type,n=((j=s.composedPath)==null?void 0:j.call(s))||[],a=n[0]||s.target,i=0,o=s.__root;if(o){var l=n.indexOf(o);if(l!==-1&&(e===document||e===window)){s.__root=e;return}var c=n.indexOf(e);if(c===-1)return;l<=c&&(i=l)}if(a=n[i]||s.target,a!==e){la(s,"currentTarget",{configurable:!0,get(){return a||t}});var u=ye,h=_e;Ke(null),ct(null);try{for(var f,v=[];a!==null;){var g=a.assignedSlot||a.parentNode||a.host||null;try{var k=a["__"+r];if(k!=null&&(!a.disabled||s.target===a))if(es(k)){var[m,...P]=k;m.apply(a,[s,...P])}else k.call(a,s)}catch(S){f?v.push(S):f=S}if(s.cancelBubble||g===e||g===null)break;a=g}if(f){for(let S of v)queueMicrotask(()=>{throw S});throw f}}finally{s.__root=e,delete s.currentTarget,Ke(u),ct(h)}}}function sn(s){var e;e=document.head.appendChild(or());try{As(()=>s(e),ha)}finally{}}function Eo(s){var e=document.createElement("template");return e.innerHTML=s.replaceAll("<!>","<!---->"),e.content}function $r(s,e){var t=_e;t.nodes_start===null&&(t.nodes_start=s,t.nodes_end=e)}function N(s,e){var t=(e&Hi)!==0,r=(e&Ji)!==0,n,a=!s.startsWith("<!>");return()=>{n===void 0&&(n=Eo(a?s:"<!>"+s),t||(n=Gs(n)));var i=r||Sa?document.importNode(n,!0):n.cloneNode(!0);if(t){var o=Gs(i),l=i.lastChild;$r(o,l)}else $r(i,i);return i}}function rn(s){return()=>xo(s())}function xo(s){const e=s.nodeType===11,t=s.tagName==="SCRIPT"?[s]:s.querySelectorAll("script"),r=_e;for(const a of t){const i=document.createElement("script");for(var n of a.attributes)i.setAttribute(n.name,n.value);i.textContent=a.textContent,(e?s.firstChild===a:s===a)&&(r.nodes_start=i),(e?s.lastChild===a:s===a)&&(r.nodes_end=i),a.replaceWith(i)}return s}function gt(){var s=document.createDocumentFragment(),e=document.createComment(""),t=or();return s.append(e,t),$r(e,t),s}function R(s,e){s!==null&&s.before(e)}let Rr=!0;function Q(s,e){var t=e==null?"":typeof e=="object"?e+"":e;t!==(s.__t??(s.__t=s.nodeValue))&&(s.__t=t,s.nodeValue=t+"")}function To(s,e){return Oo(s,e)}const Lt=new Map;function Oo(s,{target:e,anchor:t,props:r={},events:n,context:a,intro:i=!0}){Xi();var o=new Set,l=h=>{for(var f=0;f<h.length;f++){var v=h[f];if(!o.has(v)){o.add(v);var g=bo(v);e.addEventListener(v,fs,{passive:g});var k=Lt.get(v);k===void 0?(document.addEventListener(v,fs,{passive:g}),Lt.set(v,1)):Lt.set(v,k+1)}}};l(Jr(Ba)),Ir.add(l);var c=void 0,u=ro(()=>{var h=t??e.appendChild(or());return Zt(()=>{if(a){Ee({});var f=me;f.c=a}n&&(r.$$events=n),Rr=i,c=s(h,r)||{},Rr=!0,a&&xe()}),()=>{var g;for(var f of o){e.removeEventListener(f,fs);var v=Lt.get(f);--v===0?(document.removeEventListener(f,fs),Lt.delete(f)):Lt.set(f,v)}Ir.delete(l),h!==t&&((g=h.parentNode)==null||g.removeChild(h))}});return jo.set(c,u),c}let jo=new WeakMap;function le(s,e,[t,r]=[0,0]){var n=s,a=null,i=null,o=qe,l=t>0?Ts:0,c=!1;const u=(f,v=!0)=>{c=!0,h(v,f)},h=(f,v)=>{o!==(o=f)&&(o?(a?Ks(a):v&&(a=Zt(()=>v(n))),i&&Ss(i,()=>{i=null})):(i?Ks(i):v&&(i=Zt(()=>v(n,[t+1,r]))),a&&Ss(a,()=>{a=null})))};As(()=>{c=!1,e(u),c||h(null,null)},l)}function Pe(s,e){return e}function Ao(s,e,t,r){for(var n=[],a=e.length,i=0;i<a;i++)en(e[i].e,n,!0);var o=a>0&&n.length===0&&t!==null;if(o){var l=t.parentNode;eo(l),l.append(t),r.clear(),bt(s,e[0].prev,e[a-1].next)}Pa(n,()=>{for(var c=0;c<a;c++){var u=e[c];o||(r.delete(u.k),bt(s,u.prev,u.next)),Tt(u.e,!o)}})}function Me(s,e,t,r,n,a=null){var i=s,o={flags:e,items:new Map,first:null},l=(e&ma)!==0;if(l){var c=s;i=c.appendChild(or())}var u=null,h=!1,f=Zr(()=>{var v=t();return es(v)?v:v==null?[]:Jr(v)});As(()=>{var v=d(f),g=v.length;h&&g===0||(h=g===0,Po(v,o,i,n,e,r,t),a!==null&&(g===0?u?Ks(u):u=Zt(()=>a(i)):u!==null&&Ss(u,()=>{u=null})),d(f))})}function Po(s,e,t,r,n,a,i){var ce,L,Y,X;var o=(n&qi)!==0,l=(n&(Yr|Qr))!==0,c=s.length,u=e.items,h=e.first,f=h,v,g=null,k,m=[],P=[],j,S,b,x;if(o)for(x=0;x<c;x+=1)j=s[x],S=a(j,x),b=u.get(S),b!==void 0&&((ce=b.a)==null||ce.measure(),(k??(k=new Set)).add(b));for(x=0;x<c;x+=1){if(j=s[x],S=a(j,x),b=u.get(S),b===void 0){var T=f?f.e.nodes_start:t;g=Co(T,e,g,g===null?e.first:g.next,j,S,x,r,n,i),u.set(S,g),m=[],P=[],f=g.next;continue}if(l&&Mo(b,j,x,n),(b.e.f&pt)!==0&&(Ks(b.e),o&&((L=b.a)==null||L.unfix(),(k??(k=new Set)).delete(b))),b!==f){if(v!==void 0&&v.has(b)){if(m.length<P.length){var O=P[0],I;g=O.prev;var D=m[0],z=m[m.length-1];for(I=0;I<m.length;I+=1)kn(m[I],O,t);for(I=0;I<P.length;I+=1)v.delete(P[I]);bt(e,D.prev,z.next),bt(e,g,D),bt(e,z,O),f=O,g=z,x-=1,m=[],P=[]}else v.delete(b),kn(b,f,t),bt(e,b.prev,b.next),bt(e,b,g===null?e.first:g.next),bt(e,g,b),g=b;continue}for(m=[],P=[];f!==null&&f.k!==S;)(f.e.f&pt)===0&&(v??(v=new Set)).add(f),P.push(f),f=f.next;if(f===null)continue;b=f}m.push(b),g=b,f=b.next}if(f!==null||v!==void 0){for(var H=v===void 0?[]:Jr(v);f!==null;)(f.e.f&pt)===0&&H.push(f),f=f.next;var ie=H.length;if(ie>0){var oe=(n&ma)!==0&&c===0?t:null;if(o){for(x=0;x<ie;x+=1)(Y=H[x].a)==null||Y.measure();for(x=0;x<ie;x+=1)(X=H[x].a)==null||X.fix()}Ao(e,H,oe,u)}}o&&cr(()=>{var J;if(k!==void 0)for(b of k)(J=b.a)==null||J.apply()}),_e.first=e.first&&e.first.e,_e.last=g&&g.e}function Mo(s,e,t,r){(r&Yr)!==0&&Pr(s.v,e),(r&Qr)!==0?Pr(s.i,t):s.i=t}function Co(s,e,t,r,n,a,i,o,l,c){var u=(l&Yr)!==0,h=(l&Ui)===0,f=u?h?$t(n):ks(n):n,v=(l&Qr)===0?i:ks(i),g={i:v,v:f,k:a,a:null,e:null,prev:t,next:r};try{return g.e=Zt(()=>o(s,f,v,c),Zi),g.e.prev=t&&t.e,g.e.next=r&&r.e,t===null?e.first=g:(t.next=g,t.e.next=g.e),r!==null&&(r.prev=g,r.e.prev=g.e),g}finally{}}function kn(s,e,t){for(var r=s.next?s.next.e.nodes_start:t,n=e?e.e.nodes_start:t,a=s.e.nodes_start;a!==r;){var i=lr(a);n.before(a),a=i}}function bt(s,e,t){e===null?s.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function Sn(s,e,t){var r=s,n,a;As(()=>{n!==(n=e())&&(a&&(Ss(a),a=null),n&&(a=Zt(()=>t(r,n))))},Ts)}function Fa(s){var e,t,r="";if(typeof s=="string"||typeof s=="number")r+=s;else if(typeof s=="object")if(Array.isArray(s)){var n=s.length;for(e=0;e<n;e++)s[e]&&(t=Fa(s[e]))&&(r&&(r+=" "),r+=t)}else for(t in s)s[t]&&(r&&(r+=" "),r+=t);return r}function Io(){for(var s,e,t=0,r="",n=arguments.length;t<n;t++)(s=arguments[t])&&(e=Fa(s))&&(r&&(r+=" "),r+=e);return r}function er(s){return typeof s=="object"?Io(s):s??""}const En=[...` 	
\r\f \v\uFEFF`];function $o(s,e,t){var r=s==null?"":""+s;if(e&&(r=r?r+" "+e:e),t){for(var n in t)if(t[n])r=r?r+" "+n:n;else if(r.length)for(var a=n.length,i=0;(i=r.indexOf(n,i))>=0;){var o=i+a;(i===0||En.includes(r[i-1]))&&(o===r.length||En.includes(r[o]))?r=(i===0?"":r.substring(0,i))+r.substring(o+1):i=o}}return r===""?null:r}function Ro(s,e){return s==null?null:String(s)}function ze(s,e,t,r,n,a){var i=s.__className;if(i!==t||i===void 0){var o=$o(t,r,a);o==null?s.removeAttribute("class"):s.className=o,s.__className=t}else if(a&&n!==a)for(var l in a){var c=!!a[l];(n==null||c!==!!n[l])&&s.classList.toggle(l,c)}return a}function Do(s,e,t,r){var n=s.__style;if(n!==e){var a=Ro(e);a==null?s.removeAttribute("style"):s.style.cssText=a,s.__style=e}return r}function za(s,e,t){if(s.multiple){if(e==null)return;if(!es(e))return Qi();for(var r of s.options)r.selected=e.includes(gs(r));return}for(r of s.options){var n=gs(r);if(Ki(n,e)){r.selected=!0;return}}(!t||e!==void 0)&&(s.selectedIndex=-1)}function Lo(s,e){ns(()=>{var t=new MutationObserver(()=>{var r=s.__value;za(s,r)});return t.observe(s,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{t.disconnect()}})}function Ge(s,e,t=e){var r=!0;Na(s,"change",n=>{var a=n?"[selected]":":checked",i;if(s.multiple)i=[].map.call(s.querySelectorAll(a),gs);else{var o=s.querySelector(a)??s.querySelector("option:not([disabled])");i=o&&gs(o)}t(i)}),ns(()=>{var n=e();if(za(s,n,r),r&&n===void 0){var a=s.querySelector(":checked");a!==null&&(n=gs(a),t(n))}s.__value=n,r=!1}),Lo(s)}function gs(s){return"__value"in s?s.__value:s.value}const qo=Symbol("is custom element"),Uo=Symbol("is html");function Te(s,e,t,r){var n=No(s);n[e]!==(n[e]=t)&&(e==="loading"&&(s[Ti]=t),t==null?s.removeAttribute(e):typeof t!="string"&&Bo(s).includes(e)?s[e]=t:s.setAttribute(e,t))}function No(s){return s.__attributes??(s.__attributes={[qo]:s.nodeName.includes("-"),[Uo]:s.namespaceURI===Gi})}var xn=new Map;function Bo(s){var e=xn.get(s.nodeName);if(e)return e;xn.set(s.nodeName,e=[]);for(var t,r=s,n=Element.prototype;n!==r;){t=ca(r);for(var a in t)t[a].set&&e.push(a);r=Gr(r)}return e}const Fo=()=>performance.now(),vt={tick:s=>requestAnimationFrame(s),now:()=>Fo(),tasks:new Set};function Va(){const s=vt.now();vt.tasks.forEach(e=>{e.c(s)||(vt.tasks.delete(e),e.f())}),vt.tasks.size!==0&&vt.tick(Va)}function zo(s){let e;return vt.tasks.size===0&&vt.tick(Va),{promise:new Promise(t=>{vt.tasks.add(e={c:s,f:t})}),abort(){vt.tasks.delete(e)}}}function Ds(s,e){tn(()=>{s.dispatchEvent(new CustomEvent(e))})}function Vo(s){if(s==="float")return"cssFloat";if(s==="offset")return"cssOffset";if(s.startsWith("--"))return s;const e=s.split("-");return e.length===1?e[0]:e[0]+e.slice(1).map(t=>t[0].toUpperCase()+t.slice(1)).join("")}function Tn(s){const e={},t=s.split(";");for(const r of t){const[n,a]=r.split(":");if(!n||a===void 0)break;const i=Vo(n.trim());e[i]=a.trim()}return e}const Wo=s=>s;function Ho(s,e,t,r){var n=(s&Wi)!==0,a="both",i,o=e.inert,l=e.style.overflow,c,u;function h(){var m=ye,P=_e;Ke(null),ct(null);try{return i??(i=t()(e,(r==null?void 0:r())??{},{direction:a}))}finally{Ke(m),ct(P)}}var f={is_global:n,in(){e.inert=o,Ds(e,"introstart"),c=Dr(e,h(),u,1,()=>{Ds(e,"introend"),c==null||c.abort(),c=i=void 0,e.style.overflow=l})},out(m){e.inert=!0,Ds(e,"outrostart"),u=Dr(e,h(),c,0,()=>{Ds(e,"outroend"),m==null||m()})},stop:()=>{c==null||c.abort(),u==null||u.abort()}},v=_e;if((v.transitions??(v.transitions=[])).push(f),Rr){var g=n;if(!g){for(var k=v.parent;k&&(k.f&Ts)!==0;)for(;(k=k.parent)&&(k.f&nr)===0;);g=!k||(k.f&da)!==0}g&&ns(()=>{ut(()=>f.in())})}}function Dr(s,e,t,r,n){var a=r===1;if(Gt(e)){var i,o=!1;return cr(()=>{if(!o){var m=e({direction:a?"in":"out"});i=Dr(s,m,t,r,n)}}),{abort:()=>{o=!0,i==null||i.abort()},deactivate:()=>i.deactivate(),reset:()=>i.reset(),t:()=>i.t()}}if(t==null||t.deactivate(),!(e!=null&&e.duration))return n(),{abort:Ve,deactivate:Ve,reset:Ve,t:()=>r};const{delay:l=0,css:c,tick:u,easing:h=Wo}=e;var f=[];if(a&&t===void 0&&(u&&u(0,1),c)){var v=Tn(c(0,1));f.push(v,v)}var g=()=>1-r,k=s.animate(f,{duration:l,fill:"forwards"});return k.onfinish=()=>{k.cancel();var m=(t==null?void 0:t.t())??1-r;t==null||t.abort();var P=r-m,j=e.duration*Math.abs(P),S=[];if(j>0){var b=!1;if(c)for(var x=Math.ceil(j/16.666666666666668),T=0;T<=x;T+=1){var O=m+P*h(T/x),I=Tn(c(O,1-O));S.push(I),b||(b=I.overflow==="hidden")}b&&(s.style.overflow="hidden"),g=()=>{var D=k.currentTime;return m+P*h(D/j)},u&&zo(()=>{if(k.playState!=="running")return!1;var D=g();return u(D,1-D),!0})}k=s.animate(S,{duration:j,fill:"forwards"}),k.onfinish=()=>{g=()=>r,u==null||u(r,1-r),n()}},{abort:()=>{k&&(k.cancel(),k.effect=null,k.onfinish=Ve)},deactivate:()=>{n=Ve},reset:()=>{r===0&&(u==null||u(1,0))},t:()=>g()}}function nt(s,e,t=e){var r=Os();Na(s,"input",n=>{var a=n?s.defaultValue:s.value;if(a=wr(s)?br(a):a,t(a),r&&a!==(a=e())){var i=s.selectionStart,o=s.selectionEnd;s.value=a??"",o!==null&&(s.selectionStart=i,s.selectionEnd=Math.min(o,s.value.length))}}),ut(e)==null&&s.value&&t(wr(s)?br(s.value):s.value),js(()=>{var n=e();wr(s)&&n===br(s.value)||s.type==="date"&&!n&&!s.value||n!==s.value&&(s.value=n??"")})}function wr(s){var e=s.type;return e==="number"||e==="range"}function br(s){return s===""?null:+s}function On(s,e){return s===e||(s==null?void 0:s[ot])===e}function it(s={},e,t,r){return ns(()=>{var n,a;return js(()=>{n=a,a=[],ut(()=>{s!==t(...a)&&(e(s,...a),n&&On(t(...n),s)&&e(null,...n))})}),()=>{cr(()=>{a&&On(t(...a),s)&&e(null,...a)})}}),s}function Wa(s=!1){const e=me,t=e.l.u;if(!t)return;let r=()=>Ua(e.s);if(s){let n=0,a={};const i=Qt(()=>{let o=!1;const l=e.s;for(const c in l)l[c]!==a[c]&&(a[c]=l[c],o=!0);return o&&n++,n});r=()=>d(i)}t.b.length&&so(()=>{jn(e,r),ws(t.b)}),Ce(()=>{const n=ut(()=>t.m.map(Ei));return()=>{for(const a of n)typeof a=="function"&&a()}}),t.a.length&&Ce(()=>{jn(e,r),ws(t.a)})}function jn(s,e){if(s.l.s)for(const t of s.l.s)d(t);e()}function An(s,e){var a;var t=(a=s.$$events)==null?void 0:a[e.type],r=es(t)?t.slice():t==null?[]:[t];for(var n of r)n.call(this,e)}function nn(s,e,t){if(s==null)return e(void 0),t&&t(void 0),Ve;const r=ut(()=>s.subscribe(e,t));return r.unsubscribe?()=>r.unsubscribe():r}const qt=[];function Ha(s,e){return{subscribe:Ja(s,e).subscribe}}function Ja(s,e=Ve){let t=null;const r=new Set;function n(o){if(ga(s,o)&&(s=o,t)){const l=!qt.length;for(const c of r)c[1](),qt.push(c,s);if(l){for(let c=0;c<qt.length;c+=2)qt[c][0](qt[c+1]);qt.length=0}}}function a(o){n(o(s))}function i(o,l=Ve){const c=[o,l];return r.add(c),r.size===1&&(t=e(n,a)||Ve),o(s),()=>{r.delete(c),r.size===0&&t&&(t(),t=null)}}return{set:n,update:a,subscribe:i}}function Ga(s,e,t){const r=!Array.isArray(s),n=r?[s]:s;if(!n.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const a=e.length<2;return Ha(t,(i,o)=>{let l=!1;const c=[];let u=0,h=Ve;const f=()=>{if(u)return;h();const g=e(r?c[0]:c,i,o);a?i(g):h=typeof g=="function"?g:Ve},v=n.map((g,k)=>nn(g,m=>{c[k]=m,u&=~(1<<k),l&&f()},()=>{u|=1<<k}));return l=!0,f(),function(){ws(v),h(),l=!1}})}function Jo(s){let e;return nn(s,t=>e=t)(),e}let Ls=!1,Lr=Symbol();function Ps(s,e,t){const r=t[e]??(t[e]={store:null,source:$t(void 0),unsubscribe:Ve});if(r.store!==s&&!(Lr in t))if(r.unsubscribe(),r.store=s??null,s==null)r.source.v=void 0,r.unsubscribe=Ve;else{var n=!0;r.unsubscribe=nn(s,a=>{n?r.source.v=a:_(r.source,a)}),n=!1}return s&&Lr in t?Jo(s):d(r.source)}function Ms(){const s={};function e(){Xr(()=>{for(var t in s)s[t].unsubscribe();la(s,Lr,{enumerable:!1,value:!0})})}return[s,e]}function Go(s){var e=Ls;try{return Ls=!1,[s(),Ls]}finally{Ls=e}}const Ko={get(s,e){let t=s.props.length;for(;t--;){let r=s.props[t];if(Gt(r)&&(r=r()),typeof r=="object"&&r!==null&&e in r)return r[e]}},set(s,e,t){let r=s.props.length;for(;r--;){let n=s.props[r];Gt(n)&&(n=n());const a=xt(n,e);if(a&&a.set)return a.set(t),!0}return!1},getOwnPropertyDescriptor(s,e){let t=s.props.length;for(;t--;){let r=s.props[t];if(Gt(r)&&(r=r()),typeof r=="object"&&r!==null&&e in r){const n=xt(r,e);return n&&!n.configurable&&(n.configurable=!0),n}}},has(s,e){if(e===ot||e===va)return!1;for(let t of s.props)if(Gt(t)&&(t=t()),t!=null&&e in t)return!0;return!1},ownKeys(s){const e=[];for(let t of s.props)if(Gt(t)&&(t=t()),!!t){for(const r in t)e.includes(r)||e.push(r);for(const r of Object.getOwnPropertySymbols(t))e.includes(r)||e.push(r)}return e}};function Pn(...s){return new Proxy({props:s},Ko)}function Mn(s){var e;return((e=s.ctx)==null?void 0:e.d)??!1}function ge(s,e,t,r){var T;var n=(t&Ni)!==0,a=!ss||(t&Bi)!==0,i=(t&zi)!==0,o=(t&Vi)!==0,l=!1,c;i?[c,l]=Go(()=>s[e]):c=s[e];var u=ot in s||va in s,h=i&&(((T=xt(s,e))==null?void 0:T.set)??(u&&e in s&&(O=>s[e]=O)))||void 0,f=r,v=!0,g=!1,k=()=>(g=!0,v&&(v=!1,o?f=ut(r):f=r),f);c===void 0&&r!==void 0&&(h&&a&&Ci(),c=k(),h&&h(c));var m;if(a)m=()=>{var O=s[e];return O===void 0?k():(v=!0,g=!1,O)};else{var P=(n?Qt:Zr)(()=>s[e]);P.f|=xi,m=()=>{var O=d(P);return O!==void 0&&(f=void 0),O===void 0?f:O}}if((t&Fi)===0&&a)return m;if(h){var j=s.$$legacy;return function(O,I){return arguments.length>0?((!a||!I||j||l)&&h(I?m():O),O):m()}}var S=!1,b=$t(c),x=Qt(()=>{var O=m(),I=d(b);return S?(S=!1,I):b.v=O});return i&&d(x),n||(x.equals=Kr),function(O,I){if(arguments.length>0){const D=I?d(x):a&&i?B(O):O;if(!x.equals(D)){if(S=!0,_(b,D),g&&f!==void 0&&(f=D),Mn(x))return O;ut(()=>d(x))}return O}return Mn(x)?x.v:d(x)}}function He(s){me===null&&ir(),ss&&me.l!==null?Ka(me).m.push(s):Ce(()=>{const e=ut(s);if(typeof e=="function")return e})}function Yo(s){me===null&&ir(),He(()=>()=>ut(s))}function Qo(s,e,{bubbles:t=!1,cancelable:r=!1}={}){return new CustomEvent(s,{detail:e,bubbles:t,cancelable:r})}function Zo(){const s=me;return s===null&&ir(),(e,t,r)=>{var a;const n=(a=s.s.$$events)==null?void 0:a[e];if(n){const i=es(n)?n.slice():[n],o=Qo(e,t,r);for(const l of i)l.call(s.x,o);return!o.defaultPrevented}return!0}}function Xo(s){me===null&&ir(),me.l===null&&Mi(),Ka(me).a.push(s)}function Ka(s){var e=s.l;return e.u??(e.u={a:[],b:[],m:[]})}const el="5";var oa;typeof window<"u"&&((oa=window.__svelte??(window.__svelte={})).v??(oa.v=new Set)).add(el);const tl="modulepreload",sl=function(s){return"/"+s},Cn={},Cs=function(e,t,r){let n=Promise.resolve();if(t&&t.length>0){let i=function(c){return Promise.all(c.map(u=>Promise.resolve(u).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));n=i(t.map(c=>{if(c=sl(c),c in Cn)return;Cn[c]=!0;const u=c.endsWith(".css"),h=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${h}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":tl,u||(f.as="script"),f.crossOrigin="",f.href=c,l&&f.setAttribute("nonce",l),document.head.appendChild(f),u)return new Promise((v,g)=>{f.addEventListener("load",v),f.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${c}`)))})}))}function a(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return n.then(i=>{for(const o of i||[])o.status==="rejected"&&a(o.reason);return e().catch(a)})},rl=s=>{let e;return s?e=s:typeof fetch>"u"?e=(...t)=>Cs(async()=>{const{default:r}=await Promise.resolve().then(()=>ls);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)};class an extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class nl extends an{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class al extends an{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class il extends an{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var qr;(function(s){s.Any="any",s.ApNortheast1="ap-northeast-1",s.ApNortheast2="ap-northeast-2",s.ApSouth1="ap-south-1",s.ApSoutheast1="ap-southeast-1",s.ApSoutheast2="ap-southeast-2",s.CaCentral1="ca-central-1",s.EuCentral1="eu-central-1",s.EuWest1="eu-west-1",s.EuWest2="eu-west-2",s.EuWest3="eu-west-3",s.SaEast1="sa-east-1",s.UsEast1="us-east-1",s.UsWest1="us-west-1",s.UsWest2="us-west-2"})(qr||(qr={}));var ol=function(s,e,t,r){function n(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(u){try{c(r.next(u))}catch(h){i(h)}}function l(u){try{c(r.throw(u))}catch(h){i(h)}}function c(u){u.done?a(u.value):n(u.value).then(o,l)}c((r=r.apply(s,e||[])).next())})};class ll{constructor(e,{headers:t={},customFetch:r,region:n=qr.Any}={}){this.url=e,this.headers=t,this.region=n,this.fetch=rl(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var r;return ol(this,void 0,void 0,function*(){try{const{headers:n,method:a,body:i}=t;let o={},{region:l}=t;l||(l=this.region),l&&l!=="any"&&(o["x-region"]=l);let c;i&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&(typeof Blob<"u"&&i instanceof Blob||i instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",c=i):typeof i=="string"?(o["Content-Type"]="text/plain",c=i):typeof FormData<"u"&&i instanceof FormData?c=i:(o["Content-Type"]="application/json",c=JSON.stringify(i)));const u=yield this.fetch(`${this.url}/${e}`,{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),n),body:c}).catch(g=>{throw new nl(g)}),h=u.headers.get("x-relay-error");if(h&&h==="true")throw new al(u);if(!u.ok)throw new il(u);let f=((r=u.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),v;return f==="application/json"?v=yield u.json():f==="application/octet-stream"?v=yield u.blob():f==="text/event-stream"?v=u:f==="multipart/form-data"?v=yield u.formData():v=yield u.text(),{data:v,error:null}}catch(n){return{data:null,error:n}}})}}function cl(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}function ul(s){if(Object.prototype.hasOwnProperty.call(s,"__esModule"))return s;var e=s.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(s).forEach(function(r){var n=Object.getOwnPropertyDescriptor(s,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return s[r]}})}),t}var je={},Ut={},Nt={},Bt={},Ft={},zt={},dl=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Xt=dl();const hl=Xt.fetch,Ya=Xt.fetch.bind(Xt),Qa=Xt.Headers,fl=Xt.Request,vl=Xt.Response,ls=Object.freeze(Object.defineProperty({__proto__:null,Headers:Qa,Request:fl,Response:vl,default:Ya,fetch:hl},Symbol.toStringTag,{value:"Module"})),pl=ul(ls);var qs={},In;function Za(){if(In)return qs;In=1,Object.defineProperty(qs,"__esModule",{value:!0});class s extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return qs.default=s,qs}var $n;function Xa(){if($n)return zt;$n=1;var s=zt&&zt.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(zt,"__esModule",{value:!0});const e=s(pl),t=s(Za());class r{constructor(a){this.shouldThrowOnError=!1,this.method=a.method,this.url=a.url,this.headers=a.headers,this.schema=a.schema,this.body=a.body,this.shouldThrowOnError=a.shouldThrowOnError,this.signal=a.signal,this.isMaybeSingle=a.isMaybeSingle,a.fetch?this.fetch=a.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(a,i){return this.headers=Object.assign({},this.headers),this.headers[a]=i,this}then(a,i){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const o=this.fetch;let l=o(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var u,h,f;let v=null,g=null,k=null,m=c.status,P=c.statusText;if(c.ok){if(this.method!=="HEAD"){const x=await c.text();x===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?g=x:g=JSON.parse(x))}const S=(u=this.headers.Prefer)===null||u===void 0?void 0:u.match(/count=(exact|planned|estimated)/),b=(h=c.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");S&&b&&b.length>1&&(k=parseInt(b[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(g)&&(g.length>1?(v={code:"PGRST116",details:`Results contain ${g.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},g=null,k=null,m=406,P="Not Acceptable"):g.length===1?g=g[0]:g=null)}else{const S=await c.text();try{v=JSON.parse(S),Array.isArray(v)&&c.status===404&&(g=[],v=null,m=200,P="OK")}catch{c.status===404&&S===""?(m=204,P="No Content"):v={message:S}}if(v&&this.isMaybeSingle&&(!((f=v==null?void 0:v.details)===null||f===void 0)&&f.includes("0 rows"))&&(v=null,m=200,P="OK"),v&&this.shouldThrowOnError)throw new t.default(v)}return{error:v,data:g,count:k,status:m,statusText:P}});return this.shouldThrowOnError||(l=l.catch(c=>{var u,h,f;return{error:{message:`${(u=c==null?void 0:c.name)!==null&&u!==void 0?u:"FetchError"}: ${c==null?void 0:c.message}`,details:`${(h=c==null?void 0:c.stack)!==null&&h!==void 0?h:""}`,hint:"",code:`${(f=c==null?void 0:c.code)!==null&&f!==void 0?f:""}`},data:null,count:null,status:0,statusText:""}})),l.then(a,i)}returns(){return this}overrideTypes(){return this}}return zt.default=r,zt}var Rn;function ei(){if(Rn)return Ft;Rn=1;var s=Ft&&Ft.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Ft,"__esModule",{value:!0});const e=s(Xa());class t extends e.default{select(n){let a=!1;const i=(n??"*").split("").map(o=>/\s/.test(o)&&!a?"":(o==='"'&&(a=!a),o)).join("");return this.url.searchParams.set("select",i),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(n,{ascending:a=!0,nullsFirst:i,foreignTable:o,referencedTable:l=o}={}){const c=l?`${l}.order`:"order",u=this.url.searchParams.get(c);return this.url.searchParams.set(c,`${u?`${u},`:""}${n}.${a?"asc":"desc"}${i===void 0?"":i?".nullsfirst":".nullslast"}`),this}limit(n,{foreignTable:a,referencedTable:i=a}={}){const o=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(o,`${n}`),this}range(n,a,{foreignTable:i,referencedTable:o=i}={}){const l=typeof o>"u"?"offset":`${o}.offset`,c=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(l,`${n}`),this.url.searchParams.set(c,`${a-n+1}`),this}abortSignal(n){return this.signal=n,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:n=!1,verbose:a=!1,settings:i=!1,buffers:o=!1,wal:l=!1,format:c="text"}={}){var u;const h=[n?"analyze":null,a?"verbose":null,i?"settings":null,o?"buffers":null,l?"wal":null].filter(Boolean).join("|"),f=(u=this.headers.Accept)!==null&&u!==void 0?u:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${c}; for="${f}"; options=${h};`,c==="json"?this:this}rollback(){var n;return((n=this.headers.Prefer)!==null&&n!==void 0?n:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return Ft.default=t,Ft}var Dn;function on(){if(Dn)return Bt;Dn=1;var s=Bt&&Bt.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Bt,"__esModule",{value:!0});const e=s(ei());class t extends e.default{eq(n,a){return this.url.searchParams.append(n,`eq.${a}`),this}neq(n,a){return this.url.searchParams.append(n,`neq.${a}`),this}gt(n,a){return this.url.searchParams.append(n,`gt.${a}`),this}gte(n,a){return this.url.searchParams.append(n,`gte.${a}`),this}lt(n,a){return this.url.searchParams.append(n,`lt.${a}`),this}lte(n,a){return this.url.searchParams.append(n,`lte.${a}`),this}like(n,a){return this.url.searchParams.append(n,`like.${a}`),this}likeAllOf(n,a){return this.url.searchParams.append(n,`like(all).{${a.join(",")}}`),this}likeAnyOf(n,a){return this.url.searchParams.append(n,`like(any).{${a.join(",")}}`),this}ilike(n,a){return this.url.searchParams.append(n,`ilike.${a}`),this}ilikeAllOf(n,a){return this.url.searchParams.append(n,`ilike(all).{${a.join(",")}}`),this}ilikeAnyOf(n,a){return this.url.searchParams.append(n,`ilike(any).{${a.join(",")}}`),this}is(n,a){return this.url.searchParams.append(n,`is.${a}`),this}in(n,a){const i=Array.from(new Set(a)).map(o=>typeof o=="string"&&new RegExp("[,()]").test(o)?`"${o}"`:`${o}`).join(",");return this.url.searchParams.append(n,`in.(${i})`),this}contains(n,a){return typeof a=="string"?this.url.searchParams.append(n,`cs.${a}`):Array.isArray(a)?this.url.searchParams.append(n,`cs.{${a.join(",")}}`):this.url.searchParams.append(n,`cs.${JSON.stringify(a)}`),this}containedBy(n,a){return typeof a=="string"?this.url.searchParams.append(n,`cd.${a}`):Array.isArray(a)?this.url.searchParams.append(n,`cd.{${a.join(",")}}`):this.url.searchParams.append(n,`cd.${JSON.stringify(a)}`),this}rangeGt(n,a){return this.url.searchParams.append(n,`sr.${a}`),this}rangeGte(n,a){return this.url.searchParams.append(n,`nxl.${a}`),this}rangeLt(n,a){return this.url.searchParams.append(n,`sl.${a}`),this}rangeLte(n,a){return this.url.searchParams.append(n,`nxr.${a}`),this}rangeAdjacent(n,a){return this.url.searchParams.append(n,`adj.${a}`),this}overlaps(n,a){return typeof a=="string"?this.url.searchParams.append(n,`ov.${a}`):this.url.searchParams.append(n,`ov.{${a.join(",")}}`),this}textSearch(n,a,{config:i,type:o}={}){let l="";o==="plain"?l="pl":o==="phrase"?l="ph":o==="websearch"&&(l="w");const c=i===void 0?"":`(${i})`;return this.url.searchParams.append(n,`${l}fts${c}.${a}`),this}match(n){return Object.entries(n).forEach(([a,i])=>{this.url.searchParams.append(a,`eq.${i}`)}),this}not(n,a,i){return this.url.searchParams.append(n,`not.${a}.${i}`),this}or(n,{foreignTable:a,referencedTable:i=a}={}){const o=i?`${i}.or`:"or";return this.url.searchParams.append(o,`(${n})`),this}filter(n,a,i){return this.url.searchParams.append(n,`${a}.${i}`),this}}return Bt.default=t,Bt}var Ln;function ti(){if(Ln)return Nt;Ln=1;var s=Nt&&Nt.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Nt,"__esModule",{value:!0});const e=s(on());class t{constructor(n,{headers:a={},schema:i,fetch:o}){this.url=n,this.headers=a,this.schema=i,this.fetch=o}select(n,{head:a=!1,count:i}={}){const o=a?"HEAD":"GET";let l=!1;const c=(n??"*").split("").map(u=>/\s/.test(u)&&!l?"":(u==='"'&&(l=!l),u)).join("");return this.url.searchParams.set("select",c),i&&(this.headers.Prefer=`count=${i}`),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(n,{count:a,defaultToNull:i=!0}={}){const o="POST",l=[];if(this.headers.Prefer&&l.push(this.headers.Prefer),a&&l.push(`count=${a}`),i||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(n)){const c=n.reduce((u,h)=>u.concat(Object.keys(h)),[]);if(c.length>0){const u=[...new Set(c)].map(h=>`"${h}"`);this.url.searchParams.set("columns",u.join(","))}}return new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}upsert(n,{onConflict:a,ignoreDuplicates:i=!1,count:o,defaultToNull:l=!0}={}){const c="POST",u=[`resolution=${i?"ignore":"merge"}-duplicates`];if(a!==void 0&&this.url.searchParams.set("on_conflict",a),this.headers.Prefer&&u.push(this.headers.Prefer),o&&u.push(`count=${o}`),l||u.push("missing=default"),this.headers.Prefer=u.join(","),Array.isArray(n)){const h=n.reduce((f,v)=>f.concat(Object.keys(v)),[]);if(h.length>0){const f=[...new Set(h)].map(v=>`"${v}"`);this.url.searchParams.set("columns",f.join(","))}}return new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}update(n,{count:a}={}){const i="PATCH",o=[];return this.headers.Prefer&&o.push(this.headers.Prefer),a&&o.push(`count=${a}`),this.headers.Prefer=o.join(","),new e.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}delete({count:n}={}){const a="DELETE",i=[];return n&&i.push(`count=${n}`),this.headers.Prefer&&i.unshift(this.headers.Prefer),this.headers.Prefer=i.join(","),new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return Nt.default=t,Nt}var ds={},hs={},qn;function gl(){return qn||(qn=1,Object.defineProperty(hs,"__esModule",{value:!0}),hs.version=void 0,hs.version="0.0.0-automated"),hs}var Un;function ml(){if(Un)return ds;Un=1,Object.defineProperty(ds,"__esModule",{value:!0}),ds.DEFAULT_HEADERS=void 0;const s=gl();return ds.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${s.version}`},ds}var Nn;function _l(){if(Nn)return Ut;Nn=1;var s=Ut&&Ut.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(Ut,"__esModule",{value:!0});const e=s(ti()),t=s(on()),r=ml();class n{constructor(i,{headers:o={},schema:l,fetch:c}={}){this.url=i,this.headers=Object.assign(Object.assign({},r.DEFAULT_HEADERS),o),this.schemaName=l,this.fetch=c}from(i){const o=new URL(`${this.url}/${i}`);return new e.default(o,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(i){return new n(this.url,{headers:this.headers,schema:i,fetch:this.fetch})}rpc(i,o={},{head:l=!1,get:c=!1,count:u}={}){let h;const f=new URL(`${this.url}/rpc/${i}`);let v;l||c?(h=l?"HEAD":"GET",Object.entries(o).filter(([k,m])=>m!==void 0).map(([k,m])=>[k,Array.isArray(m)?`{${m.join(",")}}`:`${m}`]).forEach(([k,m])=>{f.searchParams.append(k,m)})):(h="POST",v=o);const g=Object.assign({},this.headers);return u&&(g.Prefer=`count=${u}`),new t.default({method:h,url:f,headers:g,schema:this.schemaName,body:v,fetch:this.fetch,allowEmpty:!1})}}return Ut.default=n,Ut}var Bn;function yl(){if(Bn)return je;Bn=1;var s=je&&je.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(je,"__esModule",{value:!0}),je.PostgrestError=je.PostgrestBuilder=je.PostgrestTransformBuilder=je.PostgrestFilterBuilder=je.PostgrestQueryBuilder=je.PostgrestClient=void 0;const e=s(_l());je.PostgrestClient=e.default;const t=s(ti());je.PostgrestQueryBuilder=t.default;const r=s(on());je.PostgrestFilterBuilder=r.default;const n=s(ei());je.PostgrestTransformBuilder=n.default;const a=s(Xa());je.PostgrestBuilder=a.default;const i=s(Za());return je.PostgrestError=i.default,je.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:r.default,PostgrestTransformBuilder:n.default,PostgrestBuilder:a.default,PostgrestError:i.default},je}var wl=yl();const bl=cl(wl),{PostgrestClient:kl,PostgrestQueryBuilder:oh,PostgrestFilterBuilder:lh,PostgrestTransformBuilder:ch,PostgrestBuilder:uh,PostgrestError:dh}=bl;let Ur;typeof window>"u"?Ur=require("ws"):Ur=window.WebSocket;const Sl="2.11.10",El={"X-Client-Info":`realtime-js/${Sl}`},xl="1.0.0",si=1e4,Tl=1e3;var Yt;(function(s){s[s.connecting=0]="connecting",s[s.open=1]="open",s[s.closing=2]="closing",s[s.closed=3]="closed"})(Yt||(Yt={}));var Ie;(function(s){s.closed="closed",s.errored="errored",s.joined="joined",s.joining="joining",s.leaving="leaving"})(Ie||(Ie={}));var st;(function(s){s.close="phx_close",s.error="phx_error",s.join="phx_join",s.reply="phx_reply",s.leave="phx_leave",s.access_token="access_token"})(st||(st={}));var Nr;(function(s){s.websocket="websocket"})(Nr||(Nr={}));var It;(function(s){s.Connecting="connecting",s.Open="open",s.Closing="closing",s.Closed="closed"})(It||(It={}));class Ol{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const n=t.getUint8(1),a=t.getUint8(2);let i=this.HEADER_LENGTH+2;const o=r.decode(e.slice(i,i+n));i=i+n;const l=r.decode(e.slice(i,i+a));i=i+a;const c=JSON.parse(r.decode(e.slice(i,e.byteLength)));return{ref:null,topic:o,event:l,payload:c}}}class ri{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var be;(function(s){s.abstime="abstime",s.bool="bool",s.date="date",s.daterange="daterange",s.float4="float4",s.float8="float8",s.int2="int2",s.int4="int4",s.int4range="int4range",s.int8="int8",s.int8range="int8range",s.json="json",s.jsonb="jsonb",s.money="money",s.numeric="numeric",s.oid="oid",s.reltime="reltime",s.text="text",s.time="time",s.timestamp="timestamp",s.timestamptz="timestamptz",s.timetz="timetz",s.tsrange="tsrange",s.tstzrange="tstzrange"})(be||(be={}));const Fn=(s,e,t={})=>{var r;const n=(r=t.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((a,i)=>(a[i]=jl(i,s,e,n),a),{})},jl=(s,e,t,r)=>{const n=e.find(o=>o.name===s),a=n==null?void 0:n.type,i=t[s];return a&&!r.includes(a)?ni(a,i):Br(i)},ni=(s,e)=>{if(s.charAt(0)==="_"){const t=s.slice(1,s.length);return Cl(e,t)}switch(s){case be.bool:return Al(e);case be.float4:case be.float8:case be.int2:case be.int4:case be.int8:case be.numeric:case be.oid:return Pl(e);case be.json:case be.jsonb:return Ml(e);case be.timestamp:return Il(e);case be.abstime:case be.date:case be.daterange:case be.int4range:case be.int8range:case be.money:case be.reltime:case be.text:case be.time:case be.timestamptz:case be.timetz:case be.tsrange:case be.tstzrange:return Br(e);default:return Br(e)}},Br=s=>s,Al=s=>{switch(s){case"t":return!0;case"f":return!1;default:return s}},Pl=s=>{if(typeof s=="string"){const e=parseFloat(s);if(!Number.isNaN(e))return e}return s},Ml=s=>{if(typeof s=="string")try{return JSON.parse(s)}catch(e){return console.log(`JSON parse error: ${e}`),s}return s},Cl=(s,e)=>{if(typeof s!="string")return s;const t=s.length-1,r=s[t];if(s[0]==="{"&&r==="}"){let a;const i=s.slice(1,t);try{a=JSON.parse("["+i+"]")}catch{a=i?i.split(","):[]}return a.map(o=>ni(e,o))}return s},Il=s=>typeof s=="string"?s.replace(" ","T"):s,ai=s=>{let e=s;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class kr{constructor(e,t,r={},n=si){this.channel=e,this.event=t,this.payload=r,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var zn;(function(s){s.SYNC="sync",s.JOIN="join",s.LEAVE="leave"})(zn||(zn={}));class ms{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},n=>{const{onJoin:a,onLeave:i,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ms.syncState(this.state,n,a,i),this.pendingDiffs.forEach(l=>{this.state=ms.syncDiff(this.state,l,a,i)}),this.pendingDiffs=[],o()}),this.channel._on(r.diff,{},n=>{const{onJoin:a,onLeave:i,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=ms.syncDiff(this.state,n,a,i),o())}),this.onJoin((n,a,i)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:a,newPresences:i})}),this.onLeave((n,a,i)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:a,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,n){const a=this.cloneDeep(e),i=this.transformState(t),o={},l={};return this.map(a,(c,u)=>{i[c]||(l[c]=u)}),this.map(i,(c,u)=>{const h=a[c];if(h){const f=u.map(m=>m.presence_ref),v=h.map(m=>m.presence_ref),g=u.filter(m=>v.indexOf(m.presence_ref)<0),k=h.filter(m=>f.indexOf(m.presence_ref)<0);g.length>0&&(o[c]=g),k.length>0&&(l[c]=k)}else o[c]=u}),this.syncDiff(a,{joins:o,leaves:l},r,n)}static syncDiff(e,t,r,n){const{joins:a,leaves:i}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),n||(n=()=>{}),this.map(a,(o,l)=>{var c;const u=(c=e[o])!==null&&c!==void 0?c:[];if(e[o]=this.cloneDeep(l),u.length>0){const h=e[o].map(v=>v.presence_ref),f=u.filter(v=>h.indexOf(v.presence_ref)<0);e[o].unshift(...f)}r(o,u,l)}),this.map(i,(o,l)=>{let c=e[o];if(!c)return;const u=l.map(h=>h.presence_ref);c=c.filter(h=>u.indexOf(h.presence_ref)<0),e[o]=c,n(o,c,l),c.length===0&&delete e[o]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const n=e[r];return"metas"in n?t[r]=n.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):t[r]=n,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Vn;(function(s){s.ALL="*",s.INSERT="INSERT",s.UPDATE="UPDATE",s.DELETE="DELETE"})(Vn||(Vn={}));var Wn;(function(s){s.BROADCAST="broadcast",s.PRESENCE="presence",s.POSTGRES_CHANGES="postgres_changes",s.SYSTEM="system"})(Wn||(Wn={}));var ft;(function(s){s.SUBSCRIBED="SUBSCRIBED",s.TIMED_OUT="TIMED_OUT",s.CLOSED="CLOSED",s.CHANNEL_ERROR="CHANNEL_ERROR"})(ft||(ft={}));class ln{constructor(e,t={config:{}},r){this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=Ie.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new kr(this,st.join,this.params,this.timeout),this.rejoinTimer=new ri(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ie.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(n=>n.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ie.closed,this.socket._remove(this)}),this._onError(n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=Ie.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ie.errored,this.rejoinTimer.scheduleTimeout())}),this._on(st.reply,{},(n,a)=>{this._trigger(this._replyEventName(a),n)}),this.presence=new ms(this),this.broadcastEndpointURL=ai(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var r,n;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:a,presence:i,private:o}}=this.params;this._onError(u=>e==null?void 0:e(ft.CHANNEL_ERROR,u)),this._onClose(()=>e==null?void 0:e(ft.CLOSED));const l={},c={broadcast:a,presence:i,postgres_changes:(n=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(u=>u.filter))!==null&&n!==void 0?n:[],private:o};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:u})=>{var h;if(this.socket.setAuth(),u===void 0){e==null||e(ft.SUBSCRIBED);return}else{const f=this.bindings.postgres_changes,v=(h=f==null?void 0:f.length)!==null&&h!==void 0?h:0,g=[];for(let k=0;k<v;k++){const m=f[k],{filter:{event:P,schema:j,table:S,filter:b}}=m,x=u&&u[k];if(x&&x.event===P&&x.schema===j&&x.table===S&&x.filter===b)g.push(Object.assign(Object.assign({},m),{id:x.id}));else{this.unsubscribe(),this.state=Ie.errored,e==null||e(ft.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=g,e&&e(ft.SUBSCRIBED);return}}).receive("error",u=>{this.state=Ie.errored,e==null||e(ft.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(ft.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this._on(e,t,r)}async send(e,t={}){var r,n;if(!this._canPush()&&e.type==="broadcast"){const{event:a,payload:i}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:i,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(r=t.timeout)!==null&&r!==void 0?r:this.timeout);return await((n=c.body)===null||n===void 0?void 0:n.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var i,o,l;const c=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(o=(i=this.params)===null||i===void 0?void 0:i.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&a("ok"),c.receive("ok",()=>a("ok")),c.receive("error",()=>a("error")),c.receive("timeout",()=>a("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Ie.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(st.close,"leave",this._joinRef())};return this.joinPush.destroy(),new Promise(r=>{const n=new kr(this,st.leave,{},e);n.receive("ok",()=>{t(),r("ok")}).receive("timeout",()=>{t(),r("timed out")}).receive("error",()=>{r("error")}),n.send(),this._canPush()||n.trigger("ok",{})})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,t,r){const n=new AbortController,a=setTimeout(()=>n.abort(),r),i=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:n.signal}));return clearTimeout(a),i}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new kr(this,e,t,r);return this._canPush()?n.send():(n.startTimeout(),this.pushBuffer.push(n)),n}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var n,a;const i=e.toLocaleLowerCase(),{close:o,error:l,leave:c,join:u}=st;if(r&&[o,l,c,u].indexOf(i)>=0&&r!==this._joinRef())return;let f=this._onMessage(i,t,r);if(t&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(v=>{var g,k,m;return((g=v.filter)===null||g===void 0?void 0:g.event)==="*"||((m=(k=v.filter)===null||k===void 0?void 0:k.event)===null||m===void 0?void 0:m.toLocaleLowerCase())===i}).map(v=>v.callback(f,r)):(a=this.bindings[i])===null||a===void 0||a.filter(v=>{var g,k,m,P,j,S;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in v){const b=v.id,x=(g=v.filter)===null||g===void 0?void 0:g.event;return b&&((k=t.ids)===null||k===void 0?void 0:k.includes(b))&&(x==="*"||(x==null?void 0:x.toLocaleLowerCase())===((m=t.data)===null||m===void 0?void 0:m.type.toLocaleLowerCase()))}else{const b=(j=(P=v==null?void 0:v.filter)===null||P===void 0?void 0:P.event)===null||j===void 0?void 0:j.toLocaleLowerCase();return b==="*"||b===((S=t==null?void 0:t.event)===null||S===void 0?void 0:S.toLocaleLowerCase())}else return v.type.toLocaleLowerCase()===i}).map(v=>{if(typeof f=="object"&&"ids"in f){const g=f.data,{schema:k,table:m,commit_timestamp:P,type:j,errors:S}=g;f=Object.assign(Object.assign({},{schema:k,table:m,commit_timestamp:P,eventType:j,new:{},old:{},errors:S}),this._getPayloadRecords(g))}v.callback(f,r)})}_isClosed(){return this.state===Ie.closed}_isJoined(){return this.state===Ie.joined}_isJoining(){return this.state===Ie.joining}_isLeaving(){return this.state===Ie.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const n=e.toLocaleLowerCase(),a={type:n,filter:t,callback:r};return this.bindings[n]?this.bindings[n].push(a):this.bindings[n]=[a],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(n=>{var a;return!(((a=n.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===r&&ln.isEqual(n.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(st.close,{},e)}_onError(e){this._on(st.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ie.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=Fn(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=Fn(e.columns,e.old_record)),t}}const Hn=()=>{},$l=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Rl{constructor(e,t){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers=El,this.params={},this.timeout=si,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Hn,this.ref=0,this.logger=Hn,this.conn=null,this.sendBuffer=[],this.serializer=new Ol,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=a=>{let i;return a?i=a:typeof fetch>"u"?i=(...o)=>Cs(async()=>{const{default:l}=await Promise.resolve().then(()=>ls);return{default:l}},void 0).then(({default:l})=>l(...o)):i=fetch,(...o)=>i(...o)},this.endPoint=`${e}/${Nr.websocket}`,this.httpEndpoint=ai(e),t!=null&&t.transport?this.transport=t.transport:this.transport=null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.headers&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const n=(r=t==null?void 0:t.params)===null||r===void 0?void 0:r.apikey;if(n&&(this.accessTokenValue=n,this.apiKey=n),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:a=>[1e3,2e3,5e3,1e4][a-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(a,i)=>i(JSON.stringify(a)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new ri(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t==null?void 0:t.fetch),t!=null&&t.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(t==null?void 0:t.worker)||!1,this.workerUrl=t==null?void 0:t.workerUrl}this.accessToken=(t==null?void 0:t.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=Ur),this.transport){typeof window<"u"&&this.transport===window.WebSocket?this.conn=new this.transport(this.endpointURL()):this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection();return}this.conn=new Dl(this.endpointURL(),void 0,{close:()=>{this.conn=null}})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:xl}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(r=>r.teardown()))}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels=this.channels.filter(r=>r._joinRef!==e._joinRef),this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Yt.connecting:return It.Connecting;case Yt.open:return It.Open;case Yt.closing:return It.Closing;default:return It.Closed}}isConnected(){return this.connectionState()===It.Open}channel(e,t={config:{}}){const r=`realtime:${e}`,n=this.getChannels().find(a=>a.topic===r);if(n)return n;{const a=new ln(`realtime:${e}`,t,this);return this.channels.push(a),a}}push(e){const{topic:t,event:r,payload:n,ref:a}=e,i=()=>{this.encode(e,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${t} ${r} (${a})`,n),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(r=>{t&&r.updateJoinPayload({access_token:t,version:this.headers&&this.headers["X-Client-Info"]}),r.joinedOnce&&r._isJoined()&&r._push(st.access_token,{access_token:t})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close(Tl,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:r,event:n,payload:a,ref:i}=t;r==="phoenix"&&n==="phx_reply"&&this.heartbeatCallback(t.payload.status=="ok"?"ok":"error"),i&&i===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${a.status||""} ${r} ${n} ${i&&"("+i+")"||""}`,a),Array.from(this.channels).filter(o=>o._isMember(r)).forEach(o=>o._trigger(n,a,i)),this.stateChangeCallbacks.message.forEach(o=>o(t))})}_onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(st.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const r=e.match(/\?/)?"&":"?",n=new URLSearchParams(t);return`${e}${r}${n}`}_workerObjectUrl(e){let t;if(e)t=e;else{const r=new Blob([$l],{type:"application/javascript"});t=URL.createObjectURL(r)}return t}}class Dl{constructor(e,t,r){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=Yt.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=r.close}}class cn extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Ae(s){return typeof s=="object"&&s!==null&&"__isStorageError"in s}class Ll extends cn{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Fr extends cn{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var ql=function(s,e,t,r){function n(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(u){try{c(r.next(u))}catch(h){i(h)}}function l(u){try{c(r.throw(u))}catch(h){i(h)}}function c(u){u.done?a(u.value):n(u.value).then(o,l)}c((r=r.apply(s,e||[])).next())})};const ii=s=>{let e;return s?e=s:typeof fetch>"u"?e=(...t)=>Cs(async()=>{const{default:r}=await Promise.resolve().then(()=>ls);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},Ul=()=>ql(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Cs(()=>Promise.resolve().then(()=>ls),void 0)).Response:Response}),zr=s=>{if(Array.isArray(s))return s.map(t=>zr(t));if(typeof s=="function"||s!==Object(s))return s;const e={};return Object.entries(s).forEach(([t,r])=>{const n=t.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));e[n]=zr(r)}),e};var Dt=function(s,e,t,r){function n(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(u){try{c(r.next(u))}catch(h){i(h)}}function l(u){try{c(r.throw(u))}catch(h){i(h)}}function c(u){u.done?a(u.value):n(u.value).then(o,l)}c((r=r.apply(s,e||[])).next())})};const Sr=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),Nl=(s,e,t)=>Dt(void 0,void 0,void 0,function*(){const r=yield Ul();s instanceof r&&!(t!=null&&t.noResolveJson)?s.json().then(n=>{e(new Ll(Sr(n),s.status||500))}).catch(n=>{e(new Fr(Sr(n),n))}):e(new Fr(Sr(s),s))}),Bl=(s,e,t,r)=>{const n={method:s,headers:(e==null?void 0:e.headers)||{}};return s==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),r&&(n.body=JSON.stringify(r)),Object.assign(Object.assign({},n),t))};function Is(s,e,t,r,n,a){return Dt(this,void 0,void 0,function*(){return new Promise((i,o)=>{s(t,Bl(e,r,n,a)).then(l=>{if(!l.ok)throw l;return r!=null&&r.noResolveJson?l:l.json()}).then(l=>i(l)).catch(l=>Nl(l,o,r))})})}function tr(s,e,t,r){return Dt(this,void 0,void 0,function*(){return Is(s,"GET",e,t,r)})}function kt(s,e,t,r,n){return Dt(this,void 0,void 0,function*(){return Is(s,"POST",e,r,n,t)})}function Fl(s,e,t,r,n){return Dt(this,void 0,void 0,function*(){return Is(s,"PUT",e,r,n,t)})}function zl(s,e,t,r){return Dt(this,void 0,void 0,function*(){return Is(s,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),r)})}function oi(s,e,t,r,n){return Dt(this,void 0,void 0,function*(){return Is(s,"DELETE",e,r,n,t)})}var Le=function(s,e,t,r){function n(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(u){try{c(r.next(u))}catch(h){i(h)}}function l(u){try{c(r.throw(u))}catch(h){i(h)}}function c(u){u.done?a(u.value):n(u.value).then(o,l)}c((r=r.apply(s,e||[])).next())})};const Vl={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Jn={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Wl{constructor(e,t={},r,n){this.url=e,this.headers=t,this.bucketId=r,this.fetch=ii(n)}uploadOrUpdate(e,t,r,n){return Le(this,void 0,void 0,function*(){try{let a;const i=Object.assign(Object.assign({},Jn),n);let o=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(i.upsert)});const l=i.metadata;typeof Blob<"u"&&r instanceof Blob?(a=new FormData,a.append("cacheControl",i.cacheControl),l&&a.append("metadata",this.encodeMetadata(l)),a.append("",r)):typeof FormData<"u"&&r instanceof FormData?(a=r,a.append("cacheControl",i.cacheControl),l&&a.append("metadata",this.encodeMetadata(l))):(a=r,o["cache-control"]=`max-age=${i.cacheControl}`,o["content-type"]=i.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),n!=null&&n.headers&&(o=Object.assign(Object.assign({},o),n.headers));const c=this._removeEmptyFolders(t),u=this._getFinalPath(c),h=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:e,body:a,headers:o},i!=null&&i.duplex?{duplex:i.duplex}:{})),f=yield h.json();return h.ok?{data:{path:c,id:f.Id,fullPath:f.Key},error:null}:{data:null,error:f}}catch(a){if(Ae(a))return{data:null,error:a};throw a}})}upload(e,t,r){return Le(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,n){return Le(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(e),i=this._getFinalPath(a),o=new URL(this.url+`/object/upload/sign/${i}`);o.searchParams.set("token",t);try{let l;const c=Object.assign({upsert:Jn.upsert},n),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",c.cacheControl)):(l=r,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const h=yield this.fetch(o.toString(),{method:"PUT",body:l,headers:u}),f=yield h.json();return h.ok?{data:{path:a,fullPath:f.Key},error:null}:{data:null,error:f}}catch(l){if(Ae(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,t){return Le(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const n=Object.assign({},this.headers);t!=null&&t.upsert&&(n["x-upsert"]="true");const a=yield kt(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:n}),i=new URL(this.url+a.url),o=i.searchParams.get("token");if(!o)throw new cn("No token returned by API");return{data:{signedUrl:i.toString(),path:e,token:o},error:null}}catch(r){if(Ae(r))return{data:null,error:r};throw r}})}update(e,t,r){return Le(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return Le(this,void 0,void 0,function*(){try{return{data:yield kt(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(Ae(n))return{data:null,error:n};throw n}})}copy(e,t,r){return Le(this,void 0,void 0,function*(){try{return{data:{path:(yield kt(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(Ae(n))return{data:null,error:n};throw n}})}createSignedUrl(e,t,r){return Le(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e),a=yield kt(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${i}`)},{data:a,error:null}}catch(n){if(Ae(n))return{data:null,error:n};throw n}})}createSignedUrls(e,t,r){return Le(this,void 0,void 0,function*(){try{const n=yield kt(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),a=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:n.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${a}`):null})),error:null}}catch(n){if(Ae(n))return{data:null,error:n};throw n}})}download(e,t){return Le(this,void 0,void 0,function*(){const n=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),i=a?`?${a}`:"";try{const o=this._getFinalPath(e);return{data:yield(yield tr(this.fetch,`${this.url}/${n}/${o}${i}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(Ae(o))return{data:null,error:o};throw o}})}info(e){return Le(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const r=yield tr(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:zr(r),error:null}}catch(r){if(Ae(r))return{data:null,error:r};throw r}})}exists(e){return Le(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield zl(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(Ae(r)&&r instanceof Fr){const n=r.originalError;if([400,404].includes(n==null?void 0:n.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,t){const r=this._getFinalPath(e),n=[],a=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";a!==""&&n.push(a);const o=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});l!==""&&n.push(l);let c=n.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${r}${c}`)}}}remove(e){return Le(this,void 0,void 0,function*(){try{return{data:yield oi(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(Ae(t))return{data:null,error:t};throw t}})}list(e,t,r){return Le(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},Vl),t),{prefix:e||""});return{data:yield kt(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(Ae(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const Hl="2.7.1",Jl={"X-Client-Info":`storage-js/${Hl}`};var Vt=function(s,e,t,r){function n(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(u){try{c(r.next(u))}catch(h){i(h)}}function l(u){try{c(r.throw(u))}catch(h){i(h)}}function c(u){u.done?a(u.value):n(u.value).then(o,l)}c((r=r.apply(s,e||[])).next())})};class Gl{constructor(e,t={},r){this.url=e,this.headers=Object.assign(Object.assign({},Jl),t),this.fetch=ii(r)}listBuckets(){return Vt(this,void 0,void 0,function*(){try{return{data:yield tr(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Ae(e))return{data:null,error:e};throw e}})}getBucket(e){return Vt(this,void 0,void 0,function*(){try{return{data:yield tr(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(Ae(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return Vt(this,void 0,void 0,function*(){try{return{data:yield kt(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Ae(r))return{data:null,error:r};throw r}})}updateBucket(e,t){return Vt(this,void 0,void 0,function*(){try{return{data:yield Fl(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Ae(r))return{data:null,error:r};throw r}})}emptyBucket(e){return Vt(this,void 0,void 0,function*(){try{return{data:yield kt(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(Ae(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Vt(this,void 0,void 0,function*(){try{return{data:yield oi(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(Ae(t))return{data:null,error:t};throw t}})}}class Kl extends Gl{constructor(e,t={},r){super(e,t,r)}from(e){return new Wl(this.url,this.headers,e,this.fetch)}}const Yl="2.50.0";let vs="";typeof Deno<"u"?vs="deno":typeof document<"u"?vs="web":typeof navigator<"u"&&navigator.product==="ReactNative"?vs="react-native":vs="node";const Ql={"X-Client-Info":`supabase-js-${vs}/${Yl}`},Zl={headers:Ql},Xl={schema:"public"},ec={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},tc={};var sc=function(s,e,t,r){function n(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(u){try{c(r.next(u))}catch(h){i(h)}}function l(u){try{c(r.throw(u))}catch(h){i(h)}}function c(u){u.done?a(u.value):n(u.value).then(o,l)}c((r=r.apply(s,e||[])).next())})};const rc=s=>{let e;return s?e=s:typeof fetch>"u"?e=Ya:e=fetch,(...t)=>e(...t)},nc=()=>typeof Headers>"u"?Qa:Headers,ac=(s,e,t)=>{const r=rc(t),n=nc();return(a,i)=>sc(void 0,void 0,void 0,function*(){var o;const l=(o=yield e())!==null&&o!==void 0?o:s;let c=new n(i==null?void 0:i.headers);return c.has("apikey")||c.set("apikey",s),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),r(a,Object.assign(Object.assign({},i),{headers:c}))})};var ic=function(s,e,t,r){function n(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(u){try{c(r.next(u))}catch(h){i(h)}}function l(u){try{c(r.throw(u))}catch(h){i(h)}}function c(u){u.done?a(u.value):n(u.value).then(o,l)}c((r=r.apply(s,e||[])).next())})};function oc(s){return s.endsWith("/")?s:s+"/"}function lc(s,e){var t,r;const{db:n,auth:a,realtime:i,global:o}=s,{db:l,auth:c,realtime:u,global:h}=e,f={db:Object.assign(Object.assign({},l),n),auth:Object.assign(Object.assign({},c),a),realtime:Object.assign(Object.assign({},u),i),global:Object.assign(Object.assign(Object.assign({},h),o),{headers:Object.assign(Object.assign({},(t=h==null?void 0:h.headers)!==null&&t!==void 0?t:{}),(r=o==null?void 0:o.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>ic(this,void 0,void 0,function*(){return""})};return s.accessToken?f.accessToken=s.accessToken:delete f.accessToken,f}const li="2.70.0",Kt=30*1e3,Vr=3,Er=Vr*Kt,cc="http://localhost:9999",uc="supabase.auth.token",dc={"X-Client-Info":`gotrue-js/${li}`},Wr="X-Supabase-Api-Version",ci={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},hc=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,fc=6e5;class un extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function ae(s){return typeof s=="object"&&s!==null&&"__isAuthError"in s}class vc extends un{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}function pc(s){return ae(s)&&s.name==="AuthApiError"}class ui extends un{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class jt extends un{constructor(e,t,r,n){super(e,r,n),this.name=t,this.status=r}}class wt extends jt{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function gc(s){return ae(s)&&s.name==="AuthSessionMissingError"}class Us extends jt{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Ns extends jt{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Bs extends jt{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function mc(s){return ae(s)&&s.name==="AuthImplicitGrantRedirectError"}class Gn extends jt{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Hr extends jt{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function xr(s){return ae(s)&&s.name==="AuthRetryableFetchError"}class Kn extends jt{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class _s extends jt{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const sr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Yn=` 	
\r=`.split(""),_c=(()=>{const s=new Array(128);for(let e=0;e<s.length;e+=1)s[e]=-1;for(let e=0;e<Yn.length;e+=1)s[Yn[e].charCodeAt(0)]=-2;for(let e=0;e<sr.length;e+=1)s[sr[e].charCodeAt(0)]=e;return s})();function Qn(s,e,t){if(s!==null)for(e.queue=e.queue<<8|s,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(sr[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(sr[r]),e.queuedBits-=6}}function di(s,e,t){const r=_c[s];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(s)}"`)}}function Zn(s){const e=[],t=i=>{e.push(String.fromCodePoint(i))},r={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},a=i=>{bc(i,r,t)};for(let i=0;i<s.length;i+=1)di(s.charCodeAt(i),n,a);return e.join("")}function yc(s,e){if(s<=127){e(s);return}else if(s<=2047){e(192|s>>6),e(128|s&63);return}else if(s<=65535){e(224|s>>12),e(128|s>>6&63),e(128|s&63);return}else if(s<=1114111){e(240|s>>18),e(128|s>>12&63),e(128|s>>6&63),e(128|s&63);return}throw new Error(`Unrecognized Unicode codepoint: ${s.toString(16)}`)}function wc(s,e){for(let t=0;t<s.length;t+=1){let r=s.charCodeAt(t);if(r>55295&&r<=56319){const n=(r-55296)*1024&65535;r=(s.charCodeAt(t+1)-56320&65535|n)+65536,t+=1}yc(r,e)}}function bc(s,e,t){if(e.utf8seq===0){if(s<=127){t(s);return}for(let r=1;r<6;r+=1)if((s>>7-r&1)===0){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=s&31;else if(e.utf8seq===3)e.codepoint=s&15;else if(e.utf8seq===4)e.codepoint=s&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(s<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|s&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function kc(s){const e=[],t={queue:0,queuedBits:0},r=n=>{e.push(n)};for(let n=0;n<s.length;n+=1)di(s.charCodeAt(n),t,r);return new Uint8Array(e)}function Sc(s){const e=[];return wc(s,t=>e.push(t)),new Uint8Array(e)}function Ec(s){const e=[],t={queue:0,queuedBits:0},r=n=>{e.push(n)};return s.forEach(n=>Qn(n,t,r)),Qn(null,t,r),e.join("")}function xc(s){return Math.round(Date.now()/1e3)+s}function Tc(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(s){const e=Math.random()*16|0;return(s=="x"?e:e&3|8).toString(16)})}const tt=()=>typeof window<"u"&&typeof document<"u",Mt={tested:!1,writable:!1},ys=()=>{if(!tt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Mt.tested)return Mt.writable;const s=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(s,s),globalThis.localStorage.removeItem(s),Mt.tested=!0,Mt.writable=!0}catch{Mt.tested=!0,Mt.writable=!1}return Mt.writable};function Oc(s){const e={},t=new URL(s);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((n,a)=>{e[a]=n})}catch{}return t.searchParams.forEach((r,n)=>{e[n]=r}),e}const hi=s=>{let e;return s?e=s:typeof fetch>"u"?e=(...t)=>Cs(async()=>{const{default:r}=await Promise.resolve().then(()=>ls);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},jc=s=>typeof s=="object"&&s!==null&&"status"in s&&"ok"in s&&"json"in s&&typeof s.json=="function",fi=async(s,e,t)=>{await s.setItem(e,JSON.stringify(t))},Fs=async(s,e)=>{const t=await s.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},zs=async(s,e)=>{await s.removeItem(e)};class fr{constructor(){this.promise=new fr.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}fr.promiseConstructor=Promise;function Tr(s){const e=s.split(".");if(e.length!==3)throw new _s("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!hc.test(e[r]))throw new _s("JWT not in base64url format");return{header:JSON.parse(Zn(e[0])),payload:JSON.parse(Zn(e[1])),signature:kc(e[2]),raw:{header:e[0],payload:e[1]}}}async function Ac(s){return await new Promise(e=>{setTimeout(()=>e(null),s)})}function Pc(s,e){return new Promise((r,n)=>{(async()=>{for(let a=0;a<1/0;a++)try{const i=await s(a);if(!e(a,null,i)){r(i);return}}catch(i){if(!e(a,i)){n(i);return}}})()})}function Mc(s){return("0"+s.toString(16)).substr(-2)}function Cc(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=t.length;let n="";for(let a=0;a<56;a++)n+=t.charAt(Math.floor(Math.random()*r));return n}return crypto.getRandomValues(e),Array.from(e,Mc).join("")}async function Ic(s){const t=new TextEncoder().encode(s),r=await crypto.subtle.digest("SHA-256",t),n=new Uint8Array(r);return Array.from(n).map(a=>String.fromCharCode(a)).join("")}async function $c(s){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),s;const t=await Ic(s);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Wt(s,e,t=!1){const r=Cc();let n=r;t&&(n+="/PASSWORD_RECOVERY"),await fi(s,`${e}-code-verifier`,n);const a=await $c(r);return[a,r===a?"plain":"s256"]}const Rc=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Dc(s){const e=s.headers.get(Wr);if(!e||!e.match(Rc))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Lc(s){if(!s)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(s<=e)throw new Error("JWT has expired")}function qc(s){switch(s){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Uc=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Ht(s){if(!Uc.test(s))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}var Nc=function(s,e){var t={};for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&e.indexOf(r)<0&&(t[r]=s[r]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(s);n<r.length;n++)e.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(s,r[n])&&(t[r[n]]=s[r[n]]);return t};const Ct=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),Bc=[502,503,504];async function Xn(s){var e;if(!jc(s))throw new Hr(Ct(s),0);if(Bc.includes(s.status))throw new Hr(Ct(s),s.status);let t;try{t=await s.json()}catch(a){throw new ui(Ct(a),a)}let r;const n=Dc(s);if(n&&n.getTime()>=ci["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?r=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(r=t.error_code),r){if(r==="weak_password")throw new Kn(Ct(t),s.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new wt}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((a,i)=>a&&typeof i=="string",!0))throw new Kn(Ct(t),s.status,t.weak_password.reasons);throw new vc(Ct(t),s.status||500,r)}const Fc=(s,e,t,r)=>{const n={method:s,headers:(e==null?void 0:e.headers)||{}};return s==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),n.body=JSON.stringify(r),Object.assign(Object.assign({},n),t))};async function ue(s,e,t,r){var n;const a=Object.assign({},r==null?void 0:r.headers);a[Wr]||(a[Wr]=ci["2024-01-01"].name),r!=null&&r.jwt&&(a.Authorization=`Bearer ${r.jwt}`);const i=(n=r==null?void 0:r.query)!==null&&n!==void 0?n:{};r!=null&&r.redirectTo&&(i.redirect_to=r.redirectTo);const o=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",l=await zc(s,e,t+o,{headers:a,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(l):{data:Object.assign({},l),error:null}}async function zc(s,e,t,r,n,a){const i=Fc(e,r,n,a);let o;try{o=await s(t,Object.assign({},i))}catch(l){throw console.error(l),new Hr(Ct(l),0)}if(o.ok||await Xn(o),r!=null&&r.noResolveJson)return o;try{return await o.json()}catch(l){await Xn(l)}}function ht(s){var e;let t=null;Jc(s)&&(t=Object.assign({},s),s.expires_at||(t.expires_at=xc(s.expires_in)));const r=(e=s.user)!==null&&e!==void 0?e:s;return{data:{session:t,user:r},error:null}}function ea(s){const e=ht(s);return!e.error&&s.weak_password&&typeof s.weak_password=="object"&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.message&&typeof s.weak_password.message=="string"&&s.weak_password.reasons.reduce((t,r)=>t&&typeof r=="string",!0)&&(e.data.weak_password=s.weak_password),e}function St(s){var e;return{data:{user:(e=s.user)!==null&&e!==void 0?e:s},error:null}}function Vc(s){return{data:s,error:null}}function Wc(s){const{action_link:e,email_otp:t,hashed_token:r,redirect_to:n,verification_type:a}=s,i=Nc(s,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:e,email_otp:t,hashed_token:r,redirect_to:n,verification_type:a},l=Object.assign({},i);return{data:{properties:o,user:l},error:null}}function Hc(s){return s}function Jc(s){return s.access_token&&s.refresh_token&&s.expires_in}const Or=["global","local","others"];var Gc=function(s,e){var t={};for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&e.indexOf(r)<0&&(t[r]=s[r]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(s);n<r.length;n++)e.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(s,r[n])&&(t[r[n]]=s[r[n]]);return t};class Kc{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=hi(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=Or[0]){if(Or.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Or.join(", ")}`);try{return await ue(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(ae(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await ue(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:St})}catch(r){if(ae(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=Gc(e,["options"]),n=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(n.new_email=r==null?void 0:r.newEmail,delete n.newEmail),await ue(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:Wc,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(ae(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await ue(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:St})}catch(t){if(ae(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,n,a,i,o,l;try{const c={nextPage:null,lastPage:0,total:0},u=await ue(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(a=(n=e==null?void 0:e.perPage)===null||n===void 0?void 0:n.toString())!==null&&a!==void 0?a:""},xform:Hc});if(u.error)throw u.error;const h=await u.json(),f=(i=u.headers.get("x-total-count"))!==null&&i!==void 0?i:0,v=(l=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return v.length>0&&(v.forEach(g=>{const k=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),m=JSON.parse(g.split(";")[1].split("=")[1]);c[`${m}Page`]=k}),c.total=parseInt(f)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(ae(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){Ht(e);try{return await ue(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:St})}catch(t){if(ae(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Ht(e);try{return await ue(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:St})}catch(r){if(ae(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){Ht(e);try{return await ue(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:St})}catch(r){if(ae(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){Ht(e.userId);try{const{data:t,error:r}=await ue(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:t,error:r}}catch(t){if(ae(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Ht(e.userId),Ht(e.id);try{return{data:await ue(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(ae(t))return{data:null,error:t};throw t}}}const Yc={getItem:s=>ys()?globalThis.localStorage.getItem(s):null,setItem:(s,e)=>{ys()&&globalThis.localStorage.setItem(s,e)},removeItem:s=>{ys()&&globalThis.localStorage.removeItem(s)}};function ta(s={}){return{getItem:e=>s[e]||null,setItem:(e,t)=>{s[e]=t},removeItem:e=>{delete s[e]}}}function Qc(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Jt={debug:!!(globalThis&&ys()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class vi extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Zc extends vi{}async function Xc(s,e,t){Jt.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",s,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),Jt.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",s)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(s,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async n=>{if(n){Jt.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",s,n.name);try{return await t()}finally{Jt.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",s,n.name)}}else{if(e===0)throw Jt.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",s),new Zc(`Acquiring an exclusive Navigator LockManager lock "${s}" immediately failed`);if(Jt.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}Qc();const eu={url:cc,storageKey:uc,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:dc,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function sa(s,e,t){return await t()}class xs{constructor(e){var t,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=xs.nextInstanceID,xs.nextInstanceID+=1,this.instanceID>0&&tt()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},eu),e);if(this.logDebugMessages=!!n.debug,typeof n.debug=="function"&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new Kc({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=hi(n.fetch),this.lock=n.lock||sa,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:tt()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=Xc:this.lock=sa,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?n.storage?this.storage=n.storage:ys()?this.storage=Yc:(this.memoryStorage={},this.storage=ta(this.memoryStorage)):(this.memoryStorage={},this.storage=ta(this.memoryStorage)),tt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${li}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=Oc(window.location.href);let r="none";if(this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce"),tt()&&this.detectSessionInUrl&&r!=="none"){const{data:n,error:a}=await this._getSessionFromURL(t,r);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),mc(a)){const l=(e=a.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:i,redirectType:o}=n;return this._debug("#_initialize()","detected session in URL",i,"redirect type",o),await this._saveSession(i),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return ae(t)?{error:t}:{error:new ui("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,n;try{const a=await ue(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.captchaToken}},xform:ht}),{data:i,error:o}=a;if(o||!i)return{data:{user:null,session:null},error:o};const l=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(a){if(ae(a))return{data:{user:null,session:null},error:a};throw a}}async signUp(e){var t,r,n;try{let a;if("email"in e){const{email:u,password:h,options:f}=e;let v=null,g=null;this.flowType==="pkce"&&([v,g]=await Wt(this.storage,this.storageKey)),a=await ue(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:u,password:h,data:(t=f==null?void 0:f.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:v,code_challenge_method:g},xform:ht})}else if("phone"in e){const{phone:u,password:h,options:f}=e;a=await ue(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},channel:(n=f==null?void 0:f.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:ht})}else throw new Ns("You must provide either an email or phone number and a password");const{data:i,error:o}=a;if(o||!i)return{data:{user:null,session:null},error:o};const l=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(a){if(ae(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithPassword(e){try{let t;if("email"in e){const{email:a,password:i,options:o}=e;t=await ue(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:ea})}else if("phone"in e){const{phone:a,password:i,options:o}=e;t=await ue(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:ea})}else throw new Ns("You must provide either an email or phone number and a password");const{data:r,error:n}=t;return n?{data:{user:null,session:null},error:n}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new Us}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:n})}catch(t){if(ae(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,r,n,a;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(a=e.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if(t==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,r,n,a,i,o,l,c,u,h,f,v;let g,k;if("message"in e)g=e.message,k=e.signature;else{const{chain:m,wallet:P,statement:j,options:S}=e;let b;if(tt())if(typeof P=="object")b=P;else{const T=window;if("solana"in T&&typeof T.solana=="object"&&("signIn"in T.solana&&typeof T.solana.signIn=="function"||"signMessage"in T.solana&&typeof T.solana.signMessage=="function"))b=T.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof P!="object"||!(S!=null&&S.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");b=P}const x=new URL((t=S==null?void 0:S.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in b&&b.signIn){const T=await b.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},S==null?void 0:S.signInWithSolana),{version:"1",domain:x.host,uri:x.href}),j?{statement:j}:null));let O;if(Array.isArray(T)&&T[0]&&typeof T[0]=="object")O=T[0];else if(T&&typeof T=="object"&&"signedMessage"in T&&"signature"in T)O=T;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in O&&"signature"in O&&(typeof O.signedMessage=="string"||O.signedMessage instanceof Uint8Array)&&O.signature instanceof Uint8Array)g=typeof O.signedMessage=="string"?O.signedMessage:new TextDecoder().decode(O.signedMessage),k=O.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in b)||typeof b.signMessage!="function"||!("publicKey"in b)||typeof b!="object"||!b.publicKey||!("toBase58"in b.publicKey)||typeof b.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");g=[`${x.host} wants you to sign in with your Solana account:`,b.publicKey.toBase58(),...j?["",j,""]:[""],"Version: 1",`URI: ${x.href}`,`Issued At: ${(n=(r=S==null?void 0:S.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((a=S==null?void 0:S.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${S.signInWithSolana.notBefore}`]:[],...!((i=S==null?void 0:S.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${S.signInWithSolana.expirationTime}`]:[],...!((o=S==null?void 0:S.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${S.signInWithSolana.chainId}`]:[],...!((l=S==null?void 0:S.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${S.signInWithSolana.nonce}`]:[],...!((c=S==null?void 0:S.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${S.signInWithSolana.requestId}`]:[],...!((h=(u=S==null?void 0:S.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||h===void 0)&&h.length?["Resources",...S.signInWithSolana.resources.map(O=>`- ${O}`)]:[]].join(`
`);const T=await b.signMessage(new TextEncoder().encode(g),"utf8");if(!T||!(T instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");k=T}}try{const{data:m,error:P}=await ue(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:g,signature:Ec(k)},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(v=e.options)===null||v===void 0?void 0:v.captchaToken}}:null),xform:ht});if(P)throw P;return!m||!m.session||!m.user?{data:{user:null,session:null},error:new Us}:(m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),{data:Object.assign({},m),error:P})}catch(m){if(ae(m))return{data:{user:null,session:null},error:m};throw m}}async _exchangeCodeForSession(e){const t=await Fs(this.storage,`${this.storageKey}-code-verifier`),[r,n]=(t??"").split("/");try{const{data:a,error:i}=await ue(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:ht});if(await zs(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return!a||!a.session||!a.user?{data:{user:null,session:null,redirectType:null},error:new Us}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign(Object.assign({},a),{redirectType:n??null}),error:i})}catch(a){if(ae(a))return{data:{user:null,session:null,redirectType:null},error:a};throw a}}async signInWithIdToken(e){try{const{options:t,provider:r,token:n,access_token:a,nonce:i}=e,o=await ue(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:n,access_token:a,nonce:i,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:ht}),{data:l,error:c}=o;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new Us}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(t){if(ae(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,r,n,a,i;try{if("email"in e){const{email:o,options:l}=e;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await Wt(this.storage,this.storageKey));const{error:h}=await ue(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(t=l==null?void 0:l.data)!==null&&t!==void 0?t:{},create_user:(r=l==null?void 0:l.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:o,options:l}=e,{data:c,error:u}=await ue(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(n=l==null?void 0:l.data)!==null&&n!==void 0?n:{},create_user:(a=l==null?void 0:l.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(i=l==null?void 0:l.channel)!==null&&i!==void 0?i:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u}}throw new Ns("You must provide either an email or phone number.")}catch(o){if(ae(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(e){var t,r;try{let n,a;"options"in e&&(n=(t=e.options)===null||t===void 0?void 0:t.redirectTo,a=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:i,error:o}=await ue(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:n,xform:ht});if(o)throw o;if(!i)throw new Error("An error occurred on token verification.");const l=i.session,c=i.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(n){if(ae(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(e){var t,r,n;try{let a=null,i=null;return this.flowType==="pkce"&&([a,i]=await Wt(this.storage,this.storageKey)),await ue(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&r!==void 0?r:void 0}),!((n=e==null?void 0:e.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:i}),headers:this.headers,xform:Vc})}catch(a){if(ae(a))return{data:null,error:a};throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new wt;const{error:n}=await ue(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:n}})}catch(e){if(ae(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:r,type:n,options:a}=e,{error:i}=await ue(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:n,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},redirectTo:a==null?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:i}}else if("phone"in e){const{phone:r,type:n,options:a}=e,{data:i,error:o}=await ue(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:n,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}}});return{data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:o}}throw new Ns("You must provide either an email or phone number and a type")}catch(t){if(ae(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await r,await t()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=t();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Fs(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<Er:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.storage.isServer){let i=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,c,u)=>(!i&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),i=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,u))})}return{data:{session:e},error:null}}const{session:n,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{session:null},error:a}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await ue(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:St}):await this._useSession(async t=>{var r,n,a;const{data:i,error:o}=t;if(o)throw o;return!(!((r=i.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new wt}:await ue(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0,xform:St})})}catch(t){if(ae(t))return gc(t)&&(await this._removeSession(),await zs(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:n,error:a}=r;if(a)throw a;if(!n.session)throw new wt;const i=n.session;let o=null,l=null;this.flowType==="pkce"&&e.email!=null&&([o,l]=await Wt(this.storage,this.storageKey));const{data:c,error:u}=await ue(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:l}),jwt:i.access_token,xform:St});if(u)throw u;return i.user=c.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(r){if(ae(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new wt;const t=Date.now()/1e3;let r=t,n=!0,a=null;const{payload:i}=Tr(e.access_token);if(i.exp&&(r=i.exp,n=r<=t),n){const{session:o,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};a=o}else{const{data:o,error:l}=await this._getUser(e.access_token);if(l)throw l;a={access_token:e.access_token,refresh_token:e.refresh_token,user:o.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(t){if(ae(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:i,error:o}=t;if(o)throw o;e=(r=i.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new wt;const{session:n,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{user:null,session:null},error:a}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(ae(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!tt())throw new Bs("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Bs(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new Gn("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Bs("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Gn("No code detected.");const{data:j,error:S}=await this._exchangeCodeForSession(e.code);if(S)throw S;const b=new URL(window.location.href);return b.searchParams.delete("code"),window.history.replaceState(window.history.state,"",b.toString()),{data:{session:j.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:n,access_token:a,refresh_token:i,expires_in:o,expires_at:l,token_type:c}=e;if(!a||!o||!i||!c)throw new Bs("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(o);let f=u+h;l&&(f=parseInt(l));const v=f-u;v*1e3<=Kt&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${v}s, should have been closer to ${h}s`);const g=f-h;u-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,f,u):u-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,f,u);const{data:k,error:m}=await this._getUser(a);if(m)throw m;const P={provider_token:r,provider_refresh_token:n,access_token:a,expires_in:h,expires_at:f,refresh_token:i,token_type:c,user:k.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:P,redirectType:e.type},error:null}}catch(r){if(ae(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Fs(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:n,error:a}=t;if(a)return{error:a};const i=(r=n.session)===null||r===void 0?void 0:r.access_token;if(i){const{error:o}=await this.admin.signOut(i,e);if(o&&!(pc(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return e!=="others"&&(await this._removeSession(),await zs(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=Tc(),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,n;try{const{data:{session:a},error:i}=t;if(i)throw i;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",e,"session",a)}catch(a){await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a),console.error(a)}})}async resetPasswordForEmail(e,t={}){let r=null,n=null;this.flowType==="pkce"&&([r,n]=await Wt(this.storage,this.storageKey,!0));try{return await ue(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:n,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(a){if(ae(a))return{data:null,error:a};throw a}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(ae(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:r,error:n}=await this._useSession(async a=>{var i,o,l,c,u;const{data:h,error:f}=a;if(f)throw f;const v=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(i=e.options)===null||i===void 0?void 0:i.redirectTo,scopes:(o=e.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await ue(this.fetch,"GET",v,{headers:this.headers,jwt:(u=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(n)throw n;return tt()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(ae(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,n;const{data:a,error:i}=t;if(i)throw i;return await ue(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(r=a.session)===null||r===void 0?void 0:r.access_token)!==null&&n!==void 0?n:void 0})})}catch(t){if(ae(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const r=Date.now();return await Pc(async n=>(n>0&&await Ac(200*Math.pow(2,n-1)),this._debug(t,"refreshing attempt",n),await ue(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:ht})),(n,a)=>{const i=200*Math.pow(2,n);return a&&xr(a)&&Date.now()+i-r<Kt})}catch(r){if(this._debug(t,"error",r),ae(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),tt()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const r=await Fs(this.storage,this.storageKey);if(this._debug(t,"session from storage",r),!this._isValidSession(r)){this._debug(t,"session is not valid"),r!==null&&await this._removeSession();return}const n=((e=r.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<Er;if(this._debug(t,`session has${n?"":" not"} expired with margin of ${Er}s`),n){if(this.autoRefreshToken&&r.refresh_token){const{error:a}=await this._callRefreshToken(r.refresh_token);a&&(console.error(a),xr(a)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(t,"error",r),console.error(r);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new wt;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new fr;const{data:a,error:i}=await this._refreshAccessToken(e);if(i)throw i;if(!a.session)throw new wt;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const o={session:a.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(a){if(this._debug(n,"error",a),ae(a)){const i={session:null,error:a};return xr(a)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(i),i}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(a),a}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,t,r=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const a=[],i=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(e,t)}catch(l){a.push(l)}});if(await Promise.all(i),a.length>0){for(let o=0;o<a.length;o+=1)console.error(a[o]);throw a[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await fi(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await zs(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&tt()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Kt);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((r.expires_at*1e3-e)/Kt);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${Kt}ms, refresh threshold is ${Vr} ticks`),n<=Vr&&await this._callRefreshToken(r.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof vi)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!tt()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const n=[`provider=${encodeURIComponent(t)}`];if(r!=null&&r.redirectTo&&n.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&n.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[a,i]=await Wt(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(i)}`});n.push(o.toString())}if(r!=null&&r.queryParams){const a=new URLSearchParams(r.queryParams);n.push(a.toString())}return r!=null&&r.skipBrowserRedirect&&n.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:n,error:a}=t;return a?{data:null,error:a}:await ue(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=n==null?void 0:n.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(ae(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,n;const{data:a,error:i}=t;if(i)return{data:null,error:i};const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:c}=await ue(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token});return c?{data:null,error:c}:(e.factorType==="totp"&&(!((n=l==null?void 0:l.totp)===null||n===void 0)&&n.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(t){if(ae(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:n,error:a}=t;if(a)return{data:null,error:a};const{data:i,error:o}=await ue(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=n==null?void 0:n.session)===null||r===void 0?void 0:r.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:o})})}catch(t){if(ae(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:n,error:a}=t;return a?{data:null,error:a}:await ue(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=n==null?void 0:n.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(ae(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const r=(e==null?void 0:e.factors)||[],n=r.filter(i=>i.factor_type==="totp"&&i.status==="verified"),a=r.filter(i=>i.factor_type==="phone"&&i.status==="verified");return{data:{all:r,totp:n,phone:a},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;const{data:{session:n},error:a}=e;if(a)return{data:null,error:a};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=Tr(n.access_token);let o=null;i.aal&&(o=i.aal);let l=o;((r=(t=n.user.factors)===null||t===void 0?void 0:t.filter(h=>h.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const u=i.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(e,t={keys:[]}){let r=t.keys.find(i=>i.kid===e);if(r||(r=this.jwks.keys.find(i=>i.kid===e),r&&this.jwks_cached_at+fc>Date.now()))return r;const{data:n,error:a}=await ue(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;if(!n.keys||n.keys.length===0)throw new _s("JWKS is empty");if(this.jwks=n,this.jwks_cached_at=Date.now(),r=n.keys.find(i=>i.kid===e),!r)throw new _s("No matching signing key found in JWKS");return r}async getClaims(e,t={keys:[]}){try{let r=e;if(!r){const{data:v,error:g}=await this.getSession();if(g||!v.session)return{data:null,error:g};r=v.session.access_token}const{header:n,payload:a,signature:i,raw:{header:o,payload:l}}=Tr(r);if(Lc(a.exp),!n.kid||n.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:v}=await this.getUser(r);if(v)throw v;return{data:{claims:a,header:n,signature:i},error:null}}const c=qc(n.alg),u=await this.fetchJwk(n.kid,t),h=await crypto.subtle.importKey("jwk",u,c,!0,["verify"]);if(!await crypto.subtle.verify(c,h,i,Sc(`${o}.${l}`)))throw new _s("Invalid JWT signature");return{data:{claims:a,header:n,signature:i},error:null}}catch(r){if(ae(r))return{data:null,error:r};throw r}}}xs.nextInstanceID=0;const tu=xs;class su extends tu{constructor(e){super(e)}}var ru=function(s,e,t,r){function n(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(u){try{c(r.next(u))}catch(h){i(h)}}function l(u){try{c(r.throw(u))}catch(h){i(h)}}function c(u){u.done?a(u.value):n(u.value).then(o,l)}c((r=r.apply(s,e||[])).next())})};class nu{constructor(e,t,r){var n,a,i;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const o=oc(e),l=new URL(o);this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:Xl,realtime:tc,auth:Object.assign(Object.assign({},ec),{storageKey:c}),global:Zl},h=lc(r??{},u);this.storageKey=(n=h.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(a=h.global.headers)!==null&&a!==void 0?a:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(f,v)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(v)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=h.auth)!==null&&i!==void 0?i:{},this.headers,h.global.fetch),this.fetch=ac(t,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new kl(new URL("rest/v1",l).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),h.accessToken||this._listenForAuthEvents()}get functions(){return new ll(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Kl(this.storageUrl.href,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return ru(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(t=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,storageKey:a,flowType:i,lock:o,debug:l},c,u){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new su({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),c),storageKey:a,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,flowType:i,lock:o,debug:l,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new Rl(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const au=(s,e,t)=>new nu(s,e,t),iu="https://ibgkltqlgbafpoljizdu.supabase.co",ou="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImliZ2tsdHFsZ2JhZnBvbGppemR1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDkzMjU1NzksImV4cCI6MjA2NDkwMTU3OX0.Awa-Gdd3b4uR_1MnQySyA5s6hfVfyZB6jlVS1Jj_Afk",de=au(iu,ou);Li();function ra(s,e){_(e,!d(e))}var lu=N('<button class="open-sidebar-icon icon svelte-1i6xkxq">≡</button> <aside><div class="sidebar-header svelte-1i6xkxq"><img src="https://raw.githubusercontent.com/Ewan-Dev/ewan.is-a.dev/refs/heads/main/frontend/static/loquela.png" class="logo svelte-1i6xkxq" alt="loquela logo"/> <button class="close-sidebar-icon icon svelte-1i6xkxq">X</button></div> <nav class="sidebar-nav svelte-1i6xkxq"><a href="./#/app/home"><span class="material-symbols-rounded svelte-1i6xkxq">home</span> Home</a> <a href="./#/app/music"><span class="material-symbols-rounded svelte-1i6xkxq">music_note</span> Music</a> <a href="./#/app/videos"><span class="material-symbols-rounded svelte-1i6xkxq">movie</span> Videos</a> <a href="./#/app/upload"><span class="material-symbols-rounded svelte-1i6xkxq">upload</span> Upload</a> <a href="./#/app/flashcards"><span class="material-symbols-rounded svelte-1i6xkxq">cards_star</span> Flashcards</a> <a href="./#/app/ai-chat"><span class="material-symbols-rounded svelte-1i6xkxq">chat</span> AI Chat</a></nav></aside>',1);function dt(s,e){let t=ge(e,"currentPage",8,""),r=$t(!1);var n=lu(),a=ke(n);a.__click=[ra,r];var i=y(a,2);let o;var l=w(i),c=y(w(l),2);c.__click=[ra,r];var u=y(l,2),h=w(u);let f;var v=y(h,2);let g;var k=y(v,2);let m;var P=y(k,2);let j;var S=y(P,2);let b;var x=y(S,2);let T;fe((O,I,D,z,H,ie,oe)=>{o=ze(i,1,"sidebar svelte-1i6xkxq",null,o,O),f=ze(h,1,"svelte-1i6xkxq",null,f,I),g=ze(v,1,"svelte-1i6xkxq",null,g,D),m=ze(k,1,"svelte-1i6xkxq",null,m,z),j=ze(P,1,"svelte-1i6xkxq",null,j,H),b=ze(S,1,"svelte-1i6xkxq",null,b,ie),T=ze(x,1,"svelte-1i6xkxq",null,T,oe)},[()=>({show:d(r)}),()=>({selected:t()==="/home"}),()=>({selected:t()==="/music"}),()=>({selected:t()==="/videos"}),()=>({selected:t()==="/upload"}),()=>({selected:t()==="/flashcards"}),()=>({selected:t()==="/ai-chat"})],Zr),R(s,n)}os(["click"]);var cu=N('<main class="route svelte-1454v5v"><!> <section class="main-page"><h1 class="page-header">Home</h1> <section class="main-content"><h1>👋 Hello, welcome back.</h1></section></section></main>');function uu(s,e){Ee(e,!1),He(async()=>{const{data:{user:n}}=await de.auth.getUser();console.log(n)}),Wa();var t=cu(),r=w(t);dt(r,{currentPage:"/home"}),R(s,t),xe()}const du=s=>s;function hu(s,{delay:e=0,duration:t=400,easing:r=du}={}){const n=+getComputedStyle(s).opacity;return{delay:e,duration:t,easing:r,css:a=>`opacity: ${a*n}`}}var fu=N('<section role="status"><span> </span> <p> </p></section>');function mt(s,e){Ee(e,!0);let t=ge(e,"type",3,"info"),r=ge(e,"message",3,"Information"),n=ge(e,"width",3,"100%"),a={info:"info",error:"error",success:"check_circle",warn:"warning"},i,o=A(!0);Ce(()=>(_(o,!1),r()&&(_(o,!0),clearTimeout(i),i=setTimeout(()=>{_(o,!1)},5e3)),()=>{_(o,!1),clearTimeout(i)}));var l=gt(),c=ke(l);{var u=h=>{var f=fu(),v=w(f),g=w(v),k=y(v,2),m=w(k);fe(()=>{Do(f,`width:${n()??""};`),ze(f,1,er(t()),"svelte-11c2jyb"),ze(v,1,`${t()} material-symbols-rounded`,"svelte-11c2jyb"),Q(g,a[t()]),ze(k,1,er(t()),"svelte-11c2jyb"),Q(m,r())}),Ho(3,f,()=>hu,()=>({duration:400})),R(h,f)};le(c,h=>{d(o)&&h(u)})}R(s,l),xe()}var $s={};(function s(e,t,r,n){var a=!!(e.Worker&&e.Blob&&e.Promise&&e.OffscreenCanvas&&e.OffscreenCanvasRenderingContext2D&&e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype.transferControlToOffscreen&&e.URL&&e.URL.createObjectURL),i=typeof Path2D=="function"&&typeof DOMMatrix=="function",o=function(){if(!e.OffscreenCanvas)return!1;var E=new OffscreenCanvas(1,1),p=E.getContext("2d");p.fillRect(0,0,1,1);var $=E.transferToImageBitmap();try{p.createPattern($,"no-repeat")}catch{return!1}return!0}();function l(){}function c(E){var p=t.exports.Promise,$=p!==void 0?p:e.Promise;return typeof $=="function"?new $(E):(E(l,l),null)}var u=function(E,p){return{transform:function($){if(E)return $;if(p.has($))return p.get($);var U=new OffscreenCanvas($.width,$.height),F=U.getContext("2d");return F.drawImage($,0,0),p.set($,U),U},clear:function(){p.clear()}}}(o,new Map),h=function(){var E=Math.floor(16.666666666666668),p,$,U={},F=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(p=function(G){var ee=Math.random();return U[ee]=requestAnimationFrame(function M(q){F===q||F+E-1<q?(F=q,delete U[ee],G()):U[ee]=requestAnimationFrame(M)}),ee},$=function(G){U[G]&&cancelAnimationFrame(U[G])}):(p=function(G){return setTimeout(G,E)},$=function(G){return clearTimeout(G)}),{frame:p,cancel:$}}(),f=function(){var E,p,$={};function U(F){function G(ee,M){F.postMessage({options:ee||{},callback:M})}F.init=function(M){var q=M.transferControlToOffscreen();F.postMessage({canvas:q},[q])},F.fire=function(M,q,K){if(p)return G(M,null),p;var Z=Math.random().toString(36).slice(2);return p=c(function(te){function se(we){we.data.callback===Z&&(delete $[Z],F.removeEventListener("message",se),p=null,u.clear(),K(),te())}F.addEventListener("message",se),G(M,Z),$[Z]=se.bind(null,{data:{callback:Z}})}),p},F.reset=function(){F.postMessage({reset:!0});for(var M in $)$[M](),delete $[M]}}return function(){if(E)return E;if(!r&&a){var F=["var CONFETTI, SIZE = {}, module = {};","("+s.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{E=new Worker(URL.createObjectURL(new Blob([F])))}catch(G){return typeof console!==void 0&&typeof console.warn=="function"&&console.warn("🎊 Could not load worker",G),null}U(E)}return E}}(),v={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function g(E,p){return p?p(E):E}function k(E){return E!=null}function m(E,p,$){return g(E&&k(E[p])?E[p]:v[p],$)}function P(E){return E<0?0:Math.floor(E)}function j(E,p){return Math.floor(Math.random()*(p-E))+E}function S(E){return parseInt(E,16)}function b(E){return E.map(x)}function x(E){var p=String(E).replace(/[^0-9a-f]/gi,"");return p.length<6&&(p=p[0]+p[0]+p[1]+p[1]+p[2]+p[2]),{r:S(p.substring(0,2)),g:S(p.substring(2,4)),b:S(p.substring(4,6))}}function T(E){var p=m(E,"origin",Object);return p.x=m(p,"x",Number),p.y=m(p,"y",Number),p}function O(E){E.width=document.documentElement.clientWidth,E.height=document.documentElement.clientHeight}function I(E){var p=E.getBoundingClientRect();E.width=p.width,E.height=p.height}function D(E){var p=document.createElement("canvas");return p.style.position="fixed",p.style.top="0px",p.style.left="0px",p.style.pointerEvents="none",p.style.zIndex=E,p}function z(E,p,$,U,F,G,ee,M,q){E.save(),E.translate(p,$),E.rotate(G),E.scale(U,F),E.arc(0,0,1,ee,M,q),E.restore()}function H(E){var p=E.angle*(Math.PI/180),$=E.spread*(Math.PI/180);return{x:E.x,y:E.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:E.startVelocity*.5+Math.random()*E.startVelocity,angle2D:-p+(.5*$-Math.random()*$),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:E.color,shape:E.shape,tick:0,totalTicks:E.ticks,decay:E.decay,drift:E.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:E.gravity*3,ovalScalar:.6,scalar:E.scalar,flat:E.flat}}function ie(E,p){p.x+=Math.cos(p.angle2D)*p.velocity+p.drift,p.y+=Math.sin(p.angle2D)*p.velocity+p.gravity,p.velocity*=p.decay,p.flat?(p.wobble=0,p.wobbleX=p.x+10*p.scalar,p.wobbleY=p.y+10*p.scalar,p.tiltSin=0,p.tiltCos=0,p.random=1):(p.wobble+=p.wobbleSpeed,p.wobbleX=p.x+10*p.scalar*Math.cos(p.wobble),p.wobbleY=p.y+10*p.scalar*Math.sin(p.wobble),p.tiltAngle+=.1,p.tiltSin=Math.sin(p.tiltAngle),p.tiltCos=Math.cos(p.tiltAngle),p.random=Math.random()+2);var $=p.tick++/p.totalTicks,U=p.x+p.random*p.tiltCos,F=p.y+p.random*p.tiltSin,G=p.wobbleX+p.random*p.tiltCos,ee=p.wobbleY+p.random*p.tiltSin;if(E.fillStyle="rgba("+p.color.r+", "+p.color.g+", "+p.color.b+", "+(1-$)+")",E.beginPath(),i&&p.shape.type==="path"&&typeof p.shape.path=="string"&&Array.isArray(p.shape.matrix))E.fill(X(p.shape.path,p.shape.matrix,p.x,p.y,Math.abs(G-U)*.1,Math.abs(ee-F)*.1,Math.PI/10*p.wobble));else if(p.shape.type==="bitmap"){var M=Math.PI/10*p.wobble,q=Math.abs(G-U)*.1,K=Math.abs(ee-F)*.1,Z=p.shape.bitmap.width*p.scalar,te=p.shape.bitmap.height*p.scalar,se=new DOMMatrix([Math.cos(M)*q,Math.sin(M)*q,-Math.sin(M)*K,Math.cos(M)*K,p.x,p.y]);se.multiplySelf(new DOMMatrix(p.shape.matrix));var we=E.createPattern(u.transform(p.shape.bitmap),"no-repeat");we.setTransform(se),E.globalAlpha=1-$,E.fillStyle=we,E.fillRect(p.x-Z/2,p.y-te/2,Z,te),E.globalAlpha=1}else if(p.shape==="circle")E.ellipse?E.ellipse(p.x,p.y,Math.abs(G-U)*p.ovalScalar,Math.abs(ee-F)*p.ovalScalar,Math.PI/10*p.wobble,0,2*Math.PI):z(E,p.x,p.y,Math.abs(G-U)*p.ovalScalar,Math.abs(ee-F)*p.ovalScalar,Math.PI/10*p.wobble,0,2*Math.PI);else if(p.shape==="star")for(var ne=Math.PI/2*3,V=4*p.scalar,re=8*p.scalar,C=p.x,W=p.y,ve=5,pe=Math.PI/ve;ve--;)C=p.x+Math.cos(ne)*re,W=p.y+Math.sin(ne)*re,E.lineTo(C,W),ne+=pe,C=p.x+Math.cos(ne)*V,W=p.y+Math.sin(ne)*V,E.lineTo(C,W),ne+=pe;else E.moveTo(Math.floor(p.x),Math.floor(p.y)),E.lineTo(Math.floor(p.wobbleX),Math.floor(F)),E.lineTo(Math.floor(G),Math.floor(ee)),E.lineTo(Math.floor(U),Math.floor(p.wobbleY));return E.closePath(),E.fill(),p.tick<p.totalTicks}function oe(E,p,$,U,F){var G=p.slice(),ee=E.getContext("2d"),M,q,K=c(function(Z){function te(){M=q=null,ee.clearRect(0,0,U.width,U.height),u.clear(),F(),Z()}function se(){r&&!(U.width===n.width&&U.height===n.height)&&(U.width=E.width=n.width,U.height=E.height=n.height),!U.width&&!U.height&&($(E),U.width=E.width,U.height=E.height),ee.clearRect(0,0,U.width,U.height),G=G.filter(function(we){return ie(ee,we)}),G.length?M=h.frame(se):te()}M=h.frame(se),q=te});return{addFettis:function(Z){return G=G.concat(Z),K},canvas:E,promise:K,reset:function(){M&&h.cancel(M),q&&q()}}}function ce(E,p){var $=!E,U=!!m(p||{},"resize"),F=!1,G=m(p,"disableForReducedMotion",Boolean),ee=a&&!!m(p||{},"useWorker"),M=ee?f():null,q=$?O:I,K=E&&M?!!E.__confetti_initialized:!1,Z=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,te;function se(ne,V,re){for(var C=m(ne,"particleCount",P),W=m(ne,"angle",Number),ve=m(ne,"spread",Number),pe=m(ne,"startVelocity",Number),Se=m(ne,"decay",Number),Ne=m(ne,"gravity",Number),Be=m(ne,"drift",Number),Oe=m(ne,"colors",b),Qe=m(ne,"ticks",Number),Ze=m(ne,"shapes"),vr=m(ne,"scalar"),Xe=!!m(ne,"flat"),et=T(ne),At=C,yt=[],pr=E.width*et.x,gr=E.height*et.y;At--;)yt.push(H({x:pr,y:gr,angle:W,spread:ve,startVelocity:pe,color:Oe[At%Oe.length],shape:Ze[j(0,Ze.length)],ticks:Qe,decay:Se,gravity:Ne,drift:Be,scalar:vr,flat:Xe}));return te?te.addFettis(yt):(te=oe(E,yt,q,V,re),te.promise)}function we(ne){var V=G||m(ne,"disableForReducedMotion",Boolean),re=m(ne,"zIndex",Number);if(V&&Z)return c(function(pe){pe()});$&&te?E=te.canvas:$&&!E&&(E=D(re),document.body.appendChild(E)),U&&!K&&q(E);var C={width:E.width,height:E.height};M&&!K&&M.init(E),K=!0,M&&(E.__confetti_initialized=!0);function W(){if(M){var pe={getBoundingClientRect:function(){if(!$)return E.getBoundingClientRect()}};q(pe),M.postMessage({resize:{width:pe.width,height:pe.height}});return}C.width=C.height=null}function ve(){te=null,U&&(F=!1,e.removeEventListener("resize",W)),$&&E&&(document.body.contains(E)&&document.body.removeChild(E),E=null,K=!1)}return U&&!F&&(F=!0,e.addEventListener("resize",W,!1)),M?M.fire(ne,C,ve):se(ne,C,ve)}return we.reset=function(){M&&M.reset(),te&&te.reset()},we}var L;function Y(){return L||(L=ce(null,{useWorker:!0,resize:!0})),L}function X(E,p,$,U,F,G,ee){var M=new Path2D(E),q=new Path2D;q.addPath(M,new DOMMatrix(p));var K=new Path2D;return K.addPath(q,new DOMMatrix([Math.cos(ee)*F,Math.sin(ee)*F,-Math.sin(ee)*G,Math.cos(ee)*G,$,U])),K}function J(E){if(!i)throw new Error("path confetti are not supported in this browser");var p,$;typeof E=="string"?p=E:(p=E.path,$=E.matrix);var U=new Path2D(p),F=document.createElement("canvas"),G=F.getContext("2d");if(!$){for(var ee=1e3,M=ee,q=ee,K=0,Z=0,te,se,we=0;we<ee;we+=2)for(var ne=0;ne<ee;ne+=2)G.isPointInPath(U,we,ne,"nonzero")&&(M=Math.min(M,we),q=Math.min(q,ne),K=Math.max(K,we),Z=Math.max(Z,ne));te=K-M,se=Z-q;var V=10,re=Math.min(V/te,V/se);$=[re,0,0,re,-Math.round(te/2+M)*re,-Math.round(se/2+q)*re]}return{type:"path",path:p,matrix:$}}function he(E){var p,$=1,U="#000000",F='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof E=="string"?p=E:(p=E.text,$="scalar"in E?E.scalar:$,F="fontFamily"in E?E.fontFamily:F,U="color"in E?E.color:U);var G=10*$,ee=""+G+"px "+F,M=new OffscreenCanvas(G,G),q=M.getContext("2d");q.font=ee;var K=q.measureText(p),Z=Math.ceil(K.actualBoundingBoxRight+K.actualBoundingBoxLeft),te=Math.ceil(K.actualBoundingBoxAscent+K.actualBoundingBoxDescent),se=2,we=K.actualBoundingBoxLeft+se,ne=K.actualBoundingBoxAscent+se;Z+=se+se,te+=se+se,M=new OffscreenCanvas(Z,te),q=M.getContext("2d"),q.font=ee,q.fillStyle=U,q.fillText(p,we,ne);var V=1/$;return{type:"bitmap",bitmap:M.transferToImageBitmap(),matrix:[V,0,0,V,-Z*V/2,-te*V/2]}}t.exports=function(){return Y().apply(this,arguments)},t.exports.reset=function(){Y().reset()},t.exports.create=ce,t.exports.shapeFromPath=J,t.exports.shapeFromText=he})(function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}}(),$s,!1);const cs=$s.exports;$s.exports.create;var vu=N(`<main class="svelte-1dsdca0"><h1>Signup</h1> <form class="svelte-1dsdca0"><label for="email" class="svelte-1dsdca0">Email:</label> <input class="email svelte-1dsdca0" type="email"/> <label for="password" class="svelte-1dsdca0">Password:</label> <input class="password svelte-1dsdca0" type="password"/> <button class="sign-up svelte-1dsdca0" type="submit">Sign up</button> <!></form> <p style="color:red;">Please use a well established mail client such as Outlook or Gmail as temporary email services don't allow the link to work properly.</p></main>`);function pu(s,e){Ee(e,!0);let t="",r="",n="",a=A(B(n.statusError)),i=A(B(n.statusType));async function o(){await l()}async function l(){let{data:m,error:P}=await de.auth.signUp({email:t,password:r,options:{emailRedirectTo:"https://ewan.is-a.dev/#/app/login/"}});P&&P.message.includes("Password should contain at least one character of each")?(_(a,""),_(i,""),_(a,"Password must contain capital letters, lowercase letters, numbers and special characters."),_(i,"warn")):P&&P.message?(_(i,""),_(i,"error"),_(a,""),_(a,P.message,!0)):m&&!P&&(_(a,"Signup successful! Check your email to confirm."),_(i,"success"),console.log("User signed up successfully",m),c())}function c(){cs({particleCount:200,spread:70,origin:{y:.6}})}var u=vu(),h=y(w(u),2),f=y(w(h),2),v=y(f,4),g=y(v,4);{var k=m=>{mt(m,{get type(){return d(i)},get message(){return d(a)}})};le(g,m=>{d(a)&&d(i)&&m(k)})}Ue("submit",h,m=>{m.preventDefault(),o()}),nt(f,()=>t,m=>t=m),nt(v,()=>r,m=>r=m),R(s,u),xe()}var gu=N('<!> <p>Continue <a href="./#/app/home">here</a></p>',1),mu=N('<main class="route svelte-1h09z0i"><section class="main-page"><h1 class="page-header">Login</h1> <section class="main-content"><form class="svelte-1h09z0i"><label for="email" class="svelte-1h09z0i">Email:</label> <input class="email svelte-1h09z0i" type="email"/> <label for="password" class="svelte-1h09z0i">Password:</label> <input class="password svelte-1h09z0i" type="password"/> <button class="log-in svelte-1h09z0i" type="submit">Sign in</button> <!> <!></form></section></section></main>');function na(s,e){Ee(e,!0);let t=A(""),r=A(""),n="",a=A(""),i=A("");async function o(){let{data:b,error:x}=await de.auth.signInWithPassword({email:d(t),password:d(r)});x?(x&&x.message.includes("profiles_email_key")&&_(a,""),_(a,x.message,!0)):(_(i,b,!0),console.log("Login successful",n),_(a,""),c(),l(b.user.email))}async function l(b){const{error:x}=await de.from("profiles").insert({email:b});x&&x.message?console.error(x.message):x||(_(a,""),console.log("User added to profiles table"))}function c(){cs({particleCount:200,spread:70,origin:{y:.6}})}var u=mu(),h=w(u),f=y(w(h),2),v=w(f),g=y(w(v),2),k=y(g,4),m=y(k,4);{var P=b=>{mt(b,{type:"error",get message(){return d(a)}})};le(m,b=>{d(a)&&b(P)})}var j=y(m,2);{var S=b=>{var x=gu(),T=ke(x);mt(T,{type:"success",message:"Login successful!",width:"15em"}),R(b,x)};le(j,b=>{!d(a)&&d(i)&&b(S)})}Ue("submit",v,b=>{b.preventDefault(),o()}),nt(g,()=>d(t),b=>_(t,b)),nt(k,()=>d(r),b=>_(r,b)),R(s,u),xe()}var _u=N('<!> <p>Continue <a href="./#/app/home">here</a></p>',1),yu=N('<main class="route svelte-1h09z0i"><section class="main-page"><h1 class="page-header">Login</h1> <section class="main-content"><form class="svelte-1h09z0i"><label for="email" class="svelte-1h09z0i">Email:</label> <input class="email svelte-1h09z0i" type="email"/> <label for="password" class="svelte-1h09z0i">Password:</label> <input class="password svelte-1h09z0i" type="password"/> <button class="log-in svelte-1h09z0i" type="submit">Sign in</button> <!> <!></form></section></section></main>');function wu(s,e){Ee(e,!0);let t=A(""),r=A(""),n="",a=A(""),i=A("");async function o(){let{data:b,error:x}=await de.auth.signInWithPassword({email:d(t),password:d(r)});x?(x&&x.message.includes("profiles_email_key")&&_(a,""),_(a,x.message,!0)):(_(i,b,!0),console.log("Login successful",n),_(a,""),c(),l(b.user.email))}async function l(b){const{error:x}=await de.from("profiles").insert({email:b});x&&x.message?console.error(x.message):x||(_(a,""),console.log("User added to profiles table"))}function c(){cs({particleCount:200,spread:70,origin:{y:.6}})}var u=yu(),h=w(u),f=y(w(h),2),v=w(f),g=y(w(v),2),k=y(g,4),m=y(k,4);{var P=b=>{mt(b,{type:"error",get message(){return d(a)}})};le(m,b=>{d(a)&&b(P)})}var j=y(m,2);{var S=b=>{var x=_u(),T=ke(x);mt(T,{type:"success",message:"Login successful!",width:"15em"}),R(b,x)};le(j,b=>{!d(a)&&d(i)&&b(S)})}Ue("submit",v,b=>{b.preventDefault(),o()}),nt(g,()=>d(t),b=>_(t,b)),nt(k,()=>d(r),b=>_(r,b)),R(s,u),xe()}var bu=N('<span class="material-symbols-rounded svelte-fqe1ds"> </span>'),ku=N("<div><!> <p> </p></div>");function jr(s,e){let t=ge(e,"type",8,""),r=ge(e,"message",8,""),n=ge(e,"symbol",8,"");var a=ku(),i=w(a);{var o=u=>{var h=bu(),f=w(h);fe(()=>Q(f,n())),R(u,h)};le(i,u=>{n()&&u(o)})}var l=y(i,2),c=w(l);fe(()=>{ze(a,1,`media-tag ${t()}`,"svelte-fqe1ds"),Q(c,r())}),R(s,a)}var Su=N('<div><img alt="Album cover"/> <span class="svelte-1r1x85g"><!> <!> <!></span> <a class="svelte-1r1x85g"><b> </b></a> <a class="svelte-1r1x85g"> </a></div>');function pi(s,e){let t=ge(e,"name",8,null),r=ge(e,"artist",8,null),n=ge(e,"cover",8,null),a=ge(e,"level",8,null),i=ge(e,"rating",8,null),o=ge(e,"category",8,null),l=ge(e,"link",8,null),c=ge(e,"type",8,null);var u=Su(),h=w(u),f=y(h,2),v=w(f);jr(v,{type:"level",get message(){return a()}});var g=y(v,2);jr(g,{type:"rating",get message(){return i()},symbol:"thumb_up"});var k=y(g,2);jr(k,{type:"category",get message(){return o()}});var m=y(f,2),P=w(m),j=w(P),S=y(m,2),b=w(S);fe(()=>{ze(u,1,er(c()),"svelte-1r1x85g"),Te(h,"src",n()),ze(h,1,er(c()),"svelte-1r1x85g"),Te(m,"href",l()),Q(j,t()),Q(b,r())}),R(s,u)}var Eu=N("<option> </option>"),xu=N(`<p>Try selecting a language to show media. If no languages show up, come back later as the servers may be down.
                Also, please note that the music catalogue is currently very scarce and recommend checking out the videos instead!</p>`),Tu=N('<p class="not-found svelte-3mvwdf">:/ Oops! No music found; try uploading your own or try again later.</p>'),Ou=N('<main class="route svelte-3mvwdf"><!> <section class="main-page"><h1 class="page-header">Music</h1> <section class="main-content svelte-3mvwdf"><select></select> <section class="media-container svelte-3mvwdf"><!> <!> <!></section></section></section></main>');function ju(s,e){Ee(e,!0);let t=A(B([])),r=A(B([])),n=A("");async function a(j){const{data:S,error:b}=await de.from("media").select("*").eq("language",j).eq("media_type","music");b?console.error("Error fetching music:",b):(_(t,S||[],!0),console.log(S))}async function i(){const{data:j,error:S}=await de.from("languages").select("*");if(j)return _(r,j,!0),console.log(d(r)),j;if(S)throw S}He(()=>{i()}),Ce(()=>{a(d(n))});var o=Ou(),l=w(o);dt(l,{currentPage:"/music"});var c=y(l,2),u=y(w(c),2),h=w(u);Me(h,21,()=>d(r),Pe,(j,S)=>{var b=Eu(),x={},T=w(b);fe(()=>{x!==(x=d(S).short)&&(b.value=(b.__value=d(S).short)??""),Q(T,`${d(S).emoji??""} ${d(S).name??""}`)}),R(j,b)});var f=y(h,2),v=w(f);{var g=j=>{var S=xu();R(j,S)};le(v,j=>{d(n)||j(g)})}var k=y(v,2);{var m=j=>{var S=Tu();R(j,S)};le(k,j=>{!d(t)[0]&&d(n)&&j(m)})}var P=y(k,2);Me(P,17,()=>d(t),Pe,(j,S)=>{const b=Js(()=>`#/app/music/${d(S).id}`);pi(j,{get name(){return d(S).name},get artist(){return d(S).artist},get cover(){return d(S).cover},get level(){return d(S).level},get rating(){return d(S).rating},get link(){return d(b)}})}),Ge(h,()=>d(n),j=>_(n,j)),R(s,o),xe()}var Au=N('<span class="svelte-wz29xs"><h1 class="song svelte-wz29xs"> </h1><h1 class="artist svelte-wz29xs"> </h1></span>');function gi(s,e){let t=ge(e,"song",8,"Loading..."),r=ge(e,"artist",8,"Loading...");var n=Au(),a=w(n),i=w(a),o=y(a),l=w(o);fe(()=>{Q(i,t()),Q(l,r())}),R(s,n)}var Pu=N('<i><p class="romanisation svelte-gt754h"> </p></i>'),Mu=N("<option> </option>"),Cu=N(`<span class="flashcard-functions svelte-gt754h"><span class="flashcard-upload svelte-gt754h"><button class="add-to-deck flashcard-btn svelte-gt754h"><span class="material-symbols-rounded svelte-gt754h">library_add</span></button> <select class="svelte-gt754h"></select></span> <button class="info-flashcards-btn flashcard-btn svelte-gt754h"><span class="material-symbols-rounded svelte-gt754h">info</span></button></span> <dialog class="info-flashcards-container svelte-gt754h"><strong class="definition-info-header">Where's my deck?</strong> <p class="definition-info-body svelte-gt754h">This is as you may not yet have a deck for the language you are curretly studying; You can only add words to decks of the same language</p> <button class="close-dialog svelte-gt754h">OK</button></dialog>`,1),Iu=N('<section class="svelte-gt754h"><h1 class="svelte-gt754h"> </h1> <!> <p class="part-of-speech svelte-gt754h"> </p> <p class="svelte-gt754h"> </p> <!> <!></section>');function mi(s,e){Ee(e,!0);let t=A(B({message:"",type:""})),r=A(void 0),n=A(B([])),a=A(B(HTMLObjectElement)),i=A("");He(async()=>{u()}),Ce(async()=>{d(i)?(_(n,await c(d(i)),!0),console.log(d(n))):_(n,[],!0)});async function o(g){const{data:k,error:m}=await de.from("flashcard_decks").select("content").eq("id",g);return m?(_(t,{type:"error",message:m.message},!0),[]):k[0].content}async function l(g){const k=await o(g);k.push({word:e.word,definition:e.definition,partOfSpeech:e.partOfSpeech,romanisation:e.romanisation});const{error:m}=await de.from("flashcard_decks").update({content:k}).eq("id",g);if(m&&m.message==='invalid input syntax for type bigint: "undefined"')return _(t,{type:"error",message:"You haven't selected a deck. Try making one on 'Flashcards' page"},!0),m;if(m)return _(t,{type:"error",message:gerror.message},!0),m;_(t,{type:"success",message:"Added!"},!0)}async function c(g){const{data:k,error:m}=await de.from("flashcard_decks").select("*").eq("author",g).eq("language",e.language);return m?(console.error(m),_(t,{type:"error",message:m.message},!0),m):(console.log(k),k)}async function u(){const{data:g,error:k}=await de.auth.getSession(),m=g;k?console.error("Error fetching session:",k):m&&_(i,m.session.user.id,!0)}var h=gt(),f=ke(h);{var v=g=>{var k=Iu(),m=w(k),P=w(m),j=y(m,2);{var S=H=>{var ie=Pu(),oe=w(ie),ce=w(oe);fe(()=>Q(ce,e.romanisation)),R(H,ie)};le(j,H=>{e.romanisation&&H(S)})}var b=y(j,2),x=w(b),T=y(b,2),O=w(T),I=y(T,2);{var D=H=>{var ie=Cu(),oe=ke(ie),ce=w(oe),L=w(ce),Y=y(L,2);Me(Y,21,()=>d(n),Pe,($,U)=>{var F=Mu(),G={},ee=w(F);fe(()=>{G!==(G=d(U).id)&&(F.value=(F.__value=d(U).id)??""),Q(ee,d(U).name)}),R($,F)});var X=y(ce,2),J=Js(()=>d(a).showModal()),he=y(oe,2),E=y(w(he),4),p=Js(()=>d(a).close());it(he,$=>_(a,$),()=>d(a)),Ue("click",L,()=>l(d(r))),Ge(Y,()=>d(r),$=>_(r,$)),Ue("click",X,function(...$){var U;(U=d(J))==null||U.apply(this,$)}),Ue("click",E,function(...$){var U;(U=d(p))==null||U.apply(this,$)}),R(H,ie)};le(I,H=>{d(n)&&H(D)})}var z=y(I,2);mt(z,{get type(){return d(t).type},get message(){return d(t).message}}),fe(()=>{Q(P,e.word),Q(x,e.partOfSpeech),Q(O,e.definition)}),R(g,k)};le(f,g=>{e.word&&g(v)})}R(s,h),xe()}var $u=N('<p class="current-line svelte-1byr2hh"> </p>'),Ru=N('<!> <span class="svelte-1byr2hh"><span class="main-subtitles svelte-1byr2hh"></span> <p class="full-translate svelte-1byr2hh"> </p> <button class="show-translations-btn svelte-1byr2hh">Show translations</button></span>',1);function dn(s,e){Ee(e,!0);const t=ge(e,"currentLine",3,"Play the video to see live subtitles. Click on an individual word for a definition!"),r=ge(e,"targetLanguage",3,""),n=ge(e,"nativeLanguage",3,"en");let a="",i=A(B(a.term)),o=A(B(a.definition)),l=A(B(a.partOfSpeech)),c=A(B(a.original)),u=A(B(a.translated)),h=A(B(a.romanisation)),f=!0,v=A(B([]));Ce(()=>{_(v,t().split(" "),!0),k(t())});async function g(I,D){const z=D.join(" "),H=`you are being used as an AI to give a definition of a word based of context for a language learning software the language of the word and context is ${r()} and the user's native language is ${n()} the word is ${I} and the context is ${z} so give your definition in ${n()} and as part of your just definition NOT the partOfSpeech add helpful notes such as if its plural and its singular or its case/tense and its infintive etc. but keep it simple and short return as raw json with no backtick MD markers as your respone will be directly parsed into json respond with attributes word, partOfSpeech, romanisation and definition but do NOT return romanisation where it is not necessary`,oe=await(await fetch(`https://text.pollinations.ai/${H}`)).json();console.log(oe),_(i,oe.word,!0),_(o,oe.definition,!0),_(l,oe.partOfSpeech,!0),_(h,oe.romanisation,!0)}async function k(I){const D=`Translate from ISO 639-2 ${r()} to ${n()}. Sentence: "${I}". Respond only with raw JSON: { "original": "...", "translated": "..." }. No comments, markdown, or extra text`,z=await fetch(`https://text.pollinations.ai/${D}`);console.log(z);const H=await z.json();console.log(H),_(c,H.original,!0),_(u,H.translated,!0)}async function m(){const I=document.getElementsByClassName("full-translate"),D=document.getElementsByClassName("show-translations-btn");f=!f,Array.from(I).forEach(z=>{f===!0?z.style.display="block":z.style.display="none"}),Array.from(D).forEach(z=>{f===!0?z.style.display="none":z.style.display="block"})}var P=Ru(),j=ke(P);mi(j,{get word(){return d(i)},get definition(){return d(o)},get partOfSpeech(){return d(l)},get romanisation(){return d(h)},get language(){return r()}});var S=y(j,2),b=w(S);Me(b,21,()=>d(v),Pe,(I,D)=>{var z=$u(),H=w(z);fe(()=>Q(H,d(D))),Ue("click",z,()=>g(d(D),d(v))),R(I,z)});var x=y(b,2),T=w(x),O=y(x,2);fe(()=>Q(T,d(u))),Ue("click",x,()=>m()),Ue("click",O,()=>m()),R(s,P),xe()}function Du(s,e){if(s instanceof RegExp)return{keys:!1,pattern:s};var t,r,n,a,i=[],o="",l=s.split("/");for(l[0]||l.shift();n=l.shift();)t=n[0],t==="*"?(i.push("wild"),o+="/(.*)"):t===":"?(r=n.indexOf("?",1),a=n.indexOf(".",1),i.push(n.substring(1,~r?r:~a?a:n.length)),o+=~r&&!~a?"(?:/([^/]+?))?":"/([^/]+?)",~a&&(o+=(~r?"?":"")+"\\"+n.substring(a))):o+="/"+n;return{keys:i,pattern:new RegExp("^"+o+"/?$","i")}}function aa(){const s=window.location.href.indexOf("#/");let e=s>-1?window.location.href.substr(s+1):"/";const t=e.indexOf("?");let r="";return t>-1&&(r=e.substr(t+1),e=e.substr(0,t)),{location:e,querystring:r}}const hn=Ha(null,function(e){e(aa());const t=()=>{e(aa())};return window.addEventListener("hashchange",t,!1),function(){window.removeEventListener("hashchange",t,!1)}}),Rs=Ga(hn,s=>s.location);Ga(hn,s=>s.querystring);const ia=Ja(void 0);function Lu(s){s?window.scrollTo(s.__svelte_spa_router_scrollX,s.__svelte_spa_router_scrollY):window.scrollTo(0,0)}function qu(s,e){Ee(e,!1);let t=ge(e,"routes",24,()=>({})),r=ge(e,"prefix",8,""),n=ge(e,"restoreScrollState",8,!1);class a{constructor(T,O){if(!O||typeof O!="function"&&(typeof O!="object"||O._sveltesparouter!==!0))throw Error("Invalid component object");if(!T||typeof T=="string"&&(T.length<1||T.charAt(0)!="/"&&T.charAt(0)!="*")||typeof T=="object"&&!(T instanceof RegExp))throw Error('Invalid value for "path" argument - strings must start with / or *');const{pattern:I,keys:D}=Du(T);this.path=T,typeof O=="object"&&O._sveltesparouter===!0?(this.component=O.component,this.conditions=O.conditions||[],this.userData=O.userData,this.props=O.props||{}):(this.component=()=>Promise.resolve(O),this.conditions=[],this.props={}),this._pattern=I,this._keys=D}match(T){if(r()){if(typeof r()=="string")if(T.startsWith(r()))T=T.substr(r().length)||"/";else return null;else if(r()instanceof RegExp){const z=T.match(r());if(z&&z[0])T=T.substr(z[0].length)||"/";else return null}}const O=this._pattern.exec(T);if(O===null)return null;if(this._keys===!1)return O;const I={};let D=0;for(;D<this._keys.length;){try{I[this._keys[D]]=decodeURIComponent(O[D+1]||"")||null}catch{I[this._keys[D]]=null}D++}return I}async checkConditions(T){for(let O=0;O<this.conditions.length;O++)if(!await this.conditions[O](T))return!1;return!0}}const i=[];t()instanceof Map?t().forEach((x,T)=>{i.push(new a(T,x))}):Object.keys(t()).forEach(x=>{i.push(new a(x,t()[x]))});let o=$t(null),l=$t(null),c=$t({});const u=Zo();async function h(x,T){await _o(),u(x,T)}let f=null,v=null;n()&&(v=x=>{x.state&&(x.state.__svelte_spa_router_scrollY||x.state.__svelte_spa_router_scrollX)?f=x.state:f=null},window.addEventListener("popstate",v),Xo(()=>{Lu(f)}));let g=null,k=null;const m=hn.subscribe(async x=>{g=x;let T=0;for(;T<i.length;){const O=i[T].match(x.location);if(!O){T++;continue}const I={route:i[T].path,location:x.location,querystring:x.querystring,userData:i[T].userData,params:O&&typeof O=="object"&&Object.keys(O).length?O:null};if(!await i[T].checkConditions(I)){_(o,null),k=null,h("conditionsFailed",I);return}h("routeLoading",Object.assign({},I));const D=i[T].component;if(k!=D){D.loading?(_(o,D.loading),k=D,_(l,D.loadingParams),_(c,{}),h("routeLoaded",Object.assign({},I,{component:d(o),name:d(o).name,params:d(l)}))):(_(o,null),k=null);const z=await D();if(x!=g)return;_(o,z&&z.default||z),k=D}O&&typeof O=="object"&&Object.keys(O).length?_(l,O):_(l,null),_(c,i[T].props),h("routeLoaded",Object.assign({},I,{component:d(o),name:d(o).name,params:d(l)})).then(()=>{ia.set(d(l))});return}_(o,null),k=null,ia.set(void 0)});Yo(()=>{m(),v&&window.removeEventListener("popstate",v)}),no(()=>Ua(n()),()=>{history.scrollRestoration=n()?"manual":"auto"}),ao(),Wa();var P=gt(),j=ke(P);{var S=x=>{var T=gt(),O=ke(T);Sn(O,()=>d(o),(I,D)=>{D(I,Pn({get params(){return d(l)}},()=>d(c),{$$events:{routeEvent(z){An.call(this,e,z)}}}))}),R(x,T)},b=x=>{var T=gt(),O=ke(T);Sn(O,()=>d(o),(I,D)=>{D(I,Pn(()=>d(c),{$$events:{routeEvent(z){An.call(this,e,z)}}}))}),R(x,T)};le(j,x=>{d(l)?x(S):x(b,!1)})}R(s,P),xe()}var Uu=rn(N('<script src="https://www.youtube.com/iframe_api"><\/script><!>',1)),Nu=N("<p>Oops. Loquelis is struggling to the media - it may be invalid or unavailable.</p>"),Bu=N('<main class="route svelte-8mhly"><!> <section class="main-page svelte-8mhly"><h1 class="page-header svelte-8mhly">Music</h1> <section class="main-content svelte-8mhly"><span class="heading svelte-8mhly"><!></span> <iframe id="player" frameborder="0" allowfullscreen="" class="svelte-8mhly"></iframe> <!> <!></section></section></main>');function Fu(s,e){Ee(e,!0);const[t,r]=Ms(),n=()=>Ps(Rs,"$location",t);let a=A(B(n().split("/").pop())),i,o=A("Loading..."),l=A("Loading..."),c=A("Loading..."),u=A("Loading..."),h=A("https://img.youtube.com/vi/loquela/maxresdefault.jpg"),f=A("Unknown Level"),v=A("No Rating"),g=A(""),k=A(B([])),m=A(void 0),P=A("https://youtu.be/zabswqP6xEM");Ce(()=>{const L=n().split("/").pop();L!=d(a)&&_(a,L,!0),j().then(()=>{window.YT?b():window.onYouTubeIframeAPIReady=b})}),He(()=>{fetchLanguages()});async function j(){const{data:L,error:Y}=await de.from("media").select("*").eq("id",d(a)).single();if(L){const X=L;_(o,X.name,!0),_(l,X.artist,!0),_(c,X.author,!0),_(u,X.author_username,!0),_(h,X.cover,!0),_(f,X.level,!0),_(v,X.rating,!0),_(g,X.language,!0),_(P,X.embed_link,!0),_(k,X.content.events,!0),console.log(d(k)),console.log(`${d(P)}?enablejsapi=1`)}else _(o,"Unknown Song"),_(l,"Unknown Artist"),_(h,"https://img.youtube.com/vi/loquela/maxresdefault.jpg"),_(f,"Unknown Level"),_(v,"No Rating"),_(P,"https://youtu.be/zabswqP6xEM")}function S(L){let Y=0;d(k).forEach(X=>{L>X.tStartMs&&L<d(k)[Y+1].tStartMs&&X.segs.forEach(J=>{d(m)!==J.utf8&&_(m,J.utf8,!0)}),Y++})}function b(){i=new YT.Player("player",{events:{onReady:()=>{setInterval(()=>{const L=i.getCurrentTime(),Y=Math.round(L*1e3);S(Y)},1)}}})}var x=Bu();sn(L=>{var Y=Uu();y(ke(Y)),R(L,Y)});var T=w(x);dt(T,{currentPage:"/music"});var O=y(T,2),I=y(w(O),2),D=w(I),z=w(D);gi(z,{get song(){return d(o)},get artist(){return d(l)}});var H=y(D,2),ie=y(H,2);{var oe=L=>{var Y=Nu();R(L,Y)};le(ie,L=>{d(P)==="https://youtu.be/zabswqP6xEM"&&L(oe)})}var ce=y(ie,2);dn(ce,{get currentLine(){return d(m)},get targetLanguage(){return d(g)}}),fe(()=>{Te(H,"src",`${d(P)}?enablejsapi=1`),Te(H,"title",d(o))}),R(s,x),xe(),r()}var zu=N('<option class="svelte-1pcfluu"> </option>'),Vu=N('<option class="svelte-1pcfluu"> </option>'),Wu=N('<main class="route svelte-1pcfluu"><!> <section class="main-page"><h1 class="page-header">Upload</h1> <section class="main-content svelte-1pcfluu"><form class="svelte-1pcfluu"><div class="vertical-container svelte-1pcfluu"><span class="svelte-1pcfluu"><label for="media">* Select media type:</label> <select class="media svelte-1pcfluu" required><option class="svelte-1pcfluu">--Pick the medium category--</option><option class="svelte-1pcfluu">📺 YT Video</option><option class="svelte-1pcfluu">🎧 Music</option></select></span> <span class="svelte-1pcfluu"><label for="language">* Select language of content:</label> <select class="language svelte-1pcfluu" required><option class="svelte-1pcfluu">--Select language--</option><!></select></span> <span class="svelte-1pcfluu"><label for="level">* Select level of content:</label> <select class="level svelte-1pcfluu" required><option class="svelte-1pcfluu">--Select a level--</option><option class="svelte-1pcfluu">🐣 A1</option><option class="svelte-1pcfluu">🐥 A2</option><option class="svelte-1pcfluu">🦉 B1</option><option class="svelte-1pcfluu">🦅 B2</option><option class="svelte-1pcfluu">🦜 C1</option><option class="svelte-1pcfluu">🦚 C2</option></select></span> <span class="svelte-1pcfluu"><label for="category">* Select category of content:</label> <select class="category svelte-1pcfluu" required><option class="svelte-1pcfluu">--Select category--</option><!></select></span></div> <span class="svelte-1pcfluu"><label for="url">Link to medium:</label> <input class="url svelte-1pcfluu" type="url" placeholder="Enter media URL"/></span> <button type="submit" class="svelte-1pcfluu">Upload</button> <!></form></section></section></main>');function Hu(s,e){Ee(e,!0);let t=A(B({name:"",type:""})),r="",n="",a="",i="",o="",l=A(B([])),c=A(B([])),u=A(""),h=A("");_(c,[{name:"Comedy",emoji:"🤣"},{name:"Cartoon",emoji:"🖌️"},{name:"Documentary",emoji:"📑"},{name:"Sport",emoji:"⚽️"},{name:"History",emoji:"🏰"},{name:"Politics",emoji:"🇺🇳"},{name:"Action",emoji:"⚡️"},{name:"Reviews Unboxings",emoji:"📦"},{name:"Gaming",emoji:"🎮"},{name:"Vlogs",emoji:"📷"},{name:"Movie/ Film",emoji:"🍿"},{name:"Series",emoji:"📺"}],!0);function f(){cs({particleCount:600,spread:100,origin:{y:0}})}He(async()=>{j(),v()});async function v(){const{data:V,error:re}=await de.from("languages").select("*");if(V)return _(l,V,!0),console.log(d(l)),V;if(re)throw re}async function g(V,re,C,W,ve){try{if(await m(re)){_(t,{type:"warn",name:"This has already been uploaded to Loquela"},!0);return}V==="video"||V==="music"?(await k(re,C,V,W,ve),_(t,{type:"success",name:"Beginning upload..."},!0),f()):_(t,{type:"error",name:"Error in link validation"},!0)}catch(pe){console.error("Upload error:",pe),_(t,{type:"error",name:"Error in upload process"},!0)}}async function k(V,re,C,W,ve){const pe=de.channel("subtitles");await pe.subscribe();const Se=await pe.send({type:"broadcast",event:"subtitle-update",payload:{id:1,url:V,lang:re,type:C,level:W,author:d(u),author_username:d(h),category:ve}});console.log("Broadcast result:",Se)}async function m(V){const{data:re,error:C}=await de.from("media").select("*").eq("video_link",V).single();if(C){if(C.details&&C.details.includes("0 rows"))return!1;console.error("Database error:",C)}return!!re}async function P(V,re,C,W,ve){try{return(await fetch(`https://www.youtube.com/oembed?url=${encodeURIComponent(V)}&format=json`)).ok?(await g(re,V,C,W,ve),!0):(_(t,{type:"error",name:"Invalid YouTube URL"},!0),!1)}catch(pe){return console.error("Validation error:",pe),_(t,{type:"error",name:"Error validating URL"},!0),!1}}async function j(){const{data:V,error:re}=await de.auth.getSession(),C=V;if(re)console.error("Error fetching session:",re);else if(C){_(u,C.session.user.id,!0);const{data:W,error:ve}=await de.from("profiles").select("username").eq("user_id",d(u)).single();W&&_(h,W.username,!0),ve&&console.log(ve)}re&&console.error("Error fetching userID:",re)}var S=Wu(),b=w(S);dt(b,{currentPage:"/upload"});var x=y(b,2),T=y(w(x),2),O=w(T),I=w(O),D=w(I),z=y(w(D),2),H=w(z);H.value=H.__value="";var ie=y(H);ie.value=ie.__value="video";var oe=y(ie);oe.value=oe.__value="music";var ce=y(D,2),L=y(w(ce),2),Y=w(L);Y.value=Y.__value="";var X=y(Y);Me(X,17,()=>d(l),Pe,(V,re)=>{var C=zu(),W={},ve=w(C);fe(()=>{W!==(W=d(re).short)&&(C.value=(C.__value=d(re).short)??""),Q(ve,`${d(re).emoji??""} ${d(re).name??""}`)}),R(V,C)});var J=y(ce,2),he=y(w(J),2),E=w(he);E.value=E.__value="";var p=y(E);p.value=p.__value="A1";var $=y(p);$.value=$.__value="A2";var U=y($);U.value=U.__value="B1";var F=y(U);F.value=F.__value="B2";var G=y(F);G.value=G.__value="C1";var ee=y(G);ee.value=ee.__value="C2";var M=y(J,2),q=y(w(M),2),K=w(q);K.value=K.__value="";var Z=y(K);Me(Z,17,()=>d(c),Pe,(V,re)=>{var C=Vu(),W={},ve=w(C);fe(()=>{W!==(W=d(re).name)&&(C.value=(C.__value=d(re).name)??""),Q(ve,`${d(re).emoji??""} ${d(re).name??""}`)}),R(V,C)});var te=y(I,2),se=y(w(te),2),we=y(te,4);{var ne=V=>{mt(V,{get type(){return d(t).type},get message(){return d(t).name},width:"16em"})};le(we,V=>{d(t).name&&V(ne)})}Ue("submit",O,V=>{V.preventDefault(),P(n,r,a,i,o)}),Ge(z,()=>r,V=>r=V),Ge(L,()=>a,V=>a=V),Ge(he,()=>i,V=>i=V),Ge(q,()=>o,V=>o=V),nt(se,()=>n,V=>n=V),R(s,S),xe()}var Ju=N('<section class="svelte-zs935q"><span class="text-container svelte-zs935q"><a class="svelte-zs935q"><h1 class="name svelte-zs935q"> </h1></a> <p class="terms svelte-zs935q"> </p> <p class="author svelte-zs935q"> </p></span> <span class="language-image-container svelte-zs935q"><img class="svelte-zs935q"/></span></section>');function Gu(s,e){var t=Ju(),r=w(t),n=w(r),a=w(n),i=w(a),o=y(n,2),l=w(o),c=y(o,2),u=w(c),h=y(r,2),f=w(h);fe(()=>{Te(n,"href",`#/app/flashcards/${e.id}`),Q(i,e.name),Q(l,`Terms: ${e.terms??""}`),Q(u,`@${e.author??""}`),Te(f,"src",`https://hatscripts.github.io/circle-flags/flags/${e.country??""}.svg`)}),R(s,t)}var Ku=N('<p class="not-found svelte-1t64b77">:/ Oops! No flashcards found; try uploading your own or try again later.</p>'),Yu=N("<option> </option>"),Qu=N('<main class="route svelte-1t64b77"><!> <section class="main-page"><h1 class="page-header">Flashcards</h1> <section class="main-content svelte-1t64b77"><button class="create-flashcard-deck svelte-1t64b77">+ Create Flashcard Deck</button> <section class="flashcard-decks svelte-1t64b77"><!> <!></section></section></section></main> <dialog class="svelte-1t64b77"><div class="dialog-container svelte-1t64b77"><div><h2>Create Flashcard Deck</h2> <h1> </h1> <form class="svelte-1t64b77"><label>Deck name:</label> <input class="name svelte-1t64b77"/> <label>Language:</label> <select class="language svelte-1t64b77"><option>--Select language--</option><!></select> <input type="Submit" class="svelte-1t64b77"/></form></div> <button class="close-dialog-button svelte-1t64b77">Close</button></div></dialog>',1);function Zu(s,e){Ee(e,!0);let t,r,n,a=A(B([])),i=A(void 0),o=A(""),l=A(B([]));He(async()=>{h(),c(),t.close()}),Ce(async()=>{if(d(i)){const{data:J,error:he}=await de.from("flashcard_decks").select("*");he&&console.error("Error fetching flashcard decks:",he),_(l,J||[],!0),console.log(d(l))}});async function c(){const{data:J,error:he}=await de.from("languages").select("*");if(J)return _(a,J,!0),console.log(d(a)),J;if(he)throw he}async function u(J,he,E,p,$){const{error:U}=await de.from("flashcard_decks").insert({name:J,author:he,author_username:$,language:E,country_code:p,content:[]});console.log(U),location.reload()}async function h(){const{data:J,error:he}=await de.auth.getSession(),E=J;if(he)console.error("Error fetching session:",he);else if(E){_(i,E.session.user.id,!0);const{data:p,error:$}=await de.from("profiles").select("username").eq("user_id",d(i)).single();p&&_(o,p.username,!0),$&&console.log($)}}var f=Qu(),v=ke(f),g=w(v);dt(g,{currentPage:"/flashcards"});var k=y(g,2),m=y(w(k),2),P=w(m);P.__click=()=>t.showModal();var j=y(P,2),S=w(j);{var b=J=>{var he=Ku();R(J,he)};le(S,J=>{d(l)[0]||J(b)})}var x=y(S,2);Me(x,17,()=>d(l),Pe,(J,he)=>{Gu(J,{get name(){return d(he).name},get author(){return d(he).author_username},get terms(){return d(he).content.length},get country(){return d(he).country_code},get id(){return d(he).id}})});var T=y(v,2),O=w(T),I=w(O),D=y(w(I),2),z=w(D),H=y(D,2),ie=y(w(H),2),oe=y(ie,4),ce=w(oe);ce.value=ce.__value="";var L=y(ce);{var Y=J=>{var he=gt(),E=ke(he);Me(E,17,()=>d(a),Pe,(p,$,U)=>{var F=Yu();F.value=F.__value=U;var G=w(F);fe(()=>Q(G,`${d($).emoji??""} ${d($).name??""}`)),R(p,F)}),R(J,he)};le(L,J=>{d(a)&&J(Y)})}var X=y(I,2);X.__click=()=>t.close(),it(T,J=>t=J,()=>t),fe(()=>Q(z,d(a)[n])),Ue("submit",H,J=>{u(r,d(i),d(a)[n].short,d(a)[n].country_code,d(o))}),nt(ie,()=>r,J=>r=J),Ge(oe,()=>n,J=>n=J),R(s,f),xe()}os(["click"]);function Xu(s,e){e().forEach(t=>{const r=document.getElementsByClassName(t);r&&Array.from(r).forEach(n=>{n.classList.remove("hidden")})})}function ed(s,e,t,r){e.content[d(t)]&&(d(r).push(e.content[d(t)]),ba(t))}function td(s,e,t,r,n,a){e.content[d(t)]&&(d(r).push(e.content[d(t)]),ba(t)),d(n)===100&&a()}function sd(s,e,t,r,n){_(e,0),_(t,[],!0),d(r).forEach(a=>{n.content.splice(n.content.indexOf(a),1)}),_(r,[],!0)}var rd=N('<div class="title-author-container svelte-1xxak5y"><h1 class="deck-name-heading svelte-1xxak5y"> </h1> <p class="deck-name-author svelte-1xxak5y">Uploaded by: <b> </b></p></div>'),nd=N('<i><p class="romanisation svelte-1xxak5y"> </p></i>'),ad=N('<span class="card-count-container svelte-1xxak5y"><span class="unsure-count card-count svelte-1xxak5y"> </span> <span class="known-count card-count svelte-1xxak5y"> </span></span> <div class="flashcard svelte-1xxak5y"><h1 class="word svelte-1xxak5y"> </h1> <span class="word-details svelte-1xxak5y"><!> <p class="part-of-speech svelte-1xxak5y"> </p></span> <p class="definition svelte-1xxak5y"> </p></div> <span class="buttons svelte-1xxak5y"><button class="dont-know flashcard-button svelte-1xxak5y"><span class="material-symbols-rounded svelte-1xxak5y">do_not_disturb</span>Unsure</button> <button class="flip flashcard-button svelte-1xxak5y"><span class="material-symbols-rounded svelte-1xxak5y">autorenew</span>Flip</button> <button class="know flashcard-button svelte-1xxak5y"><span class="material-symbols-rounded svelte-1xxak5y">check_circle</span>Know</button></span>',1),id=N('<button class="flashcard-continue svelte-1xxak5y"><span class="material-symbols-rounded svelte-1xxak5y">expand_circle_right</span> Continue with unknown terms</button>'),od=N('<p class="svelte-1xxak5y">Congratulations! You know all the terms in this deck!</p>'),ld=N('<div class="flashcard svelte-1xxak5y"><p class="known-percentage svelte-1xxak5y"> </p> <!> <!></div>'),cd=N('<main class="svelte-1xxak5y"><!> <!> <!></main>');function ud(s,e){Ee(e,!0);const t=ge(e,"backContent",19,()=>[]),r=ge(e,"author",3,"");let n=A(0),a=A(B([])),i=A(B([])),o="",l=A(B(o.word)),c=A(B(o.definition)),u=A(B(o.partOfSpeech)),h=A(B(o.romanisation)),f=A(0);Ce(()=>{_(f,Math.round(d(i).length/(d(a).length+d(i).length)*100),!0)}),console.log(e.content),He(()=>{Ce(()=>{if(e.content&&Array.isArray(e.content)&&e.content[d(n)]){const T=JSON.parse(e.content[d(n)]);console.log(T),_(l,T.word,!0),_(c,T.definition,!0),_(u,T.partOfSpeech,!0),_(h,T.romanisation,!0),v()}})});function v(){t().forEach(T=>{const O=document.getElementsByClassName(T);O&&Array.from(O).forEach(I=>{I.classList.add("hidden")})})}function g(){cs({particleCount:200,spread:70,origin:{y:0}})}var k=cd(),m=w(k);{var P=T=>{var O=rd(),I=w(O),D=w(I),z=y(I,2),H=y(w(z)),ie=w(H);fe(()=>{Q(D,e.deckName),Q(ie,`@${r()??""}`)}),R(T,O)};le(m,T=>{r()&&e.deckName&&T(P)})}var j=y(m,2);{var S=T=>{var O=ad(),I=ke(O),D=w(I),z=w(D),H=y(D,2),ie=w(H),oe=y(I,2),ce=w(oe),L=w(ce),Y=y(ce,2),X=w(Y);{var J=M=>{var q=nd(),K=w(q),Z=w(K);fe(()=>Q(Z,d(h))),R(M,q)};le(X,M=>{d(h)&&M(J)})}var he=y(X,2),E=w(he),p=y(Y,2),$=w(p),U=y(oe,2),F=w(U);F.__click=[ed,e,n,a];var G=y(F,2);G.__click=[Xu,t];var ee=y(G,2);ee.__click=[td,e,n,i,f,g],fe(()=>{Q(z,d(a).length),Q(ie,d(i).length),Q(L,d(l)),Q(E,d(u)),Q($,d(c))}),R(T,O)};le(j,T=>{d(n)!==e.content.length&&T(S)})}var b=y(j,2);{var x=T=>{var O=ld(),I=w(O),D=w(I),z=y(I,2);{var H=ce=>{var L=id();L.__click=[sd,n,a,i,e],R(ce,L)};le(z,ce=>{d(f)!==100&&ce(H)})}var ie=y(z,2);{var oe=ce=>{var L=od();R(ce,L)};le(ie,ce=>{d(f)===100&&ce(oe)})}fe(()=>Q(D,`Known: ${d(f)??""}%`)),R(T,O)};le(b,T=>{d(n)===e.content.length&&T(x)})}R(s,k),xe()}os(["click"]);var dd=N("<h3>Oops! Looks like there are no cards in this deck. Try going to a video, song or AI Chat and add some!</h3>"),hd=N('<main class="route svelte-1ia8qag"><!> <section class="main-page"><h1 class="page-header">Flashcards</h1> <section class="main-content svelte-1ia8qag"><!> <!></section></section></main>');function fd(s,e){Ee(e,!0);const[t,r]=Ms();let a=B(Ps(Rs,"$location",t).split("/").pop()),i=A(B([])),o=A(0),l="",c=A(B(l.flashcardDeckName)),u=A(B(l.flashcardDeckAuthor));He(async()=>{const b=await h(a);b?(_(c,b.name,!0),_(u,b.author_username,!0),_(i,b.content,!0),_(o,d(i).length,!0),console.log(d(o))):console.error("Flashcards not found")});async function h(b){const{data:x,error:T}=await de.from("flashcard_decks").select("*").eq("id",b).single();if(T){console.error(T);return}return x}var f=hd(),v=w(f);dt(v,{currentPage:"/flashcards"});var g=y(v,2),k=y(w(g),2),m=w(k);{var P=b=>{ud(b,{get content(){return d(i)},backContent:["part-of-speech","definition"],get deckName(){return d(c)},get author(){return d(u)}})};le(m,b=>{d(i)&&d(i).length>0&&b(P)})}var j=y(m,2);{var S=b=>{var x=dd();R(b,x)};le(j,b=>{!d(i).length>0&&b(S)})}R(s,f),xe(),r()}var vd=N("<option> </option>"),pd=N('<p class="not-found svelte-3mvwdf">:/ Oops! No videos found; try uploading your own or try again later.</p>'),gd=N("<p>Try selecting a language to show media. If no languages show up, come back later as the servers may be down.</p>"),md=N('<main class="route svelte-3mvwdf"><!> <section class="main-page"><h1 class="page-header">Videos</h1> <section class="main-content svelte-3mvwdf"><select></select> <section class="media-container svelte-3mvwdf"><!> <!> <!></section></section></section></main>');function _d(s,e){Ee(e,!0);let t=A(B([])),r=A(B([])),n=A("");async function a(j){const{data:S,error:b}=await de.from("media").select("*").eq("language",j).eq("media_type","video");b?(console.error("Error fetching videos:",b),_(t,[],!0)):(console.log(d(t)),_(t,S||[],!0))}async function i(){const{data:j,error:S}=await de.from("languages").select("*");if(j)return _(r,j,!0),console.log(d(r)),j;if(S)throw S}He(()=>{i()}),Ce(()=>{a(d(n))});var o=md(),l=w(o);dt(l,{currentPage:"/videos"});var c=y(l,2),u=y(w(c),2),h=w(u);Me(h,21,()=>d(r),Pe,(j,S,b,x)=>{var T=vd(),O={},I=w(T);fe(()=>{O!==(O=d(S).short)&&(T.value=(T.__value=d(S).short)??""),Q(I,`${d(S).emoji??""} ${d(S).name??""}`)}),R(j,T)});var f=y(h,2),v=w(f);{var g=j=>{var S=pd();R(j,S)};le(v,j=>{!d(t)[0]&&d(n)&&j(g)})}var k=y(v,2);{var m=j=>{var S=gd();R(j,S)};le(k,j=>{d(n)||j(m)})}var P=y(k,2);Me(P,17,()=>d(t),Pe,(j,S)=>{const b=Js(()=>`#/app/videos/${d(S).id}`);pi(j,{get name(){return d(S).name},get artist(){return d(S).artist},get cover(){return d(S).cover},get level(){return d(S).level},get rating(){return d(S).rating},get link(){return d(b)},type:"video"})}),Ge(h,()=>d(n),j=>_(n,j)),R(s,o),xe()}var yd=rn(N('<script src="https://www.youtube.com/iframe_api"><\/script><!>',1)),wd=N("<p>Oops. Loquelis is struggling to the media - it may be invalid or unavailable.</p>"),bd=N('<main class="route svelte-104pp2a"><!> <section class="main-page svelte-104pp2a"><h1 class="page-header svelte-104pp2a">Videos</h1> <section class="main-content svelte-104pp2a"><span class="heading svelte-104pp2a"><!></span> <iframe id="player" frameborder="0" allowfullscreen="" class="svelte-104pp2a"></iframe> <!> <!></section></section></main>');function kd(s,e){Ee(e,!0);const[t,r]=Ms(),n=()=>Ps(Rs,"$location",t);let a=A(B(n().split("/").pop())),i,o=A("Loading..."),l=A("Loading..."),c=A("Loading..."),u=A("Loading..."),h=A("https://img.youtube.com/vi/loquela/maxresdefault.jpg"),f=A("Unknown Level"),v=A("No Rating"),g=A(""),k=A(B([])),m=A(void 0),P=A("https://youtu.be/zabswqP6xEM");Ce(()=>{const L=n().split("/").pop();L!=d(a)&&_(a,L,!0),j().then(()=>{window.YT?b():window.onYouTubeIframeAPIReady=b})});async function j(){const{data:L,error:Y}=await de.from("media").select("*").eq("id",d(a)).single();if(L){const X=L;_(o,X.name,!0),_(u,X.artist,!0),_(l,X.author,!0),_(c,X.author_username,!0),_(h,X.cover,!0),_(f,X.level,!0),_(v,X.rating,!0),_(g,X.language,!0),_(P,X.embed_link,!0),_(k,X.content.events,!0),console.log(d(k)),console.log(`${d(P)}?enablejsapi=1`)}else _(o,"Unknown Video"),_(u,"Unknown Artist"),_(h,"https://img.youtube.com/vi/loquela/maxresdefault.jpg"),_(f,"Unknown Level"),_(v,"No Rating"),_(P,"https://youtu.be/zabswqP6xEM")}function S(L){let Y=0;d(k).forEach(X=>{L>X.tStartMs&&L<d(k)[Y+1].tStartMs&&X.segs.forEach(J=>{d(m)!==J.utf8&&_(m,J.utf8,!0)}),Y++})}function b(){i=new YT.Player("player",{events:{onReady:()=>{setInterval(()=>{const L=i.getCurrentTime(),Y=Math.round(L*1e3);S(Y)},1)}}})}var x=bd();sn(L=>{var Y=yd();y(ke(Y)),R(L,Y)});var T=w(x);dt(T,{currentPage:"/videos"});var O=y(T,2),I=y(w(O),2),D=w(I),z=w(D);gi(z,{get song(){return d(o)},get artist(){return d(u)}});var H=y(D,2),ie=y(H,2);{var oe=L=>{var Y=wd();R(L,Y)};le(ie,L=>{d(P)==="https://youtu.be/zabswqP6xEM"&&L(oe)})}var ce=y(ie,2);dn(ce,{get currentLine(){return d(m)},get targetLanguage(){return d(g)}}),fe(()=>{Te(H,"src",`${d(P)}?enablejsapi=1`),Te(H,"title",d(o))}),R(s,x),xe(),r()}var Sd=N('<img class="svelte-1eyogx4"/>'),Ed=N('<section class="ai-chat-box svelte-1eyogx4"><div class="pfp-name-occupation-container svelte-1eyogx4"><!> <div class="text svelte-1eyogx4"><a class="svelte-1eyogx4"><h2 class="svelte-1eyogx4"> </h2></a> <p class="occupation svelte-1eyogx4"> </p></div></div> <div class="flag-tags-container svelte-1eyogx4"><img class="lang-flag svelte-1eyogx4"/> <span class="traits svelte-1eyogx4"><p class="trait-tag svelte-1eyogx4"> </p></span></div></section>');function xd(s,e){var t=Ed(),r=w(t),n=w(r);{var a=P=>{var j=Sd();fe(()=>{Te(j,"src",e.image),Te(j,"alt",e.firstName)}),R(P,j)};le(n,P=>{e.image&&P(a)})}var i=y(n,2),o=w(i),l=w(o),c=w(l),u=y(o,2),h=w(u),f=y(r,2),v=w(f),g=y(v,2),k=w(g),m=w(k);fe(()=>{Te(o,"href",`/#/app/ai-chat/${e.id}`),Q(c,e.firstName),Q(h,e.occupation),Te(v,"src",`https://hatscripts.github.io/circle-flags/flags/${e.lang}.svg`),Te(v,"alt",e.lang),Q(m,e.trait)}),R(s,t)}var Td=(s,e)=>d(e).showModal(),Od=N('<p class="not-found svelte-zgr3mn">:/ Oops! No flashcards found; try uploading your own or try again later.</p>'),jd=N("<option> </option>"),Ad=N("<option> </option>"),Pd=N("<option> </option>"),Md=(s,e)=>d(e).close(),Cd=N('<main class="route svelte-zgr3mn"><!> <section class="main-page"><h1 class="page-header">AI Chat</h1> <section class="main-content svelte-zgr3mn"><button class="create-ai-character svelte-zgr3mn"><span class="material-symbols-rounded svelte-zgr3mn">person_add</span>Create AI Character</button> <div class="chats svelte-zgr3mn"><!> <!></div></section></section></main> <dialog class="svelte-zgr3mn"><div class="dialog-container svelte-zgr3mn"><h2 class="dialog-header svelte-zgr3mn">Create AI Character</h2> <form class="svelte-zgr3mn"><label class="svelte-zgr3mn">🪪 Character name:</label> <input class="name svelte-zgr3mn" required/> <span class="label-input-container svelte-zgr3mn"><label class="svelte-zgr3mn">💬 Language:</label> <select class="language svelte-zgr3mn" required><option>--Select language--</option><!></select></span> <span class="label-input-container svelte-zgr3mn"><label class="svelte-zgr3mn">👔 Occupation:</label> <select class="occupation svelte-zgr3mn" required><option>--Select occupation--</option><!></select></span> <span class="label-input-container svelte-zgr3mn"><label class="svelte-zgr3mn">🧠 Trait:</label> <select class="traits svelte-zgr3mn" required><option>--Select trait--</option><!></select></span> <!> <input class="submit-btn svelte-zgr3mn" type="Submit"/></form> <button class="close-dialog-btn svelte-zgr3mn">Close</button></div></dialog>',1);function Id(s,e){Ee(e,!0),ge(e,"occupation",3,"Knight"),ge(e,"image",3,"https://image.pollinations.ai/prompt/Generate%20a%20pixar-style%20image%20of%20a%20knight%20called%20Hansel%20with%20traits%20of%20brave,%20adventurous%20who%20is%20dressed%20in%20traditional%20attire%20of%20German"),ge(e,"firstName",3,"Hansel"),ge(e,"trait",3,"Friendly"),ge(e,"lang",3,"de");let t="",r=A(B(t.characterName)),n=A(B(t.characterLang)),a=A(B(t.characterTrait)),i=A(B(t.characterOccupation)),o=A(B([])),l=A(null),c=A(B([])),u=B([]),h=B([]),f=A(B([])),v="",g=A(B(v.characterCreateStatus)),k=A(B(v.characterCreateMessage));He(async()=>{await b(),await x(),P(),j(),m()});async function m(){const{data:C,error:W}=await de.from("ai_characters").select("*");C&&_(f,C,!0),W&&console.error(W)}function P(){Array.from(d(c)).forEach(C=>{console.log("gabo"),C.type==="occupation"?u.push(C.name):console.error("Error finding occupations")})}function j(){Array.from(d(c)).forEach(C=>{console.log("gabo"),C.type==="trait"?h.push(C.name):console.error("Error finding traits")})}async function S(C,W,ve,pe,Se){_(g,""),_(k,""),console.log(Se);const{error:Ne}=await de.from("ai_characters").insert([{name:C,trait:W,occupation:ve,language:pe,country:Se,image:`https://image.pollinations.ai/prompt/Generate a pixar-style image of a ${ve} called ${C} with trait of ${W} who is dressed in traditional attire of ${pe}.`}]);Ne||(_(g,"success"),_(k,"Created! Reload the page to see your character!")),Ne&&(_(g,"error"),_(k,"Error adding character"),console.error(Ne))}async function b(){const{data:C,error:W}=await de.from("languages").select("*");if(C)return _(o,C,!0),console.log(d(o)),C;if(W)throw W}async function x(){const{data:C,error:W}=await de.from("character_fields").select("*");if(C)return _(c,C,!0),console.log(d(c)),C;if(W)throw W}var T=Cd(),O=ke(T),I=w(O);dt(I,{currentPage:"/ai-chat"});var D=y(I,2),z=y(w(D),2),H=w(z);H.__click=[Td,l];var ie=y(H,2),oe=w(ie);{var ce=C=>{var W=Od();R(C,W)};le(oe,C=>{d(f)[0]||C(ce)})}var L=y(oe,2);Me(L,17,()=>d(f),Pe,(C,W)=>{xd(C,{get id(){return d(W).id},get image(){return d(W).image},get firstName(){return d(W).name},get trait(){return d(W).trait},get lang(){return d(W).country},get occupation(){return d(W).occupation}})});var Y=y(O,2),X=w(Y),J=y(w(X),2),he=y(w(J),2),E=y(he,2),p=y(w(E),2),$=w(p);$.value=$.__value="";var U=y($);{var F=C=>{var W=gt(),ve=ke(W);Me(ve,17,()=>d(o),Pe,(pe,Se,Ne)=>{var Be=jd();Be.value=Be.__value=Ne;var Oe=w(Be);fe(()=>Q(Oe,`${d(Se).emoji??""} ${d(Se).name??""}`)),R(pe,Be)}),R(C,W)};le(U,C=>{d(o)&&C(F)})}var G=y(E,2),ee=y(w(G),2),M=w(ee);M.value=M.__value="";var q=y(M);{var K=C=>{var W=gt(),ve=ke(W);Me(ve,17,()=>u,Pe,(pe,Se,Ne,Be)=>{var Oe=Ad(),Qe={},Ze=w(Oe);fe(()=>{Qe!==(Qe=d(Se))&&(Oe.value=(Oe.__value=d(Se))??""),Q(Ze,d(Se))}),R(pe,Oe)}),R(C,W)};le(q,C=>{u&&C(K)})}var Z=y(G,2),te=y(w(Z),2),se=w(te);se.value=se.__value="";var we=y(se);{var ne=C=>{var W=gt(),ve=ke(W);Me(ve,17,()=>h,Pe,(pe,Se,Ne,Be)=>{var Oe=Pd(),Qe={},Ze=w(Oe);fe(()=>{Qe!==(Qe=d(Se))&&(Oe.value=(Oe.__value=d(Se))??""),Q(Ze,d(Se))}),R(pe,Oe)}),R(C,W)};le(we,C=>{h&&C(ne)})}var V=y(Z,2);mt(V,{get type(){return d(g)},get message(){return d(k)}});var re=y(J,2);re.__click=[Md,l],it(Y,C=>_(l,C),()=>d(l)),Ue("submit",J,C=>{C.preventDefault(),S(d(r),d(a),d(i),d(o)[d(n)].short,d(o)[d(n)].country_code)}),nt(he,()=>d(r),C=>_(r,C)),Ge(p,()=>d(n),C=>_(n,C)),Ge(ee,()=>d(i),C=>_(i,C)),Ge(te,()=>d(a),C=>_(a,C)),R(s,T),xe()}os(["click"]);var $d=async(s,e)=>await e(),Rd=(s,e,t)=>{d(e).showModal(),t()},Dd=(s,e,t,r)=>e(d(t),d(r)),Ld=N('<p class="ai-word svelte-e3qlvf"> </p>'),qd=N('<div class="message ai-sent svelte-e3qlvf"></div>'),Ud=N('<div class="message user-sent svelte-e3qlvf"> </div>'),Nd=N("<!> <!>",1),Bd=N('<span class="deck-label svelte-e3qlvf">Deck: <b> </b></span>'),Fd=(s,e,t,r)=>e(d(t),r),zd=N('<div class="chat-container svelte-e3qlvf"><section class="header-messages-container svelte-e3qlvf"><span class="chat-header svelte-e3qlvf"><span class="pfp-name-container svelte-e3qlvf"><img class="character-header-image svelte-e3qlvf"/> <h3 class="svelte-e3qlvf"> </h3> <p> </p> <p class="trait-tag svelte-e3qlvf"> </p></span> <button class="ai-analysis-btn svelte-e3qlvf">Get AI analysis of chat</button></span> <button class="test-deck-btn svelte-e3qlvf">Get tested on a deck</button> <div class="messages-container svelte-e3qlvf"></div></section> <div class="input-deck-label-container svelte-e3qlvf"><!> <span class="send-container svelte-e3qlvf"><input class="send-message-input svelte-e3qlvf"/> <button class="send-message-btn svelte-e3qlvf"><span class="material-symbols-rounded">send</span></button></span></div></div>'),Vd=N('<span class="sentence-container svelte-e3qlvf"><span class="corrected_sentence_label_container svelte-e3qlvf">📑 <p class="original_sentence_label svelte-e3qlvf">Original sentence:</p></span> <p class="original_sentence svelte-e3qlvf"> </p></span> <span class="sentence-container svelte-e3qlvf"><span class="corrected_sentence_label_container svelte-e3qlvf">✅ <p class="corrected_sentence_label svelte-e3qlvf">Corrected sentence:</p></span> <p class="corrected_sentence svelte-e3qlvf"> </p></span>',1),Wd=N('<span class="analysis-character-container svelte-e3qlvf"><img class="analysis-image svelte-e3qlvf"/> <h1 class="analysis-header svelte-e3qlvf"> </h1></span> <div class="stats-container svelte-e3qlvf"><div class="ai-chat-analysis-container svelte-e3qlvf"><h3 class="ai-chat-analysis-header svelte-e3qlvf">💡 AI Chat Analysis</h3> <p class="ai-chat-analysis svelte-e3qlvf"> </p></div> <!></div>',1),Hd=N("<option required> </option>"),Jd=(s,e)=>d(e).close(),Gd=N('<main class="route svelte-e3qlvf"><!> <section class="main-page svelte-e3qlvf"><h1 class="page-header">AI Chat</h1> <section class="main-content svelte-e3qlvf"><!> <!> <!></section></section></main> <dialog class="svelte-e3qlvf"><div class="dialog-container svelte-e3qlvf"><h2 class="dialog-header svelte-e3qlvf">Select deck to be tested on:</h2> <form class="svelte-e3qlvf"><select class="deck-select svelte-e3qlvf"></select> <span class="deck-buttons-container svelte-e3qlvf"><input type="Submit" class="submit-deck-btn svelte-e3qlvf"/> <button class="close-deck-btn svelte-e3qlvf">Close</button></span></form></div></dialog>',1);function Kd(s,e){Ee(e,!0);const[t,r]=Ms();let a=B(Ps(Rs,"$location",t).split("/").pop()),i=A(B(Object)),o=A(""),l=A(void 0),c=B([]),u=A(""),h=HTMLObjectElement,f=A(B(h.messagesContainer)),v=A(B(h.dialogBox)),g=A(void 0),k="",m=A(B(k.term)),P=A(B(k.definition)),j=A(B(k.partOfSpeech)),S=A(B(k.romanisation)),b=A("");He(async()=>{await x()}),Ce(async()=>{const{data:M,error:q}=await de.from("ai_characters").select("*").eq("id",a).single();q&&console.error(q),M&&_(i,M,!0)});async function x(){const{data:M,error:q}=await de.auth.getSession(),K=M;q?console.error("Error fetching session:",q):K&&_(b,K.session.user.id,!0),q&&console.error("Error fetching username:",q)}async function T(M,q){let K="";q.push({sender:"User",content:M}),d(l)?K=`You are an AI chatbot for a language learning app. 
                your name is ${d(i).name} - but you dont need to append that before your response
        Give short and simple responses and only respond in ISO CODE ${d(i).language} 
        Your job is a ${d(i).occupation} Even if the user gets something wrong, try to interperet it and don't give corrections 
        Base all your response lightly on the selected flashcard deck as the user selected the deck for you, the AI character to test me on. You dont need all words in one response. You can see which words you've used and haven't in chat history. Take it slow and but the words in at any order but they must make sense in context
        only respond in ISO ${d(i).language}
        your personality is ${d(i).trait} for character engagement reasons.
        Here is the deck content:
        ${d(l)[d(g)].content}
        Here is the user response: 
        ${M}. 
        Here is the chat history:
       ${q.map(se=>`SENT BY ${se.sender}: ${se.content}`)}`:K=`You are an AI chatbot for a language learning app. 
        your name is ${d(i).name} - but you dont need to append that before your response
        Give short and simple responses and only respond in ISO ${d(i).language} and and your personality is very exaggerated ${d(i).trait} . 
        Your job is a ${d(i).occupation} Even if the user gets something wrong, try to interperet it and don't give corrections 
        only respond in ISO ${d(i).language}
        Here is the user response: 
        ${M}. 
        Here is the chat history:
        ${q.map(se=>`SENT BY ${se.sender}: ${se.content}`)}`,console.log(K);const Z=await fetch(`https://text.pollinations.ai/prompt/${K}`);Z.ok||console.error("AI API error:",Z.statusText);const te=await Z.text();q.push({sender:"AI",content:te}),console.log("AI Response:",te)}async function O(){const M=`
    You are an AI for a language learning app. The user and AI are having a conversation in ${d(i).language}. The user's messages are marked with "User :". Your task is to return a pure JSON object as your response will be directly parsed into JSON and use no markdown annotates and the response has two fields:

    1. "analysis" — A strict critique in English aimed at helping the user improve. Also if flashcards deck is valid it means teh user wants to use or see all those deck words. So take that into your anaylisis account - pw well did they respond or did they use any flashcard words?
    2. "mistakes" — An array of objects. Each object must include:

    {
    "original_sentence": <user sentence>,
    "corrected_sentence": <correct version, even if its the same as original if no issues found>
    }

    ⚠️ Include **every single sentence** spoken by the user — even if it's 100% correct — so we can evaluate all usage. Do not skip or omit any. Assume all are full sentences. Do not return markdown, just raw JSON.

    Here is the deck content:
    ${d(l)[d(g)].content}
    Conversation:
    ${c.map(te=>`SENT BY ${te.sender}: ${te.content}`)}`,q=encodeURIComponent(M);console.log(M);const Z=await(await fetch(`https://text.pollinations.ai/prompt/${q}`)).json();_(u,Z,!0),console.log(d(u))}async function I(){if(!d(l)){const{data:M,error:q}=await de.from("flashcards").select("*").eq("author",d(b)).eq("language",d(i).language);q&&console.error("Error fetching flashcard decks:",q),_(l,M||[],!0),console.log(d(l))}}function D(){d(v).close()}async function z(M,q){let K=q;Array.isArray(q)&&(K=q.join(" "));const Z=`you are being used as an AI to give a definition of a word based of context for a language learning software the language of the word and context is ISO code ${d(i).language} and the user's native language is english the word is ${M} and the context is ${K} so give your definition in ENGLISH and as part of your just definition NOT the partOfSpeech add helpful notes such as if its plural and its singular or its case/tense and its infintive etc. but keep it simple and short return as raw json with no backtick MD markers as your respone will be directly parsed into json respond with attributes word, partOfSpeech, romanisation and definition but do NOT return romanisation where it is not necessary`,te=await fetch(`https://text.pollinations.ai/${Z}`),se=await te.json();console.log(te),_(m,se.word,!0),_(P,se.definition,!0),_(j,se.partOfSpeech,!0),_(S,se.romanisation,!0)}var H=Gd(),ie=ke(H),oe=w(ie);dt(oe,{currentPage:"/ai-chat"});var ce=y(oe,2),L=y(w(ce),2),Y=w(L);{var X=M=>{var q=zd(),K=w(q),Z=w(K),te=w(Z),se=w(te),we=y(se,2),ne=w(we),V=y(we,2),re=w(V),C=y(V,2),W=w(C),ve=y(te,2);ve.__click=[$d,O];var pe=y(Z,2);pe.__click=[Rd,v,I];var Se=y(pe,2);Me(Se,21,()=>c,Pe,(Xe,et)=>{var At=Nd(),yt=ke(At);{var pr=Pt=>{var us=qd();Me(us,21,()=>d(et).content.split(" "),Pe,(mr,fn)=>{var _r=Ld();_r.__click=[Dd,z,fn,et];var yi=w(_r);fe(()=>Q(yi,d(fn))),R(mr,_r)}),R(Pt,us)};le(yt,Pt=>{d(et).sender==="AI"&&Pt(pr)})}var gr=y(yt,2);{var _i=Pt=>{var us=Ud(),mr=w(us);fe(()=>Q(mr,d(et).content)),R(Pt,us)};le(gr,Pt=>{d(et).sender==="User"&&Pt(_i)})}R(Xe,At)}),it(Se,Xe=>_(f,Xe),()=>d(f));var Ne=y(K,2),Be=w(Ne);{var Oe=Xe=>{var et=Bd(),At=y(w(et)),yt=w(At);fe(()=>Q(yt,d(l)[d(g)].name)),R(Xe,et)};le(Be,Xe=>{(d(g)||d(g)===0)&&Xe(Oe)})}var Qe=y(Be,2),Ze=w(Qe),vr=y(Ze,2);vr.__click=[Fd,T,o,c],fe(()=>{Te(se,"src",d(i).image),Te(se,"alt",`Image of charater ${d(i).name}`),Q(ne,d(i).name),Q(re,d(i).occupation),Q(W,d(i).trait)}),nt(Ze,()=>d(o),Xe=>_(o,Xe)),R(M,q)};le(Y,M=>{d(u)||M(X)})}var J=y(Y,2);mi(J,{get word(){return d(m)},get definition(){return d(P)},get partOfSpeech(){return d(j)},get romanisation(){return d(S)},get language(){return d(i).language}});var he=y(J,2);{var E=M=>{var q=Wd(),K=ke(q),Z=w(K),te=y(Z,2),se=w(te),we=y(K,2),ne=w(we),V=y(w(ne),2),re=w(V),C=y(ne,2);Me(C,17,()=>d(u).mistakes,Pe,(W,ve)=>{var pe=Vd(),Se=ke(pe),Ne=y(w(Se),2),Be=w(Ne),Oe=y(Se,2),Qe=y(w(Oe),2),Ze=w(Qe);fe(()=>{Q(Be,d(ve).original_sentence),Q(Ze,d(ve).corrected_sentence)}),R(W,pe)}),fe(()=>{Te(Z,"src",d(i).image),Te(Z,"alt",d(i).name),Q(se,d(i).name),Q(re,d(u).analysis)}),R(M,q)};le(he,M=>{d(u)&&M(E)})}var p=y(ie,2),$=w(p),U=y(w($),2),F=w(U);Me(F,21,()=>d(l),Pe,(M,q,K)=>{var Z=Hd();Z.value=Z.__value=K;var te=w(Z);fe(()=>Q(te,d(q).name)),R(M,Z)});var G=y(F,2),ee=y(w(G),2);ee.__click=[Jd,v],it(p,M=>_(v,M),()=>d(v)),Ue("submit",U,M=>{M.preventDefault(),D()}),Ge(F,()=>d(g),M=>_(g,M)),R(s,H),xe(),r()}os(["click"]);var Yd=rn(N('<script src="https://www.youtube.com/iframe_api" class="svelte-14syiml"><\/script><!>',1)),Qd=(s,e)=>d(e).scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),Zd=(s,e)=>d(e).scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),Xd=(s,e)=>d(e).scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),eh=(s,e)=>d(e).scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),th=N(`<main class="svelte-14syiml"><section class="page-1 page svelte-14syiml"><div class="media-scroller svelte-14syiml"><div class="media-list svelte-14syiml"><span class="media-box music-media-box svelte-14syiml"><span class="emoji music-emoji svelte-14syiml">🎧</span> Music</span> <span class="media-box videos-media-box svelte-14syiml"><span class="emoji videos-emoji svelte-14syiml">📹</span> Videos</span> <span class="media-box flashcards-media-box svelte-14syiml"><span class="emoji flashcards-emoji svelte-14syiml">🗃️</span> Flashcards</span> <span class="media-box ai-chats-media-box svelte-14syiml"><span class="emoji ai-chats-emoji svelte-14syiml">💬</span> AI Chats</span> <span class="media-box music-media-box svelte-14syiml"><span class="emoji music-emoji svelte-14syiml">🎧</span> Music</span> <span class="media-box videos-media-box svelte-14syiml"><span class="emoji videos-emoji svelte-14syiml">📹</span> Videos</span> <span class="media-box flashcards-media-box svelte-14syiml"><span class="emoji flashcards-emoji svelte-14syiml">🗃️</span> Flashcards</span> <span class="media-box ai-chats-media-box svelte-14syiml"><span class="emoji ai-chats-emoji svelte-14syiml">💬</span> AI Chats</span></div></div> <section class="hero-1 svelte-14syiml"><h1 class="welcome svelte-14syiml">Welcome to Loquelis!!!</h1> <p class="welcome-message svelte-14syiml">🤗 Happy to see you!</p></section> <button class="get-started-btn svelte-14syiml"><a href="./#/app/signup/" class="svelte-14syiml">Let's get started! →</a></button></section> <section class="page-2 page svelte-14syiml"><h1 class="svelte-14syiml">Let's get started with a language-learning favourite - Peppa Pig! 🐷</h1> <span class="video-info-box info-box svelte-14syiml"><p class="icon svelte-14syiml">💡</p>Click on a word for a definition based off context, part of speech and romanisation.</span> <span class="video-info-box info-box svelte-14syiml"><p class="icon svelte-14syiml">📍</p>Play the video and watch the live subtitles flow through!</span> <section class="video-container svelte-14syiml"><iframe id="player" frameborder="0" allowfullscreen="" class="svelte-14syiml"></iframe> <!></section></section> <hr class="svelte-14syiml"/> <section class="page-3 page svelte-14syiml"><h2 class="svelte-14syiml">Learn with user curated/ custom:</h2> <div class="media-container svelte-14syiml"><span class="media-box music-media-box svelte-14syiml"><span class="emoji music-emoji svelte-14syiml">🎧</span> Music</span> <span class="media-box videos-media-box svelte-14syiml"><span class="emoji videos-emoji svelte-14syiml">📹</span> Videos</span> <span class="media-box flashcards-media-box svelte-14syiml"><span class="emoji flashcards-emoji svelte-14syiml">🗃️</span> Flashcards</span> <span class="media-box ai-chats-media-box svelte-14syiml"><span class="emoji ai-chats-emoji svelte-14syiml">💬</span> AI Chats</span></div></section> <hr class="svelte-14syiml"/> <section class="page-4 page svelte-14syiml"><h1 class="media-header svelte-14syiml">🎧 Music</h1> <p class="media-p svelte-14syiml">Learn through user curated music options and immerse yourself in the culture of the region of your chosen language</p> <div class="media-image-container svelte-14syiml"><img src="https://upload.wikimedia.org/wikipedia/en/b/bc/Molchat_Doma_-_Etazhi.png" alt="Molchat Doma music" class="media-img svelte-14syiml"/> <img src="https://upload.wikimedia.org/wikipedia/en/4/40/99_Luftballons_single_cover.jpg" alt="99 Luftballons Music" class="media-img svelte-14syiml"/> <img src="https://upload.wikimedia.org/wikipedia/en/f/fa/RammsteinRadioSingleCover.jpg" alt="Rammstein Music" class="media-img svelte-14syiml"/> <img src="https://upload.wikimedia.org/wikipedia/en/2/20/Fortuna_Wheel.jpg" alt="Rammstein Music" class="media-img svelte-14syiml"/></div> <hr class="svelte-14syiml"/> <h1 class="media-header svelte-14syiml">📹 Video</h1> <p class="media-p svelte-14syiml">Learn through user curated video options and finally switch from textbooks to shows, documentaries, news and YouTubers</p> <div class="media-image-container svelte-14syiml"><img src="https://i.ytimg.com/vi/WYqIlqp2_9c/sddefault.jpg" alt="coca cola documentary in german" class="vid-media-img media-img svelte-14syiml"/> <img src="https://i.ytimg.com/vi/_fPXQnfCWqI/sddefault.jpg" class="vid-media-img media-img svelte-14syiml" alt="french news"/> <img src="https://i.ytimg.com/vi/ZzfeHWgEVDs/sddefault.jpg" alt="vlog video" class="vid-media-img media-img svelte-14syiml"/></div> <hr class="svelte-14syiml"/> <h1 class="media-header svelte-14syiml">🗃️ Flashcards</h1> <p class="media-p svelte-14syiml">Create your own decks from words saved from songs, videos and AI Chats</p> <div class="media-image-container svelte-14syiml"><img src="https://raw.githubusercontent.com/Ewan-Dev/ewan.is-a.dev/refs/heads/main/frontend/static/food-deck.png" class="deck-media-img media-img svelte-14syiml" alt="deck"/> <img src="https://raw.githubusercontent.com/Ewan-Dev/ewan.is-a.dev/refs/heads/main/frontend/static/animals-deck.png" alt="deck" class="deck-media-img media-img svelte-14syiml"/> <img src="https://raw.githubusercontent.com/Ewan-Dev/ewan.is-a.dev/refs/heads/main/frontend/static/flashcards.png" alt="flashcards" class="deck-media-img media-img svelte-14syiml"/></div> <hr class="svelte-14syiml"/> <h1 class="media-header svelte-14syiml">💬 AI Chat</h1> <p class="media-p svelte-14syiml">Create your own AI character to practise your language skills and decks with.</p> <div class="media-image-container svelte-14syiml"><img src="https://raw.githubusercontent.com/Ewan-Dev/ewan.is-a.dev/refs/heads/main/frontend/static/ai-chat.png" alt="ai chat" class="ai-chat-img media-img svelte-14syiml"/></div></section> <hr class="svelte-14syiml"/> <section class="page-5 page svelte-14syiml"><h1 class="svelte-14syiml">Start your journey. <p class="blue svelte-14syiml">Today.</p></h1> <div class="sign-up-contact-container svelte-14syiml"><button class="big-get-started-btn svelte-14syiml"><a href="./#/app/signup/" class="svelte-14syiml">Get started! →</a></button> <button class="big-contact-btn svelte-14syiml"><span class="material-symbols-rounded svelte-14syiml">login</span><a href="./#/app/login/" class="contact-p svelte-14syiml">Sign in</a></button></div></section></main>`);function sh(s,e){Ee(e,!0);const[t,r]=Ms(),n=()=>Ps(Rs,"$location",t),i={events:[{tStartMs:10791,dDurationMs:1508,segs:[{utf8:"Herr Vogelscheuche"}]},{tStartMs:15535,dDurationMs:4067,segs:[{utf8:"Peppa und Schorsch sind heute zu Besuch bei Oma und Opa Wutz."}]},{tStartMs:23350,dDurationMs:1641,segs:[{utf8:"Hallo Opa Wutz."}]},{tStartMs:25960,dDurationMs:3547,segs:[{utf8:"Huhu Hallo Peppa Hallo Schorsch."}]},{tStartMs:29571,dDurationMs:2317,segs:[{utf8:"Opa was machst du denn da?"}]},{tStartMs:31897,dDurationMs:2158,segs:[{utf8:"Ich pflanze einen Blumengarten."}]},{tStartMs:34072,dDurationMs:1579,segs:[{utf8:"Oh!"}]},{tStartMs:35675,dDurationMs:3720,segs:[{utf8:"Aus diesen Samen wachsen wunderschöne Blumen."}]},{tStartMs:40090,dDurationMs:3153,segs:[{utf8:"Ich streue die Samenkörner auf den Boden."}]},{tStartMs:44163,dDurationMs:2722,segs:[{utf8:"Dann decke ich sie mit Erde zu."}]},{tStartMs:47211,dDurationMs:1841,segs:[{utf8:"Oh wo sind sie denn?"}]},{tStartMs:49110,dDurationMs:1865,segs:[{utf8:"Die Samenkörner sind verschwunden."}]},{tStartMs:50999,dDurationMs:4049,segs:[{utf8:`Wie merkwürdig! 
Ich bin sicher dass ich hier Samen verstaut hatte.`}]},{tStartMs:55076,dDurationMs:2456,segs:[{utf8:`Ja Opa.
Wir haben es gesehen.`}]},{tStartMs:57932,dDurationMs:1598,segs:[{utf8:`Ja!
Jetzt sind sie weg.`}]},{tStartMs:60167,dDurationMs:3047,segs:[{utf8:"Na gut dann muss ich eben noch welche nehmen."}]},{tStartMs:63522,dDurationMs:4459,segs:[{utf8:"Wie schon sagte, ich treue die Samenkörner einfach auf den Boden."}]},{tStartMs:70334,dDurationMs:3534,segs:[{utf8:"Ein kleiner Vogel pickt die Samenkörner von Opa Wutz auf."}]},{tStartMs:73960,dDurationMs:765,segs:[{utf8:"Heyy!"}]},{tStartMs:74776,dDurationMs:1962,segs:[{utf8:"Lass meine Samenkörner!"}]},{tStartMs:77137,dDurationMs:2561,segs:[{utf8:"Also da sind meine ganzen Samen hin."}]},{tStartMs:79709,dDurationMs:3240,segs:[{utf8:"Im Bauch von dem kleinen Vogel."}]},{tStartMs:83320,dDurationMs:3741,segs:[{utf8:"Und noch zwei kleine Vögel picken Opa wird Samenkörner auf."}]},{tStartMs:87180,dDurationMs:1319,segs:[{utf8:"Oh Guck!"}]},{tStartMs:88507,dDurationMs:1987,segs:[{utf8:"Ah! Weg da Weg da!"}]},{tStartMs:91405,dDurationMs:1666,segs:[{utf8:"Was ist das für ein Lärm."}]},{tStartMs:93256,dDurationMs:3800,segs:[{utf8:`Oma Wutz!
Die Vögel picken meine ganzen Blumensamen weg.`}]},{tStartMs:97138,dDurationMs:2397,segs:[{utf8:"Und jetzt werden die Vögel weg."}]},{tStartMs:99765,dDurationMs:3239,segs:[{utf8:"Wegjagen hat keinen Zweck! Sie kommen einfach wieder."}]},{tStartMs:103020,dDurationMs:959,segs:[{utf8:"Guck!"}]},{tStartMs:104823,dDurationMs:2133,segs:[{utf8:"Wir brauchen eine Vogelscheuche."}]},{tStartMs:106990,dDurationMs:1964,segs:[{utf8:"Was ist eine Vogelscheuche?"}]},{tStartMs:109017,dDurationMs:3719,segs:[{utf8:"Eine Vogelscheuche ist ein Mann aus Stroh der den Vögeln Angst macht."}]},{tStartMs:112761,dDurationMs:2916,segs:[{utf8:"Das ist eine gute Idee Oma Wutz."}]},{tStartMs:115697,dDurationMs:1305,segs:[{utf8:"Ich baue eine."}]},{tStartMs:117038,dDurationMs:1663,segs:[{utf8:"Kommt alle mit."}]},{tStartMs:119901,dDurationMs:6213,segs:[{utf8:"Wiedersehen kleine Vögel. Wir bauen eine Vogelscheuche."}]},{tStartMs:126387,dDurationMs:2133,segs:[{utf8:"Das ist Opa Wutz Gartenschuppen."}]},{tStartMs:128928,dDurationMs:4022,segs:[{utf8:"Hier drin gibt es eine Menge Sachen um eine Vogelscheuche zu bauen."}]},{tStartMs:133306,dDurationMs:3583,segs:[{utf8:"Zuerst brauchen wir zwei Stöcke und etwas Kordel."}]},{tStartMs:136913,dDurationMs:2023,segs:[{utf8:"Das besorgen wir."}]},{tStartMs:140720,dDurationMs:4139,segs:[{utf8:"Peppa hat zwei Stücke gefunden Schorsch hat etwas Kordel gefunden."}]},{tStartMs:144900,dDurationMs:1090,segs:[{utf8:"Gut!"}]},{tStartMs:146042,dDurationMs:3400,segs:[{utf8:"Ich binde die Stöcke zusammen. Das wird der Körper."}]},{tStartMs:149529,dDurationMs:3666,segs:[{utf8:"Oma Wutz hat etwas Stroh gefunden und einen alten Sack."}]},{tStartMs:153237,dDurationMs:5544,segs:[{utf8:`Großartig!
Ich stecke das Stroh in den Sack. Das wird der Kopf.`}]},{tStartMs:158817,dDurationMs:3276,segs:[{utf8:"Jetzt braucht die Vogelscheuche was zum anziehen."}]},{tStartMs:162146,dDurationMs:2129,segs:[{utf8:"Hier ist eine Tasche mit alten Kleidern."}]},{tStartMs:164334,dDurationMs:5122,segs:[{utf8:`Oh!
Schorsch hat ein Kleid gefunden.`}]},{tStartMs:170717,dDurationMs:6222,segs:[{utf8:`Dumber Schorsch!
Herr Vogelscheuche hat doch kein Kleid an.`}]},{tStartMs:177184,dDurationMs:2503,segs:[{utf8:"Peppa hat einen Mantel gefunden."}]},{tStartMs:179918,dDurationMs:1875,segs:[{utf8:"Sehr gut Peppa!"}]},{tStartMs:183037,dDurationMs:1961,segs:[{utf8:"Schorsch hat einen Hut gefunden."}]},{tStartMs:185023,dDurationMs:1709,segs:[{utf8:"Sehr gut Schorsch."}]},{tStartMs:187126,dDurationMs:2881,segs:[{utf8:"Herr Vogelscheuche braucht ein Gesicht."}]},{tStartMs:190015,dDurationMs:1e3,segs:[{utf8:"Das Stimmt."}]},{tStartMs:191285,dDurationMs:2564,segs:[{utf8:"Willst du mit Schorch ein Gesicht für ihn malen."}]},{tStartMs:193911,dDurationMs:2596,segs:[{utf8:"Ja bitte."}]},{tStartMs:196794,dDurationMs:2467,segs:[{utf8:"Schorsch malt die Augen und die Nase."}]},{tStartMs:199643,dDurationMs:2004,segs:[{utf8:"Peppa malt den Mund."}]},{tStartMs:202331,dDurationMs:1949,segs:[{utf8:"Fantastisch!"}]},{tStartMs:204305,dDurationMs:1352,segs:[{utf8:"Herr Vogelscheuche ist fertig."}]},{tStartMs:205689,dDurationMs:1750,segs:[{utf8:"Hurraa"}]},{tStartMs:208970,dDurationMs:2877,segs:[{utf8:"Die kleinen Vögel suchen nach Opa Wutz Blumensamen."}]},{tStartMs:211985,dDurationMs:2704,segs:[{utf8:`Guck!
Die kleinen Vögel sind wieder da.`}]},{tStartMs:214706,dDurationMs:1327,segs:[{utf8:"Keine Sorge Peppa."}]},{tStartMs:216041,dDurationMs:2345,segs:[{utf8:"Die Vogelscheuche wird sie feucht."}]},{tStartMs:223868,dDurationMs:1266,segs:[{utf8:"Es funktioniert!"}]},{tStartMs:225194,dDurationMs:2491,segs:[{utf8:"Die Vogelscheuche hat die Vögel verscheucht."}]},{tStartMs:227757,dDurationMs:1528,segs:[{utf8:"Hurra!"}]},{tStartMs:229296,dDurationMs:726,segs:[{utf8:" Gut!"}]},{tStartMs:230099,dDurationMs:3049,segs:[{utf8:"Jetzt werden meine Blumensamen nicht mehr gefressen."}]},{tStartMs:234964,dDurationMs:4325,segs:[{utf8:"Oh Opa die kleinen Vögel sehen sehr traurig aus."}]},{tStartMs:239329,dDurationMs:2435,segs:[{utf8:"Ja sie haben sicher Hunger."}]},{tStartMs:241820,dDurationMs:1730,segs:[{utf8:"Dafür habe ich das hier."}]},{tStartMs:243594,dDurationMs:1951,segs:[{utf8:"Das ist das Oma?"}]},{tStartMs:245561,dDurationMs:1721,segs:[{utf8:"Eine Futterstation."}]},{tStartMs:247307,dDurationMs:5499,segs:[{utf8:"Opa gibst du mir bitte etwas von den Samen."}]},{tStartMs:254689,dDurationMs:3828,segs:[{utf8:"Kommt ihr Vögelchen. Essen Zeit."}]},{tStartMs:259175,dDurationMs:2599,segs:[{utf8:"Jetzt haben die Vögel ihre eigenen Samen."}]},{tStartMs:262604,dDurationMs:2274,segs:[{utf8:"Die kleinen Vögel sind wieder glücklich."}]},{tStartMs:264903,dDurationMs:3639,segs:[{utf8:"Peppa ist froh dass Opas Blumensamen nicht gefressen werden."}]},{tStartMs:268644,dDurationMs:8125,segs:[{utf8:"Aber noch vor ist sie dass die kleinen Vögel auch etwas zu fressen haben."}]}]}.events;console.log(i);let o=A(void 0),l=A(void 0),c=A(void 0),u=A(void 0);B([]);let h,f=A("Peppa Wutz");Ce(()=>{n().split("/").pop()==="welcome"&&(v(),window.YT?g():window.onYouTubeIframeAPIReady=g)});function v(){cs({particleCount:1e3,spread:150,origin:{y:0}})}function g(){h=new YT.Player("player",{events:{onReady:()=>{setInterval(()=>{const L=h.getCurrentTime(),Y=Math.round(L*1e3);k(Y)},1)}}})}function k(L){let Y=0;i.forEach(X=>{L>X.tStartMs&&L<i[Y+1].tStartMs&&X.segs.forEach(J=>{d(f)!==J.utf8&&(_(f,J.utf8,!0),console.log(J.utf8))}),Y++})}var m=th();sn(L=>{var Y=Yd();y(ke(Y)),R(L,Y)});var P=y(w(m),2),j=y(w(P),6),S=w(j);Te(S,"src","https://www.youtube.com/embed/Q_sqR4aLLu0?enablejsapi=1"),Te(S,"title","peppapig");var b=y(S,2);dn(b,{get currentLine(){return d(f)},targetLanguage:"de"});var x=y(P,4),T=y(w(x),2),O=w(T);O.__click=[Qd,o];var I=y(O,2);I.__click=[Zd,l];var D=y(I,2);D.__click=[Xd,c];var z=y(D,2);z.__click=[eh,u];var H=y(x,4),ie=y(w(H),6);it(ie,L=>_(l,L),()=>d(l));var oe=y(ie,8);it(oe,L=>_(c,L),()=>d(c));var ce=y(oe,10);it(ce,L=>_(u,L),()=>d(u)),it(H,L=>_(o,L),()=>d(o)),R(s,m),xe(),r()}os(["click"]);var rh=N('<head><link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:wght@400" rel="stylesheet"/></head> <main class="svelte-1gyy4yy"><dialog class="svelte-1gyy4yy"><form class="svelte-1gyy4yy"><label class="username-header svelte-1gyy4yy">👤 Set a username:</label> <span class="input-container svelte-1gyy4yy"><p class="at-symbol svelte-1gyy4yy">@</p><input placeholder="username" class="username-input svelte-1gyy4yy"/></span> <input type="Submit" class="svelte-1gyy4yy"/> <!></form></dialog> <!></main>',1);function nh(s,e){Ee(e,!0);const t={"/":na,"/welcome":sh,"/app/ai-chat/:slug":Kd,"/app/ai-chat":Id,"/app/videos/:slug":kd,"/app/videos":_d,"/app/flashcards/:slug":fd,"/app/flashcards":Zu,"/app/upload":Hu,"/app/music/:slug":Fu,"/app/music":ju,"/app/login":na,"/app/login/:slug":wu,"/app/signup":pu,"/app/home":uu};let r=A(""),n=A(!1),a=A(""),i="",o=A(B(i.statusMessage)),l=A(B(i.statusType)),c=A(""),u;He(async()=>{await h()}),Ce(()=>{d(n)&&u.showModal()});async function h(){const{data:T,error:O}=await de.auth.getSession(),I=T;if(O)console.error("Error fetching session:",O);else if(I){_(c,I.session.user.id,!0);const{data:D,error:z}=await de.from("profiles").select("username").eq("user_id",d(c)).single();D&&(console.log(D),_(r,D.username,!0),console.log("User: ",d(r)),d(r)||_(n,!0))}}async function f(T){if(T){const{error:O}=await de.from("profiles").update({username:T}).eq("user_id",d(c));O?(console.error(O.message),_(o,""),_(l,""),O.message.includes("duplicate")&&O.message.includes("username")?(_(o,""),_(l,""),_(o,"Account with username already exists"),_(l,"error")):(_(o,""),_(l,""),_(o,O.message,!0),_(l,"error")),O.message==='Column "username" cannot be modified once set'&&(_(o,""),_(l,""),_(o,"Username already set!"),_(l,"warn"))):(_(o,""),_(l,""),_(o,"success"),_(l,"success"))}else _(o,""),_(l,""),_(o,"No username typed"),_(l,"warn")}var v=rh(),g=y(ke(v),2),k=w(g),m=w(k),P=y(w(m),2),j=y(w(P)),S=y(P,4);{var b=T=>{mt(T,{get message(){return d(o)},get type(){return d(l)}})};le(S,T=>{d(o)&&T(b)})}it(k,T=>u=T,()=>u);var x=y(k,2);qu(x,{get routes(){return t}}),Ue("submit",m,T=>{T.preventDefault(),f(d(a))}),nt(j,()=>d(a),T=>_(a,T)),R(s,v),xe()}To(nh,{target:document.getElementById("app")})});export default ah();
