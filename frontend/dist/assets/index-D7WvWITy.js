var ho=Object.defineProperty;var Qn=s=>{throw TypeError(s)};var fo=(s,e,t)=>e in s?ho(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var vo=(s,e)=>()=>(e||s((e={exports:{}}).exports,e),e.exports);var qs=(s,e,t)=>fo(s,typeof e!="symbol"?e+"":e,t),Kr=(s,e,t)=>e.has(s)||Qn("Cannot "+t);var ye=(s,e,t)=>(Kr(s,e,"read from private field"),t?t.call(s):e.get(s)),Qe=(s,e,t)=>e.has(s)?Qn("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(s):e.set(s,t),it=(s,e,t,r)=>(Kr(s,e,"write to private field"),r?r.call(s,t):e.set(s,t),t),Vt=(s,e,t)=>(Kr(s,e,"access private method"),t);var pf=vo((Sf,pr)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function t(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(n){if(n.ep)return;n.ep=!0;const a=t(n);fetch(n.href,a)}})();const Ha=!1;var Ms=Array.isArray,po=Array.prototype.indexOf,Tn=Array.from,Tr=Object.defineProperty,qt=Object.getOwnPropertyDescriptor,Ja=Object.getOwnPropertyDescriptors,go=Object.prototype,_o=Array.prototype,jn=Object.getPrototypeOf,Zn=Object.isExtensible;function ys(s){return typeof s=="function"}const rt=()=>{};function mo(s){return s()}function Ys(s){for(var e=0;e<s.length;e++)s[e]()}function yo(){var s,e,t=new Promise((r,n)=>{s=r,e=n});return{promise:t,resolve:s,reject:e}}function wo(s,e){if(Array.isArray(s))return s;if(!(Symbol.iterator in s))return Array.from(s);const t=[];for(const r of s)if(t.push(r),t.length===e)break;return t}const nt=2,On=4,Dr=8,ts=16,Pt=32,ss=64,Ga=128,lt=256,jr=512,Ve=1024,ct=2048,Mt=4096,ft=8192,rs=16384,Lr=32768,or=65536,Xn=1<<17,Ka=1<<18,lr=1<<19,Ya=1<<20,ln=1<<21,An=1<<22,Qt=1<<23,mt=Symbol("$state"),Qa=Symbol("legacy props"),bo=Symbol(""),Pn=new class extends Error{constructor(){super(...arguments);qs(this,"name","StaleReactionError");qs(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}},ko=11;function So(){throw new Error("https://svelte.dev/e/await_outside_boundary")}function Ur(s){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Eo(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function xo(s){throw new Error("https://svelte.dev/e/effect_in_teardown")}function To(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function jo(s){throw new Error("https://svelte.dev/e/effect_orphan")}function Oo(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Ao(s){throw new Error("https://svelte.dev/e/lifecycle_legacy_only")}function Po(s){throw new Error("https://svelte.dev/e/props_invalid_value")}function Mo(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Co(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Io(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}const zr=1,qr=2,Za=4,$o=8,Ro=16,Do=1,Lo=2,Uo=4,zo=8,qo=16,No=4,Bo=1,Fo=2,We=Symbol(),Wo="http://www.w3.org/1999/xhtml";function Vo(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}let Ho=!1;function Xa(s){return s===this.v}function ei(s,e){return s!=s?e==e:s!==e||s!==null&&typeof s=="object"||typeof s=="function"}function ti(s){return!ei(s,this.v)}let Cs=!1,Jo=!1;function Go(){Cs=!0}let xe=null;function Or(s){xe=s}function Ce(s,e=!1,t){xe={p:xe,c:null,e:null,s,x:null,l:Cs&&!e?{s:null,u:null,$:[]}:null}}function Ie(s){var e=xe,t=e.e;if(t!==null){e.e=null;for(var r of t)gi(r)}return xe=e.p,{}}function cr(){return!Cs||xe!==null&&xe.l===null}const Ko=new WeakMap;function Yo(s){var e=ve;if(e===null)return ge.f|=Qt,s;if((e.f&Lr)===0){if((e.f&Ga)===0)throw!e.parent&&s instanceof Error&&si(s),s;e.b.error(s)}else Mn(s,e)}function Mn(s,e){for(;e!==null;){if((e.f&Ga)!==0)try{e.b.error(s);return}catch(t){s=t}e=e.parent}throw s instanceof Error&&si(s),s}function si(s){const e=Ko.get(s);e&&(Tr(s,"message",{value:e.message}),Tr(s,"stack",{value:e.stack}))}let Ut=[],Ar=[];function ri(){var s=Ut;Ut=[],Ys(s)}function Qo(){var s=Ar;Ar=[],Ys(s)}function Zo(){return Ut.length>0||Ar.length>0}function ur(s){if(Ut.length===0&&!Vs){var e=Ut;queueMicrotask(()=>{e===Ut&&ri()})}Ut.push(s)}function Xo(){Ut.length>0&&ri(),Ar.length>0&&Qo()}function el(){const s=ve.b;return s===null&&So(),s}function dr(s){var e=nt|ct,t=ge!==null&&(ge.f&nt)!==0?ge:null;return ve===null||t!==null&&(t.f&lt)!==0?e|=lt:ve.f|=lr,{ctx:xe,deps:null,effects:null,equals:Xa,f:e,fn:s,reactions:null,rv:0,v:We,wv:0,parent:t??ve,ac:null}}function tl(s,e){let t=ve;t===null&&Eo();var r=t.b,n=void 0,a=Zs(We),i=null,o=!ge;return gl(()=>{try{var l=s();i&&Promise.resolve(l).catch(()=>{})}catch(p){l=Promise.reject(p)}var u=()=>l;n=(i==null?void 0:i.then(u,u))??Promise.resolve(l),i=n;var d=Se,h=r.is_pending();o&&(r.update_pending_count(1),h||d.increment());const f=(p,v=void 0)=>{i=null,h||d.activate(),v?v!==Pn&&(a.f|=Qt,Xs(a,v)):((a.f&Qt)!==0&&(a.f^=Qt),Xs(a,p)),o&&(r.update_pending_count(-1),h||d.decrement()),ii()};if(n.then(f,p=>f(null,p||"unknown")),d)return()=>{queueMicrotask(()=>d.neuter())}}),new Promise(l=>{function u(d){function h(){d===n?l(a):u(n)}d.then(h,h)}u(n)})}function js(s){const e=dr(s);return ki(e),e}function Cn(s){const e=dr(s);return e.equals=ti,e}function ni(s){var e=s.effects;if(e!==null){s.effects=null;for(var t=0;t<e.length;t+=1)Ot(e[t])}}function sl(s){for(var e=s.parent;e!==null;){if((e.f&nt)===0)return e;e=e.parent}return null}function In(s){var e,t=ve;Bt(sl(s));try{ni(s),e=Ti(s)}finally{Bt(t)}return e}function ai(s){var e=In(s);if(s.equals(e)||(s.v=e,s.wv=Ei()),!as){var t=(zt||(s.f&lt)!==0)&&s.deps!==null?Mt:Ve;Ye(s,t)}}function rl(s,e,t){const r=cr()?dr:Cn;if(e.length===0){t(s.map(r));return}var n=Se,a=ve,i=nl(),o=el();Promise.all(e.map(l=>tl(l))).then(l=>{n==null||n.activate(),i();try{t([...s.map(r),...l])}catch(u){(a.f&rs)===0&&Mn(u,a)}n==null||n.deactivate(),ii()}).catch(l=>{o.error(l)})}function nl(){var s=ve,e=ge,t=xe,r=Se;return function(){Bt(s),yt(e),Or(t),r==null||r.activate()}}function ii(){Bt(null),yt(null),Or(null)}const Yr=new Set;let Se=null,Er=null,ea=new Set,es=[],Nr=null,cn=!1,Vs=!1;var sr,Es,Dt,rr,nr,Kt,xs,Yt,Lt,Ts,ar,ir,vt,oi,xr,un;const Rr=class Rr{constructor(){Qe(this,vt);qs(this,"current",new Map);Qe(this,sr,new Map);Qe(this,Es,new Set);Qe(this,Dt,0);Qe(this,rr,null);Qe(this,nr,!1);Qe(this,Kt,[]);Qe(this,xs,[]);Qe(this,Yt,[]);Qe(this,Lt,[]);Qe(this,Ts,[]);Qe(this,ar,[]);Qe(this,ir,[]);qs(this,"skipped_effects",new Set)}process(e){var n;es=[],Er=null;for(const a of e)Vt(this,vt,oi).call(this,a);if(ye(this,Kt).length===0&&ye(this,Dt)===0){Vt(this,vt,un).call(this);var t=ye(this,Yt),r=ye(this,Lt);it(this,Yt,[]),it(this,Lt,[]),it(this,Ts,[]),Er=Se,Se=null,ta(t),ta(r),Se===null?Se=this:Yr.delete(this),(n=ye(this,rr))==null||n.resolve()}else Vt(this,vt,xr).call(this,ye(this,Yt)),Vt(this,vt,xr).call(this,ye(this,Lt)),Vt(this,vt,xr).call(this,ye(this,Ts));for(const a of ye(this,Kt))Xt(a);for(const a of ye(this,xs))Xt(a);it(this,Kt,[]),it(this,xs,[])}capture(e,t){ye(this,sr).has(e)||ye(this,sr).set(e,t),this.current.set(e,e.v)}activate(){Se=this}deactivate(){Se=null,Er=null;for(const e of ea)if(ea.delete(e),e(),Se!==null)break}neuter(){it(this,nr,!0)}flush(){es.length>0?li():Vt(this,vt,un).call(this),Se===this&&(ye(this,Dt)===0&&Yr.delete(this),this.deactivate())}increment(){it(this,Dt,ye(this,Dt)+1)}decrement(){if(it(this,Dt,ye(this,Dt)-1),ye(this,Dt)===0){for(const e of ye(this,ar))Ye(e,ct),Os(e);for(const e of ye(this,ir))Ye(e,Mt),Os(e);it(this,Yt,[]),it(this,Lt,[]),this.flush()}else this.deactivate()}add_callback(e){ye(this,Es).add(e)}settled(){return(ye(this,rr)??it(this,rr,yo())).promise}static ensure(){if(Se===null){const e=Se=new Rr;Yr.add(Se),Vs||Rr.enqueue(()=>{Se===e&&e.flush()})}return Se}static enqueue(e){ur(e)}};sr=new WeakMap,Es=new WeakMap,Dt=new WeakMap,rr=new WeakMap,nr=new WeakMap,Kt=new WeakMap,xs=new WeakMap,Yt=new WeakMap,Lt=new WeakMap,Ts=new WeakMap,ar=new WeakMap,ir=new WeakMap,vt=new WeakSet,oi=function(e){var d;e.f^=Ve;for(var t=e.first;t!==null;){var r=t.f,n=(r&(Pt|ss))!==0,a=n&&(r&Ve)!==0,i=a||(r&ft)!==0||this.skipped_effects.has(t);if(!i&&t.fn!==null){if(n)t.f^=Ve;else if((r&On)!==0)ye(this,Lt).push(t);else if((r&Ve)===0)if((r&An)!==0){var o=(d=t.b)!=null&&d.is_pending()?ye(this,xs):ye(this,Kt);o.push(t)}else hr(t)&&((t.f&ts)!==0&&ye(this,Ts).push(t),Xt(t));var l=t.first;if(l!==null){t=l;continue}}var u=t.parent;for(t=t.next;t===null&&u!==null;)t=u.next,u=u.parent}},xr=function(e){for(const t of e)((t.f&ct)!==0?ye(this,ar):ye(this,ir)).push(t),Ye(t,Ve);e.length=0},un=function(){if(!ye(this,nr))for(const e of ye(this,Es))e();ye(this,Es).clear()};let Qs=Rr;function al(s){var e=Vs;Vs=!0;try{for(var t;;){if(Xo(),es.length===0&&!Zo()&&(Se==null||Se.flush(),es.length===0))return Nr=null,t;li()}}finally{Vs=e}}function li(){var s=ks;cn=!0;try{var e=0;for(aa(!0);es.length>0;){var t=Qs.ensure();if(e++>1e3){var r,n;il()}t.process(es),Nt.clear()}}finally{cn=!1,aa(s),Nr=null}}function il(){try{Oo()}catch(s){Mn(s,Nr)}}let Et=null;function ta(s){var e=s.length;if(e!==0){for(var t=0;t<e;){var r=s[t++];if((r.f&(rs|ft))===0&&hr(r)&&(Et=[],Xt(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null&&r.ac===null?yi(r):r.fn=null),(Et==null?void 0:Et.length)>0)){Nt.clear();for(const n of Et)Xt(n);Et=[]}}Et=null}}function Os(s){for(var e=Nr=s;e.parent!==null;){e=e.parent;var t=e.f;if(cn&&e===ve&&(t&ts)!==0)return;if((t&(ss|Pt))!==0){if((t&Ve)===0)return;e.f^=Ve}}es.push(e)}const Nt=new Map;function Zs(s,e){var t={f:0,v:s,reactions:null,equals:Xa,rv:0,wv:0};return t}function j(s,e){const t=Zs(s);return ki(t),t}function bs(s,e=!1,t=!0){var n;const r=Zs(s);return e||(r.equals=ti),Cs&&t&&xe!==null&&xe.l!==null&&((n=xe.l).s??(n.s=[])).push(r),r}function m(s,e,t=!1){ge!==null&&(!_t||(ge.f&Xn)!==0)&&cr()&&(ge.f&(nt|ts|An|Xn))!==0&&!(Ke!=null&&Ke.includes(s))&&Io();let r=t?H(e):e;return Xs(s,r)}function Xs(s,e){if(!s.equals(e)){var t=s.v;as?Nt.set(s,e):Nt.set(s,t),s.v=e;var r=Qs.ensure();r.capture(s,t),(s.f&nt)!==0&&((s.f&ct)!==0&&In(s),Ye(s,(s.f&lt)===0?Ve:Mt)),s.wv=Ei(),ui(s,ct),cr()&&ve!==null&&(ve.f&Ve)!==0&&(ve.f&(Pt|ss))===0&&(ot===null?yl([s]):ot.push(s))}return e}function ci(s,e=1){var t=c(s),r=e===1?t++:t--;return m(s,t),r}function Qr(s){m(s,s.v+1)}function ui(s,e){var t=s.reactions;if(t!==null)for(var r=cr(),n=t.length,a=0;a<n;a++){var i=t[a],o=i.f;if(!(!r&&i===ve)){var l=(o&ct)===0;l&&Ye(i,e),(o&nt)!==0?ui(i,Mt):l&&((o&ts)!==0&&Et!==null&&Et.push(i),Os(i))}}}function H(s){if(typeof s!="object"||s===null||mt in s)return s;const e=jn(s);if(e!==go&&e!==_o)return s;var t=new Map,r=Ms(s),n=j(0),a=Zt,i=o=>{if(Zt===a)return o();var l=ge,u=Zt;yt(null),oa(a);var d=o();return yt(l),oa(u),d};return r&&t.set("length",j(s.length)),new Proxy(s,{defineProperty(o,l,u){(!("value"in u)||u.configurable===!1||u.enumerable===!1||u.writable===!1)&&Mo();var d=t.get(l);return d===void 0?d=i(()=>{var h=j(u.value);return t.set(l,h),h}):m(d,u.value,!0),!0},deleteProperty(o,l){var u=t.get(l);if(u===void 0){if(l in o){const d=i(()=>j(We));t.set(l,d),Qr(n)}}else m(u,We),Qr(n);return!0},get(o,l,u){var p;if(l===mt)return s;var d=t.get(l),h=l in o;if(d===void 0&&(!h||(p=qt(o,l))!=null&&p.writable)&&(d=i(()=>{var v=H(h?o[l]:We),k=j(v);return k}),t.set(l,d)),d!==void 0){var f=c(d);return f===We?void 0:f}return Reflect.get(o,l,u)},getOwnPropertyDescriptor(o,l){var u=Reflect.getOwnPropertyDescriptor(o,l);if(u&&"value"in u){var d=t.get(l);d&&(u.value=c(d))}else if(u===void 0){var h=t.get(l),f=h==null?void 0:h.v;if(h!==void 0&&f!==We)return{enumerable:!0,configurable:!0,value:f,writable:!0}}return u},has(o,l){var f;if(l===mt)return!0;var u=t.get(l),d=u!==void 0&&u.v!==We||Reflect.has(o,l);if(u!==void 0||ve!==null&&(!d||(f=qt(o,l))!=null&&f.writable)){u===void 0&&(u=i(()=>{var p=d?H(o[l]):We,v=j(p);return v}),t.set(l,u));var h=c(u);if(h===We)return!1}return d},set(o,l,u,d){var T;var h=t.get(l),f=l in o;if(r&&l==="length")for(var p=u;p<h.v;p+=1){var v=t.get(p+"");v!==void 0?m(v,We):p in o&&(v=i(()=>j(We)),t.set(p+"",v))}if(h===void 0)(!f||(T=qt(o,l))!=null&&T.writable)&&(h=i(()=>j(void 0)),m(h,H(u)),t.set(l,h));else{f=h.v!==We;var k=i(()=>H(u));m(h,k)}var _=Reflect.getOwnPropertyDescriptor(o,l);if(_!=null&&_.set&&_.set.call(d,u),!f){if(r&&typeof l=="string"){var O=t.get("length"),C=Number(l);Number.isInteger(C)&&C>=O.v&&m(O,C+1)}Qr(n)}return!0},ownKeys(o){c(n);var l=Reflect.ownKeys(o).filter(h=>{var f=t.get(h);return f===void 0||f.v!==We});for(var[u,d]of t)d.v!==We&&!(u in o)&&l.push(u);return l},setPrototypeOf(){Co()}})}function sa(s){try{if(s!==null&&typeof s=="object"&&mt in s)return s[mt]}catch{}return s}function ol(s,e){return Object.is(sa(s),sa(e))}var ra,di,hi,fi;function ll(){if(ra===void 0){ra=window,di=/Firefox/.test(navigator.userAgent);var s=Element.prototype,e=Node.prototype,t=Text.prototype;hi=qt(e,"firstChild").get,fi=qt(e,"nextSibling").get,Zn(s)&&(s.__click=void 0,s.__className=void 0,s.__attributes=null,s.__style=void 0,s.__e=void 0),Zn(t)&&(t.__t=void 0)}}function ns(s=""){return document.createTextNode(s)}function Pr(s){return hi.call(s)}function Br(s){return fi.call(s)}function w(s,e){return Pr(s)}function Oe(s,e){{var t=Pr(s);return t instanceof Comment&&t.data===""?Br(t):t}}function y(s,e=1,t=!1){let r=s;for(;e--;)r=Br(r);return r}function cl(s){s.textContent=""}function $n(){return!1}let na=!1;function ul(){na||(na=!0,document.addEventListener("reset",s=>{Promise.resolve().then(()=>{var e;if(!s.defaultPrevented)for(const t of s.target.elements)(e=t.__on_r)==null||e.call(t)})},{capture:!0}))}function Is(s){var e=ge,t=ve;yt(null),Bt(null);try{return s()}finally{yt(e),Bt(t)}}function vi(s,e,t,r=t){s.addEventListener(e,()=>Is(t));const n=s.__on_r;n?s.__on_r=()=>{n(),r(!0)}:s.__on_r=()=>r(!0),ul()}function pi(s){ve===null&&ge===null&&jo(),ge!==null&&(ge.f&lt)!==0&&ve===null&&To(),as&&xo()}function dl(s,e){var t=e.last;t===null?e.last=e.first=s:(t.next=s,s.prev=t,e.last=s)}function wt(s,e,t,r=!0){var n=ve;n!==null&&(n.f&ft)!==0&&(s|=ft);var a={ctx:xe,deps:null,nodes_start:null,nodes_end:null,f:s|ct,first:null,fn:e,last:null,next:null,parent:n,b:n&&n.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(t)try{Xt(a),a.f|=Lr}catch(l){throw Ot(a),l}else e!==null&&Os(a);if(r){var i=a;if(t&&i.deps===null&&i.teardown===null&&i.nodes_start===null&&i.first===i.last&&(i.f&lr)===0&&(i=i.first),i!==null&&(i.parent=n,n!==null&&dl(i,n),ge!==null&&(ge.f&nt)!==0&&(s&ss)===0)){var o=ge;(o.effects??(o.effects=[])).push(i)}}return a}function Rn(s){const e=wt(Dr,null,!1);return Ye(e,Ve),e.teardown=s,e}function be(s){pi();var e=ve.f,t=!ge&&(e&Pt)!==0&&(e&Lr)===0;if(t){var r=xe;(r.e??(r.e=[])).push(s)}else return gi(s)}function gi(s){return wt(On|Ya,s,!1)}function hl(s){return pi(),wt(Dr|Ya,s,!0)}function fl(s){Qs.ensure();const e=wt(ss|lr,s,!0);return(t={})=>new Promise(r=>{t.outro?Vr(e,()=>{Ot(e),r(void 0)}):(Ot(e),r(void 0))})}function Dn(s){return wt(On,s,!1)}function vl(s,e){var t=xe,r={effect:null,ran:!1,deps:s};t.l.$.push(r),r.effect=Fr(()=>{s(),!r.ran&&(r.ran=!0,Ct(e))})}function pl(){var s=xe;Fr(()=>{for(var e of s.l.$){e.deps();var t=e.effect;(t.f&Ve)!==0&&Ye(t,Mt),hr(t)&&Xt(t),e.ran=!1}})}function gl(s){return wt(An|lr,s,!0)}function Fr(s,e=0){return wt(Dr|e,s,!0)}function le(s,e=[],t=[]){rl(e,t,r=>{wt(Dr,()=>s(...r.map(c)),!0)})}function Wr(s,e=0){var t=wt(ts|e,s,!0);return t}function As(s,e=!0){return wt(Pt|lr,s,!0,e)}function _i(s){var e=s.teardown;if(e!==null){const t=as,r=ge;ia(!0),yt(null);try{e.call(null)}finally{ia(t),yt(r)}}}function mi(s,e=!1){var t=s.first;for(s.first=s.last=null;t!==null;){const n=t.ac;n!==null&&Is(()=>{n.abort(Pn)});var r=t.next;(t.f&ss)!==0?t.parent=null:Ot(t,e),t=r}}function _l(s){for(var e=s.first;e!==null;){var t=e.next;(e.f&Pt)===0&&Ot(e),e=t}}function Ot(s,e=!0){var t=!1;(e||(s.f&Ka)!==0)&&s.nodes_start!==null&&s.nodes_end!==null&&(ml(s.nodes_start,s.nodes_end),t=!0),mi(s,e&&!t),Mr(s,0),Ye(s,rs);var r=s.transitions;if(r!==null)for(const a of r)a.stop();_i(s);var n=s.parent;n!==null&&n.first!==null&&yi(s),s.next=s.prev=s.teardown=s.ctx=s.deps=s.fn=s.nodes_start=s.nodes_end=s.ac=null}function ml(s,e){for(;s!==null;){var t=s===e?null:Br(s);s.remove(),s=t}}function yi(s){var e=s.parent,t=s.prev,r=s.next;t!==null&&(t.next=r),r!==null&&(r.prev=t),e!==null&&(e.first===s&&(e.first=r),e.last===s&&(e.last=t))}function Vr(s,e){var t=[];Ln(s,t,!0),wi(t,()=>{Ot(s),e&&e()})}function wi(s,e){var t=s.length;if(t>0){var r=()=>--t||e();for(var n of s)n.out(r)}else e()}function Ln(s,e,t){if((s.f&ft)===0){if(s.f^=ft,s.transitions!==null)for(const i of s.transitions)(i.is_global||t)&&e.push(i);for(var r=s.first;r!==null;){var n=r.next,a=(r.f&or)!==0||(r.f&Pt)!==0;Ln(r,e,a?t:!1),r=n}}}function Un(s){bi(s,!0)}function bi(s,e){if((s.f&ft)!==0){s.f^=ft,(s.f&Ve)===0&&(Ye(s,ct),Os(s));for(var t=s.first;t!==null;){var r=t.next,n=(t.f&or)!==0||(t.f&Pt)!==0;bi(t,n?e:!1),t=r}if(s.transitions!==null)for(const a of s.transitions)(a.is_global||e)&&a.in()}}let ks=!1;function aa(s){ks=s}let as=!1;function ia(s){as=s}let ge=null,_t=!1;function yt(s){ge=s}let ve=null;function Bt(s){ve=s}let Ke=null;function ki(s){ge!==null&&(Ke===null?Ke=[s]:Ke.push(s))}let Ge=null,tt=0,ot=null;function yl(s){ot=s}let Si=1,er=0,Zt=er;function oa(s){Zt=s}let zt=!1;function Ei(){return++Si}function hr(s){var h;var e=s.f;if((e&ct)!==0)return!0;if((e&Mt)!==0){var t=s.deps,r=(e&lt)!==0;if(t!==null){var n,a,i=(e&jr)!==0,o=r&&ve!==null&&!zt,l=t.length;if((i||o)&&(ve===null||(ve.f&rs)===0)){var u=s,d=u.parent;for(n=0;n<l;n++)a=t[n],(i||!((h=a==null?void 0:a.reactions)!=null&&h.includes(u)))&&(a.reactions??(a.reactions=[])).push(u);i&&(u.f^=jr),o&&d!==null&&(d.f&lt)===0&&(u.f^=lt)}for(n=0;n<l;n++)if(a=t[n],hr(a)&&ai(a),a.wv>s.wv)return!0}(!r||ve!==null&&!zt)&&Ye(s,Ve)}return!1}function xi(s,e,t=!0){var r=s.reactions;if(r!==null&&!(Ke!=null&&Ke.includes(s)))for(var n=0;n<r.length;n++){var a=r[n];(a.f&nt)!==0?xi(a,e,!1):e===a&&(t?Ye(a,ct):(a.f&Ve)!==0&&Ye(a,Mt),Os(a))}}function Ti(s){var k;var e=Ge,t=tt,r=ot,n=ge,a=zt,i=Ke,o=xe,l=_t,u=Zt,d=s.f;Ge=null,tt=0,ot=null,zt=(d&lt)!==0&&(_t||!ks||ge===null),ge=(d&(Pt|ss))===0?s:null,Ke=null,Or(s.ctx),_t=!1,Zt=++er,s.ac!==null&&(Is(()=>{s.ac.abort(Pn)}),s.ac=null);try{s.f|=ln;var h=s.fn,f=h(),p=s.deps;if(Ge!==null){var v;if(Mr(s,tt),p!==null&&tt>0)for(p.length=tt+Ge.length,v=0;v<Ge.length;v++)p[tt+v]=Ge[v];else s.deps=p=Ge;if(!zt||(d&nt)!==0&&s.reactions!==null)for(v=tt;v<p.length;v++)((k=p[v]).reactions??(k.reactions=[])).push(s)}else p!==null&&tt<p.length&&(Mr(s,tt),p.length=tt);if(cr()&&ot!==null&&!_t&&p!==null&&(s.f&(nt|Mt|ct))===0)for(v=0;v<ot.length;v++)xi(ot[v],s);return n!==null&&n!==s&&(er++,ot!==null&&(r===null?r=ot:r.push(...ot))),(s.f&Qt)!==0&&(s.f^=Qt),f}catch(_){return Yo(_)}finally{s.f^=ln,Ge=e,tt=t,ot=r,ge=n,zt=a,Ke=i,Or(o),_t=l,Zt=u}}function wl(s,e){let t=e.reactions;if(t!==null){var r=po.call(t,s);if(r!==-1){var n=t.length-1;n===0?t=e.reactions=null:(t[r]=t[n],t.pop())}}t===null&&(e.f&nt)!==0&&(Ge===null||!Ge.includes(e))&&(Ye(e,Mt),(e.f&(lt|jr))===0&&(e.f^=jr),ni(e),Mr(e,0))}function Mr(s,e){var t=s.deps;if(t!==null)for(var r=e;r<t.length;r++)wl(s,t[r])}function Xt(s){var e=s.f;if((e&rs)===0){Ye(s,Ve);var t=ve,r=ks;ve=s,ks=!0;try{(e&ts)!==0?_l(s):mi(s),_i(s);var n=Ti(s);s.teardown=typeof n=="function"?n:null,s.wv=Si;var a;Ha&&Jo&&(s.f&ct)!==0&&s.deps}finally{ks=r,ve=t}}}async function ji(){await Promise.resolve(),al()}function c(s){var e=s.f,t=(e&nt)!==0;if(ge!==null&&!_t){var r=ve!==null&&(ve.f&rs)!==0;if(!r&&!(Ke!=null&&Ke.includes(s))){var n=ge.deps;if((ge.f&ln)!==0)s.rv<er&&(s.rv=er,Ge===null&&n!==null&&n[tt]===s?tt++:Ge===null?Ge=[s]:(!zt||!Ge.includes(s))&&Ge.push(s));else{(ge.deps??(ge.deps=[])).push(s);var a=s.reactions;a===null?s.reactions=[ge]:a.includes(ge)||a.push(ge)}}}else if(t&&s.deps===null&&s.effects===null){var i=s,o=i.parent;o!==null&&(o.f&lt)===0&&(i.f^=lt)}if(as){if(Nt.has(s))return Nt.get(s);if(t){i=s;var l=i.v;return((i.f&Ve)===0&&i.reactions!==null||Oi(i))&&(l=In(i)),Nt.set(i,l),l}}else t&&(i=s,hr(i)&&ai(i));if((s.f&Qt)!==0)throw s.v;return s.v}function Oi(s){if(s.v===We)return!0;if(s.deps===null)return!1;for(const e of s.deps)if(Nt.has(e)||(e.f&nt)!==0&&Oi(e))return!0;return!1}function Ct(s){var e=_t;try{return _t=!0,s()}finally{_t=e}}const bl=-7169;function Ye(s,e){s.f=s.f&bl|e}function Ai(s){if(!(typeof s!="object"||!s||s instanceof EventTarget)){if(mt in s)dn(s);else if(!Array.isArray(s))for(let e in s){const t=s[e];typeof t=="object"&&t&&mt in t&&dn(t)}}}function dn(s,e=new Set){if(typeof s=="object"&&s!==null&&!(s instanceof EventTarget)&&!e.has(s)){e.add(s),s instanceof Date&&s.getTime();for(let r in s)try{dn(s[r],e)}catch{}const t=jn(s);if(t!==Object.prototype&&t!==Array.prototype&&t!==Map.prototype&&t!==Set.prototype&&t!==Date.prototype){const r=Ja(t);for(let n in r){const a=r[n].get;if(a)try{a.call(s)}catch{}}}}}const kl=["touchstart","touchmove"];function Sl(s){return kl.includes(s)}const Pi=new Set,hn=new Set;function El(s,e,t,r={}){function n(a){if(r.capture||Fs.call(e,a),!a.cancelBubble)return Is(()=>t==null?void 0:t.call(this,a))}return s.startsWith("pointer")||s.startsWith("touch")||s==="wheel"?ur(()=>{e.addEventListener(s,n,r)}):e.addEventListener(s,n,r),n}function Xe(s,e,t,r,n){var a={capture:r,passive:n},i=El(s,e,t,a);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&Rn(()=>{e.removeEventListener(s,i,a)})}function is(s){for(var e=0;e<s.length;e++)Pi.add(s[e]);for(var t of hn)t(s)}let la=null;function Fs(s){var C;var e=this,t=e.ownerDocument,r=s.type,n=((C=s.composedPath)==null?void 0:C.call(s))||[],a=n[0]||s.target;la=s;var i=0,o=la===s&&s.__root;if(o){var l=n.indexOf(o);if(l!==-1&&(e===document||e===window)){s.__root=e;return}var u=n.indexOf(e);if(u===-1)return;l<=u&&(i=l)}if(a=n[i]||s.target,a!==e){Tr(s,"currentTarget",{configurable:!0,get(){return a||t}});var d=ge,h=ve;yt(null),Bt(null);try{for(var f,p=[];a!==null;){var v=a.assignedSlot||a.parentNode||a.host||null;try{var k=a["__"+r];if(k!=null&&(!a.disabled||s.target===a))if(Ms(k)){var[_,...O]=k;_.apply(a,[s,...O])}else k.call(a,s)}catch(T){f?p.push(T):f=T}if(s.cancelBubble||v===e||v===null)break;a=v}if(f){for(let T of p)queueMicrotask(()=>{throw T});throw f}}finally{s.__root=e,delete s.currentTarget,yt(d),Bt(h)}}}function zn(s){var e;e=document.head.appendChild(ns());try{Wr(()=>s(e),Ka)}finally{}}function xl(s){var e=document.createElement("template");return e.innerHTML=s.replaceAll("<!>","<!---->"),e.content}function fn(s,e){var t=ve;t.nodes_start===null&&(t.nodes_start=s,t.nodes_end=e)}function W(s,e){var t=(e&Bo)!==0,r=(e&Fo)!==0,n,a=!s.startsWith("<!>");return()=>{n===void 0&&(n=xl(a?s:"<!>"+s),t||(n=Pr(n)));var i=r||di?document.importNode(n,!0):n.cloneNode(!0);if(t){var o=Pr(i),l=i.lastChild;fn(o,l)}else fn(i,i);return i}}function qn(s){return()=>Tl(s())}function Tl(s){const e=s.nodeType===ko,t=s.tagName==="SCRIPT"?[s]:s.querySelectorAll("script"),r=ve;for(const a of t){const i=document.createElement("script");for(var n of a.attributes)i.setAttribute(n.name,n.value);i.textContent=a.textContent,(e?s.firstChild===a:s===a)&&(r.nodes_start=i),(e?s.lastChild===a:s===a)&&(r.nodes_end=i),a.replaceWith(i)}return s}function jt(){var s=document.createDocumentFragment(),e=document.createComment(""),t=ns();return s.append(e,t),fn(e,t),s}function U(s,e){s!==null&&s.before(e)}let vn=!0;function ee(s,e){var t=e==null?"":typeof e=="object"?e+"":e;t!==(s.__t??(s.__t=s.nodeValue))&&(s.__t=t,s.nodeValue=t+"")}function jl(s,e){return Ol(s,e)}const ls=new Map;function Ol(s,{target:e,anchor:t,props:r={},events:n,context:a,intro:i=!0}){ll();var o=new Set,l=h=>{for(var f=0;f<h.length;f++){var p=h[f];if(!o.has(p)){o.add(p);var v=Sl(p);e.addEventListener(p,Fs,{passive:v});var k=ls.get(p);k===void 0?(document.addEventListener(p,Fs,{passive:v}),ls.set(p,1)):ls.set(p,k+1)}}};l(Tn(Pi)),hn.add(l);var u=void 0,d=fl(()=>{var h=t??e.appendChild(ns());return As(()=>{if(a){Ce({});var f=xe;f.c=a}n&&(r.$$events=n),vn=i,u=s(h,r)||{},vn=!0,a&&Ie()}),()=>{var v;for(var f of o){e.removeEventListener(f,Fs);var p=ls.get(f);--p===0?(document.removeEventListener(f,Fs),ls.delete(f)):ls.set(f,p)}hn.delete(l),h!==t&&((v=h.parentNode)==null||v.removeChild(h))}});return Al.set(u,d),u}let Al=new WeakMap;function ce(s,e,t=!1){var r=s,n=null,a=null,i=We,o=t?or:0,l=!1;const u=(p,v=!0)=>{l=!0,f(v,p)};var d=null;function h(){d!==null&&(d.lastChild.remove(),r.before(d),d=null);var p=i?n:a,v=i?a:n;p&&Un(p),v&&Vr(v,()=>{i?a=null:n=null})}const f=(p,v)=>{if(i!==(i=p)){var k=$n(),_=r;if(k&&(d=document.createDocumentFragment(),d.append(_=ns())),i?n??(n=v&&As(()=>v(_))):a??(a=v&&As(()=>v(_))),k){var O=Se,C=i?n:a,T=i?a:n;C&&O.skipped_effects.delete(C),T&&O.skipped_effects.add(T),O.add_callback(h)}else h()}};Wr(()=>{l=!1,e(u),l||f(null,null)},o)}function Pe(s,e){return e}function Pl(s,e,t){for(var r=s.items,n=[],a=e.length,i=0;i<a;i++)Ln(e[i].e,n,!0);var o=a>0&&n.length===0&&t!==null;if(o){var l=t.parentNode;cl(l),l.append(t),r.clear(),gt(s,e[0].prev,e[a-1].next)}wi(n,()=>{for(var u=0;u<a;u++){var d=e[u];o||(r.delete(d.k),gt(s,d.prev,d.next)),Ot(d.e,!o)}})}function Me(s,e,t,r,n,a=null){var i=s,o={flags:e,items:new Map,first:null},l=(e&Za)!==0;if(l){var u=s;i=u.appendChild(ns())}var d=null,h=!1,f=new Map,p=Cn(()=>{var O=t();return Ms(O)?O:O==null?[]:Tn(O)}),v,k;function _(){Ml(k,v,o,f,i,n,e,r,t),a!==null&&(v.length===0?d?Un(d):d=As(()=>a(i)):d!==null&&Vr(d,()=>{d=null}))}Wr(()=>{k??(k=ve),v=c(p);var O=v.length;if(!(h&&O===0)){h=O===0;var C,T,E,x;if($n()){var S=new Set,A=Se;for(T=0;T<O;T+=1){E=v[T],x=r(E,T);var P=o.items.get(x)??f.get(x);P?(e&(zr|qr))!==0&&Mi(P,E,T,e):(C=Ci(null,o,null,null,E,x,T,n,e,t,!0),f.set(x,C)),S.add(x)}for(const[M,B]of o.items)S.has(M)||A.skipped_effects.add(B.e);A.add_callback(_)}else _();c(p)}})}function Ml(s,e,t,r,n,a,i,o,l){var me,b,g,R;var u=(i&$o)!==0,d=(i&(zr|qr))!==0,h=e.length,f=t.items,p=t.first,v=p,k,_=null,O,C=[],T=[],E,x,S,A;if(u)for(A=0;A<h;A+=1)E=e[A],x=o(E,A),S=f.get(x),S!==void 0&&((me=S.a)==null||me.measure(),(O??(O=new Set)).add(S));for(A=0;A<h;A+=1){if(E=e[A],x=o(E,A),S=f.get(x),S===void 0){var P=r.get(x);if(P!==void 0){r.delete(x),f.set(x,P);var M=_?_.next:v;gt(t,_,P),gt(t,P,M),Zr(P,M,n),_=P}else{var B=v?v.e.nodes_start:n;_=Ci(B,t,_,_===null?t.first:_.next,E,x,A,a,i,l)}f.set(x,_),C=[],T=[],v=_.next;continue}if(d&&Mi(S,E,A,i),(S.e.f&ft)!==0&&(Un(S.e),u&&((b=S.a)==null||b.unfix(),(O??(O=new Set)).delete(S))),S!==v){if(k!==void 0&&k.has(S)){if(C.length<T.length){var J=T[0],K;_=J.prev;var I=C[0],z=C[C.length-1];for(K=0;K<C.length;K+=1)Zr(C[K],J,n);for(K=0;K<T.length;K+=1)k.delete(T[K]);gt(t,I.prev,z.next),gt(t,_,I),gt(t,z,J),v=J,_=z,A-=1,C=[],T=[]}else k.delete(S),Zr(S,v,n),gt(t,S.prev,S.next),gt(t,S,_===null?t.first:_.next),gt(t,_,S),_=S;continue}for(C=[],T=[];v!==null&&v.k!==x;)(v.e.f&ft)===0&&(k??(k=new Set)).add(v),T.push(v),v=v.next;if(v===null)continue;S=v}C.push(S),_=S,v=S.next}if(v!==null||k!==void 0){for(var D=k===void 0?[]:Tn(k);v!==null;)(v.e.f&ft)===0&&D.push(v),v=v.next;var L=D.length;if(L>0){var Q=(i&Za)!==0&&h===0?n:null;if(u){for(A=0;A<L;A+=1)(g=D[A].a)==null||g.measure();for(A=0;A<L;A+=1)(R=D[A].a)==null||R.fix()}Pl(t,D,Q)}}u&&ur(()=>{var N;if(O!==void 0)for(S of O)(N=S.a)==null||N.apply()}),s.first=t.first&&t.first.e,s.last=_&&_.e;for(var re of r.values())Ot(re.e);r.clear()}function Mi(s,e,t,r){(r&zr)!==0&&Xs(s.v,e),(r&qr)!==0?Xs(s.i,t):s.i=t}function Ci(s,e,t,r,n,a,i,o,l,u,d){var h=(l&zr)!==0,f=(l&Ro)===0,p=h?f?bs(n,!1,!1):Zs(n):n,v=(l&qr)===0?i:Zs(i),k={i:v,v:p,k:a,a:null,e:null,prev:t,next:r};try{if(s===null){var _=document.createDocumentFragment();_.append(s=ns())}return k.e=As(()=>o(s,p,v,u),Ho),k.e.prev=t&&t.e,k.e.next=r&&r.e,t===null?d||(e.first=k):(t.next=k,t.e.next=k.e),r!==null&&(r.prev=k,r.e.prev=k.e),k}finally{}}function Zr(s,e,t){for(var r=s.next?s.next.e.nodes_start:t,n=e?e.e.nodes_start:t,a=s.e.nodes_start;a!==null&&a!==r;){var i=Br(a);n.before(a),a=i}}function gt(s,e,t){e===null?s.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function ca(s,e,t){var r=s,n,a,i=null,o=null;function l(){a&&(Vr(a),a=null),i&&(i.lastChild.remove(),r.before(i),i=null),a=o,o=null}Wr(()=>{if(n!==(n=e())){var u=$n();if(n){var d=r;u&&(i=document.createDocumentFragment(),i.append(d=ns()),a&&Se.skipped_effects.add(a)),o=As(()=>t(d,n))}u?Se.add_callback(l):l()}},or)}function Ii(s){var e,t,r="";if(typeof s=="string"||typeof s=="number")r+=s;else if(typeof s=="object")if(Array.isArray(s)){var n=s.length;for(e=0;e<n;e++)s[e]&&(t=Ii(s[e]))&&(r&&(r+=" "),r+=t)}else for(t in s)s[t]&&(r&&(r+=" "),r+=t);return r}function Cl(){for(var s,e,t=0,r="",n=arguments.length;t<n;t++)(s=arguments[t])&&(e=Ii(s))&&(r&&(r+=" "),r+=e);return r}function Cr(s){return typeof s=="object"?Cl(s):s??""}const ua=[...` 	
\r\fÂ \v\uFEFF`];function Il(s,e,t){var r=s==null?"":""+s;if(e&&(r=r?r+" "+e:e),t){for(var n in t)if(t[n])r=r?r+" "+n:n;else if(r.length)for(var a=n.length,i=0;(i=r.indexOf(n,i))>=0;){var o=i+a;(i===0||ua.includes(r[i-1]))&&(o===r.length||ua.includes(r[o]))?r=(i===0?"":r.substring(0,i))+r.substring(o+1):i=o}}return r===""?null:r}function $l(s,e){return s==null?null:String(s)}function st(s,e,t,r,n,a){var i=s.__className;if(i!==t||i===void 0){var o=Il(t,r,a);o==null?s.removeAttribute("class"):s.className=o,s.__className=t}else if(a&&n!==a)for(var l in a){var u=!!a[l];(n==null||u!==!!n[l])&&s.classList.toggle(l,u)}return a}function Rl(s,e,t,r){var n=s.__style;if(n!==e){var a=$l(e);a==null?s.removeAttribute("style"):s.style.cssText=a,s.__style=e}return r}function $i(s,e,t=!1){if(s.multiple){if(e==null)return;if(!Ms(e))return Vo();for(var r of s.options)r.selected=e.includes(Hs(r));return}for(r of s.options){var n=Hs(r);if(ol(n,e)){r.selected=!0;return}}(!t||e!==void 0)&&(s.selectedIndex=-1)}function Dl(s){var e=new MutationObserver(()=>{$i(s,s.__value)});e.observe(s,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Rn(()=>{e.disconnect()})}function He(s,e,t=e){var r=!0;vi(s,"change",n=>{var a=n?"[selected]":":checked",i;if(s.multiple)i=[].map.call(s.querySelectorAll(a),Hs);else{var o=s.querySelector(a)??s.querySelector("option:not([disabled])");i=o&&Hs(o)}t(i)}),Dn(()=>{var n=e();if($i(s,n,r),r&&n===void 0){var a=s.querySelector(":checked");a!==null&&(n=Hs(a),t(n))}s.__value=n,r=!1}),Dl(s)}function Hs(s){return"__value"in s?s.__value:s.value}const Ll=Symbol("is custom element"),Ul=Symbol("is html");function Ue(s,e,t,r){var n=zl(s);n[e]!==(n[e]=t)&&(e==="loading"&&(s[bo]=t),t==null?s.removeAttribute(e):typeof t!="string"&&ql(s).includes(e)?s[e]=t:s.setAttribute(e,t))}function zl(s){return s.__attributes??(s.__attributes={[Ll]:s.nodeName.includes("-"),[Ul]:s.namespaceURI===Wo})}var da=new Map;function ql(s){var e=s.getAttribute("is")||s.nodeName,t=da.get(e);if(t)return t;da.set(e,t=[]);for(var r,n=s,a=Element.prototype;a!==n;){r=Ja(n);for(var i in r)r[i].set&&t.push(i);n=jn(n)}return t}const Nl=()=>performance.now(),Tt={tick:s=>requestAnimationFrame(s),now:()=>Nl(),tasks:new Set};function Ri(){const s=Tt.now();Tt.tasks.forEach(e=>{e.c(s)||(Tt.tasks.delete(e),e.f())}),Tt.tasks.size!==0&&Tt.tick(Ri)}function Bl(s){let e;return Tt.tasks.size===0&&Tt.tick(Ri),{promise:new Promise(t=>{Tt.tasks.add(e={c:s,f:t})}),abort(){Tt.tasks.delete(e)}}}function gr(s,e){Is(()=>{s.dispatchEvent(new CustomEvent(e))})}function Fl(s){if(s==="float")return"cssFloat";if(s==="offset")return"cssOffset";if(s.startsWith("--"))return s;const e=s.split("-");return e.length===1?e[0]:e[0]+e.slice(1).map(t=>t[0].toUpperCase()+t.slice(1)).join("")}function ha(s){const e={},t=s.split(";");for(const r of t){const[n,a]=r.split(":");if(!n||a===void 0)break;const i=Fl(n.trim());e[i]=a.trim()}return e}const Wl=s=>s;function Vl(s,e,t,r){var n=(s&No)!==0,a="both",i,o=e.inert,l=e.style.overflow,u,d;function h(){return Is(()=>i??(i=t()(e,(r==null?void 0:r())??{},{direction:a})))}var f={is_global:n,in(){e.inert=o,gr(e,"introstart"),u=pn(e,h(),d,1,()=>{gr(e,"introend"),u==null||u.abort(),u=i=void 0,e.style.overflow=l})},out(_){e.inert=!0,gr(e,"outrostart"),d=pn(e,h(),u,0,()=>{gr(e,"outroend"),_==null||_()})},stop:()=>{u==null||u.abort(),d==null||d.abort()}},p=ve;if((p.transitions??(p.transitions=[])).push(f),vn){var v=n;if(!v){for(var k=p.parent;k&&(k.f&or)!==0;)for(;(k=k.parent)&&(k.f&ts)===0;);v=!k||(k.f&Lr)!==0}v&&Dn(()=>{Ct(()=>f.in())})}}function pn(s,e,t,r,n){var a=r===1;if(ys(e)){var i,o=!1;return ur(()=>{if(!o){var _=e({direction:a?"in":"out"});i=pn(s,_,t,r,n)}}),{abort:()=>{o=!0,i==null||i.abort()},deactivate:()=>i.deactivate(),reset:()=>i.reset(),t:()=>i.t()}}if(t==null||t.deactivate(),!(e!=null&&e.duration))return n(),{abort:rt,deactivate:rt,reset:rt,t:()=>r};const{delay:l=0,css:u,tick:d,easing:h=Wl}=e;var f=[];if(a&&t===void 0&&(d&&d(0,1),u)){var p=ha(u(0,1));f.push(p,p)}var v=()=>1-r,k=s.animate(f,{duration:l,fill:"forwards"});return k.onfinish=()=>{k.cancel();var _=(t==null?void 0:t.t())??1-r;t==null||t.abort();var O=r-_,C=e.duration*Math.abs(O),T=[];if(C>0){var E=!1;if(u)for(var x=Math.ceil(C/16.666666666666668),S=0;S<=x;S+=1){var A=_+O*h(S/x),P=ha(u(A,1-A));T.push(P),E||(E=P.overflow==="hidden")}E&&(s.style.overflow="hidden"),v=()=>{var M=k.currentTime;return _+O*h(M/C)},d&&Bl(()=>{if(k.playState!=="running")return!1;var M=v();return d(M,1-M),!0})}k=s.animate(T,{duration:C,fill:"forwards"}),k.onfinish=()=>{v=()=>r,d==null||d(r,1-r),n()}},{abort:()=>{k&&(k.cancel(),k.effect=null,k.onfinish=rt)},deactivate:()=>{n=rt},reset:()=>{r===0&&(d==null||d(1,0))},t:()=>v()}}function pt(s,e,t=e){var r=new WeakSet;vi(s,"input",async n=>{var a=n?s.defaultValue:s.value;if(a=Xr(s)?en(a):a,t(a),Se!==null&&r.add(Se),await ji(),a!==(a=e())){var i=s.selectionStart,o=s.selectionEnd;s.value=a??"",o!==null&&(s.selectionStart=i,s.selectionEnd=Math.min(o,s.value.length))}}),Ct(e)==null&&s.value&&(t(Xr(s)?en(s.value):s.value),Se!==null&&r.add(Se)),Fr(()=>{var n=e();if(s===document.activeElement){var a=Er??Se;if(r.has(a))return}Xr(s)&&n===en(s.value)||s.type==="date"&&!n&&!s.value||n!==s.value&&(s.value=n??"")})}function Xr(s){var e=s.type;return e==="number"||e==="range"}function en(s){return s===""?null:+s}function fa(s,e){return s===e||(s==null?void 0:s[mt])===e}function ht(s={},e,t,r){return Dn(()=>{var n,a;return Fr(()=>{n=a,a=[],Ct(()=>{s!==t(...a)&&(e(s,...a),n&&fa(t(...n),s)&&e(null,...n))})}),()=>{ur(()=>{a&&fa(t(...a),s)&&e(null,...a)})}}),s}function Nn(s=!1){const e=xe,t=e.l.u;if(!t)return;let r=()=>Ai(e.s);if(s){let n=0,a={};const i=dr(()=>{let o=!1;const l=e.s;for(const u in l)l[u]!==a[u]&&(a[u]=l[u],o=!0);return o&&n++,n});r=()=>c(i)}t.b.length&&hl(()=>{va(e,r),Ys(t.b)}),be(()=>{const n=Ct(()=>t.m.map(mo));return()=>{for(const a of n)typeof a=="function"&&a()}}),t.a.length&&be(()=>{va(e,r),Ys(t.a)})}function va(s,e){if(s.l.s)for(const t of s.l.s)c(t);e()}function pa(s,e){var a;var t=(a=s.$$events)==null?void 0:a[e.type],r=Ms(t)?t.slice():t==null?[]:[t];for(var n of r)n.call(this,e)}function Bn(s,e,t){if(s==null)return e(void 0),t&&t(void 0),rt;const r=Ct(()=>s.subscribe(e,t));return r.unsubscribe?()=>r.unsubscribe():r}const cs=[];function Di(s,e){return{subscribe:Li(s,e).subscribe}}function Li(s,e=rt){let t=null;const r=new Set;function n(o){if(ei(s,o)&&(s=o,t)){const l=!cs.length;for(const u of r)u[1](),cs.push(u,s);if(l){for(let u=0;u<cs.length;u+=2)cs[u][0](cs[u+1]);cs.length=0}}}function a(o){n(o(s))}function i(o,l=rt){const u=[o,l];return r.add(u),r.size===1&&(t=e(n,a)||rt),o(s),()=>{r.delete(u),r.size===0&&t&&(t(),t=null)}}return{set:n,update:a,subscribe:i}}function Ui(s,e,t){const r=!Array.isArray(s),n=r?[s]:s;if(!n.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const a=e.length<2;return Di(t,(i,o)=>{let l=!1;const u=[];let d=0,h=rt;const f=()=>{if(d)return;h();const v=e(r?u[0]:u,i,o);a?i(v):h=typeof v=="function"?v:rt},p=n.map((v,k)=>Bn(v,_=>{u[k]=_,d&=~(1<<k),l&&f()},()=>{d|=1<<k}));return l=!0,f(),function(){Ys(p),h(),l=!1}})}function Hl(s){let e;return Bn(s,t=>e=t)(),e}let _r=!1,gn=Symbol();function $s(s,e,t){const r=t[e]??(t[e]={store:null,source:bs(void 0),unsubscribe:rt});if(r.store!==s&&!(gn in t))if(r.unsubscribe(),r.store=s??null,s==null)r.source.v=void 0,r.unsubscribe=rt;else{var n=!0;r.unsubscribe=Bn(s,a=>{n?r.source.v=a:m(r.source,a)}),n=!1}return s&&gn in t?Hl(s):c(r.source)}function Rs(){const s={};function e(){Rn(()=>{for(var t in s)s[t].unsubscribe();Tr(s,gn,{enumerable:!1,value:!0})})}return[s,e]}function Jl(s){var e=_r;try{return _r=!1,[s(),_r]}finally{_r=e}}const Gl={get(s,e){let t=s.props.length;for(;t--;){let r=s.props[t];if(ys(r)&&(r=r()),typeof r=="object"&&r!==null&&e in r)return r[e]}},set(s,e,t){let r=s.props.length;for(;r--;){let n=s.props[r];ys(n)&&(n=n());const a=qt(n,e);if(a&&a.set)return a.set(t),!0}return!1},getOwnPropertyDescriptor(s,e){let t=s.props.length;for(;t--;){let r=s.props[t];if(ys(r)&&(r=r()),typeof r=="object"&&r!==null&&e in r){const n=qt(r,e);return n&&!n.configurable&&(n.configurable=!0),n}}},has(s,e){if(e===mt||e===Qa)return!1;for(let t of s.props)if(ys(t)&&(t=t()),t!=null&&e in t)return!0;return!1},ownKeys(s){const e=[];for(let t of s.props)if(ys(t)&&(t=t()),!!t){for(const r in t)e.includes(r)||e.push(r);for(const r of Object.getOwnPropertySymbols(t))e.includes(r)||e.push(r)}return e}};function ga(...s){return new Proxy({props:s},Gl)}function we(s,e,t,r){var T;var n=!Cs||(t&Lo)!==0,a=(t&zo)!==0,i=(t&qo)!==0,o=r,l=!0,u=()=>(l&&(l=!1,o=i?Ct(r):r),o),d;if(a){var h=mt in s||Qa in s;d=((T=qt(s,e))==null?void 0:T.set)??(h&&e in s?E=>s[e]=E:void 0)}var f,p=!1;a?[f,p]=Jl(()=>s[e]):f=s[e],f===void 0&&r!==void 0&&(f=u(),d&&(n&&Po(),d(f)));var v;if(n?v=()=>{var E=s[e];return E===void 0?u():(l=!0,E)}:v=()=>{var E=s[e];return E!==void 0&&(o=void 0),E===void 0?o:E},n&&(t&Uo)===0)return v;if(d){var k=s.$$legacy;return function(E,x){return arguments.length>0?((!n||!x||k||p)&&d(x?v():E),E):v()}}var _=!1,O=((t&Do)!==0?dr:Cn)(()=>(_=!1,v()));a&&c(O);var C=ve;return function(E,x){if(arguments.length>0){const S=x?c(O):n&&a?H(E):E;return m(O,S),_=!0,o!==void 0&&(o=S),E}return as&&_||(C.f&rs)!==0?O.v:c(O)}}function et(s){xe===null&&Ur(),Cs&&xe.l!==null?zi(xe).m.push(s):be(()=>{const e=Ct(s);if(typeof e=="function")return e})}function Kl(s){xe===null&&Ur(),et(()=>()=>Ct(s))}function Yl(s,e,{bubbles:t=!1,cancelable:r=!1}={}){return new CustomEvent(s,{detail:e,bubbles:t,cancelable:r})}function Ql(){const s=xe;return s===null&&Ur(),(e,t,r)=>{var a;const n=(a=s.s.$$events)==null?void 0:a[e];if(n){const i=Ms(n)?n.slice():[n],o=Yl(e,t,r);for(const l of i)l.call(s.x,o);return!o.defaultPrevented}return!0}}function Zl(s){xe===null&&Ur(),xe.l===null&&Ao(),zi(xe).a.push(s)}function zi(s){var e=s.l;return e.u??(e.u={a:[],b:[],m:[]})}const Xl="5";var Va;typeof window<"u"&&((Va=window.__svelte??(window.__svelte={})).v??(Va.v=new Set)).add(Xl);const ec="modulepreload",tc=function(s){return"/"+s},_a={},fr=function(e,t,r){let n=Promise.resolve();if(t&&t.length>0){let i=function(u){return Promise.all(u.map(d=>Promise.resolve(d).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));n=i(t.map(u=>{if(u=tc(u),u in _a)return;_a[u]=!0;const d=u.endsWith(".css"),h=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${h}`))return;const f=document.createElement("link");if(f.rel=d?"stylesheet":ec,d||(f.as="script"),f.crossOrigin="",f.href=u,l&&f.setAttribute("nonce",l),document.head.appendChild(f),d)return new Promise((p,v)=>{f.addEventListener("load",p),f.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${u}`)))})}))}function a(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return n.then(i=>{for(const o of i||[])o.status==="rejected"&&a(o.reason);return e().catch(a)})},sc=s=>{let e;return s?e=s:typeof fetch>"u"?e=(...t)=>fr(async()=>{const{default:r}=await Promise.resolve().then(()=>Ds);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)};class Fn extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class rc extends Fn{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class nc extends Fn{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class ac extends Fn{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var _n;(function(s){s.Any="any",s.ApNortheast1="ap-northeast-1",s.ApNortheast2="ap-northeast-2",s.ApSouth1="ap-south-1",s.ApSoutheast1="ap-southeast-1",s.ApSoutheast2="ap-southeast-2",s.CaCentral1="ca-central-1",s.EuCentral1="eu-central-1",s.EuWest1="eu-west-1",s.EuWest2="eu-west-2",s.EuWest3="eu-west-3",s.SaEast1="sa-east-1",s.UsEast1="us-east-1",s.UsWest1="us-west-1",s.UsWest2="us-west-2"})(_n||(_n={}));var ic=function(s,e,t,r){function n(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(d){try{u(r.next(d))}catch(h){i(h)}}function l(d){try{u(r.throw(d))}catch(h){i(h)}}function u(d){d.done?a(d.value):n(d.value).then(o,l)}u((r=r.apply(s,e||[])).next())})};class oc{constructor(e,{headers:t={},customFetch:r,region:n=_n.Any}={}){this.url=e,this.headers=t,this.region=n,this.fetch=sc(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var r;return ic(this,void 0,void 0,function*(){try{const{headers:n,method:a,body:i}=t;let o={},{region:l}=t;l||(l=this.region),l&&l!=="any"&&(o["x-region"]=l);let u;i&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&(typeof Blob<"u"&&i instanceof Blob||i instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",u=i):typeof i=="string"?(o["Content-Type"]="text/plain",u=i):typeof FormData<"u"&&i instanceof FormData?u=i:(o["Content-Type"]="application/json",u=JSON.stringify(i)));const d=yield this.fetch(`${this.url}/${e}`,{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),n),body:u}).catch(v=>{throw new rc(v)}),h=d.headers.get("x-relay-error");if(h&&h==="true")throw new nc(d);if(!d.ok)throw new ac(d);let f=((r=d.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),p;return f==="application/json"?p=yield d.json():f==="application/octet-stream"?p=yield d.blob():f==="text/event-stream"?p=d:f==="multipart/form-data"?p=yield d.formData():p=yield d.text(),{data:p,error:null}}catch(n){return{data:null,error:n}}})}}function lc(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}function cc(s){if(Object.prototype.hasOwnProperty.call(s,"__esModule"))return s;var e=s.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(s).forEach(function(r){var n=Object.getOwnPropertyDescriptor(s,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return s[r]}})}),t}var Be={},us={},ds={},hs={},fs={},vs={},uc=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Ps=uc();const dc=Ps.fetch,qi=Ps.fetch.bind(Ps),Ni=Ps.Headers,hc=Ps.Request,fc=Ps.Response,Ds=Object.freeze(Object.defineProperty({__proto__:null,Headers:Ni,Request:hc,Response:fc,default:qi,fetch:dc},Symbol.toStringTag,{value:"Module"})),vc=cc(Ds);var mr={},ma;function Bi(){if(ma)return mr;ma=1,Object.defineProperty(mr,"__esModule",{value:!0});class s extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return mr.default=s,mr}var ya;function Fi(){if(ya)return vs;ya=1;var s=vs&&vs.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(vs,"__esModule",{value:!0});const e=s(vc),t=s(Bi());class r{constructor(a){this.shouldThrowOnError=!1,this.method=a.method,this.url=a.url,this.headers=a.headers,this.schema=a.schema,this.body=a.body,this.shouldThrowOnError=a.shouldThrowOnError,this.signal=a.signal,this.isMaybeSingle=a.isMaybeSingle,a.fetch?this.fetch=a.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(a,i){return this.headers=Object.assign({},this.headers),this.headers[a]=i,this}then(a,i){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const o=this.fetch;let l=o(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async u=>{var d,h,f;let p=null,v=null,k=null,_=u.status,O=u.statusText;if(u.ok){if(this.method!=="HEAD"){const x=await u.text();x===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?v=x:v=JSON.parse(x))}const T=(d=this.headers.Prefer)===null||d===void 0?void 0:d.match(/count=(exact|planned|estimated)/),E=(h=u.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");T&&E&&E.length>1&&(k=parseInt(E[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(v)&&(v.length>1?(p={code:"PGRST116",details:`Results contain ${v.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},v=null,k=null,_=406,O="Not Acceptable"):v.length===1?v=v[0]:v=null)}else{const T=await u.text();try{p=JSON.parse(T),Array.isArray(p)&&u.status===404&&(v=[],p=null,_=200,O="OK")}catch{u.status===404&&T===""?(_=204,O="No Content"):p={message:T}}if(p&&this.isMaybeSingle&&(!((f=p==null?void 0:p.details)===null||f===void 0)&&f.includes("0 rows"))&&(p=null,_=200,O="OK"),p&&this.shouldThrowOnError)throw new t.default(p)}return{error:p,data:v,count:k,status:_,statusText:O}});return this.shouldThrowOnError||(l=l.catch(u=>{var d,h,f;return{error:{message:`${(d=u==null?void 0:u.name)!==null&&d!==void 0?d:"FetchError"}: ${u==null?void 0:u.message}`,details:`${(h=u==null?void 0:u.stack)!==null&&h!==void 0?h:""}`,hint:"",code:`${(f=u==null?void 0:u.code)!==null&&f!==void 0?f:""}`},data:null,count:null,status:0,statusText:""}})),l.then(a,i)}returns(){return this}overrideTypes(){return this}}return vs.default=r,vs}var wa;function Wi(){if(wa)return fs;wa=1;var s=fs&&fs.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(fs,"__esModule",{value:!0});const e=s(Fi());class t extends e.default{select(n){let a=!1;const i=(n??"*").split("").map(o=>/\s/.test(o)&&!a?"":(o==='"'&&(a=!a),o)).join("");return this.url.searchParams.set("select",i),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(n,{ascending:a=!0,nullsFirst:i,foreignTable:o,referencedTable:l=o}={}){const u=l?`${l}.order`:"order",d=this.url.searchParams.get(u);return this.url.searchParams.set(u,`${d?`${d},`:""}${n}.${a?"asc":"desc"}${i===void 0?"":i?".nullsfirst":".nullslast"}`),this}limit(n,{foreignTable:a,referencedTable:i=a}={}){const o=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(o,`${n}`),this}range(n,a,{foreignTable:i,referencedTable:o=i}={}){const l=typeof o>"u"?"offset":`${o}.offset`,u=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(l,`${n}`),this.url.searchParams.set(u,`${a-n+1}`),this}abortSignal(n){return this.signal=n,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:n=!1,verbose:a=!1,settings:i=!1,buffers:o=!1,wal:l=!1,format:u="text"}={}){var d;const h=[n?"analyze":null,a?"verbose":null,i?"settings":null,o?"buffers":null,l?"wal":null].filter(Boolean).join("|"),f=(d=this.headers.Accept)!==null&&d!==void 0?d:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${u}; for="${f}"; options=${h};`,u==="json"?this:this}rollback(){var n;return((n=this.headers.Prefer)!==null&&n!==void 0?n:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return fs.default=t,fs}var ba;function Wn(){if(ba)return hs;ba=1;var s=hs&&hs.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(hs,"__esModule",{value:!0});const e=s(Wi());class t extends e.default{eq(n,a){return this.url.searchParams.append(n,`eq.${a}`),this}neq(n,a){return this.url.searchParams.append(n,`neq.${a}`),this}gt(n,a){return this.url.searchParams.append(n,`gt.${a}`),this}gte(n,a){return this.url.searchParams.append(n,`gte.${a}`),this}lt(n,a){return this.url.searchParams.append(n,`lt.${a}`),this}lte(n,a){return this.url.searchParams.append(n,`lte.${a}`),this}like(n,a){return this.url.searchParams.append(n,`like.${a}`),this}likeAllOf(n,a){return this.url.searchParams.append(n,`like(all).{${a.join(",")}}`),this}likeAnyOf(n,a){return this.url.searchParams.append(n,`like(any).{${a.join(",")}}`),this}ilike(n,a){return this.url.searchParams.append(n,`ilike.${a}`),this}ilikeAllOf(n,a){return this.url.searchParams.append(n,`ilike(all).{${a.join(",")}}`),this}ilikeAnyOf(n,a){return this.url.searchParams.append(n,`ilike(any).{${a.join(",")}}`),this}is(n,a){return this.url.searchParams.append(n,`is.${a}`),this}in(n,a){const i=Array.from(new Set(a)).map(o=>typeof o=="string"&&new RegExp("[,()]").test(o)?`"${o}"`:`${o}`).join(",");return this.url.searchParams.append(n,`in.(${i})`),this}contains(n,a){return typeof a=="string"?this.url.searchParams.append(n,`cs.${a}`):Array.isArray(a)?this.url.searchParams.append(n,`cs.{${a.join(",")}}`):this.url.searchParams.append(n,`cs.${JSON.stringify(a)}`),this}containedBy(n,a){return typeof a=="string"?this.url.searchParams.append(n,`cd.${a}`):Array.isArray(a)?this.url.searchParams.append(n,`cd.{${a.join(",")}}`):this.url.searchParams.append(n,`cd.${JSON.stringify(a)}`),this}rangeGt(n,a){return this.url.searchParams.append(n,`sr.${a}`),this}rangeGte(n,a){return this.url.searchParams.append(n,`nxl.${a}`),this}rangeLt(n,a){return this.url.searchParams.append(n,`sl.${a}`),this}rangeLte(n,a){return this.url.searchParams.append(n,`nxr.${a}`),this}rangeAdjacent(n,a){return this.url.searchParams.append(n,`adj.${a}`),this}overlaps(n,a){return typeof a=="string"?this.url.searchParams.append(n,`ov.${a}`):this.url.searchParams.append(n,`ov.{${a.join(",")}}`),this}textSearch(n,a,{config:i,type:o}={}){let l="";o==="plain"?l="pl":o==="phrase"?l="ph":o==="websearch"&&(l="w");const u=i===void 0?"":`(${i})`;return this.url.searchParams.append(n,`${l}fts${u}.${a}`),this}match(n){return Object.entries(n).forEach(([a,i])=>{this.url.searchParams.append(a,`eq.${i}`)}),this}not(n,a,i){return this.url.searchParams.append(n,`not.${a}.${i}`),this}or(n,{foreignTable:a,referencedTable:i=a}={}){const o=i?`${i}.or`:"or";return this.url.searchParams.append(o,`(${n})`),this}filter(n,a,i){return this.url.searchParams.append(n,`${a}.${i}`),this}}return hs.default=t,hs}var ka;function Vi(){if(ka)return ds;ka=1;var s=ds&&ds.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(ds,"__esModule",{value:!0});const e=s(Wn());class t{constructor(n,{headers:a={},schema:i,fetch:o}){this.url=n,this.headers=a,this.schema=i,this.fetch=o}select(n,{head:a=!1,count:i}={}){const o=a?"HEAD":"GET";let l=!1;const u=(n??"*").split("").map(d=>/\s/.test(d)&&!l?"":(d==='"'&&(l=!l),d)).join("");return this.url.searchParams.set("select",u),i&&(this.headers.Prefer=`count=${i}`),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(n,{count:a,defaultToNull:i=!0}={}){const o="POST",l=[];if(this.headers.Prefer&&l.push(this.headers.Prefer),a&&l.push(`count=${a}`),i||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(n)){const u=n.reduce((d,h)=>d.concat(Object.keys(h)),[]);if(u.length>0){const d=[...new Set(u)].map(h=>`"${h}"`);this.url.searchParams.set("columns",d.join(","))}}return new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}upsert(n,{onConflict:a,ignoreDuplicates:i=!1,count:o,defaultToNull:l=!0}={}){const u="POST",d=[`resolution=${i?"ignore":"merge"}-duplicates`];if(a!==void 0&&this.url.searchParams.set("on_conflict",a),this.headers.Prefer&&d.push(this.headers.Prefer),o&&d.push(`count=${o}`),l||d.push("missing=default"),this.headers.Prefer=d.join(","),Array.isArray(n)){const h=n.reduce((f,p)=>f.concat(Object.keys(p)),[]);if(h.length>0){const f=[...new Set(h)].map(p=>`"${p}"`);this.url.searchParams.set("columns",f.join(","))}}return new e.default({method:u,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}update(n,{count:a}={}){const i="PATCH",o=[];return this.headers.Prefer&&o.push(this.headers.Prefer),a&&o.push(`count=${a}`),this.headers.Prefer=o.join(","),new e.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}delete({count:n}={}){const a="DELETE",i=[];return n&&i.push(`count=${n}`),this.headers.Prefer&&i.unshift(this.headers.Prefer),this.headers.Prefer=i.join(","),new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return ds.default=t,ds}var Ns={},Bs={},Sa;function pc(){return Sa||(Sa=1,Object.defineProperty(Bs,"__esModule",{value:!0}),Bs.version=void 0,Bs.version="0.0.0-automated"),Bs}var Ea;function gc(){if(Ea)return Ns;Ea=1,Object.defineProperty(Ns,"__esModule",{value:!0}),Ns.DEFAULT_HEADERS=void 0;const s=pc();return Ns.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${s.version}`},Ns}var xa;function _c(){if(xa)return us;xa=1;var s=us&&us.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(us,"__esModule",{value:!0});const e=s(Vi()),t=s(Wn()),r=gc();class n{constructor(i,{headers:o={},schema:l,fetch:u}={}){this.url=i,this.headers=Object.assign(Object.assign({},r.DEFAULT_HEADERS),o),this.schemaName=l,this.fetch=u}from(i){const o=new URL(`${this.url}/${i}`);return new e.default(o,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(i){return new n(this.url,{headers:this.headers,schema:i,fetch:this.fetch})}rpc(i,o={},{head:l=!1,get:u=!1,count:d}={}){let h;const f=new URL(`${this.url}/rpc/${i}`);let p;l||u?(h=l?"HEAD":"GET",Object.entries(o).filter(([k,_])=>_!==void 0).map(([k,_])=>[k,Array.isArray(_)?`{${_.join(",")}}`:`${_}`]).forEach(([k,_])=>{f.searchParams.append(k,_)})):(h="POST",p=o);const v=Object.assign({},this.headers);return d&&(v.Prefer=`count=${d}`),new t.default({method:h,url:f,headers:v,schema:this.schemaName,body:p,fetch:this.fetch,allowEmpty:!1})}}return us.default=n,us}var Ta;function mc(){if(Ta)return Be;Ta=1;var s=Be&&Be.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(Be,"__esModule",{value:!0}),Be.PostgrestError=Be.PostgrestBuilder=Be.PostgrestTransformBuilder=Be.PostgrestFilterBuilder=Be.PostgrestQueryBuilder=Be.PostgrestClient=void 0;const e=s(_c());Be.PostgrestClient=e.default;const t=s(Vi());Be.PostgrestQueryBuilder=t.default;const r=s(Wn());Be.PostgrestFilterBuilder=r.default;const n=s(Wi());Be.PostgrestTransformBuilder=n.default;const a=s(Fi());Be.PostgrestBuilder=a.default;const i=s(Bi());return Be.PostgrestError=i.default,Be.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:r.default,PostgrestTransformBuilder:n.default,PostgrestBuilder:a.default,PostgrestError:i.default},Be}var yc=mc();const wc=lc(yc),{PostgrestClient:bc,PostgrestQueryBuilder:mf,PostgrestFilterBuilder:yf,PostgrestTransformBuilder:wf,PostgrestBuilder:bf,PostgrestError:kf}=wc;let mn;typeof window>"u"?mn=require("ws"):mn=window.WebSocket;const kc="2.11.10",Sc={"X-Client-Info":`realtime-js/${kc}`},Ec="1.0.0",Hi=1e4,xc=1e3;var Ss;(function(s){s[s.connecting=0]="connecting",s[s.open=1]="open",s[s.closing=2]="closing",s[s.closed=3]="closed"})(Ss||(Ss={}));var Je;(function(s){s.closed="closed",s.errored="errored",s.joined="joined",s.joining="joining",s.leaving="leaving"})(Je||(Je={}));var dt;(function(s){s.close="phx_close",s.error="phx_error",s.join="phx_join",s.reply="phx_reply",s.leave="phx_leave",s.access_token="access_token"})(dt||(dt={}));var yn;(function(s){s.websocket="websocket"})(yn||(yn={}));var Gt;(function(s){s.Connecting="connecting",s.Open="open",s.Closing="closing",s.Closed="closed"})(Gt||(Gt={}));class Tc{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const n=t.getUint8(1),a=t.getUint8(2);let i=this.HEADER_LENGTH+2;const o=r.decode(e.slice(i,i+n));i=i+n;const l=r.decode(e.slice(i,i+a));i=i+a;const u=JSON.parse(r.decode(e.slice(i,e.byteLength)));return{ref:null,topic:o,event:l,payload:u}}}class Ji{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var je;(function(s){s.abstime="abstime",s.bool="bool",s.date="date",s.daterange="daterange",s.float4="float4",s.float8="float8",s.int2="int2",s.int4="int4",s.int4range="int4range",s.int8="int8",s.int8range="int8range",s.json="json",s.jsonb="jsonb",s.money="money",s.numeric="numeric",s.oid="oid",s.reltime="reltime",s.text="text",s.time="time",s.timestamp="timestamp",s.timestamptz="timestamptz",s.timetz="timetz",s.tsrange="tsrange",s.tstzrange="tstzrange"})(je||(je={}));const ja=(s,e,t={})=>{var r;const n=(r=t.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((a,i)=>(a[i]=jc(i,s,e,n),a),{})},jc=(s,e,t,r)=>{const n=e.find(o=>o.name===s),a=n==null?void 0:n.type,i=t[s];return a&&!r.includes(a)?Gi(a,i):wn(i)},Gi=(s,e)=>{if(s.charAt(0)==="_"){const t=s.slice(1,s.length);return Mc(e,t)}switch(s){case je.bool:return Oc(e);case je.float4:case je.float8:case je.int2:case je.int4:case je.int8:case je.numeric:case je.oid:return Ac(e);case je.json:case je.jsonb:return Pc(e);case je.timestamp:return Cc(e);case je.abstime:case je.date:case je.daterange:case je.int4range:case je.int8range:case je.money:case je.reltime:case je.text:case je.time:case je.timestamptz:case je.timetz:case je.tsrange:case je.tstzrange:return wn(e);default:return wn(e)}},wn=s=>s,Oc=s=>{switch(s){case"t":return!0;case"f":return!1;default:return s}},Ac=s=>{if(typeof s=="string"){const e=parseFloat(s);if(!Number.isNaN(e))return e}return s},Pc=s=>{if(typeof s=="string")try{return JSON.parse(s)}catch(e){return console.log(`JSON parse error: ${e}`),s}return s},Mc=(s,e)=>{if(typeof s!="string")return s;const t=s.length-1,r=s[t];if(s[0]==="{"&&r==="}"){let a;const i=s.slice(1,t);try{a=JSON.parse("["+i+"]")}catch{a=i?i.split(","):[]}return a.map(o=>Gi(e,o))}return s},Cc=s=>typeof s=="string"?s.replace(" ","T"):s,Ki=s=>{let e=s;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class tn{constructor(e,t,r={},n=Hi){this.channel=e,this.event=t,this.payload=r,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Oa;(function(s){s.SYNC="sync",s.JOIN="join",s.LEAVE="leave"})(Oa||(Oa={}));class Js{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},n=>{const{onJoin:a,onLeave:i,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Js.syncState(this.state,n,a,i),this.pendingDiffs.forEach(l=>{this.state=Js.syncDiff(this.state,l,a,i)}),this.pendingDiffs=[],o()}),this.channel._on(r.diff,{},n=>{const{onJoin:a,onLeave:i,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=Js.syncDiff(this.state,n,a,i),o())}),this.onJoin((n,a,i)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:a,newPresences:i})}),this.onLeave((n,a,i)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:a,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,n){const a=this.cloneDeep(e),i=this.transformState(t),o={},l={};return this.map(a,(u,d)=>{i[u]||(l[u]=d)}),this.map(i,(u,d)=>{const h=a[u];if(h){const f=d.map(_=>_.presence_ref),p=h.map(_=>_.presence_ref),v=d.filter(_=>p.indexOf(_.presence_ref)<0),k=h.filter(_=>f.indexOf(_.presence_ref)<0);v.length>0&&(o[u]=v),k.length>0&&(l[u]=k)}else o[u]=d}),this.syncDiff(a,{joins:o,leaves:l},r,n)}static syncDiff(e,t,r,n){const{joins:a,leaves:i}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),n||(n=()=>{}),this.map(a,(o,l)=>{var u;const d=(u=e[o])!==null&&u!==void 0?u:[];if(e[o]=this.cloneDeep(l),d.length>0){const h=e[o].map(p=>p.presence_ref),f=d.filter(p=>h.indexOf(p.presence_ref)<0);e[o].unshift(...f)}r(o,d,l)}),this.map(i,(o,l)=>{let u=e[o];if(!u)return;const d=l.map(h=>h.presence_ref);u=u.filter(h=>d.indexOf(h.presence_ref)<0),e[o]=u,n(o,u,l),u.length===0&&delete e[o]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const n=e[r];return"metas"in n?t[r]=n.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):t[r]=n,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Aa;(function(s){s.ALL="*",s.INSERT="INSERT",s.UPDATE="UPDATE",s.DELETE="DELETE"})(Aa||(Aa={}));var Pa;(function(s){s.BROADCAST="broadcast",s.PRESENCE="presence",s.POSTGRES_CHANGES="postgres_changes",s.SYSTEM="system"})(Pa||(Pa={}));var xt;(function(s){s.SUBSCRIBED="SUBSCRIBED",s.TIMED_OUT="TIMED_OUT",s.CLOSED="CLOSED",s.CHANNEL_ERROR="CHANNEL_ERROR"})(xt||(xt={}));class Vn{constructor(e,t={config:{}},r){this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=Je.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new tn(this,dt.join,this.params,this.timeout),this.rejoinTimer=new Ji(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Je.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(n=>n.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Je.closed,this.socket._remove(this)}),this._onError(n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=Je.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Je.errored,this.rejoinTimer.scheduleTimeout())}),this._on(dt.reply,{},(n,a)=>{this._trigger(this._replyEventName(a),n)}),this.presence=new Js(this),this.broadcastEndpointURL=Ki(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var r,n;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:a,presence:i,private:o}}=this.params;this._onError(d=>e==null?void 0:e(xt.CHANNEL_ERROR,d)),this._onClose(()=>e==null?void 0:e(xt.CLOSED));const l={},u={broadcast:a,presence:i,postgres_changes:(n=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(d=>d.filter))!==null&&n!==void 0?n:[],private:o};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:u},l)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:d})=>{var h;if(this.socket.setAuth(),d===void 0){e==null||e(xt.SUBSCRIBED);return}else{const f=this.bindings.postgres_changes,p=(h=f==null?void 0:f.length)!==null&&h!==void 0?h:0,v=[];for(let k=0;k<p;k++){const _=f[k],{filter:{event:O,schema:C,table:T,filter:E}}=_,x=d&&d[k];if(x&&x.event===O&&x.schema===C&&x.table===T&&x.filter===E)v.push(Object.assign(Object.assign({},_),{id:x.id}));else{this.unsubscribe(),this.state=Je.errored,e==null||e(xt.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=v,e&&e(xt.SUBSCRIBED);return}}).receive("error",d=>{this.state=Je.errored,e==null||e(xt.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(d).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(xt.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this._on(e,t,r)}async send(e,t={}){var r,n;if(!this._canPush()&&e.type==="broadcast"){const{event:a,payload:i}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:i,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(r=t.timeout)!==null&&r!==void 0?r:this.timeout);return await((n=u.body)===null||n===void 0?void 0:n.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var i,o,l;const u=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(o=(i=this.params)===null||i===void 0?void 0:i.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&a("ok"),u.receive("ok",()=>a("ok")),u.receive("error",()=>a("error")),u.receive("timeout",()=>a("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Je.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(dt.close,"leave",this._joinRef())};return this.joinPush.destroy(),new Promise(r=>{const n=new tn(this,dt.leave,{},e);n.receive("ok",()=>{t(),r("ok")}).receive("timeout",()=>{t(),r("timed out")}).receive("error",()=>{r("error")}),n.send(),this._canPush()||n.trigger("ok",{})})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,t,r){const n=new AbortController,a=setTimeout(()=>n.abort(),r),i=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:n.signal}));return clearTimeout(a),i}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new tn(this,e,t,r);return this._canPush()?n.send():(n.startTimeout(),this.pushBuffer.push(n)),n}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var n,a;const i=e.toLocaleLowerCase(),{close:o,error:l,leave:u,join:d}=dt;if(r&&[o,l,u,d].indexOf(i)>=0&&r!==this._joinRef())return;let f=this._onMessage(i,t,r);if(t&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(p=>{var v,k,_;return((v=p.filter)===null||v===void 0?void 0:v.event)==="*"||((_=(k=p.filter)===null||k===void 0?void 0:k.event)===null||_===void 0?void 0:_.toLocaleLowerCase())===i}).map(p=>p.callback(f,r)):(a=this.bindings[i])===null||a===void 0||a.filter(p=>{var v,k,_,O,C,T;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in p){const E=p.id,x=(v=p.filter)===null||v===void 0?void 0:v.event;return E&&((k=t.ids)===null||k===void 0?void 0:k.includes(E))&&(x==="*"||(x==null?void 0:x.toLocaleLowerCase())===((_=t.data)===null||_===void 0?void 0:_.type.toLocaleLowerCase()))}else{const E=(C=(O=p==null?void 0:p.filter)===null||O===void 0?void 0:O.event)===null||C===void 0?void 0:C.toLocaleLowerCase();return E==="*"||E===((T=t==null?void 0:t.event)===null||T===void 0?void 0:T.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===i}).map(p=>{if(typeof f=="object"&&"ids"in f){const v=f.data,{schema:k,table:_,commit_timestamp:O,type:C,errors:T}=v;f=Object.assign(Object.assign({},{schema:k,table:_,commit_timestamp:O,eventType:C,new:{},old:{},errors:T}),this._getPayloadRecords(v))}p.callback(f,r)})}_isClosed(){return this.state===Je.closed}_isJoined(){return this.state===Je.joined}_isJoining(){return this.state===Je.joining}_isLeaving(){return this.state===Je.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const n=e.toLocaleLowerCase(),a={type:n,filter:t,callback:r};return this.bindings[n]?this.bindings[n].push(a):this.bindings[n]=[a],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(n=>{var a;return!(((a=n.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===r&&Vn.isEqual(n.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(dt.close,{},e)}_onError(e){this._on(dt.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Je.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=ja(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=ja(e.columns,e.old_record)),t}}const Ma=()=>{},Ic=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class $c{constructor(e,t){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers=Sc,this.params={},this.timeout=Hi,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Ma,this.ref=0,this.logger=Ma,this.conn=null,this.sendBuffer=[],this.serializer=new Tc,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=a=>{let i;return a?i=a:typeof fetch>"u"?i=(...o)=>fr(async()=>{const{default:l}=await Promise.resolve().then(()=>Ds);return{default:l}},void 0).then(({default:l})=>l(...o)):i=fetch,(...o)=>i(...o)},this.endPoint=`${e}/${yn.websocket}`,this.httpEndpoint=Ki(e),t!=null&&t.transport?this.transport=t.transport:this.transport=null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.headers&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const n=(r=t==null?void 0:t.params)===null||r===void 0?void 0:r.apikey;if(n&&(this.accessTokenValue=n,this.apiKey=n),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:a=>[1e3,2e3,5e3,1e4][a-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(a,i)=>i(JSON.stringify(a)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Ji(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t==null?void 0:t.fetch),t!=null&&t.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(t==null?void 0:t.worker)||!1,this.workerUrl=t==null?void 0:t.workerUrl}this.accessToken=(t==null?void 0:t.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=mn),this.transport){typeof window<"u"&&this.transport===window.WebSocket?this.conn=new this.transport(this.endpointURL()):this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection();return}this.conn=new Rc(this.endpointURL(),void 0,{close:()=>{this.conn=null}})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Ec}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(r=>r.teardown()))}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels=this.channels.filter(r=>r._joinRef!==e._joinRef),this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Ss.connecting:return Gt.Connecting;case Ss.open:return Gt.Open;case Ss.closing:return Gt.Closing;default:return Gt.Closed}}isConnected(){return this.connectionState()===Gt.Open}channel(e,t={config:{}}){const r=`realtime:${e}`,n=this.getChannels().find(a=>a.topic===r);if(n)return n;{const a=new Vn(`realtime:${e}`,t,this);return this.channels.push(a),a}}push(e){const{topic:t,event:r,payload:n,ref:a}=e,i=()=>{this.encode(e,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${t} ${r} (${a})`,n),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(r=>{t&&r.updateJoinPayload({access_token:t,version:this.headers&&this.headers["X-Client-Info"]}),r.joinedOnce&&r._isJoined()&&r._push(dt.access_token,{access_token:t})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close(xc,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:r,event:n,payload:a,ref:i}=t;r==="phoenix"&&n==="phx_reply"&&this.heartbeatCallback(t.payload.status=="ok"?"ok":"error"),i&&i===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${a.status||""} ${r} ${n} ${i&&"("+i+")"||""}`,a),Array.from(this.channels).filter(o=>o._isMember(r)).forEach(o=>o._trigger(n,a,i)),this.stateChangeCallbacks.message.forEach(o=>o(t))})}_onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(dt.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const r=e.match(/\?/)?"&":"?",n=new URLSearchParams(t);return`${e}${r}${n}`}_workerObjectUrl(e){let t;if(e)t=e;else{const r=new Blob([Ic],{type:"application/javascript"});t=URL.createObjectURL(r)}return t}}class Rc{constructor(e,t,r){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=Ss.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=r.close}}class Hn extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Fe(s){return typeof s=="object"&&s!==null&&"__isStorageError"in s}class Dc extends Hn{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class bn extends Hn{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var Lc=function(s,e,t,r){function n(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(d){try{u(r.next(d))}catch(h){i(h)}}function l(d){try{u(r.throw(d))}catch(h){i(h)}}function u(d){d.done?a(d.value):n(d.value).then(o,l)}u((r=r.apply(s,e||[])).next())})};const Yi=s=>{let e;return s?e=s:typeof fetch>"u"?e=(...t)=>fr(async()=>{const{default:r}=await Promise.resolve().then(()=>Ds);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},Uc=()=>Lc(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield fr(()=>Promise.resolve().then(()=>Ds),void 0)).Response:Response}),kn=s=>{if(Array.isArray(s))return s.map(t=>kn(t));if(typeof s=="function"||s!==Object(s))return s;const e={};return Object.entries(s).forEach(([t,r])=>{const n=t.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));e[n]=kn(r)}),e};var os=function(s,e,t,r){function n(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(d){try{u(r.next(d))}catch(h){i(h)}}function l(d){try{u(r.throw(d))}catch(h){i(h)}}function u(d){d.done?a(d.value):n(d.value).then(o,l)}u((r=r.apply(s,e||[])).next())})};const sn=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),zc=(s,e,t)=>os(void 0,void 0,void 0,function*(){const r=yield Uc();s instanceof r&&!(t!=null&&t.noResolveJson)?s.json().then(n=>{e(new Dc(sn(n),s.status||500))}).catch(n=>{e(new bn(sn(n),n))}):e(new bn(sn(s),s))}),qc=(s,e,t,r)=>{const n={method:s,headers:(e==null?void 0:e.headers)||{}};return s==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),r&&(n.body=JSON.stringify(r)),Object.assign(Object.assign({},n),t))};function vr(s,e,t,r,n,a){return os(this,void 0,void 0,function*(){return new Promise((i,o)=>{s(t,qc(e,r,n,a)).then(l=>{if(!l.ok)throw l;return r!=null&&r.noResolveJson?l:l.json()}).then(l=>i(l)).catch(l=>zc(l,o,r))})})}function Ir(s,e,t,r){return os(this,void 0,void 0,function*(){return vr(s,"GET",e,t,r)})}function $t(s,e,t,r,n){return os(this,void 0,void 0,function*(){return vr(s,"POST",e,r,n,t)})}function Nc(s,e,t,r,n){return os(this,void 0,void 0,function*(){return vr(s,"PUT",e,r,n,t)})}function Bc(s,e,t,r){return os(this,void 0,void 0,function*(){return vr(s,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),r)})}function Qi(s,e,t,r,n){return os(this,void 0,void 0,function*(){return vr(s,"DELETE",e,r,n,t)})}var Ze=function(s,e,t,r){function n(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(d){try{u(r.next(d))}catch(h){i(h)}}function l(d){try{u(r.throw(d))}catch(h){i(h)}}function u(d){d.done?a(d.value):n(d.value).then(o,l)}u((r=r.apply(s,e||[])).next())})};const Fc={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Ca={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Wc{constructor(e,t={},r,n){this.url=e,this.headers=t,this.bucketId=r,this.fetch=Yi(n)}uploadOrUpdate(e,t,r,n){return Ze(this,void 0,void 0,function*(){try{let a;const i=Object.assign(Object.assign({},Ca),n);let o=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(i.upsert)});const l=i.metadata;typeof Blob<"u"&&r instanceof Blob?(a=new FormData,a.append("cacheControl",i.cacheControl),l&&a.append("metadata",this.encodeMetadata(l)),a.append("",r)):typeof FormData<"u"&&r instanceof FormData?(a=r,a.append("cacheControl",i.cacheControl),l&&a.append("metadata",this.encodeMetadata(l))):(a=r,o["cache-control"]=`max-age=${i.cacheControl}`,o["content-type"]=i.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),n!=null&&n.headers&&(o=Object.assign(Object.assign({},o),n.headers));const u=this._removeEmptyFolders(t),d=this._getFinalPath(u),h=yield this.fetch(`${this.url}/object/${d}`,Object.assign({method:e,body:a,headers:o},i!=null&&i.duplex?{duplex:i.duplex}:{})),f=yield h.json();return h.ok?{data:{path:u,id:f.Id,fullPath:f.Key},error:null}:{data:null,error:f}}catch(a){if(Fe(a))return{data:null,error:a};throw a}})}upload(e,t,r){return Ze(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,n){return Ze(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(e),i=this._getFinalPath(a),o=new URL(this.url+`/object/upload/sign/${i}`);o.searchParams.set("token",t);try{let l;const u=Object.assign({upsert:Ca.upsert},n),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",u.cacheControl),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",u.cacheControl)):(l=r,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType);const h=yield this.fetch(o.toString(),{method:"PUT",body:l,headers:d}),f=yield h.json();return h.ok?{data:{path:a,fullPath:f.Key},error:null}:{data:null,error:f}}catch(l){if(Fe(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,t){return Ze(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const n=Object.assign({},this.headers);t!=null&&t.upsert&&(n["x-upsert"]="true");const a=yield $t(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:n}),i=new URL(this.url+a.url),o=i.searchParams.get("token");if(!o)throw new Hn("No token returned by API");return{data:{signedUrl:i.toString(),path:e,token:o},error:null}}catch(r){if(Fe(r))return{data:null,error:r};throw r}})}update(e,t,r){return Ze(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return Ze(this,void 0,void 0,function*(){try{return{data:yield $t(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(Fe(n))return{data:null,error:n};throw n}})}copy(e,t,r){return Ze(this,void 0,void 0,function*(){try{return{data:{path:(yield $t(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(Fe(n))return{data:null,error:n};throw n}})}createSignedUrl(e,t,r){return Ze(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e),a=yield $t(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${i}`)},{data:a,error:null}}catch(n){if(Fe(n))return{data:null,error:n};throw n}})}createSignedUrls(e,t,r){return Ze(this,void 0,void 0,function*(){try{const n=yield $t(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),a=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:n.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${a}`):null})),error:null}}catch(n){if(Fe(n))return{data:null,error:n};throw n}})}download(e,t){return Ze(this,void 0,void 0,function*(){const n=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),i=a?`?${a}`:"";try{const o=this._getFinalPath(e);return{data:yield(yield Ir(this.fetch,`${this.url}/${n}/${o}${i}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(Fe(o))return{data:null,error:o};throw o}})}info(e){return Ze(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const r=yield Ir(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:kn(r),error:null}}catch(r){if(Fe(r))return{data:null,error:r};throw r}})}exists(e){return Ze(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield Bc(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(Fe(r)&&r instanceof bn){const n=r.originalError;if([400,404].includes(n==null?void 0:n.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,t){const r=this._getFinalPath(e),n=[],a=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";a!==""&&n.push(a);const o=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});l!==""&&n.push(l);let u=n.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${r}${u}`)}}}remove(e){return Ze(this,void 0,void 0,function*(){try{return{data:yield Qi(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(Fe(t))return{data:null,error:t};throw t}})}list(e,t,r){return Ze(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},Fc),t),{prefix:e||""});return{data:yield $t(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(Fe(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const Vc="2.7.1",Hc={"X-Client-Info":`storage-js/${Vc}`};var ps=function(s,e,t,r){function n(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(d){try{u(r.next(d))}catch(h){i(h)}}function l(d){try{u(r.throw(d))}catch(h){i(h)}}function u(d){d.done?a(d.value):n(d.value).then(o,l)}u((r=r.apply(s,e||[])).next())})};class Jc{constructor(e,t={},r){this.url=e,this.headers=Object.assign(Object.assign({},Hc),t),this.fetch=Yi(r)}listBuckets(){return ps(this,void 0,void 0,function*(){try{return{data:yield Ir(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Fe(e))return{data:null,error:e};throw e}})}getBucket(e){return ps(this,void 0,void 0,function*(){try{return{data:yield Ir(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(Fe(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return ps(this,void 0,void 0,function*(){try{return{data:yield $t(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Fe(r))return{data:null,error:r};throw r}})}updateBucket(e,t){return ps(this,void 0,void 0,function*(){try{return{data:yield Nc(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Fe(r))return{data:null,error:r};throw r}})}emptyBucket(e){return ps(this,void 0,void 0,function*(){try{return{data:yield $t(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(Fe(t))return{data:null,error:t};throw t}})}deleteBucket(e){return ps(this,void 0,void 0,function*(){try{return{data:yield Qi(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(Fe(t))return{data:null,error:t};throw t}})}}class Gc extends Jc{constructor(e,t={},r){super(e,t,r)}from(e){return new Wc(this.url,this.headers,e,this.fetch)}}const Kc="2.50.0";let Ws="";typeof Deno<"u"?Ws="deno":typeof document<"u"?Ws="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ws="react-native":Ws="node";const Yc={"X-Client-Info":`supabase-js-${Ws}/${Kc}`},Qc={headers:Yc},Zc={schema:"public"},Xc={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},eu={};var tu=function(s,e,t,r){function n(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(d){try{u(r.next(d))}catch(h){i(h)}}function l(d){try{u(r.throw(d))}catch(h){i(h)}}function u(d){d.done?a(d.value):n(d.value).then(o,l)}u((r=r.apply(s,e||[])).next())})};const su=s=>{let e;return s?e=s:typeof fetch>"u"?e=qi:e=fetch,(...t)=>e(...t)},ru=()=>typeof Headers>"u"?Ni:Headers,nu=(s,e,t)=>{const r=su(t),n=ru();return(a,i)=>tu(void 0,void 0,void 0,function*(){var o;const l=(o=yield e())!==null&&o!==void 0?o:s;let u=new n(i==null?void 0:i.headers);return u.has("apikey")||u.set("apikey",s),u.has("Authorization")||u.set("Authorization",`Bearer ${l}`),r(a,Object.assign(Object.assign({},i),{headers:u}))})};var au=function(s,e,t,r){function n(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(d){try{u(r.next(d))}catch(h){i(h)}}function l(d){try{u(r.throw(d))}catch(h){i(h)}}function u(d){d.done?a(d.value):n(d.value).then(o,l)}u((r=r.apply(s,e||[])).next())})};function iu(s){return s.endsWith("/")?s:s+"/"}function ou(s,e){var t,r;const{db:n,auth:a,realtime:i,global:o}=s,{db:l,auth:u,realtime:d,global:h}=e,f={db:Object.assign(Object.assign({},l),n),auth:Object.assign(Object.assign({},u),a),realtime:Object.assign(Object.assign({},d),i),global:Object.assign(Object.assign(Object.assign({},h),o),{headers:Object.assign(Object.assign({},(t=h==null?void 0:h.headers)!==null&&t!==void 0?t:{}),(r=o==null?void 0:o.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>au(this,void 0,void 0,function*(){return""})};return s.accessToken?f.accessToken=s.accessToken:delete f.accessToken,f}const Zi="2.70.0",ws=30*1e3,Sn=3,rn=Sn*ws,lu="http://localhost:9999",cu="supabase.auth.token",uu={"X-Client-Info":`gotrue-js/${Zi}`},En="X-Supabase-Api-Version",Xi={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},du=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,hu=6e5;class Jn extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function oe(s){return typeof s=="object"&&s!==null&&"__isAuthError"in s}class fu extends Jn{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}function vu(s){return oe(s)&&s.name==="AuthApiError"}class eo extends Jn{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Ft extends Jn{constructor(e,t,r,n){super(e,r,n),this.name=t,this.status=r}}class It extends Ft{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function pu(s){return oe(s)&&s.name==="AuthSessionMissingError"}class yr extends Ft{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class wr extends Ft{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class br extends Ft{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function gu(s){return oe(s)&&s.name==="AuthImplicitGrantRedirectError"}class Ia extends Ft{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class xn extends Ft{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function nn(s){return oe(s)&&s.name==="AuthRetryableFetchError"}class $a extends Ft{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class Gs extends Ft{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const $r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Ra=` 	
\r=`.split(""),_u=(()=>{const s=new Array(128);for(let e=0;e<s.length;e+=1)s[e]=-1;for(let e=0;e<Ra.length;e+=1)s[Ra[e].charCodeAt(0)]=-2;for(let e=0;e<$r.length;e+=1)s[$r[e].charCodeAt(0)]=e;return s})();function Da(s,e,t){if(s!==null)for(e.queue=e.queue<<8|s,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t($r[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t($r[r]),e.queuedBits-=6}}function to(s,e,t){const r=_u[s];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(s)}"`)}}function La(s){const e=[],t=i=>{e.push(String.fromCodePoint(i))},r={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},a=i=>{wu(i,r,t)};for(let i=0;i<s.length;i+=1)to(s.charCodeAt(i),n,a);return e.join("")}function mu(s,e){if(s<=127){e(s);return}else if(s<=2047){e(192|s>>6),e(128|s&63);return}else if(s<=65535){e(224|s>>12),e(128|s>>6&63),e(128|s&63);return}else if(s<=1114111){e(240|s>>18),e(128|s>>12&63),e(128|s>>6&63),e(128|s&63);return}throw new Error(`Unrecognized Unicode codepoint: ${s.toString(16)}`)}function yu(s,e){for(let t=0;t<s.length;t+=1){let r=s.charCodeAt(t);if(r>55295&&r<=56319){const n=(r-55296)*1024&65535;r=(s.charCodeAt(t+1)-56320&65535|n)+65536,t+=1}mu(r,e)}}function wu(s,e,t){if(e.utf8seq===0){if(s<=127){t(s);return}for(let r=1;r<6;r+=1)if((s>>7-r&1)===0){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=s&31;else if(e.utf8seq===3)e.codepoint=s&15;else if(e.utf8seq===4)e.codepoint=s&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(s<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|s&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function bu(s){const e=[],t={queue:0,queuedBits:0},r=n=>{e.push(n)};for(let n=0;n<s.length;n+=1)to(s.charCodeAt(n),t,r);return new Uint8Array(e)}function ku(s){const e=[];return yu(s,t=>e.push(t)),new Uint8Array(e)}function Su(s){const e=[],t={queue:0,queuedBits:0},r=n=>{e.push(n)};return s.forEach(n=>Da(n,t,r)),Da(null,t,r),e.join("")}function Eu(s){return Math.round(Date.now()/1e3)+s}function xu(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(s){const e=Math.random()*16|0;return(s=="x"?e:e&3|8).toString(16)})}const ut=()=>typeof window<"u"&&typeof document<"u",Ht={tested:!1,writable:!1},Ks=()=>{if(!ut())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ht.tested)return Ht.writable;const s=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(s,s),globalThis.localStorage.removeItem(s),Ht.tested=!0,Ht.writable=!0}catch{Ht.tested=!0,Ht.writable=!1}return Ht.writable};function Tu(s){const e={},t=new URL(s);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((n,a)=>{e[a]=n})}catch{}return t.searchParams.forEach((r,n)=>{e[n]=r}),e}const so=s=>{let e;return s?e=s:typeof fetch>"u"?e=(...t)=>fr(async()=>{const{default:r}=await Promise.resolve().then(()=>Ds);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},ju=s=>typeof s=="object"&&s!==null&&"status"in s&&"ok"in s&&"json"in s&&typeof s.json=="function",ro=async(s,e,t)=>{await s.setItem(e,JSON.stringify(t))},kr=async(s,e)=>{const t=await s.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Sr=async(s,e)=>{await s.removeItem(e)};class Hr{constructor(){this.promise=new Hr.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Hr.promiseConstructor=Promise;function an(s){const e=s.split(".");if(e.length!==3)throw new Gs("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!du.test(e[r]))throw new Gs("JWT not in base64url format");return{header:JSON.parse(La(e[0])),payload:JSON.parse(La(e[1])),signature:bu(e[2]),raw:{header:e[0],payload:e[1]}}}async function Ou(s){return await new Promise(e=>{setTimeout(()=>e(null),s)})}function Au(s,e){return new Promise((r,n)=>{(async()=>{for(let a=0;a<1/0;a++)try{const i=await s(a);if(!e(a,null,i)){r(i);return}}catch(i){if(!e(a,i)){n(i);return}}})()})}function Pu(s){return("0"+s.toString(16)).substr(-2)}function Mu(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=t.length;let n="";for(let a=0;a<56;a++)n+=t.charAt(Math.floor(Math.random()*r));return n}return crypto.getRandomValues(e),Array.from(e,Pu).join("")}async function Cu(s){const t=new TextEncoder().encode(s),r=await crypto.subtle.digest("SHA-256",t),n=new Uint8Array(r);return Array.from(n).map(a=>String.fromCharCode(a)).join("")}async function Iu(s){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),s;const t=await Cu(s);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function gs(s,e,t=!1){const r=Mu();let n=r;t&&(n+="/PASSWORD_RECOVERY"),await ro(s,`${e}-code-verifier`,n);const a=await Iu(r);return[a,r===a?"plain":"s256"]}const $u=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Ru(s){const e=s.headers.get(En);if(!e||!e.match($u))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Du(s){if(!s)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(s<=e)throw new Error("JWT has expired")}function Lu(s){switch(s){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Uu=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function _s(s){if(!Uu.test(s))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}var zu=function(s,e){var t={};for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&e.indexOf(r)<0&&(t[r]=s[r]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(s);n<r.length;n++)e.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(s,r[n])&&(t[r[n]]=s[r[n]]);return t};const Jt=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),qu=[502,503,504];async function Ua(s){var e;if(!ju(s))throw new xn(Jt(s),0);if(qu.includes(s.status))throw new xn(Jt(s),s.status);let t;try{t=await s.json()}catch(a){throw new eo(Jt(a),a)}let r;const n=Ru(s);if(n&&n.getTime()>=Xi["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?r=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(r=t.error_code),r){if(r==="weak_password")throw new $a(Jt(t),s.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new It}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((a,i)=>a&&typeof i=="string",!0))throw new $a(Jt(t),s.status,t.weak_password.reasons);throw new fu(Jt(t),s.status||500,r)}const Nu=(s,e,t,r)=>{const n={method:s,headers:(e==null?void 0:e.headers)||{}};return s==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),n.body=JSON.stringify(r),Object.assign(Object.assign({},n),t))};async function he(s,e,t,r){var n;const a=Object.assign({},r==null?void 0:r.headers);a[En]||(a[En]=Xi["2024-01-01"].name),r!=null&&r.jwt&&(a.Authorization=`Bearer ${r.jwt}`);const i=(n=r==null?void 0:r.query)!==null&&n!==void 0?n:{};r!=null&&r.redirectTo&&(i.redirect_to=r.redirectTo);const o=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",l=await Bu(s,e,t+o,{headers:a,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(l):{data:Object.assign({},l),error:null}}async function Bu(s,e,t,r,n,a){const i=Nu(e,r,n,a);let o;try{o=await s(t,Object.assign({},i))}catch(l){throw console.error(l),new xn(Jt(l),0)}if(o.ok||await Ua(o),r!=null&&r.noResolveJson)return o;try{return await o.json()}catch(l){await Ua(l)}}function St(s){var e;let t=null;Hu(s)&&(t=Object.assign({},s),s.expires_at||(t.expires_at=Eu(s.expires_in)));const r=(e=s.user)!==null&&e!==void 0?e:s;return{data:{session:t,user:r},error:null}}function za(s){const e=St(s);return!e.error&&s.weak_password&&typeof s.weak_password=="object"&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.message&&typeof s.weak_password.message=="string"&&s.weak_password.reasons.reduce((t,r)=>t&&typeof r=="string",!0)&&(e.data.weak_password=s.weak_password),e}function Rt(s){var e;return{data:{user:(e=s.user)!==null&&e!==void 0?e:s},error:null}}function Fu(s){return{data:s,error:null}}function Wu(s){const{action_link:e,email_otp:t,hashed_token:r,redirect_to:n,verification_type:a}=s,i=zu(s,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:e,email_otp:t,hashed_token:r,redirect_to:n,verification_type:a},l=Object.assign({},i);return{data:{properties:o,user:l},error:null}}function Vu(s){return s}function Hu(s){return s.access_token&&s.refresh_token&&s.expires_in}const on=["global","local","others"];var Ju=function(s,e){var t={};for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&e.indexOf(r)<0&&(t[r]=s[r]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(s);n<r.length;n++)e.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(s,r[n])&&(t[r[n]]=s[r[n]]);return t};class Gu{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=so(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=on[0]){if(on.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${on.join(", ")}`);try{return await he(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(oe(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await he(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Rt})}catch(r){if(oe(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=Ju(e,["options"]),n=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(n.new_email=r==null?void 0:r.newEmail,delete n.newEmail),await he(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:Wu,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(oe(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await he(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Rt})}catch(t){if(oe(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,n,a,i,o,l;try{const u={nextPage:null,lastPage:0,total:0},d=await he(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(a=(n=e==null?void 0:e.perPage)===null||n===void 0?void 0:n.toString())!==null&&a!==void 0?a:""},xform:Vu});if(d.error)throw d.error;const h=await d.json(),f=(i=d.headers.get("x-total-count"))!==null&&i!==void 0?i:0,p=(l=(o=d.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(v=>{const k=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(v.split(";")[1].split("=")[1]);u[`${_}Page`]=k}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(oe(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){_s(e);try{return await he(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Rt})}catch(t){if(oe(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){_s(e);try{return await he(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Rt})}catch(r){if(oe(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){_s(e);try{return await he(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Rt})}catch(r){if(oe(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){_s(e.userId);try{const{data:t,error:r}=await he(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:t,error:r}}catch(t){if(oe(t))return{data:null,error:t};throw t}}async _deleteFactor(e){_s(e.userId),_s(e.id);try{return{data:await he(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(oe(t))return{data:null,error:t};throw t}}}const Ku={getItem:s=>Ks()?globalThis.localStorage.getItem(s):null,setItem:(s,e)=>{Ks()&&globalThis.localStorage.setItem(s,e)},removeItem:s=>{Ks()&&globalThis.localStorage.removeItem(s)}};function qa(s={}){return{getItem:e=>s[e]||null,setItem:(e,t)=>{s[e]=t},removeItem:e=>{delete s[e]}}}function Yu(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const ms={debug:!!(globalThis&&Ks()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class no extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Qu extends no{}async function Zu(s,e,t){ms.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",s,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),ms.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",s)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(s,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async n=>{if(n){ms.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",s,n.name);try{return await t()}finally{ms.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",s,n.name)}}else{if(e===0)throw ms.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",s),new Qu(`Acquiring an exclusive Navigator LockManager lock "${s}" immediately failed`);if(ms.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}Yu();const Xu={url:lu,storageKey:cu,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:uu,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Na(s,e,t){return await t()}class tr{constructor(e){var t,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=tr.nextInstanceID,tr.nextInstanceID+=1,this.instanceID>0&&ut()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},Xu),e);if(this.logDebugMessages=!!n.debug,typeof n.debug=="function"&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new Gu({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=so(n.fetch),this.lock=n.lock||Na,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:ut()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=Zu:this.lock=Na,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?n.storage?this.storage=n.storage:Ks()?this.storage=Ku:(this.memoryStorage={},this.storage=qa(this.memoryStorage)):(this.memoryStorage={},this.storage=qa(this.memoryStorage)),ut()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Zi}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=Tu(window.location.href);let r="none";if(this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce"),ut()&&this.detectSessionInUrl&&r!=="none"){const{data:n,error:a}=await this._getSessionFromURL(t,r);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),gu(a)){const l=(e=a.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:i,redirectType:o}=n;return this._debug("#_initialize()","detected session in URL",i,"redirect type",o),await this._saveSession(i),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return oe(t)?{error:t}:{error:new eo("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,n;try{const a=await he(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.captchaToken}},xform:St}),{data:i,error:o}=a;if(o||!i)return{data:{user:null,session:null},error:o};const l=i.session,u=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(a){if(oe(a))return{data:{user:null,session:null},error:a};throw a}}async signUp(e){var t,r,n;try{let a;if("email"in e){const{email:d,password:h,options:f}=e;let p=null,v=null;this.flowType==="pkce"&&([p,v]=await gs(this.storage,this.storageKey)),a=await he(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:d,password:h,data:(t=f==null?void 0:f.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:p,code_challenge_method:v},xform:St})}else if("phone"in e){const{phone:d,password:h,options:f}=e;a=await he(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:h,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},channel:(n=f==null?void 0:f.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:St})}else throw new wr("You must provide either an email or phone number and a password");const{data:i,error:o}=a;if(o||!i)return{data:{user:null,session:null},error:o};const l=i.session,u=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(a){if(oe(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithPassword(e){try{let t;if("email"in e){const{email:a,password:i,options:o}=e;t=await he(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:za})}else if("phone"in e){const{phone:a,password:i,options:o}=e;t=await he(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:za})}else throw new wr("You must provide either an email or phone number and a password");const{data:r,error:n}=t;return n?{data:{user:null,session:null},error:n}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new yr}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:n})}catch(t){if(oe(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,r,n,a;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(a=e.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if(t==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,r,n,a,i,o,l,u,d,h,f,p;let v,k;if("message"in e)v=e.message,k=e.signature;else{const{chain:_,wallet:O,statement:C,options:T}=e;let E;if(ut())if(typeof O=="object")E=O;else{const S=window;if("solana"in S&&typeof S.solana=="object"&&("signIn"in S.solana&&typeof S.solana.signIn=="function"||"signMessage"in S.solana&&typeof S.solana.signMessage=="function"))E=S.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof O!="object"||!(T!=null&&T.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");E=O}const x=new URL((t=T==null?void 0:T.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in E&&E.signIn){const S=await E.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},T==null?void 0:T.signInWithSolana),{version:"1",domain:x.host,uri:x.href}),C?{statement:C}:null));let A;if(Array.isArray(S)&&S[0]&&typeof S[0]=="object")A=S[0];else if(S&&typeof S=="object"&&"signedMessage"in S&&"signature"in S)A=S;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in A&&"signature"in A&&(typeof A.signedMessage=="string"||A.signedMessage instanceof Uint8Array)&&A.signature instanceof Uint8Array)v=typeof A.signedMessage=="string"?A.signedMessage:new TextDecoder().decode(A.signedMessage),k=A.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in E)||typeof E.signMessage!="function"||!("publicKey"in E)||typeof E!="object"||!E.publicKey||!("toBase58"in E.publicKey)||typeof E.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");v=[`${x.host} wants you to sign in with your Solana account:`,E.publicKey.toBase58(),...C?["",C,""]:[""],"Version: 1",`URI: ${x.href}`,`Issued At: ${(n=(r=T==null?void 0:T.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((a=T==null?void 0:T.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${T.signInWithSolana.notBefore}`]:[],...!((i=T==null?void 0:T.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${T.signInWithSolana.expirationTime}`]:[],...!((o=T==null?void 0:T.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${T.signInWithSolana.chainId}`]:[],...!((l=T==null?void 0:T.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${T.signInWithSolana.nonce}`]:[],...!((u=T==null?void 0:T.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${T.signInWithSolana.requestId}`]:[],...!((h=(d=T==null?void 0:T.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||h===void 0)&&h.length?["Resources",...T.signInWithSolana.resources.map(A=>`- ${A}`)]:[]].join(`
`);const S=await E.signMessage(new TextEncoder().encode(v),"utf8");if(!S||!(S instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");k=S}}try{const{data:_,error:O}=await he(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:v,signature:Su(k)},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(p=e.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:St});if(O)throw O;return!_||!_.session||!_.user?{data:{user:null,session:null},error:new yr}:(_.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),{data:Object.assign({},_),error:O})}catch(_){if(oe(_))return{data:{user:null,session:null},error:_};throw _}}async _exchangeCodeForSession(e){const t=await kr(this.storage,`${this.storageKey}-code-verifier`),[r,n]=(t??"").split("/");try{const{data:a,error:i}=await he(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:St});if(await Sr(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return!a||!a.session||!a.user?{data:{user:null,session:null,redirectType:null},error:new yr}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign(Object.assign({},a),{redirectType:n??null}),error:i})}catch(a){if(oe(a))return{data:{user:null,session:null,redirectType:null},error:a};throw a}}async signInWithIdToken(e){try{const{options:t,provider:r,token:n,access_token:a,nonce:i}=e,o=await he(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:n,access_token:a,nonce:i,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:St}),{data:l,error:u}=o;return u?{data:{user:null,session:null},error:u}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new yr}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:u})}catch(t){if(oe(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,r,n,a,i;try{if("email"in e){const{email:o,options:l}=e;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await gs(this.storage,this.storageKey));const{error:h}=await he(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(t=l==null?void 0:l.data)!==null&&t!==void 0?t:{},create_user:(r=l==null?void 0:l.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:o,options:l}=e,{data:u,error:d}=await he(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(n=l==null?void 0:l.data)!==null&&n!==void 0?n:{},create_user:(a=l==null?void 0:l.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(i=l==null?void 0:l.channel)!==null&&i!==void 0?i:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:d}}throw new wr("You must provide either an email or phone number.")}catch(o){if(oe(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(e){var t,r;try{let n,a;"options"in e&&(n=(t=e.options)===null||t===void 0?void 0:t.redirectTo,a=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:i,error:o}=await he(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:n,xform:St});if(o)throw o;if(!i)throw new Error("An error occurred on token verification.");const l=i.session,u=i.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(n){if(oe(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(e){var t,r,n;try{let a=null,i=null;return this.flowType==="pkce"&&([a,i]=await gs(this.storage,this.storageKey)),await he(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&r!==void 0?r:void 0}),!((n=e==null?void 0:e.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:i}),headers:this.headers,xform:Fu})}catch(a){if(oe(a))return{data:null,error:a};throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new It;const{error:n}=await he(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:n}})}catch(e){if(oe(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:r,type:n,options:a}=e,{error:i}=await he(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:n,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},redirectTo:a==null?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:i}}else if("phone"in e){const{phone:r,type:n,options:a}=e,{data:i,error:o}=await he(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:n,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}}});return{data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:o}}throw new wr("You must provide either an email or phone number and a type")}catch(t){if(oe(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await r,await t()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=t();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await kr(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<rn:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.storage.isServer){let i=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,u,d)=>(!i&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),i=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,u,d))})}return{data:{session:e},error:null}}const{session:n,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{session:null},error:a}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await he(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Rt}):await this._useSession(async t=>{var r,n,a;const{data:i,error:o}=t;if(o)throw o;return!(!((r=i.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new It}:await he(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0,xform:Rt})})}catch(t){if(oe(t))return pu(t)&&(await this._removeSession(),await Sr(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:n,error:a}=r;if(a)throw a;if(!n.session)throw new It;const i=n.session;let o=null,l=null;this.flowType==="pkce"&&e.email!=null&&([o,l]=await gs(this.storage,this.storageKey));const{data:u,error:d}=await he(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:l}),jwt:i.access_token,xform:Rt});if(d)throw d;return i.user=u.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(r){if(oe(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new It;const t=Date.now()/1e3;let r=t,n=!0,a=null;const{payload:i}=an(e.access_token);if(i.exp&&(r=i.exp,n=r<=t),n){const{session:o,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};a=o}else{const{data:o,error:l}=await this._getUser(e.access_token);if(l)throw l;a={access_token:e.access_token,refresh_token:e.refresh_token,user:o.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(t){if(oe(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:i,error:o}=t;if(o)throw o;e=(r=i.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new It;const{session:n,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{user:null,session:null},error:a}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(oe(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!ut())throw new br("No browser detected.");if(e.error||e.error_description||e.error_code)throw new br(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new Ia("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new br("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Ia("No code detected.");const{data:C,error:T}=await this._exchangeCodeForSession(e.code);if(T)throw T;const E=new URL(window.location.href);return E.searchParams.delete("code"),window.history.replaceState(window.history.state,"",E.toString()),{data:{session:C.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:n,access_token:a,refresh_token:i,expires_in:o,expires_at:l,token_type:u}=e;if(!a||!o||!i||!u)throw new br("No session defined in URL");const d=Math.round(Date.now()/1e3),h=parseInt(o);let f=d+h;l&&(f=parseInt(l));const p=f-d;p*1e3<=ws&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${h}s`);const v=f-h;d-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,f,d):d-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,f,d);const{data:k,error:_}=await this._getUser(a);if(_)throw _;const O={provider_token:r,provider_refresh_token:n,access_token:a,expires_in:h,expires_at:f,refresh_token:i,token_type:u,user:k.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:O,redirectType:e.type},error:null}}catch(r){if(oe(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await kr(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:n,error:a}=t;if(a)return{error:a};const i=(r=n.session)===null||r===void 0?void 0:r.access_token;if(i){const{error:o}=await this.admin.signOut(i,e);if(o&&!(vu(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return e!=="others"&&(await this._removeSession(),await Sr(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=xu(),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,n;try{const{data:{session:a},error:i}=t;if(i)throw i;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",e,"session",a)}catch(a){await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a),console.error(a)}})}async resetPasswordForEmail(e,t={}){let r=null,n=null;this.flowType==="pkce"&&([r,n]=await gs(this.storage,this.storageKey,!0));try{return await he(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:n,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(a){if(oe(a))return{data:null,error:a};throw a}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(oe(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:r,error:n}=await this._useSession(async a=>{var i,o,l,u,d;const{data:h,error:f}=a;if(f)throw f;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(i=e.options)===null||i===void 0?void 0:i.redirectTo,scopes:(o=e.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await he(this.fetch,"GET",p,{headers:this.headers,jwt:(d=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(n)throw n;return ut()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(oe(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,n;const{data:a,error:i}=t;if(i)throw i;return await he(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(r=a.session)===null||r===void 0?void 0:r.access_token)!==null&&n!==void 0?n:void 0})})}catch(t){if(oe(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const r=Date.now();return await Au(async n=>(n>0&&await Ou(200*Math.pow(2,n-1)),this._debug(t,"refreshing attempt",n),await he(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:St})),(n,a)=>{const i=200*Math.pow(2,n);return a&&nn(a)&&Date.now()+i-r<ws})}catch(r){if(this._debug(t,"error",r),oe(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),ut()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const r=await kr(this.storage,this.storageKey);if(this._debug(t,"session from storage",r),!this._isValidSession(r)){this._debug(t,"session is not valid"),r!==null&&await this._removeSession();return}const n=((e=r.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<rn;if(this._debug(t,`session has${n?"":" not"} expired with margin of ${rn}s`),n){if(this.autoRefreshToken&&r.refresh_token){const{error:a}=await this._callRefreshToken(r.refresh_token);a&&(console.error(a),nn(a)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(t,"error",r),console.error(r);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new It;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new Hr;const{data:a,error:i}=await this._refreshAccessToken(e);if(i)throw i;if(!a.session)throw new It;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const o={session:a.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(a){if(this._debug(n,"error",a),oe(a)){const i={session:null,error:a};return nn(a)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(i),i}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(a),a}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,t,r=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const a=[],i=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(e,t)}catch(l){a.push(l)}});if(await Promise.all(i),a.length>0){for(let o=0;o<a.length;o+=1)console.error(a[o]);throw a[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await ro(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await Sr(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&ut()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),ws);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((r.expires_at*1e3-e)/ws);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${ws}ms, refresh threshold is ${Sn} ticks`),n<=Sn&&await this._callRefreshToken(r.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof no)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ut()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const n=[`provider=${encodeURIComponent(t)}`];if(r!=null&&r.redirectTo&&n.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&n.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[a,i]=await gs(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(i)}`});n.push(o.toString())}if(r!=null&&r.queryParams){const a=new URLSearchParams(r.queryParams);n.push(a.toString())}return r!=null&&r.skipBrowserRedirect&&n.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:n,error:a}=t;return a?{data:null,error:a}:await he(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=n==null?void 0:n.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(oe(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,n;const{data:a,error:i}=t;if(i)return{data:null,error:i};const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:u}=await he(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token});return u?{data:null,error:u}:(e.factorType==="totp"&&(!((n=l==null?void 0:l.totp)===null||n===void 0)&&n.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(t){if(oe(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:n,error:a}=t;if(a)return{data:null,error:a};const{data:i,error:o}=await he(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=n==null?void 0:n.session)===null||r===void 0?void 0:r.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:o})})}catch(t){if(oe(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:n,error:a}=t;return a?{data:null,error:a}:await he(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=n==null?void 0:n.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(oe(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const r=(e==null?void 0:e.factors)||[],n=r.filter(i=>i.factor_type==="totp"&&i.status==="verified"),a=r.filter(i=>i.factor_type==="phone"&&i.status==="verified");return{data:{all:r,totp:n,phone:a},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;const{data:{session:n},error:a}=e;if(a)return{data:null,error:a};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=an(n.access_token);let o=null;i.aal&&(o=i.aal);let l=o;((r=(t=n.user.factors)===null||t===void 0?void 0:t.filter(h=>h.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const d=i.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:d},error:null}}))}async fetchJwk(e,t={keys:[]}){let r=t.keys.find(i=>i.kid===e);if(r||(r=this.jwks.keys.find(i=>i.kid===e),r&&this.jwks_cached_at+hu>Date.now()))return r;const{data:n,error:a}=await he(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;if(!n.keys||n.keys.length===0)throw new Gs("JWKS is empty");if(this.jwks=n,this.jwks_cached_at=Date.now(),r=n.keys.find(i=>i.kid===e),!r)throw new Gs("No matching signing key found in JWKS");return r}async getClaims(e,t={keys:[]}){try{let r=e;if(!r){const{data:p,error:v}=await this.getSession();if(v||!p.session)return{data:null,error:v};r=p.session.access_token}const{header:n,payload:a,signature:i,raw:{header:o,payload:l}}=an(r);if(Du(a.exp),!n.kid||n.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:p}=await this.getUser(r);if(p)throw p;return{data:{claims:a,header:n,signature:i},error:null}}const u=Lu(n.alg),d=await this.fetchJwk(n.kid,t),h=await crypto.subtle.importKey("jwk",d,u,!0,["verify"]);if(!await crypto.subtle.verify(u,h,i,ku(`${o}.${l}`)))throw new Gs("Invalid JWT signature");return{data:{claims:a,header:n,signature:i},error:null}}catch(r){if(oe(r))return{data:null,error:r};throw r}}}tr.nextInstanceID=0;const ed=tr;class td extends ed{constructor(e){super(e)}}var sd=function(s,e,t,r){function n(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(d){try{u(r.next(d))}catch(h){i(h)}}function l(d){try{u(r.throw(d))}catch(h){i(h)}}function u(d){d.done?a(d.value):n(d.value).then(o,l)}u((r=r.apply(s,e||[])).next())})};class rd{constructor(e,t,r){var n,a,i;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const o=iu(e),l=new URL(o);this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const u=`sb-${l.hostname.split(".")[0]}-auth-token`,d={db:Zc,realtime:eu,auth:Object.assign(Object.assign({},Xc),{storageKey:u}),global:Qc},h=ou(r??{},d);this.storageKey=(n=h.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(a=h.global.headers)!==null&&a!==void 0?a:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(f,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=h.auth)!==null&&i!==void 0?i:{},this.headers,h.global.fetch),this.fetch=nu(t,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new bc(new URL("rest/v1",l).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),h.accessToken||this._listenForAuthEvents()}get functions(){return new oc(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Gc(this.storageUrl.href,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return sd(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(t=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,storageKey:a,flowType:i,lock:o,debug:l},u,d){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new td({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),u),storageKey:a,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,flowType:i,lock:o,debug:l,fetch:d,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new $c(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const nd=(s,e,t)=>new rd(s,e,t),ad="https://ibgkltqlgbafpoljizdu.supabase.co",id="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImliZ2tsdHFsZ2JhZnBvbGppemR1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDkzMjU1NzksImV4cCI6MjA2NDkwMTU3OX0.Awa-Gdd3b4uR_1MnQySyA5s6hfVfyZB6jlVS1Jj_Afk",de=nd(ad,id);Go();function Ba(s,e){m(e,!c(e))}var od=W('<button class="open-sidebar-icon icon svelte-1hv2e3s">â¡</button> <aside><div class="sidebar-header svelte-1hv2e3s"><img src="https://raw.githubusercontent.com/Ewan-Dev/ewan.is-a.dev/refs/heads/main/frontend/static/loquela.png" class="logo svelte-1hv2e3s" alt="loquela logo"/> <button class="close-sidebar-icon icon svelte-1hv2e3s">X</button></div> <nav class="sidebar-nav svelte-1hv2e3s"><a href="./#/app/home"><span class="material-symbols-rounded svelte-1hv2e3s">home</span> Home</a> <a href="./#/app/music"><span class="material-symbols-rounded svelte-1hv2e3s">music_note</span> Music</a> <a href="./#/app/videos"><span class="material-symbols-rounded svelte-1hv2e3s">movie</span> Videos</a> <a href="./#/app/upload"><span class="material-symbols-rounded svelte-1hv2e3s">upload</span> Upload</a> <a href="./#/app/flashcards"><span class="material-symbols-rounded svelte-1hv2e3s">cards_star</span> Flashcards</a> <a href="./#/app/ai-chat"><span class="material-symbols-rounded svelte-1hv2e3s">chat</span> AI Chat</a></nav></aside>',1);function bt(s,e){let t=we(e,"currentPage",8,""),r=bs(!1);var n=od(),a=Oe(n);a.__click=[Ba,r];var i=y(a,2);let o;var l=w(i),u=y(w(l),2);u.__click=[Ba,r];var d=y(l,2),h=w(d);let f;var p=y(h,2);let v;var k=y(p,2);let _;var O=y(k,2);let C;var T=y(O,2);let E;var x=y(T,2);let S;le((A,P,M,B,J,K,I)=>{o=st(i,1,"sidebar svelte-1hv2e3s",null,o,A),f=st(h,1,"svelte-1hv2e3s",null,f,P),v=st(p,1,"svelte-1hv2e3s",null,v,M),_=st(k,1,"svelte-1hv2e3s",null,_,B),C=st(O,1,"svelte-1hv2e3s",null,C,J),E=st(T,1,"svelte-1hv2e3s",null,E,K),S=st(x,1,"svelte-1hv2e3s",null,S,I)},[()=>({show:c(r)}),()=>({selected:t()==="/home"}),()=>({selected:t()==="/music"}),()=>({selected:t()==="/videos"}),()=>({selected:t()==="/upload"}),()=>({selected:t()==="/flashcards"}),()=>({selected:t()==="/ai-chat"})]),U(s,n)}is(["click"]);var ld=W('<main class="route svelte-1nmp6pz"><!> <section class="main-page"><h1 class="page-header">Home</h1> <section class="main-content"><h1>ð Hello, welcome back.</h1></section></section></main>');function cd(s,e){Ce(e,!1),et(async()=>{const{data:{user:n}}=await de.auth.getUser();console.log(n)}),Nn();var t=ld(),r=w(t);bt(r,{currentPage:"/home"}),U(s,t),Ie()}const ud=s=>s;function dd(s,{delay:e=0,duration:t=400,easing:r=ud}={}){const n=+getComputedStyle(s).opacity;return{delay:e,duration:t,easing:r,css:a=>`opacity: ${a*n}`}}var hd=W('<section role="status"><span> </span> <p> </p></section>');function At(s,e){Ce(e,!0);let t=we(e,"type",3,"info"),r=we(e,"message",3,"Information"),n=we(e,"width",3,"100%"),a={info:"info",error:"error",success:"check_circle",warn:"warning"},i,o=j(!0);be(()=>(m(o,!1),r()&&(m(o,!0),clearTimeout(i),i=setTimeout(()=>{m(o,!1)},5e3)),()=>{m(o,!1),clearTimeout(i)}));var l=jt(),u=Oe(l);{var d=h=>{var f=hd(),p=w(f),v=w(p),k=y(p,2),_=w(k);le(()=>{Rl(f,`width:${n()??""};`),st(f,1,Cr(t()),"svelte-1o9ullj"),st(p,1,`${t()} material-symbols-rounded`,"svelte-1o9ullj"),ee(v,a[t()]),st(k,1,Cr(t()),"svelte-1o9ullj"),ee(_,r())}),Vl(3,f,()=>dd,()=>({duration:400})),U(h,f)};ce(u,h=>{c(o)&&h(d)})}U(s,l),Ie()}var pr={};(function s(e,t,r,n){var a=!!(e.Worker&&e.Blob&&e.Promise&&e.OffscreenCanvas&&e.OffscreenCanvasRenderingContext2D&&e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype.transferControlToOffscreen&&e.URL&&e.URL.createObjectURL),i=typeof Path2D=="function"&&typeof DOMMatrix=="function",o=function(){if(!e.OffscreenCanvas)return!1;var b=new OffscreenCanvas(1,1),g=b.getContext("2d");g.fillRect(0,0,1,1);var R=b.transferToImageBitmap();try{g.createPattern(R,"no-repeat")}catch{return!1}return!0}();function l(){}function u(b){var g=t.exports.Promise,R=g!==void 0?g:e.Promise;return typeof R=="function"?new R(b):(b(l,l),null)}var d=function(b,g){return{transform:function(R){if(b)return R;if(g.has(R))return g.get(R);var N=new OffscreenCanvas(R.width,R.height),V=N.getContext("2d");return V.drawImage(R,0,0),g.set(R,N),N},clear:function(){g.clear()}}}(o,new Map),h=function(){var b=Math.floor(16.666666666666668),g,R,N={},V=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(g=function(G){var Z=Math.random();return N[Z]=requestAnimationFrame(function $(F){V===F||V+b-1<F?(V=F,delete N[Z],G()):N[Z]=requestAnimationFrame($)}),Z},R=function(G){N[G]&&cancelAnimationFrame(N[G])}):(g=function(G){return setTimeout(G,b)},R=function(G){return clearTimeout(G)}),{frame:g,cancel:R}}(),f=function(){var b,g,R={};function N(V){function G(Z,$){V.postMessage({options:Z||{},callback:$})}V.init=function($){var F=$.transferControlToOffscreen();V.postMessage({canvas:F},[F])},V.fire=function($,F,te){if(g)return G($,null),g;var se=Math.random().toString(36).slice(2);return g=u(function(ne){function ae(Ee){Ee.data.callback===se&&(delete R[se],V.removeEventListener("message",ae),g=null,d.clear(),te(),ne())}V.addEventListener("message",ae),G($,se),R[se]=ae.bind(null,{data:{callback:se}})}),g},V.reset=function(){V.postMessage({reset:!0});for(var $ in R)R[$](),delete R[$]}}return function(){if(b)return b;if(!r&&a){var V=["var CONFETTI, SIZE = {}, module = {};","("+s.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{b=new Worker(URL.createObjectURL(new Blob([V])))}catch(G){return typeof console!==void 0&&typeof console.warn=="function"&&console.warn("ð Could not load worker",G),null}N(b)}return b}}(),p={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function v(b,g){return g?g(b):b}function k(b){return b!=null}function _(b,g,R){return v(b&&k(b[g])?b[g]:p[g],R)}function O(b){return b<0?0:Math.floor(b)}function C(b,g){return Math.floor(Math.random()*(g-b))+b}function T(b){return parseInt(b,16)}function E(b){return b.map(x)}function x(b){var g=String(b).replace(/[^0-9a-f]/gi,"");return g.length<6&&(g=g[0]+g[0]+g[1]+g[1]+g[2]+g[2]),{r:T(g.substring(0,2)),g:T(g.substring(2,4)),b:T(g.substring(4,6))}}function S(b){var g=_(b,"origin",Object);return g.x=_(g,"x",Number),g.y=_(g,"y",Number),g}function A(b){b.width=document.documentElement.clientWidth,b.height=document.documentElement.clientHeight}function P(b){var g=b.getBoundingClientRect();b.width=g.width,b.height=g.height}function M(b){var g=document.createElement("canvas");return g.style.position="fixed",g.style.top="0px",g.style.left="0px",g.style.pointerEvents="none",g.style.zIndex=b,g}function B(b,g,R,N,V,G,Z,$,F){b.save(),b.translate(g,R),b.rotate(G),b.scale(N,V),b.arc(0,0,1,Z,$,F),b.restore()}function J(b){var g=b.angle*(Math.PI/180),R=b.spread*(Math.PI/180);return{x:b.x,y:b.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:b.startVelocity*.5+Math.random()*b.startVelocity,angle2D:-g+(.5*R-Math.random()*R),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:b.color,shape:b.shape,tick:0,totalTicks:b.ticks,decay:b.decay,drift:b.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:b.gravity*3,ovalScalar:.6,scalar:b.scalar,flat:b.flat}}function K(b,g){g.x+=Math.cos(g.angle2D)*g.velocity+g.drift,g.y+=Math.sin(g.angle2D)*g.velocity+g.gravity,g.velocity*=g.decay,g.flat?(g.wobble=0,g.wobbleX=g.x+10*g.scalar,g.wobbleY=g.y+10*g.scalar,g.tiltSin=0,g.tiltCos=0,g.random=1):(g.wobble+=g.wobbleSpeed,g.wobbleX=g.x+10*g.scalar*Math.cos(g.wobble),g.wobbleY=g.y+10*g.scalar*Math.sin(g.wobble),g.tiltAngle+=.1,g.tiltSin=Math.sin(g.tiltAngle),g.tiltCos=Math.cos(g.tiltAngle),g.random=Math.random()+2);var R=g.tick++/g.totalTicks,N=g.x+g.random*g.tiltCos,V=g.y+g.random*g.tiltSin,G=g.wobbleX+g.random*g.tiltCos,Z=g.wobbleY+g.random*g.tiltSin;if(b.fillStyle="rgba("+g.color.r+", "+g.color.g+", "+g.color.b+", "+(1-R)+")",b.beginPath(),i&&g.shape.type==="path"&&typeof g.shape.path=="string"&&Array.isArray(g.shape.matrix))b.fill(Q(g.shape.path,g.shape.matrix,g.x,g.y,Math.abs(G-N)*.1,Math.abs(Z-V)*.1,Math.PI/10*g.wobble));else if(g.shape.type==="bitmap"){var $=Math.PI/10*g.wobble,F=Math.abs(G-N)*.1,te=Math.abs(Z-V)*.1,se=g.shape.bitmap.width*g.scalar,ne=g.shape.bitmap.height*g.scalar,ae=new DOMMatrix([Math.cos($)*F,Math.sin($)*F,-Math.sin($)*te,Math.cos($)*te,g.x,g.y]);ae.multiplySelf(new DOMMatrix(g.shape.matrix));var Ee=b.createPattern(d.transform(g.shape.bitmap),"no-repeat");Ee.setTransform(ae),b.globalAlpha=1-R,b.fillStyle=Ee,b.fillRect(g.x-se/2,g.y-ne/2,se,ne),b.globalAlpha=1}else if(g.shape==="circle")b.ellipse?b.ellipse(g.x,g.y,Math.abs(G-N)*g.ovalScalar,Math.abs(Z-V)*g.ovalScalar,Math.PI/10*g.wobble,0,2*Math.PI):B(b,g.x,g.y,Math.abs(G-N)*g.ovalScalar,Math.abs(Z-V)*g.ovalScalar,Math.PI/10*g.wobble,0,2*Math.PI);else if(g.shape==="star")for(var ie=Math.PI/2*3,Ae=4*g.scalar,Le=8*g.scalar,Re=g.x,ze=g.y,qe=5,De=Math.PI/qe;qe--;)Re=g.x+Math.cos(ie)*Le,ze=g.y+Math.sin(ie)*Le,b.lineTo(Re,ze),ie+=De,Re=g.x+Math.cos(ie)*Ae,ze=g.y+Math.sin(ie)*Ae,b.lineTo(Re,ze),ie+=De;else b.moveTo(Math.floor(g.x),Math.floor(g.y)),b.lineTo(Math.floor(g.wobbleX),Math.floor(V)),b.lineTo(Math.floor(G),Math.floor(Z)),b.lineTo(Math.floor(N),Math.floor(g.wobbleY));return b.closePath(),b.fill(),g.tick<g.totalTicks}function I(b,g,R,N,V){var G=g.slice(),Z=b.getContext("2d"),$,F,te=u(function(se){function ne(){$=F=null,Z.clearRect(0,0,N.width,N.height),d.clear(),V(),se()}function ae(){r&&!(N.width===n.width&&N.height===n.height)&&(N.width=b.width=n.width,N.height=b.height=n.height),!N.width&&!N.height&&(R(b),N.width=b.width,N.height=b.height),Z.clearRect(0,0,N.width,N.height),G=G.filter(function(Ee){return K(Z,Ee)}),G.length?$=h.frame(ae):ne()}$=h.frame(ae),F=ne});return{addFettis:function(se){return G=G.concat(se),te},canvas:b,promise:te,reset:function(){$&&h.cancel($),F&&F()}}}function z(b,g){var R=!b,N=!!_(g||{},"resize"),V=!1,G=_(g,"disableForReducedMotion",Boolean),Z=a&&!!_(g||{},"useWorker"),$=Z?f():null,F=R?A:P,te=b&&$?!!b.__confetti_initialized:!1,se=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,ne;function ae(ie,Ae,Le){for(var Re=_(ie,"particleCount",O),ze=_(ie,"angle",Number),qe=_(ie,"spread",Number),De=_(ie,"startVelocity",Number),X=_(ie,"decay",Number),ue=_(ie,"gravity",Number),pe=_(ie,"drift",Number),q=_(ie,"colors",E),Y=_(ie,"ticks",Number),fe=_(ie,"shapes"),$e=_(ie,"scalar"),_e=!!_(ie,"flat"),ke=S(ie),Ne=Re,Te=[],kt=b.width*ke.x,at=b.height*ke.y;Ne--;)Te.push(J({x:kt,y:at,angle:ze,spread:qe,startVelocity:De,color:q[Ne%q.length],shape:fe[C(0,fe.length)],ticks:Y,decay:X,gravity:ue,drift:pe,scalar:$e,flat:_e}));return ne?ne.addFettis(Te):(ne=I(b,Te,F,Ae,Le),ne.promise)}function Ee(ie){var Ae=G||_(ie,"disableForReducedMotion",Boolean),Le=_(ie,"zIndex",Number);if(Ae&&se)return u(function(De){De()});R&&ne?b=ne.canvas:R&&!b&&(b=M(Le),document.body.appendChild(b)),N&&!te&&F(b);var Re={width:b.width,height:b.height};$&&!te&&$.init(b),te=!0,$&&(b.__confetti_initialized=!0);function ze(){if($){var De={getBoundingClientRect:function(){if(!R)return b.getBoundingClientRect()}};F(De),$.postMessage({resize:{width:De.width,height:De.height}});return}Re.width=Re.height=null}function qe(){ne=null,N&&(V=!1,e.removeEventListener("resize",ze)),R&&b&&(document.body.contains(b)&&document.body.removeChild(b),b=null,te=!1)}return N&&!V&&(V=!0,e.addEventListener("resize",ze,!1)),$?$.fire(ie,Re,qe):ae(ie,Re,qe)}return Ee.reset=function(){$&&$.reset(),ne&&ne.reset()},Ee}var D;function L(){return D||(D=z(null,{useWorker:!0,resize:!0})),D}function Q(b,g,R,N,V,G,Z){var $=new Path2D(b),F=new Path2D;F.addPath($,new DOMMatrix(g));var te=new Path2D;return te.addPath(F,new DOMMatrix([Math.cos(Z)*V,Math.sin(Z)*V,-Math.sin(Z)*G,Math.cos(Z)*G,R,N])),te}function re(b){if(!i)throw new Error("path confetti are not supported in this browser");var g,R;typeof b=="string"?g=b:(g=b.path,R=b.matrix);var N=new Path2D(g),V=document.createElement("canvas"),G=V.getContext("2d");if(!R){for(var Z=1e3,$=Z,F=Z,te=0,se=0,ne,ae,Ee=0;Ee<Z;Ee+=2)for(var ie=0;ie<Z;ie+=2)G.isPointInPath(N,Ee,ie,"nonzero")&&($=Math.min($,Ee),F=Math.min(F,ie),te=Math.max(te,Ee),se=Math.max(se,ie));ne=te-$,ae=se-F;var Ae=10,Le=Math.min(Ae/ne,Ae/ae);R=[Le,0,0,Le,-Math.round(ne/2+$)*Le,-Math.round(ae/2+F)*Le]}return{type:"path",path:g,matrix:R}}function me(b){var g,R=1,N="#000000",V='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof b=="string"?g=b:(g=b.text,R="scalar"in b?b.scalar:R,V="fontFamily"in b?b.fontFamily:V,N="color"in b?b.color:N);var G=10*R,Z=""+G+"px "+V,$=new OffscreenCanvas(G,G),F=$.getContext("2d");F.font=Z;var te=F.measureText(g),se=Math.ceil(te.actualBoundingBoxRight+te.actualBoundingBoxLeft),ne=Math.ceil(te.actualBoundingBoxAscent+te.actualBoundingBoxDescent),ae=2,Ee=te.actualBoundingBoxLeft+ae,ie=te.actualBoundingBoxAscent+ae;se+=ae+ae,ne+=ae+ae,$=new OffscreenCanvas(se,ne),F=$.getContext("2d"),F.font=Z,F.fillStyle=N,F.fillText(g,Ee,ie);var Ae=1/R;return{type:"bitmap",bitmap:$.transferToImageBitmap(),matrix:[Ae,0,0,Ae,-se*Ae/2,-ne*Ae/2]}}t.exports=function(){return L().apply(this,arguments)},t.exports.reset=function(){L().reset()},t.exports.create=z,t.exports.shapeFromPath=re,t.exports.shapeFromText=me})(function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}}(),pr,!1);const Ls=pr.exports;pr.exports.create;var fd=W('<main class="svelte-1lzp8li"><h1>Signup</h1> <form class="svelte-1lzp8li"><label for="email" class="svelte-1lzp8li">Email:</label> <input class="email svelte-1lzp8li" type="email"/> <label for="password" class="svelte-1lzp8li">Password:</label> <input class="password svelte-1lzp8li" type="password"/> <button class="sign-up" type="submit">Sign up</button> <!></form></main>');function vd(s,e){Ce(e,!0);let t="",r="",n="",a=j(H(n.statusError)),i=j(H(n.statusType));async function o(){await l()}async function l(){console.log("Signing up...");let{data:_,error:O}=await de.auth.signUp({email:t,password:r,options:{emailRedirectTo:"https://ewan.is-a.dev/#/app/login/"}});O&&O.message.includes("Password should contain at least one character of each")?(m(a,""),m(i,""),m(a,"Password must contain capital letters, lowercase letters, numbers and special characters."),m(i,"warn")):O&&O.message?(m(i,""),m(i,"error"),m(a,""),m(a,O.message,!0)):_&&!O&&(m(a,"Signup successful! Check your email to confirm."),m(i,"success"),console.log("User signed up successfully",_),u())}function u(){Ls({particleCount:200,spread:70,origin:{y:.6}})}var d=fd(),h=y(w(d),2),f=y(w(h),2),p=y(f,4),v=y(p,4);{var k=_=>{At(_,{get type(){return c(i)},get message(){return c(a)}})};ce(v,_=>{c(a)&&c(i)&&_(k)})}Xe("submit",h,_=>{_.preventDefault(),o()}),pt(f,()=>t,_=>t=_),pt(p,()=>r,_=>r=_),U(s,d),Ie()}var pd=W('<!> <p>Continue <a href="./#/app/home">here</a></p>',1),gd=W('<main class="route svelte-1x05zx6"><section class="main-page"><h1 class="page-header">Login</h1> <section class="main-content"><form class="svelte-1x05zx6"><label for="email" class="svelte-1x05zx6">Email:</label> <input class="email svelte-1x05zx6" type="email"/> <label for="password" class="svelte-1x05zx6">Password:</label> <input class="password svelte-1x05zx6" type="password"/> <button class="log-in svelte-1x05zx6" type="submit">Sign in</button> <!> <!></form></section></section></main>');function _d(s,e){Ce(e,!0);let t=j(""),r=j(""),n="",a=j(""),i=j("");async function o(){let{data:E,error:x}=await de.auth.signInWithPassword({email:c(t),password:c(r)});x?(x&&x.message.includes("profiles_email_key")&&m(a,""),m(a,x.message,!0)):(m(i,E,!0),console.log("Login successful",n),m(a,""),u(),l(E.user.email))}async function l(E){const{error:x}=await de.from("profiles").insert({email:E});x&&x.message?console.error(x.message):x||(m(a,""),console.log("User added to profiles table"))}function u(){Ls({particleCount:200,spread:70,origin:{y:.6}})}var d=gd(),h=w(d),f=y(w(h),2),p=w(f),v=y(w(p),2),k=y(v,4),_=y(k,4);{var O=E=>{At(E,{type:"error",get message(){return c(a)}})};ce(_,E=>{c(a)&&E(O)})}var C=y(_,2);{var T=E=>{var x=pd(),S=Oe(x);At(S,{type:"success",message:"Login successful!",width:"15em"}),U(E,x)};ce(C,E=>{!c(a)&&c(i)&&E(T)})}Xe("submit",p,E=>{E.preventDefault(),o()}),pt(v,()=>c(t),E=>m(t,E)),pt(k,()=>c(r),E=>m(r,E)),U(s,d),Ie()}var md=W('<!> <p>Continue <a href="./#/app/home">here</a></p>',1),yd=W('<main class="route svelte-6jdv1j"><section class="main-page"><h1 class="page-header">Login</h1> <section class="main-content"><form class="svelte-6jdv1j"><label for="email" class="svelte-6jdv1j">Email:</label> <input class="email svelte-6jdv1j" type="email"/> <label for="password" class="svelte-6jdv1j">Password:</label> <input class="password svelte-6jdv1j" type="password"/> <button class="log-in svelte-6jdv1j" type="submit">Sign in</button> <!> <!></form></section></section></main>');function wd(s,e){Ce(e,!0);let t=j(""),r=j(""),n="",a=j(""),i=j("");async function o(){let{data:E,error:x}=await de.auth.signInWithPassword({email:c(t),password:c(r)});x?(x&&x.message.includes("profiles_email_key")&&m(a,""),m(a,x.message,!0)):(m(i,E,!0),console.log("Login successful",n),m(a,""),u(),l(E.user.email))}async function l(E){const{error:x}=await de.from("profiles").insert({email:E});x&&x.message?console.error(x.message):x||(m(a,""),console.log("User added to profiles table"))}function u(){Ls({particleCount:200,spread:70,origin:{y:.6}})}var d=yd(),h=w(d),f=y(w(h),2),p=w(f),v=y(w(p),2),k=y(v,4),_=y(k,4);{var O=E=>{At(E,{type:"error",get message(){return c(a)}})};ce(_,E=>{c(a)&&E(O)})}var C=y(_,2);{var T=E=>{var x=md(),S=Oe(x);At(S,{type:"success",message:"Login successful!",width:"15em"}),U(E,x)};ce(C,E=>{!c(a)&&c(i)&&E(T)})}Xe("submit",p,E=>{E.preventDefault(),o()}),pt(v,()=>c(t),E=>m(t,E)),pt(k,()=>c(r),E=>m(r,E)),U(s,d),Ie()}var bd=W('<div><span class="material-symbols-rounded svelte-hct3vs"> </span> <p> </p></div>');function kd(s,e){let t=we(e,"type",8,""),r=we(e,"message",8,""),n=we(e,"symbol",8,"");var a=bd(),i=w(a),o=w(i),l=y(i,2),u=w(l);le(()=>{st(a,1,`media-tag ${t()}`,"svelte-hct3vs"),ee(o,n()),ee(u,r())}),U(s,a)}var Sd=W('<div><img alt="Album cover"/> <span class="svelte-1pu170t"><!></span> <a class="svelte-1pu170t"><b> </b></a> <a class="svelte-1pu170t"> </a></div>');function ao(s,e){Ce(e,!1);let t=we(e,"name",12,null),r=we(e,"artist",12,null),n=we(e,"cover",8,null),a=we(e,"level",8,null);we(e,"rating",8,null);let i=we(e,"link",8,null),o=we(e,"type",8,null);t().length>45&&t(t().slice(0,42)+"..."),r().length>45&&r(r().slice(0,42)+"..."),Nn();var l=Sd(),u=w(l),d=y(u,2),h=w(d);kd(h,{type:"level",get message(){return a()}});var f=y(d,2),p=w(f),v=w(p),k=y(f,2),_=w(k);le(()=>{st(l,1,Cr(o()),"svelte-1pu170t"),Ue(u,"src",n()),st(u,1,Cr(o()),"svelte-1pu170t"),Ue(f,"href",i()),ee(v,t()),ee(_,r())}),U(s,l),Ie()}var Ed=W("<option> </option>"),xd=W("<option> </option>"),Td=W('<span><label for="language">Select further detail:</label> <select class="language svelte-1d376ng" required><option>--Select--</option><!></select></span>'),jd=W('<p class="not-found svelte-1d376ng">:/ Oops! No songs found; try uploading your own or try again later.</p>'),Od=W("<p>Try selecting a language to show media. If no languages show up, come back later as the servers may be down.</p>"),Ad=W('<main class="route svelte-1d376ng"><!> <section class="main-page"><h1 class="page-header">Songs</h1> <section class="main-content svelte-1d376ng"><select class="svelte-1d376ng"></select> <!> <section class="media-container svelte-1d376ng"><!> <!> <!></section></section></section></main>');function Pd(s,e){Ce(e,!0);let t=j(H([])),r=j(H([])),n=j(""),a=j(""),i=j("");async function o(P){const{data:M,error:B}=await de.from("media").select("*").eq("language",P).eq("media_type","music");B?console.error("Error fetching songs:",B):(console.log(c(t)),console.log(M),M.forEach(J=>{c(t).push(J||[])}),console.log(c(t)))}be(()=>{console.log(c(t))});async function l(){const{data:P,error:M}=await de.from("languages").select("*");if(P)return m(r,P,!0),console.log(c(r)),P;if(M)throw M}et(()=>{l()}),be(()=>{m(t,[],!0),Array.isArray(c(n))&&c(n).forEach(P=>{console.log(P),o(P)})});let u=j(void 0),d=j(void 0);be(()=>{var P;m(u,c(r).find(M=>M.short===c(a)),!0),m(d,(P=c(u))==null?void 0:P.sub_options,!0),console.log(c(d))}),be(()=>{c(a).length===1?m(n,c(a),!0):m(n,c(i),!0)}),be(()=>{console.log(c(n))});var h=Ad(),f=w(h);bt(f,{currentPage:"/music"});var p=y(f,2),v=y(w(p),2),k=w(v);Me(k,21,()=>c(r),Pe,(P,M,B,J)=>{var K=Ed(),I=w(K),z={};le(()=>{ee(I,`${c(M).emoji??""} ${c(M).name??""}`),z!==(z=c(M).short)&&(K.value=(K.__value=c(M).short)??"")}),U(P,K)});var _=y(k,2);{var O=P=>{var M=Td(),B=y(w(M),2),J=w(B);J.value=J.__value="";var K=y(J);Me(K,17,()=>c(d),Pe,(I,z)=>{var D=xd(),L=w(D),Q={};le(()=>{ee(L,c(z).name),Q!==(Q=c(z).codes)&&(D.value=(D.__value=c(z).codes)??"")}),U(I,D)}),He(B,()=>c(i),I=>m(i,I)),U(P,M)};ce(_,P=>{c(a).length>1&&P(O)})}var C=y(_,2),T=w(C);{var E=P=>{var M=jd();U(P,M)};ce(T,P=>{!c(t)[0]&&c(n)&&P(E)})}var x=y(T,2);{var S=P=>{var M=Od();U(P,M)};ce(x,P=>{c(a)||P(S)})}var A=y(x,2);Me(A,17,()=>c(t),Pe,(P,M)=>{{let B=js(()=>`#/app/songs/${c(M).id}`);ao(P,{get name(){return c(M).name},get artist(){return c(M).artist},get cover(){return c(M).cover},get level(){return c(M).level},get rating(){return c(M).rating},get link(){return c(B)},type:"song"})}}),He(k,()=>c(a),P=>m(a,P)),U(s,h),Ie()}var Md=W('<span class="svelte-1wzg23z"><h1 class="song svelte-1wzg23z"> </h1><h1 class="artist svelte-1wzg23z"> </h1></span>');function io(s,e){let t=we(e,"song",8,"Loading..."),r=we(e,"artist",8,"Loading...");var n=Md(),a=w(n),i=w(a),o=y(a),l=w(o);le(()=>{ee(i,t()),ee(l,r())}),U(s,n)}var Cd=W('<i><p class="romanisation svelte-1m7wp3l"> </p></i>'),Id=W("<option> </option>"),$d=W(`<span class="flashcard-functions svelte-1m7wp3l"><span class="flashcard-upload svelte-1m7wp3l"><button class="add-to-deck flashcard-btn svelte-1m7wp3l"><span class="material-symbols-rounded svelte-1m7wp3l">library_add</span></button> <select class="svelte-1m7wp3l"></select></span> <button class="info-flashcards-btn flashcard-btn svelte-1m7wp3l"><span class="material-symbols-rounded svelte-1m7wp3l">info</span></button></span> <dialog class="info-flashcards-container svelte-1m7wp3l"><strong class="definition-info-header">Where's my deck?</strong> <p class="definition-info-body svelte-1m7wp3l">This is as you may not yet have a deck for the language you are curretly studying; You can only add words to decks of the same language</p> <button class="close-dialog svelte-1m7wp3l">OK</button></dialog>`,1),Rd=W('<section class="svelte-1m7wp3l"><h1 class="svelte-1m7wp3l"> </h1> <!> <p class="part-of-speech svelte-1m7wp3l"> </p> <p class="svelte-1m7wp3l"> </p> <!> <!></section>');function oo(s,e){Ce(e,!0);let t=j(H({message:"",type:""})),r=j(void 0),n=j(H([])),a=j(H(HTMLObjectElement)),i=j("");et(async()=>{d()}),be(async()=>{c(i)?(m(n,await u(c(i)),!0),console.log(c(n))):m(n,[],!0)});async function o(v){const{data:k,error:_}=await de.from("flashcard_decks").select("content").eq("id",v);return _?(m(t,{type:"error",message:_.message},!0),[]):k[0].content}async function l(v){const k=await o(v);k.push({word:e.word,definition:e.definition,partOfSpeech:e.partOfSpeech,romanisation:e.romanisation});const{error:_}=await de.from("flashcard_decks").update({content:k}).eq("id",v);if(_&&_.message==='invalid input syntax for type bigint: "undefined"')return m(t,{type:"error",message:"You haven't selected a deck. Try making one on 'Flashcards' page"},!0),_;if(_)return m(t,{type:"error",message:gerror.message},!0),_;m(t,{type:"success",message:"Added!"},!0)}async function u(v){const{data:k,error:_}=await de.from("flashcard_decks").select("*").eq("author",v).eq("language",e.language);return _?(console.error(_),m(t,{type:"error",message:_.message},!0),_):(console.log(k),k)}async function d(){const{data:v,error:k}=await de.auth.getSession(),_=v;k?console.error("Error fetching session:",k):_&&m(i,_.session.user.id,!0)}var h=jt(),f=Oe(h);{var p=v=>{var k=Rd(),_=w(k),O=w(_),C=y(_,2);{var T=J=>{var K=Cd(),I=w(K),z=w(I);le(()=>ee(z,e.romanisation)),U(J,K)};ce(C,J=>{e.romanisation&&J(T)})}var E=y(C,2),x=w(E),S=y(E,2),A=w(S),P=y(S,2);{var M=J=>{var K=$d(),I=Oe(K),z=w(I),D=w(z),L=y(D,2);Me(L,21,()=>c(n),Pe,(R,N)=>{var V=Id(),G=w(V),Z={};le(()=>{ee(G,c(N).name),Z!==(Z=c(N).id)&&(V.value=(V.__value=c(N).id)??"")}),U(R,V)});var Q=y(z,2),re=js(()=>c(a).showModal()),me=y(I,2),b=y(w(me),4),g=js(()=>c(a).close());ht(me,R=>m(a,R),()=>c(a)),Xe("click",D,()=>l(c(r))),He(L,()=>c(r),R=>m(r,R)),Xe("click",Q,function(...R){var N;(N=c(re))==null||N.apply(this,R)}),Xe("click",b,function(...R){var N;(N=c(g))==null||N.apply(this,R)}),U(J,K)};ce(P,J=>{c(n)&&J(M)})}var B=y(P,2);At(B,{get type(){return c(t).type},get message(){return c(t).message}}),le(()=>{ee(O,e.word),ee(x,e.partOfSpeech),ee(A,e.definition)}),U(v,k)};ce(f,v=>{e.word&&v(p)})}U(s,h),Ie()}var Dd=W('<p class="current-line svelte-61xipn"> </p>'),Ld=W('<img src="././static/load.gif"/> <!> <span class="svelte-61xipn"><span class="main-subtitles svelte-61xipn"></span> <p class="full-translate svelte-61xipn"> </p> <button class="show-translations-btn svelte-61xipn">Show translations</button></span>',1);function Gn(s,e){Ce(e,!0);const t=we(e,"currentLine",3,"Play the video to see live subtitles. Click on an individual word for a definition!"),r=we(e,"targetLanguage",3,""),n=we(e,"nativeLanguage",3,"en");let a="",i=j(H(a.term)),o=j(H(a.definition)),l=j(H(a.partOfSpeech)),u=j(H(a.original)),d=j(H(a.translated)),h=j(H(a.romanisation)),f=!0,p=j(H([]));be(()=>{const P=new Intl.Segmenter("zh",{granularity:"word"});m(p,[...P.segment(t())].map(M=>M.segment),!0),k(t())});async function v(P,M){console.log("Fetching definition for ",P);const B=M.join(" "),J=`you are being used as an AI to give a definition of a word based of context for a language learning software the language of the word and context is ${r()} and the user's native language is ${n()} the word is ${P} and the context is ${B} so give your definition in ${n()} and as part of your just definition NOT the partOfSpeech add helpful notes such as if its plural and its singular or its case/tense and its infintive etc. but keep it simple and short return as raw json with no backtick MD markers as your respone will be directly parsed into json respond with attributes word, partOfSpeech, romanisation and definition but do NOT return romanisation where it is not necessary`,I=await(await fetch(`https://text.pollinations.ai/${J}`)).json();console.log(I),m(i,I.word,!0),m(o,I.definition,!0),m(l,I.partOfSpeech,!0),m(h,I.romanisation,!0)}async function k(P){const M=`Translate from ISO 639-2 ${r()} to ${n()}. Sentence: "${P}". Respond only with raw JSON: { "original": "...", "translated": "..." }. No comments, markdown, or extra text`,B=await fetch(`https://text.pollinations.ai/${M}`);console.log(B);const J=await B.json();console.log(J),m(u,J.original,!0),m(d,J.translated,!0)}async function _(){const P=document.getElementsByClassName("full-translate"),M=document.getElementsByClassName("show-translations-btn");f=!f,Array.from(P).forEach(B=>{f===!0?B.style.display="block":B.style.display="none"}),Array.from(M).forEach(B=>{f===!0?B.style.display="none":B.style.display="block"})}var O=Ld(),C=y(Oe(O),2);oo(C,{get word(){return c(i)},get definition(){return c(o)},get partOfSpeech(){return c(l)},get romanisation(){return c(h)},get language(){return r()}});var T=y(C,2),E=w(T);Me(E,21,()=>c(p),Pe,(P,M)=>{var B=Dd(),J=w(B);le(()=>ee(J,c(M))),Xe("click",B,()=>v(c(M),c(p))),U(P,B)});var x=y(E,2),S=w(x),A=y(x,2);le(()=>ee(S,c(d))),Xe("click",x,()=>_()),Xe("click",A,()=>_()),U(s,O),Ie()}var Ud=W('<span class="author-tag svelte-2mqmtf"><span class="material-symbols-rounded svelte-2mqmtf">person</span> <span class="author-text-container svelte-2mqmtf"><p class="svelte-2mqmtf">Uploaded by:</p> <p class="author svelte-2mqmtf"> </p></span></span>');function lo(s,e){Ce(e,!0);let t=we(e,"author",7,"Loading...");t()&&t(t().slice(0,17)+"...");var r=Ud(),n=y(w(r),2),a=y(w(n),2),i=w(a);le(()=>ee(i,t())),U(s,r),Ie()}function zd(s,e){if(s instanceof RegExp)return{keys:!1,pattern:s};var t,r,n,a,i=[],o="",l=s.split("/");for(l[0]||l.shift();n=l.shift();)t=n[0],t==="*"?(i.push("wild"),o+="/(.*)"):t===":"?(r=n.indexOf("?",1),a=n.indexOf(".",1),i.push(n.substring(1,~r?r:~a?a:n.length)),o+=~r&&!~a?"(?:/([^/]+?))?":"/([^/]+?)",~a&&(o+=(~r?"?":"")+"\\"+n.substring(a))):o+="/"+n;return{keys:i,pattern:new RegExp("^"+o+"/?$","i")}}function Fa(){const s=window.location.href.indexOf("#/");let e=s>-1?window.location.href.substr(s+1):"/";const t=e.indexOf("?");let r="";return t>-1&&(r=e.substr(t+1),e=e.substr(0,t)),{location:e,querystring:r}}const Kn=Di(null,function(e){e(Fa());const t=()=>{e(Fa())};return window.addEventListener("hashchange",t,!1),function(){window.removeEventListener("hashchange",t,!1)}}),Us=Ui(Kn,s=>s.location);Ui(Kn,s=>s.querystring);const Wa=Li(void 0);function qd(s){s?window.scrollTo(s.__svelte_spa_router_scrollX,s.__svelte_spa_router_scrollY):window.scrollTo(0,0)}function Nd(s,e){Ce(e,!1);let t=we(e,"routes",24,()=>({})),r=we(e,"prefix",8,""),n=we(e,"restoreScrollState",8,!1);class a{constructor(S,A){if(!A||typeof A!="function"&&(typeof A!="object"||A._sveltesparouter!==!0))throw Error("Invalid component object");if(!S||typeof S=="string"&&(S.length<1||S.charAt(0)!="/"&&S.charAt(0)!="*")||typeof S=="object"&&!(S instanceof RegExp))throw Error('Invalid value for "path" argument - strings must start with / or *');const{pattern:P,keys:M}=zd(S);this.path=S,typeof A=="object"&&A._sveltesparouter===!0?(this.component=A.component,this.conditions=A.conditions||[],this.userData=A.userData,this.props=A.props||{}):(this.component=()=>Promise.resolve(A),this.conditions=[],this.props={}),this._pattern=P,this._keys=M}match(S){if(r()){if(typeof r()=="string")if(S.startsWith(r()))S=S.substr(r().length)||"/";else return null;else if(r()instanceof RegExp){const B=S.match(r());if(B&&B[0])S=S.substr(B[0].length)||"/";else return null}}const A=this._pattern.exec(S);if(A===null)return null;if(this._keys===!1)return A;const P={};let M=0;for(;M<this._keys.length;){try{P[this._keys[M]]=decodeURIComponent(A[M+1]||"")||null}catch{P[this._keys[M]]=null}M++}return P}async checkConditions(S){for(let A=0;A<this.conditions.length;A++)if(!await this.conditions[A](S))return!1;return!0}}const i=[];t()instanceof Map?t().forEach((x,S)=>{i.push(new a(S,x))}):Object.keys(t()).forEach(x=>{i.push(new a(x,t()[x]))});let o=bs(null),l=bs(null),u=bs({});const d=Ql();async function h(x,S){await ji(),d(x,S)}let f=null,p=null;n()&&(p=x=>{x.state&&(x.state.__svelte_spa_router_scrollY||x.state.__svelte_spa_router_scrollX)?f=x.state:f=null},window.addEventListener("popstate",p),Zl(()=>{qd(f)}));let v=null,k=null;const _=Kn.subscribe(async x=>{v=x;let S=0;for(;S<i.length;){const A=i[S].match(x.location);if(!A){S++;continue}const P={route:i[S].path,location:x.location,querystring:x.querystring,userData:i[S].userData,params:A&&typeof A=="object"&&Object.keys(A).length?A:null};if(!await i[S].checkConditions(P)){m(o,null),k=null,h("conditionsFailed",P);return}h("routeLoading",Object.assign({},P));const M=i[S].component;if(k!=M){M.loading?(m(o,M.loading),k=M,m(l,M.loadingParams),m(u,{}),h("routeLoaded",Object.assign({},P,{component:c(o),name:c(o).name,params:c(l)}))):(m(o,null),k=null);const B=await M();if(x!=v)return;m(o,B&&B.default||B),k=M}A&&typeof A=="object"&&Object.keys(A).length?m(l,A):m(l,null),m(u,i[S].props),h("routeLoaded",Object.assign({},P,{component:c(o),name:c(o).name,params:c(l)})).then(()=>{Wa.set(c(l))});return}m(o,null),k=null,Wa.set(void 0)});Kl(()=>{_(),p&&window.removeEventListener("popstate",p)}),vl(()=>Ai(n()),()=>{history.scrollRestoration=n()?"manual":"auto"}),pl(),Nn();var O=jt(),C=Oe(O);{var T=x=>{var S=jt(),A=Oe(S);ca(A,()=>c(o),(P,M)=>{M(P,ga({get params(){return c(l)}},()=>c(u),{$$events:{routeEvent(B){pa.call(this,e,B)}}}))}),U(x,S)},E=x=>{var S=jt(),A=Oe(S);ca(A,()=>c(o),(P,M)=>{M(P,ga(()=>c(u),{$$events:{routeEvent(B){pa.call(this,e,B)}}}))}),U(x,S)};ce(C,x=>{c(l)?x(T):x(E,!1)})}U(s,O),Ie()}var Bd=qn(W('<script src="https://www.youtube.com/iframe_api"><\/script><!>',1)),Fd=W('<main class="route svelte-bcry69"><!> <section class="main-page svelte-bcry69"><h1 class="page-header svelte-bcry69">Music</h1> <section class="main-content svelte-bcry69"><span class="heading svelte-bcry69"><!></span> <!> <iframe id="player" frameborder="0" allowfullscreen="" class="svelte-bcry69"></iframe> <!></section></section></main>');function Wd(s,e){Ce(e,!0);const t=()=>$s(Us,"$location",r),[r,n]=Rs();let a=j(H(t().split("/").pop())),i,o=j("Loading..."),l=j("Loading..."),u=j("Loading..."),d=j("https://img.youtube.com/vi/loquela/maxresdefault.jpg"),h=j("Unknown Level"),f=j("No Rating"),p=j(""),v=j(H([])),k=j(void 0),_=j("https://youtu.be/zabswqP6xEM");be(()=>{const I=t().split("/").pop();I!=c(a)&&m(a,I,!0),O().then(()=>{window.YT?T():window.onYouTubeIframeAPIReady=T})}),et(()=>{fetchLanguages()});async function O(){const{data:I,error:z}=await de.from("media").select("*").eq("id",c(a)).single();if(I){const D=I;m(o,D.name,!0),m(l,D.artist,!0),m(u,D.author_username,!0),m(d,D.cover,!0),m(h,D.level,!0),m(f,D.rating,!0),m(p,D.language,!0),m(_,D.embed_link,!0),m(v,D.content.events,!0),console.log(c(v)),console.log(`${c(_)}?enablejsapi=1`)}else m(o,"Unknown Song"),m(l,"Unknown Artist"),m(d,"https://img.youtube.com/vi/loquela/maxresdefault.jpg"),m(h,"Unknown Level"),m(f,"No Rating"),m(_,"https://youtu.be/zabswqP6xEM")}function C(I){let z=0;c(v).forEach(D=>{I>D.tStartMs&&I<c(v)[z+1].tStartMs&&D.segs.forEach(L=>{c(k)!==L.utf8&&m(k,L.utf8,!0)}),z++})}function T(){i=new YT.Player("player",{events:{onReady:()=>{setInterval(()=>{const I=i.getCurrentTime(),z=Math.round(I*1e3);C(z)},1)}}})}var E=Fd();zn(I=>{var z=Bd();y(Oe(z)),U(I,z)});var x=w(E);bt(x,{currentPage:"/music"});var S=y(x,2),A=y(w(S),2),P=w(A),M=w(P);io(M,{get song(){return c(o)},get artist(){return c(l)}});var B=y(P,2);lo(B,{get author(){return c(u)}});var J=y(B,2),K=y(J,2);Gn(K,{get currentLine(){return c(k)},get targetLanguage(){return c(p)}}),le(()=>{Ue(J,"src",`${c(_)}?enablejsapi=1`),Ue(J,"title",c(o))}),U(s,E),Ie(),n()}var Vd=W('<option class="svelte-1xupfpx"> </option>'),Hd=W('<option class="svelte-1xupfpx"> </option>'),Jd=W('<span class="svelte-1xupfpx"><label for="language">* Select further detail:</label> <select class="language svelte-1xupfpx" required><option class="svelte-1xupfpx">--Select--</option><!></select></span>'),Gd=W('<option class="svelte-1xupfpx"> </option>'),Kd=W('<main class="route  svelte-1xupfpx"><!> <section class="main-page"><h1 class="page-header">Upload</h1> <section class="notice svelte-1xupfpx"><h3 class="notice-text svelte-1xupfpx">Notice</h3> <p class="notice-text svelte-1xupfpx">Please ensure video has subtitles enabled by creator!</p></section> <section class="main-content svelte-1xupfpx"><form class="svelte-1xupfpx"><div class="vertical-container svelte-1xupfpx"><span class="svelte-1xupfpx"><label for="media">* Select media type:</label> <select class="media svelte-1xupfpx" required><option class="svelte-1xupfpx">--Pick the medium category--</option><option class="svelte-1xupfpx">ðº YT Video</option><option class="svelte-1xupfpx">ð§ Music</option></select></span> <span class="svelte-1xupfpx"><label for="language">* Select language of content:</label> <select class="language svelte-1xupfpx" required><option class="svelte-1xupfpx">--Select language--</option><!></select></span> <!> <span class="svelte-1xupfpx"><label for="level">* Select level of content:</label> <select class="level svelte-1xupfpx" required><option class="svelte-1xupfpx">--Select a level--</option><option class="svelte-1xupfpx">ð£ A1</option><option class="svelte-1xupfpx">ð¥ A2</option><option class="svelte-1xupfpx">ð¦ B1</option><option class="svelte-1xupfpx">ð¦ B2</option><option class="svelte-1xupfpx">ð¦ C1</option><option class="svelte-1xupfpx">ð¦ C2</option></select></span> <span class="svelte-1xupfpx"><label for="category">* Select category of content:</label> <select class="category svelte-1xupfpx" required><option class="svelte-1xupfpx">--Select category--</option><!></select></span></div> <span class="svelte-1xupfpx"><label for="url">Link to medium:</label> <input class="url svelte-1xupfpx" type="url" placeholder="Enter media URL"/></span> <button type="submit" class="push-btn svelte-1xupfpx"><span class="front-push-btn svelte-1xupfpx">Upload</span></button> <!></form></section></section></main>');function Yd(s,e){Ce(e,!0);let t=j(H({name:"",type:""})),r="",n="",a=j(""),i=j(""),o="",l="",u=j(H([])),d=j(H([])),h=j(""),f=j(""),p=j(void 0),v=j(void 0);be(()=>{var X;m(p,c(u).find(ue=>ue.short===c(a)),!0),m(v,(X=c(p))==null?void 0:X.sub_options,!0),console.log(c(v))});async function k(){const{data:X,error:ue}=await de.from("categories").select("*");m(d,X,!0)}k();function _(){Ls({particleCount:600,spread:100,origin:{y:0}})}et(async()=>{S(),O()});async function O(){const{data:X,error:ue}=await de.from("languages").select("*");if(X)return m(u,X,!0),console.log(c(u)),X;if(ue)throw ue}async function C(X,ue,pe,q,Y){try{if(await E(ue)){m(t,{type:"warn",name:"This has already been uploaded"},!0);return}X==="video"||X==="music"?(await T(ue,pe,X,q,Y),m(t,{type:"success",name:"Beginning upload..."},!0),_()):m(t,{type:"error",name:"Error in link validation"},!0)}catch(fe){console.error("Upload error:",fe),m(t,{type:"error",name:"Error in upload process"},!0)}}async function T(X,ue,pe,q,Y){const fe=de.channel("subtitles");await fe.subscribe();const $e=await fe.send({type:"broadcast",event:"subtitle-update",payload:{id:1,url:X,lang:ue,type:pe,level:q,author:c(h),author_username:c(f),category:Y}});console.log("Broadcast result:",$e)}async function E(X){const{data:ue,error:pe}=await de.from("media").select("*").eq("video_link",X).single();if(pe){if(pe.details&&pe.details.includes("0 rows"))return!1;console.error("Database error:",pe)}return!!ue}async function x(X,ue,pe,q,Y){try{const fe=await fetch(`https://www.youtube.com/oembed?url=${encodeURIComponent(X)}&format=json`);return console.log(fe),console.log(X),!fe.ok||!X.startsWith("https://www.youtube.com/watch?v=")?(m(t,{type:"error",name:"Invalid URL. Must be in format 'https://www.youtube.com/watch?v='"},!0),!1):(await C(ue,X,pe,q,Y),!0)}catch(fe){return console.error("Validation error:",fe),m(t,{type:"error",name:"Error validating URL"},!0),!1}}async function S(){const{data:X,error:ue}=await de.auth.getSession(),pe=X;if(ue)console.error("Error fetching session:",ue);else if(pe){m(h,pe.session.user.id,!0);const{data:q,error:Y}=await de.from("profiles").select("username").eq("user_id",c(h)).single();q&&m(f,q.username,!0),Y&&console.log(Y)}ue&&console.error("Error fetching userID:",ue)}be(()=>{c(i)?m(i,c(i),!0):m(i,c(a),!0)});var A=Kd(),P=w(A);bt(P,{currentPage:"/upload"});var M=y(P,2),B=y(w(M),4),J=w(B),K=w(J),I=w(K),z=y(w(I),2),D=w(z);D.value=D.__value="";var L=y(D);L.value=L.__value="video";var Q=y(L);Q.value=Q.__value="music";var re=y(I,2),me=y(w(re),2),b=w(me);b.value=b.__value="";var g=y(b);Me(g,17,()=>c(u),Pe,(X,ue)=>{var pe=Vd(),q=w(pe),Y={};le(()=>{ee(q,`${c(ue).emoji??""} ${c(ue).name??""}`),Y!==(Y=c(ue).short)&&(pe.value=(pe.__value=c(ue).short)??"")}),U(X,pe)});var R=y(re,2);{var N=X=>{var ue=Jd(),pe=y(w(ue),2),q=w(pe);q.value=q.__value="";var Y=y(q);Me(Y,17,()=>c(v),Pe,(fe,$e)=>{var _e=Hd(),ke=w(_e),Ne={};le(()=>{ee(ke,c($e).name),Ne!==(Ne=c($e).codes)&&(_e.value=(_e.__value=c($e).codes)??"")}),U(fe,_e)}),He(pe,()=>c(i),fe=>m(i,fe)),U(X,ue)};ce(R,X=>{c(a).length>1&&X(N)})}var V=y(R,2),G=y(w(V),2),Z=w(G);Z.value=Z.__value="";var $=y(Z);$.value=$.__value="A1";var F=y($);F.value=F.__value="A2";var te=y(F);te.value=te.__value="B1";var se=y(te);se.value=se.__value="B2";var ne=y(se);ne.value=ne.__value="C1";var ae=y(ne);ae.value=ae.__value="C2";var Ee=y(V,2),ie=y(w(Ee),2),Ae=w(ie);Ae.value=Ae.__value="";var Le=y(Ae);Me(Le,17,()=>c(d),Pe,(X,ue)=>{var pe=Gd(),q=w(pe),Y={};le(()=>{ee(q,`${c(ue).emoji??""} ${c(ue).name??""}`),Y!==(Y=c(ue).name)&&(pe.value=(pe.__value=c(ue).name)??"")}),U(X,pe)});var Re=y(K,2),ze=y(w(Re),2),qe=y(Re,4);{var De=X=>{At(X,{get type(){return c(t).type},get message(){return c(t).name},width:"17em"})};ce(qe,X=>{c(t).name&&X(De)})}Xe("submit",J,X=>{X.preventDefault(),x(n,r,c(i),o,l)}),He(z,()=>r,X=>r=X),He(me,()=>c(a),X=>m(a,X)),He(G,()=>o,X=>o=X),He(ie,()=>l,X=>l=X),pt(ze,()=>n,X=>n=X),U(s,A),Ie()}var Qd=W('<section class="svelte-i5t88f"><span class="text-container svelte-i5t88f"><a class="svelte-i5t88f"><h1 class="name svelte-i5t88f"> </h1></a> <p class="terms svelte-i5t88f"> </p> <p class="author svelte-i5t88f"> </p></span> <span class="language-image-container svelte-i5t88f"><img class="svelte-i5t88f"/></span></section>');function Zd(s,e){var t=Qd(),r=w(t),n=w(r),a=w(n),i=w(a),o=y(n,2),l=w(o),u=y(o,2),d=w(u),h=y(r,2),f=w(h);le(()=>{Ue(n,"href",`#/app/flashcards/${e.id}`),ee(i,e.name),ee(l,`Terms: ${e.terms??""}`),ee(d,`@${e.author??""}`),Ue(f,"src",`https://hatscripts.github.io/circle-flags/flags/${e.country??""}.svg`)}),U(s,t)}var Xd=W('<p class="not-found svelte-3pf8ly">:/ Oops! No flashcards found; try uploading your own or try again later.</p>'),eh=W("<option> </option>"),th=W('<main class="route svelte-3pf8ly"><!> <section class="main-page"><h1 class="page-header svelte-3pf8ly">Flashcards</h1> <section class="main-content svelte-3pf8ly"><button class="create-flashcard-deck svelte-3pf8ly">+ Create Flashcard Deck</button> <section class="flashcard-decks svelte-3pf8ly"><!> <!></section></section></section></main> <dialog class="svelte-3pf8ly"><div class="dialog-container svelte-3pf8ly"><div><h2 class="svelte-3pf8ly">Create Flashcard Deck</h2> <h1 class="svelte-3pf8ly"> </h1> <form class="svelte-3pf8ly"><span class="svelte-3pf8ly"><label>Deck name:</label> <input class="name svelte-3pf8ly"/></span> <span class="svelte-3pf8ly"><label>Language:</label> <select class="language svelte-3pf8ly"><option>--Select language--</option><!></select></span> <input class="submit-btn svelte-3pf8ly" type="Submit"/></form></div> <button class="close-dialog-button svelte-3pf8ly">Close</button></div></dialog>',1);function sh(s,e){Ce(e,!0);let t,r,n,a=j(H([])),i=j(void 0),o=j(""),l=j(H([]));et(async()=>{h(),u(),t.close()}),be(async()=>{if(c(i)){const{data:b,error:g}=await de.from("flashcard_decks").select("*");g&&console.error("Error fetching flashcard decks:",g),m(l,b||[],!0),console.log(c(l))}});async function u(){const{data:b,error:g}=await de.from("languages").select("*");if(b)return m(a,b,!0),console.log(c(a)),b;if(g)throw g}async function d(b,g,R,N,V){const{error:G}=await de.from("flashcard_decks").insert({name:b,author:g,author_username:V,language:R,country_code:N,content:[]});console.log(G),location.reload()}async function h(){const{data:b,error:g}=await de.auth.getSession(),R=b;if(g)console.error("Error fetching session:",g);else if(R){m(i,R.session.user.id,!0);const{data:N,error:V}=await de.from("profiles").select("username").eq("user_id",c(i)).single();N&&m(o,N.username,!0),V&&console.log(V)}}var f=th(),p=Oe(f),v=w(p);bt(v,{currentPage:"/flashcards"});var k=y(v,2),_=y(w(k),2),O=w(_);O.__click=()=>t.showModal();var C=y(O,2),T=w(C);{var E=b=>{var g=Xd();U(b,g)};ce(T,b=>{c(l)[0]||b(E)})}var x=y(T,2);Me(x,17,()=>c(l),Pe,(b,g)=>{Zd(b,{get name(){return c(g).name},get author(){return c(g).author_username},get terms(){return c(g).content.length},get country(){return c(g).country_code},get id(){return c(g).id}})});var S=y(p,2),A=w(S),P=w(A),M=y(w(P),2),B=w(M),J=y(M,2),K=w(J),I=y(w(K),2),z=y(K,2),D=y(w(z),2),L=w(D);L.value=L.__value="";var Q=y(L);{var re=b=>{var g=jt(),R=Oe(g);Me(R,17,()=>c(a),Pe,(N,V,G)=>{var Z=eh(),$=w(Z);Z.value=Z.__value=G,le(()=>ee($,`${c(V).emoji??""} ${c(V).name??""}`)),U(N,Z)}),U(b,g)};ce(Q,b=>{c(a)&&b(re)})}var me=y(P,2);me.__click=()=>t.close(),ht(S,b=>t=b,()=>t),le(()=>ee(B,c(a)[n])),Xe("submit",J,b=>{d(r,c(i),c(a)[n].short,c(a)[n].country_code,c(o))}),pt(I,()=>r,b=>r=b),He(D,()=>n,b=>n=b),U(s,f),Ie()}is(["click"]);function rh(s,e){e().forEach(t=>{const r=document.getElementsByClassName(t);r&&Array.from(r).forEach(n=>{n.classList.remove("hidden")})})}function nh(s,e,t,r){e.content[c(t)]&&(c(r).push(e.content[c(t)]),ci(t))}function ah(s,e,t,r,n,a){e.content[c(t)]&&(c(r).push(e.content[c(t)]),ci(t)),c(n)===100&&a()}function ih(s,e,t,r,n){m(e,0),m(t,[],!0),c(r).forEach(a=>{n.content.splice(n.content.indexOf(a),1)}),m(r,[],!0)}var oh=W('<div class="title-author-container svelte-baker"><h1 class="deck-name-heading svelte-baker"> </h1> <p class="deck-name-author svelte-baker">Uploaded by: <b> </b></p></div>'),lh=W('<i><p class="romanisation svelte-baker"> </p></i>'),ch=W('<span class="card-count-container svelte-baker"><span class="unsure-count card-count svelte-baker"> </span> <span class="known-count card-count svelte-baker"> </span></span> <div class="flashcard svelte-baker"><h1 class="word svelte-baker"> </h1> <span class="word-details svelte-baker"><!> <p class="part-of-speech svelte-baker"> </p></span> <p class="definition svelte-baker"> </p></div> <span class="buttons svelte-baker"><button class="dont-know flashcard-button svelte-baker"><span class="material-symbols-rounded svelte-baker">do_not_disturb</span>Unsure</button> <button class="flip flashcard-button svelte-baker"><span class="material-symbols-rounded svelte-baker">autorenew</span>Flip</button> <button class="know flashcard-button svelte-baker"><span class="material-symbols-rounded svelte-baker">check_circle</span>Know</button></span>',1),uh=W('<button class="flashcard-continue svelte-baker"><span class="material-symbols-rounded svelte-baker">expand_circle_right</span> Continue with unknown terms</button>'),dh=W('<p class="svelte-baker">Congratulations! You know all the terms in this deck!</p>'),hh=W('<div class="flashcard svelte-baker"><p class="known-percentage svelte-baker"> </p> <!> <!></div>'),fh=W('<main class="svelte-baker"><!> <!> <!></main>');function vh(s,e){Ce(e,!0);const t=we(e,"backContent",19,()=>[]),r=we(e,"author",3,"");let n=j(0),a=j(H([])),i=j(H([])),o="",l=j(H(o.word)),u=j(H(o.definition)),d=j(H(o.partOfSpeech)),h=j(H(o.romanisation)),f=j(0);be(()=>{m(f,Math.round(c(i).length/(c(a).length+c(i).length)*100),!0)}),console.log(e.content),et(()=>{be(()=>{if(e.content&&Array.isArray(e.content)&&e.content[c(n)]){const S=JSON.parse(e.content[c(n)]);console.log(S),m(l,S.word,!0),m(u,S.definition,!0),m(d,S.partOfSpeech,!0),m(h,S.romanisation,!0),p()}})});function p(){t().forEach(S=>{const A=document.getElementsByClassName(S);A&&Array.from(A).forEach(P=>{P.classList.add("hidden")})})}function v(){Ls({particleCount:200,spread:70,origin:{y:0}})}var k=fh(),_=w(k);{var O=S=>{var A=oh(),P=w(A),M=w(P),B=y(P,2),J=y(w(B)),K=w(J);le(()=>{ee(M,e.deckName),ee(K,`@${r()??""}`)}),U(S,A)};ce(_,S=>{r()&&e.deckName&&S(O)})}var C=y(_,2);{var T=S=>{var A=ch(),P=Oe(A),M=w(P),B=w(M),J=y(M,2),K=w(J),I=y(P,2),z=w(I),D=w(z),L=y(z,2),Q=w(L);{var re=$=>{var F=lh(),te=w(F),se=w(te);le(()=>ee(se,c(h))),U($,F)};ce(Q,$=>{c(h)&&$(re)})}var me=y(Q,2),b=w(me),g=y(L,2),R=w(g),N=y(I,2),V=w(N);V.__click=[nh,e,n,a];var G=y(V,2);G.__click=[rh,t];var Z=y(G,2);Z.__click=[ah,e,n,i,f,v],le(()=>{ee(B,c(a).length),ee(K,c(i).length),ee(D,c(l)),ee(b,c(d)),ee(R,c(u))}),U(S,A)};ce(C,S=>{c(n)!==e.content.length&&S(T)})}var E=y(C,2);{var x=S=>{var A=hh(),P=w(A),M=w(P),B=y(P,2);{var J=z=>{var D=uh();D.__click=[ih,n,a,i,e],U(z,D)};ce(B,z=>{c(f)!==100&&z(J)})}var K=y(B,2);{var I=z=>{var D=dh();U(z,D)};ce(K,z=>{c(f)===100&&z(I)})}le(()=>ee(M,`Known: ${c(f)??""}%`)),U(S,A)};ce(E,S=>{c(n)===e.content.length&&S(x)})}U(s,k),Ie()}is(["click"]);var ph=W("<h3>Oops! Looks like there are no cards in this deck. Try going to a video, song or AI Chat and add some!</h3>"),gh=W('<main class="route svelte-967ptl"><!> <section class="main-page"><h1 class="page-header">Flashcards</h1> <section class="main-content svelte-967ptl"><!> <!></section></section></main>');function _h(s,e){Ce(e,!0);const t=()=>$s(Us,"$location",r),[r,n]=Rs();let a=H(t().split("/").pop()),i=j(H([])),o=j(0),l="",u=j(H(l.flashcardDeckName)),d=j(H(l.flashcardDeckAuthor));et(async()=>{const E=await h(a);E?(m(u,E.name,!0),m(d,E.author_username,!0),m(i,E.content,!0),m(o,c(i).length,!0),console.log(c(o))):console.error("Flashcards not found")});async function h(E){const{data:x,error:S}=await de.from("flashcard_decks").select("*").eq("id",E).single();if(S){console.error(S);return}return x}var f=gh(),p=w(f);bt(p,{currentPage:"/flashcards"});var v=y(p,2),k=y(w(v),2),_=w(k);{var O=E=>{vh(E,{get content(){return c(i)},backContent:["part-of-speech","definition"],get deckName(){return c(u)},get author(){return c(d)}})};ce(_,E=>{c(i)&&c(i).length>0&&E(O)})}var C=y(_,2);{var T=E=>{var x=ph();U(E,x)};ce(C,E=>{!c(i).length>0&&E(T)})}U(s,f),Ie(),n()}var mh=W("<option> </option>"),yh=W("<option> </option>"),wh=W('<span><label for="language">Select further detail:</label> <select class="language svelte-yxunt" required><option>--Select--</option><!></select></span>'),bh=W("<p>Try selecting a language to show media. If no languages show up, come back later as the servers may be down.</p>"),kh=W('<h1 class="category-title svelte-yxunt"> </h1> <section class="category-section svelte-yxunt"></section>',1),Sh=W('<main class="route svelte-yxunt"><!> <section class="main-page"><h1 class="page-header">Videos</h1> <section class="main-content svelte-yxunt"><select class="language-select svelte-yxunt"></select> <!> <section class="media-container svelte-yxunt"><!> <!> <section class="categories-section svelte-yxunt"></section></section></section></section></main>');function Eh(s,e){Ce(e,!0);let t=j(H([])),r=j(H([])),n="",a=j(""),i=j(""),o=j(""),l=j(""),u=j(H({}));async function d(){const{data:I,error:z}=await de.from("categories").select("*");m(l,I,!0)}et(()=>{d()}),be(()=>{console.log(c(l))});async function h(I){const{data:z,error:D}=await de.from("media").select("*").eq("language",I).eq("media_type","video");D?console.error("Error fetching videos:",D):(console.log(c(t)),console.log(z),z.forEach(L=>{c(t).push(L||[])}),console.log(c(t)),m(u,[],!0),await p(c(t)))}function f(I){const z=c(l).find(D=>D.name===I);return z?z.emoji:"ð·ï¸"}async function p(I){I.forEach(z=>{if(z){let D=z.category;D||(D="Uncategorised"),!c(u)[D]&&D&&(c(u)[D]=[]),c(u)[D].push(z)}console.log(c(u))})}be(()=>{console.log(c(t))});async function v(){const{data:I,error:z}=await de.from("languages").select("*");if(I)return m(r,I,!0),console.log(c(r)),I;if(z)throw z}et(()=>{v()}),be(()=>{m(t,[],!0),Array.isArray(c(a))&&c(a).forEach(I=>{console.log(I),h(I)})});let k=j(void 0),_=j(void 0);be(()=>{var I;m(k,c(r).find(z=>z.short===c(i)),!0),m(_,(I=c(k))==null?void 0:I.sub_options,!0),console.log(c(_))}),be(()=>{c(i).length===1?m(a,c(i),!0):m(a,c(o),!0)});var O=Sh(),C=w(O);bt(C,{currentPage:"/videos"});var T=y(C,2),E=y(w(T),2),x=w(E);Me(x,21,()=>c(r),Pe,(I,z,D,L)=>{var Q=mh(),re=w(Q),me={};le(()=>{ee(re,`${c(z).emoji??""} ${c(z).name??""}`),me!==(me=c(z).short)&&(Q.value=(Q.__value=c(z).short)??"")}),U(I,Q)});var S=y(x,2);{var A=I=>{var z=wh(),D=y(w(z),2),L=w(D);L.value=L.__value="";var Q=y(L);Me(Q,17,()=>c(_),Pe,(re,me)=>{var b=yh(),g=w(b),R={};le(()=>{ee(g,c(me).name),R!==(R=c(me).codes)&&(b.value=(b.__value=c(me).codes)??"")}),U(re,b)}),He(D,()=>c(o),re=>m(o,re)),U(I,z)};ce(S,I=>{c(i).length>1&&I(A)})}var P=y(S,2),M=w(P);ce(M,I=>{c(t)[0]});var B=y(M,2);{var J=I=>{var z=bh();U(I,z)};ce(B,I=>{c(i)||I(J)})}var K=y(B,2);Me(K,21,()=>Object.entries(c(u)),Pe,(I,z,D,L)=>{var Q=js(()=>wo(c(z),2));let re=()=>c(Q)[0],me=()=>c(Q)[1];var b=kh(),g=Oe(b),R=w(g),N=y(g,2);Me(N,21,me,Pe,(V,G)=>{{let Z=js(()=>`#/app/videos/${c(G).id}`);ao(V,{get name(){return c(G).name},get artist(){return c(G).artist},get cover(){return c(G).cover},get level(){return c(G).level},get rating(){return c(G).rating},get link(){return c(Z)},type:"video"})}}),le(V=>ee(R,`${V??""} ${re()??""}`),[()=>f(re())]),U(I,b)}),He(x,()=>c(i),I=>m(i,I)),U(s,O),Ie()}var xh=qn(W('<script src="https://www.youtube.com/iframe_api"><\/script><!>',1)),Th=W("<p>Oops. Loquelis is struggling to the media - it may be invalid or unavailable.</p>"),jh=W('<main class="route svelte-1ml0pbe"><!> <section class="main-page svelte-1ml0pbe"><h1 class="page-header svelte-1ml0pbe">Videos</h1> <section class="main-content svelte-1ml0pbe"><span class="heading svelte-1ml0pbe"><!> <!></span> <iframe id="player" frameborder="0" allowfullscreen="" class="svelte-1ml0pbe"></iframe> <!> <!></section></section></main>');function Oh(s,e){Ce(e,!0);const t=()=>$s(Us,"$location",r),[r,n]=Rs();let a=j(H(t().split("/").pop())),i,o=j("Loading..."),l=j("Loading..."),u=j("Loading..."),d=j("Loading..."),h=j("https://img.youtube.com/vi/loquela/maxresdefault.jpg"),f=j("Unknown Level"),p=j("No Rating"),v=j(""),k=j(H([])),_=j(void 0),O=j("https://youtu.be/zabswqP6xEM");be(()=>{const L=t().split("/").pop();L!=c(a)&&m(a,L,!0),C().then(()=>{window.YT?E():window.onYouTubeIframeAPIReady=E})});async function C(){const{data:L,error:Q}=await de.from("media").select("*").eq("id",c(a)).single();if(L){const re=L;m(o,re.name,!0),m(d,re.artist,!0),m(l,re.author_username,!0),m(u,re.author_username,!0),m(h,re.cover,!0),m(f,re.level,!0),m(p,re.rating,!0),m(v,re.language,!0),m(O,re.embed_link,!0),m(k,re.content.events,!0),console.log(c(k)),console.log(`${c(O)}?enablejsapi=1`)}else m(o,"Unknown Video"),m(d,"Unknown Artist"),m(h,"https://img.youtube.com/vi/loquela/maxresdefault.jpg"),m(f,"Unknown Level"),m(p,"No Rating"),m(O,"https://youtu.be/zabswqP6xEM")}function T(L){let Q=0;c(k).forEach(re=>{L>re.tStartMs&&L<c(k)[Q+1].tStartMs&&re.segs.forEach(me=>{c(_)!==me.utf8&&m(_,me.utf8,!0)}),Q++})}function E(){i=new YT.Player("player",{events:{onReady:()=>{setInterval(()=>{const L=i.getCurrentTime(),Q=Math.round(L*1e3);T(Q)},1)}}})}var x=jh();zn(L=>{var Q=xh();y(Oe(Q)),U(L,Q)});var S=w(x);bt(S,{currentPage:"/videos"});var A=y(S,2),P=y(w(A),2),M=w(P),B=w(M);io(B,{get song(){return c(o)},get artist(){return c(d)}});var J=y(B,2);lo(J,{get author(){return c(l)}});var K=y(M,2),I=y(K,2);{var z=L=>{var Q=Th();U(L,Q)};ce(I,L=>{c(O)==="https://youtu.be/zabswqP6xEM"&&L(z)})}var D=y(I,2);Gn(D,{get currentLine(){return c(_)},get targetLanguage(){return c(v)}}),le(()=>{Ue(K,"src",`${c(O)}?enablejsapi=1`),Ue(K,"title",c(o))}),U(s,x),Ie(),n()}var Ah=W('<img class="svelte-1afzn3p"/>'),Ph=W('<section class="ai-chat-box svelte-1afzn3p"><div class="pfp-name-occupation-container svelte-1afzn3p"><!> <div class="text svelte-1afzn3p"><a class="svelte-1afzn3p"><h2 class="svelte-1afzn3p"> </h2></a> <p class="occupation svelte-1afzn3p"> </p></div></div> <div class="flag-tags-container svelte-1afzn3p"><img class="lang-flag svelte-1afzn3p"/> <span class="traits svelte-1afzn3p"><p class="trait-tag svelte-1afzn3p"> </p></span></div></section>');function Mh(s,e){var t=Ph(),r=w(t),n=w(r);{var a=O=>{var C=Ah();le(()=>{Ue(C,"src",e.image),Ue(C,"alt",e.firstName)}),U(O,C)};ce(n,O=>{e.image&&O(a)})}var i=y(n,2),o=w(i),l=w(o),u=w(l),d=y(o,2),h=w(d),f=y(r,2),p=w(f),v=y(p,2),k=w(v),_=w(k);le(()=>{Ue(o,"href",`/#/app/ai-chat/${e.id}`),ee(u,e.firstName),ee(h,e.occupation),Ue(p,"src",`https://hatscripts.github.io/circle-flags/flags/${e.lang}.svg`),Ue(p,"alt",e.lang),ee(_,e.trait)}),U(s,t)}var Ch=(s,e)=>c(e).showModal(),Ih=W('<p class="not-found svelte-javkzk">:/ Oops! No flashcards found; try uploading your own or try again later.</p>'),$h=W("<option> </option>"),Rh=W("<option> </option>"),Dh=W('<span><label for="language" class="svelte-javkzk">* Select further detail:</label> <select class="language svelte-javkzk" required><option>--Select--</option><!></select></span>'),Lh=W("<option> </option>"),Uh=W("<option> </option>"),zh=(s,e)=>c(e).close(),qh=W('<main class="route svelte-javkzk"><!> <section class="main-page"><h1 class="page-header">AI Chat</h1> <section class="main-content svelte-javkzk"><button class="create-ai-character svelte-javkzk"><span class="material-symbols-rounded svelte-javkzk">person_add</span>Create AI Character</button> <div class="chats svelte-javkzk"><!> <!></div></section></section></main> <dialog class="svelte-javkzk"><div class="dialog-container svelte-javkzk"><h2 class="dialog-header svelte-javkzk">Create AI Character</h2> <form class="svelte-javkzk"><label class="svelte-javkzk">ðªª Character name:</label> <input class="name svelte-javkzk" required/> <span class="label-input-container svelte-javkzk"><label class="svelte-javkzk">ð¬ Language:</label> <select class="language svelte-javkzk" required><option>--Select language--</option><!></select></span> <!> <span class="label-input-container svelte-javkzk"><label class="svelte-javkzk">ð Occupation:</label> <select class="occupation svelte-javkzk" required><option>--Select occupation--</option><!></select></span> <span class="label-input-container svelte-javkzk"><label class="svelte-javkzk">ð§  Trait:</label> <select class="traits svelte-javkzk" required><option>--Select trait--</option><!></select></span> <!> <input class="submit-btn svelte-javkzk" type="Submit"/></form> <button class="close-dialog-btn svelte-javkzk">Close</button></div></dialog>',1);function Nh(s,e){Ce(e,!0),we(e,"occupation",3,"Knight"),we(e,"image",3,"https://image.pollinations.ai/prompt/Generate%20a%20pixar-style%20image%20of%20a%20knight%20called%20Hansel%20with%20traits%20of%20brave,%20adventurous%20who%20is%20dressed%20in%20traditional%20attire%20of%20German"),we(e,"firstName",3,"Hansel"),we(e,"trait",3,"Friendly"),we(e,"lang",3,"de");let t="",r=j(H(t.characterName)),n=j(H(t.characterTrait)),a=j(H(t.characterOccupation)),i=j(H([])),o=j(H([])),l=j(null),u=j(H([])),d=H([]),h=H([]),f=j(H([])),p=j(H([])),v=j(H([])),k="",_=j(H(k.characterCreateStatus)),O=j(H(k.characterCreateMessage));et(async()=>{await S(),await A(),T(),E(),C()});async function C(){const{data:q,error:Y}=await de.from("ai_characters").select("*").limit(20);q&&m(f,q,!0),Y&&console.error(Y)}function T(){Array.from(c(u)).forEach(q=>{console.log("gabo"),q.type==="occupation"?d.push(q.name):console.error("Error finding occupations")})}function E(){Array.from(c(u)).forEach(q=>{console.log("gabo"),q.type==="trait"?h.push(q.name):console.error("Error finding traits")})}async function x(q,Y,fe,$e,_e){m(_,""),m(O,""),console.log(_e);const{error:ke}=await de.from("ai_characters").insert([{name:q,trait:Y,occupation:fe,language:$e,country:_e,image:`https://image.pollinations.ai/prompt/Generate a pixar-style image of a ${fe} called ${q} with trait of ${Y} who is dressed in traditional attire of ${$e}.`}]);ke||(m(_,"success"),m(O,"Created! Reload the page to see your character!")),ke&&(m(_,"error"),m(O,"Error adding character"),console.error(ke))}async function S(){const{data:q,error:Y}=await de.from("languages").select("*");if(q)return m(o,q,!0),console.log(c(o)),q;if(Y)throw Y}async function A(){const{data:q,error:Y}=await de.from("character_fields").select("*");if(q)return m(u,q,!0),console.log(c(u)),q;if(Y)throw Y}let P=j(void 0),M=j(void 0),B=j("");be(()=>{var q,Y;m(P,c(o).find(fe=>fe.short===c(i)),!0),m(M,(q=c(P))==null?void 0:q.sub_options,!0),m(B,(Y=c(P))==null?void 0:Y.country_code,!0),console.log(c(B))}),be(()=>{c(i).length===1?m(p,c(i),!0):m(p,c(v),!0),console.log(c(p))});var J=qh(),K=Oe(J),I=w(K);bt(I,{currentPage:"/ai-chat"});var z=y(I,2),D=y(w(z),2),L=w(D);L.__click=[Ch,l];var Q=y(L,2),re=w(Q);{var me=q=>{var Y=Ih();U(q,Y)};ce(re,q=>{c(f)[0]||q(me)})}var b=y(re,2);Me(b,17,()=>c(f),Pe,(q,Y)=>{Mh(q,{get id(){return c(Y).id},get image(){return c(Y).image},get firstName(){return c(Y).name},get trait(){return c(Y).trait},get lang(){return c(Y).country},get occupation(){return c(Y).occupation}})});var g=y(K,2),R=w(g),N=y(w(R),2),V=y(w(N),2),G=y(V,2),Z=y(w(G),2),$=w(Z);$.value=$.__value="";var F=y($);{var te=q=>{var Y=jt(),fe=Oe(Y);Me(fe,17,()=>c(o),Pe,($e,_e)=>{var ke=$h(),Ne=w(ke),Te={};le(()=>{ee(Ne,`${c(_e).emoji??""} ${c(_e).name??""}`),Te!==(Te=c(_e).short)&&(ke.value=(ke.__value=c(_e).short)??"")}),U($e,ke)}),U(q,Y)};ce(F,q=>{c(o)&&q(te)})}var se=y(G,2);{var ne=q=>{var Y=Dh(),fe=y(w(Y),2),$e=w(fe);$e.value=$e.__value="";var _e=y($e);Me(_e,17,()=>c(M),Pe,(ke,Ne)=>{var Te=Rh(),kt=w(Te),at={};le(()=>{ee(kt,c(Ne).name),at!==(at=c(Ne).codes)&&(Te.value=(Te.__value=c(Ne).codes)??"")}),U(ke,Te)}),He(fe,()=>c(v),ke=>m(v,ke)),U(q,Y)};ce(se,q=>{c(i).length>1&&q(ne)})}var ae=y(se,2),Ee=y(w(ae),2),ie=w(Ee);ie.value=ie.__value="";var Ae=y(ie);{var Le=q=>{var Y=jt(),fe=Oe(Y);Me(fe,17,()=>d,Pe,($e,_e,ke,Ne)=>{var Te=Lh(),kt=w(Te),at={};le(()=>{ee(kt,c(_e)),at!==(at=c(_e))&&(Te.value=(Te.__value=c(_e))??"")}),U($e,Te)}),U(q,Y)};ce(Ae,q=>{d&&q(Le)})}var Re=y(ae,2),ze=y(w(Re),2),qe=w(ze);qe.value=qe.__value="";var De=y(qe);{var X=q=>{var Y=jt(),fe=Oe(Y);Me(fe,17,()=>h,Pe,($e,_e,ke,Ne)=>{var Te=Uh(),kt=w(Te),at={};le(()=>{ee(kt,c(_e)),at!==(at=c(_e))&&(Te.value=(Te.__value=c(_e))??"")}),U($e,Te)}),U(q,Y)};ce(De,q=>{h&&q(X)})}var ue=y(Re,2);At(ue,{get type(){return c(_)},get message(){return c(O)}});var pe=y(N,2);pe.__click=[zh,l],ht(g,q=>m(l,q),()=>c(l)),Xe("submit",N,q=>{q.preventDefault(),x(c(r),c(n),c(a),c(p),c(B))}),pt(V,()=>c(r),q=>m(r,q)),He(Z,()=>c(i),q=>m(i,q)),He(Ee,()=>c(a),q=>m(a,q)),He(ze,()=>c(n),q=>m(n,q)),U(s,J),Ie()}is(["click"]);var Bh=async(s,e)=>await e(),Fh=(s,e,t)=>{c(e).showModal(),t()},Wh=(s,e,t,r)=>e(c(t),c(r)),Vh=W('<p class="ai-word svelte-1g4eeoh"> </p>'),Hh=W('<div class="message ai-sent svelte-1g4eeoh"></div>'),Jh=W('<div class="message user-sent svelte-1g4eeoh"> </div>'),Gh=W("<!> <!>",1),Kh=W('<span class="deck-label svelte-1g4eeoh">Deck: <b> </b></span>'),Yh=(s,e,t,r)=>e(c(t),r),Qh=W('<div class="chat-container svelte-1g4eeoh"><section class="header-messages-container svelte-1g4eeoh"><span class="chat-header svelte-1g4eeoh"><span class="pfp-name-container svelte-1g4eeoh"><img class="character-header-image svelte-1g4eeoh"/> <h3 class="svelte-1g4eeoh"> </h3> <p> </p> <p class="trait-tag svelte-1g4eeoh"> </p></span> <button class="ai-analysis-btn svelte-1g4eeoh">Get AI analysis of chat</button></span> <button class="test-deck-btn svelte-1g4eeoh">Get tested on a deck</button> <div class="messages-container svelte-1g4eeoh"></div></section> <div class="input-deck-label-container svelte-1g4eeoh"><!> <span class="send-container svelte-1g4eeoh"><input class="send-message-input svelte-1g4eeoh"/> <button class="send-message-btn svelte-1g4eeoh"><span class="material-symbols-rounded">send</span></button></span></div></div>'),Zh=W('<span class="sentence-container svelte-1g4eeoh"><span class="corrected_sentence_label_container svelte-1g4eeoh">ð <p class="original_sentence_label svelte-1g4eeoh">Original sentence:</p></span> <p class="original_sentence svelte-1g4eeoh"> </p></span> <span class="sentence-container svelte-1g4eeoh"><span class="corrected_sentence_label_container svelte-1g4eeoh">â <p class="corrected_sentence_label svelte-1g4eeoh">Corrected sentence:</p></span> <p class="corrected_sentence svelte-1g4eeoh"> </p></span>',1),Xh=W('<span class="analysis-character-container svelte-1g4eeoh"><img class="analysis-image svelte-1g4eeoh"/> <h1 class="analysis-header svelte-1g4eeoh"> </h1></span> <div class="stats-container svelte-1g4eeoh"><div class="ai-chat-analysis-container svelte-1g4eeoh"><h3 class="ai-chat-analysis-header svelte-1g4eeoh">ð¡ AI Chat Analysis</h3> <p class="ai-chat-analysis svelte-1g4eeoh"> </p></div> <!></div>',1),ef=W("<option required> </option>"),tf=(s,e)=>c(e).close(),sf=W('<main class="route svelte-1g4eeoh"><!> <section class="main-page svelte-1g4eeoh"><h1 class="page-header">AI Chat</h1> <section class="main-content svelte-1g4eeoh"><!> <!> <!></section></section></main> <dialog class="svelte-1g4eeoh"><div class="dialog-container svelte-1g4eeoh"><h2 class="dialog-header svelte-1g4eeoh">Select deck to be tested on:</h2> <form class="svelte-1g4eeoh"><select class="deck-select svelte-1g4eeoh"></select> <span class="deck-buttons-container svelte-1g4eeoh"><input type="Submit" class="submit-deck-btn svelte-1g4eeoh"/> <button class="close-deck-btn svelte-1g4eeoh">Close</button></span></form></div></dialog>',1);function rf(s,e){Ce(e,!0);const t=()=>$s(Us,"$location",r),[r,n]=Rs();let a=H(t().split("/").pop()),i=j(H(Object)),o=j(""),l=j(H([])),u=H([]),d=j(""),h=HTMLObjectElement,f=j(H(h.messagesContainer)),p=j(H(h.dialogBox)),v=j(void 0),k="",_=j(H(k.term)),O=j(H(k.definition)),C=j(H(k.partOfSpeech)),T=j(H(k.romanisation)),E=j("");et(async()=>{await x()}),be(async()=>{const{data:$,error:F}=await de.from("ai_characters").select("*").eq("id",a).single();F&&console.error(F),$&&m(i,$,!0)});async function x(){const{data:$,error:F}=await de.auth.getSession(),te=$;F?console.error("Error fetching session:",F):te&&m(E,te.session.user.id,!0),F&&console.error("Error fetching username:",F)}async function S($,F){let te="";F.push({sender:"User",content:$}),c(l)!=[]?(print(c(l)),te=`You are an AI chatbot for a language learning app. 
                your name is ${c(i).name} - but you dont need to append that before your response
        Give short and simple responses and only respond in ISO CODE ${c(i).language} 
        Your job is a ${c(i).occupation} Even if the user gets something wrong, try to interperet it and don't give corrections 
        Base all your response lightly on the selected flashcard deck as the user selected the deck for you, the AI character to test me on. You dont need all words in one response. You can see which words you've used and haven't in chat history. Take it slow and but the words in at any order but they must make sense in context
        only respond in ISO ${c(i).language}
        your personality is ${c(i).trait} for character engagement reasons.
        Here is the deck content:
        ${c(l)[c(v)]}
        Here is the user response: 
        ${$}. 
        Here is the chat history:
       ${F.map(ae=>`SENT BY ${ae.sender}: ${ae.content}`)}`):te=`You are an AI chatbot for a language learning app. 
        your name is ${c(i).name} - but you dont need to append that before your response
        Give short and simple responses and only respond in ISO ${c(i).language} and and your personality is very exaggerated ${c(i).trait} . 
        Your job is a ${c(i).occupation} Even if the user gets something wrong, try to interperet it and don't give corrections 
        only respond in ISO ${c(i).language}
        Here is the user response: 
        ${$}. 
        Here is the chat history:
        ${F.map(ae=>`SENT BY ${ae.sender}: ${ae.content}`)}`,console.log(te);const se=await fetch(`https://text.pollinations.ai/prompt/${te}`);se.ok||console.error("AI API error:",se.statusText);const ne=await se.text();F.push({sender:"AI",content:ne}),console.log("AI Response:",ne)}async function A(){const $=`
    You are an AI for a language learning app. The user and AI are having a conversation in ${c(i).language}. The user's messages are marked with "User :". Your task is to return a pure JSON object as your response will be directly parsed into JSON and use no markdown annotates and the response has two fields:

    1. "analysis" â A strict critique in English aimed at helping the user improve. Also if flashcards deck is valid it means teh user wants to use or see all those deck words. So take that into your anaylisis account - pw well did they respond or did they use any flashcard words?
    2. "mistakes" â An array of objects. Each object must include:

    {
    "original_sentence": <user sentence>,
    "corrected_sentence": <correct version, even if its the same as original if no issues found>
    }

    â ï¸ Include **every single sentence** spoken by the user â even if it's 100% correct â so we can evaluate all usage. Do not skip or omit any. Assume all are full sentences. Do not return markdown, just raw JSON.

    Here is the deck content:
    ${c(l)[c(v)]}
    Conversation:
    ${u.map(ne=>`SENT BY ${ne.sender}: ${ne.content}`)}`,F=encodeURIComponent($);console.log($);const se=await(await fetch(`https://text.pollinations.ai/prompt/${F}`)).json();m(d,se,!0),console.log(c(d))}async function P(){if(!c(l)){const{data:$,error:F}=await de.from("flashcards").select("*").eq("author",c(E)).eq("language",c(i).language);F&&console.error("Error fetching flashcard decks:",F),$?m(l,$,!0):m(l,[],!0),console.log(c(l))}}function M(){c(p).close()}async function B($,F){let te=F;Array.isArray(F)&&(te=F.join(" "));const se=`you are being used as an AI to give a definition of a word based of context for a language learning software the language of the word and context is ISO code ${c(i).language} and the user's native language is english the word is ${$} and the context is ${te} so give your definition in ENGLISH and as part of your just definition NOT the partOfSpeech add helpful notes such as if its plural and its singular or its case/tense and its infintive etc. but keep it simple and short return as raw json with no backtick MD markers as your respone will be directly parsed into json respond with attributes word, partOfSpeech, romanisation and definition but do NOT return romanisation where it is not necessary`,ne=await fetch(`https://text.pollinations.ai/${se}`),ae=await ne.json();console.log(ne),m(_,ae.word,!0),m(O,ae.definition,!0),m(C,ae.partOfSpeech,!0),m(T,ae.romanisation,!0)}var J=sf(),K=Oe(J),I=w(K);bt(I,{currentPage:"/ai-chat"});var z=y(I,2),D=y(w(z),2),L=w(D);{var Q=$=>{var F=Qh(),te=w(F),se=w(te),ne=w(se),ae=w(ne),Ee=y(ae,2),ie=w(Ee),Ae=y(Ee,2),Le=w(Ae),Re=y(Ae,2),ze=w(Re),qe=y(ne,2);qe.__click=[Bh,A];var De=y(se,2);De.__click=[Fh,p,P];var X=y(De,2);Me(X,21,()=>u,Pe,(_e,ke)=>{var Ne=Gh(),Te=Oe(Ne);{var kt=Wt=>{var zs=Hh();Me(zs,21,()=>c(ke).content.split(" "),Pe,(Jr,Yn)=>{var Gr=Vh();Gr.__click=[Wh,B,Yn,ke];var uo=w(Gr);le(()=>ee(uo,c(Yn))),U(Jr,Gr)}),U(Wt,zs)};ce(Te,Wt=>{c(ke).sender==="AI"&&Wt(kt)})}var at=y(Te,2);{var co=Wt=>{var zs=Jh(),Jr=w(zs);le(()=>ee(Jr,c(ke).content)),U(Wt,zs)};ce(at,Wt=>{c(ke).sender==="User"&&Wt(co)})}U(_e,Ne)}),ht(X,_e=>m(f,_e),()=>c(f));var ue=y(te,2),pe=w(ue);{var q=_e=>{var ke=Kh(),Ne=y(w(ke)),Te=w(Ne);le(()=>ee(Te,c(l)[c(v)].name)),U(_e,ke)};ce(pe,_e=>{(c(v)||c(v)===0)&&_e(q)})}var Y=y(pe,2),fe=w(Y),$e=y(fe,2);$e.__click=[Yh,S,o,u],le(()=>{Ue(ae,"src",c(i).image),Ue(ae,"alt",`Image of charater ${c(i).name}`),ee(ie,c(i).name),ee(Le,c(i).occupation),ee(ze,c(i).trait)}),pt(fe,()=>c(o),_e=>m(o,_e)),U($,F)};ce(L,$=>{c(d)||$(Q)})}var re=y(L,2);oo(re,{get word(){return c(_)},get definition(){return c(O)},get partOfSpeech(){return c(C)},get romanisation(){return c(T)},get language(){return c(i).language}});var me=y(re,2);{var b=$=>{var F=Xh(),te=Oe(F),se=w(te),ne=y(se,2),ae=w(ne),Ee=y(te,2),ie=w(Ee),Ae=y(w(ie),2),Le=w(Ae),Re=y(ie,2);Me(Re,17,()=>c(d).mistakes,Pe,(ze,qe)=>{var De=Zh(),X=Oe(De),ue=y(w(X),2),pe=w(ue),q=y(X,2),Y=y(w(q),2),fe=w(Y);le(()=>{ee(pe,c(qe).original_sentence),ee(fe,c(qe).corrected_sentence)}),U(ze,De)}),le(()=>{Ue(se,"src",c(i).image),Ue(se,"alt",c(i).name),ee(ae,c(i).name),ee(Le,c(d).analysis)}),U($,F)};ce(me,$=>{c(d)&&$(b)})}var g=y(K,2),R=w(g),N=y(w(R),2),V=w(N);Me(V,21,()=>c(l),Pe,($,F,te)=>{var se=ef(),ne=w(se);se.value=se.__value=te,le(()=>ee(ne,c(F).name)),U($,se)});var G=y(V,2),Z=y(w(G),2);Z.__click=[tf,p],ht(g,$=>m(p,$),()=>c(p)),Xe("submit",N,$=>{$.preventDefault(),M()}),He(V,()=>c(v),$=>m(v,$)),U(s,J),Ie(),n()}is(["click"]);var nf=qn(W('<script src="https://www.youtube.com/iframe_api" class="svelte-18y4z1i"><\/script><!>',1)),af=(s,e)=>c(e).scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),of=(s,e)=>c(e).scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),lf=(s,e)=>c(e).scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),cf=(s,e)=>c(e).scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),uf=W(`<main class="svelte-18y4z1i"><section class="page-1 page svelte-18y4z1i"><div class="media-scroller svelte-18y4z1i"><div class="media-list svelte-18y4z1i"><span class="media-box music-media-box svelte-18y4z1i"><span class="emoji music-emoji svelte-18y4z1i">ð§</span> Music</span> <span class="media-box videos-media-box svelte-18y4z1i"><span class="emoji videos-emoji svelte-18y4z1i">ð¹</span> Videos</span> <span class="media-box flashcards-media-box svelte-18y4z1i"><span class="emoji flashcards-emoji svelte-18y4z1i">ðï¸</span> Flashcards</span> <span class="media-box ai-chats-media-box svelte-18y4z1i"><span class="emoji ai-chats-emoji svelte-18y4z1i">ð¬</span> AI Chats</span> <span class="media-box music-media-box svelte-18y4z1i"><span class="emoji music-emoji svelte-18y4z1i">ð§</span> Music</span> <span class="media-box videos-media-box svelte-18y4z1i"><span class="emoji videos-emoji svelte-18y4z1i">ð¹</span> Videos</span> <span class="media-box flashcards-media-box svelte-18y4z1i"><span class="emoji flashcards-emoji svelte-18y4z1i">ðï¸</span> Flashcards</span> <span class="media-box ai-chats-media-box svelte-18y4z1i"><span class="emoji ai-chats-emoji svelte-18y4z1i">ð¬</span> AI Chats</span></div></div> <section class="hero-1 svelte-18y4z1i"><h1 class="welcome svelte-18y4z1i">Welcome to Loquelis!!!</h1> <p class="welcome-message svelte-18y4z1i">ð¤ Happy to see you!</p></section> <button class="get-started-btn svelte-18y4z1i"><a href="./#/app/signup/" class="svelte-18y4z1i">Let's get started! â</a></button></section> <section class="page-2 page svelte-18y4z1i"><h1 class="svelte-18y4z1i">Let's get started with a language-learning favourite - Peppa Pig! ð·</h1> <span class="video-info-box info-box svelte-18y4z1i"><p class="icon svelte-18y4z1i">ð¡</p>Click on a word for a definition based off context, part of speech and romanisation.</span> <span class="video-info-box info-box svelte-18y4z1i"><p class="icon svelte-18y4z1i">ð</p>Play the video and watch the live subtitles flow through!</span> <section class="video-container svelte-18y4z1i"><iframe id="player" frameborder="0" allowfullscreen="" class="svelte-18y4z1i"></iframe> <!></section></section> <hr class="svelte-18y4z1i"/> <section class="page-3 page svelte-18y4z1i"><h2 class="svelte-18y4z1i">Learn with user curated/ custom:</h2> <div class="media-container svelte-18y4z1i"><span class="media-box music-media-box svelte-18y4z1i"><span class="emoji music-emoji svelte-18y4z1i">ð§</span> Music</span> <span class="media-box videos-media-box svelte-18y4z1i"><span class="emoji videos-emoji svelte-18y4z1i">ð¹</span> Videos</span> <span class="media-box flashcards-media-box svelte-18y4z1i"><span class="emoji flashcards-emoji svelte-18y4z1i">ðï¸</span> Flashcards</span> <span class="media-box ai-chats-media-box svelte-18y4z1i"><span class="emoji ai-chats-emoji svelte-18y4z1i">ð¬</span> AI Chats</span></div></section> <hr class="svelte-18y4z1i"/> <section class="page-4 page svelte-18y4z1i"><h1 class="media-header svelte-18y4z1i">ð§ Music</h1> <p class="media-p svelte-18y4z1i">Learn through user curated music options and immerse yourself in the culture of the region of your chosen language</p> <div class="media-image-container svelte-18y4z1i"><img src="https://upload.wikimedia.org/wikipedia/en/b/bc/Molchat_Doma_-_Etazhi.png" alt="Molchat Doma music" class="media-img svelte-18y4z1i"/> <img src="https://upload.wikimedia.org/wikipedia/en/4/40/99_Luftballons_single_cover.jpg" alt="99 Luftballons Music" class="media-img svelte-18y4z1i"/> <img src="https://upload.wikimedia.org/wikipedia/en/f/fa/RammsteinRadioSingleCover.jpg" alt="Rammstein Music" class="media-img svelte-18y4z1i"/> <img src="https://upload.wikimedia.org/wikipedia/en/2/20/Fortuna_Wheel.jpg" alt="Rammstein Music" class="media-img svelte-18y4z1i"/></div> <hr class="svelte-18y4z1i"/> <h1 class="media-header svelte-18y4z1i">ð¹ Video</h1> <p class="media-p svelte-18y4z1i">Learn through user curated video options and finally switch from textbooks to shows, documentaries, news and YouTubers</p> <div class="media-image-container svelte-18y4z1i"><img src="https://i.ytimg.com/vi/WYqIlqp2_9c/sddefault.jpg" alt="coca cola documentary in german" class="vid-media-img media-img svelte-18y4z1i"/> <img src="https://i.ytimg.com/vi/_fPXQnfCWqI/sddefault.jpg" class="vid-media-img media-img svelte-18y4z1i" alt="french news"/> <img src="https://i.ytimg.com/vi/ZzfeHWgEVDs/sddefault.jpg" alt="vlog video" class="vid-media-img media-img svelte-18y4z1i"/></div> <hr class="svelte-18y4z1i"/> <h1 class="media-header svelte-18y4z1i">ðï¸ Flashcards</h1> <p class="media-p svelte-18y4z1i">Create your own decks from words saved from songs, videos and AI Chats</p> <div class="media-image-container svelte-18y4z1i"><img src="https://raw.githubusercontent.com/Ewan-Dev/ewan.is-a.dev/refs/heads/main/frontend/static/food-deck.png" class="deck-media-img media-img svelte-18y4z1i" alt="deck"/> <img src="https://raw.githubusercontent.com/Ewan-Dev/ewan.is-a.dev/refs/heads/main/frontend/static/animals-deck.png" alt="deck" class="deck-media-img media-img svelte-18y4z1i"/> <img src="https://raw.githubusercontent.com/Ewan-Dev/ewan.is-a.dev/refs/heads/main/frontend/static/flashcards.png" alt="flashcards" class="deck-media-img media-img svelte-18y4z1i"/></div> <hr class="svelte-18y4z1i"/> <h1 class="media-header svelte-18y4z1i">ð¬ AI Chat</h1> <p class="media-p svelte-18y4z1i">Create your own AI character to practise your language skills and decks with.</p> <div class="media-image-container svelte-18y4z1i"><img src="https://raw.githubusercontent.com/Ewan-Dev/ewan.is-a.dev/refs/heads/main/frontend/static/ai-chat.png" alt="ai chat" class="ai-chat-img media-img svelte-18y4z1i"/></div></section> <hr class="svelte-18y4z1i"/> <section class="page-5 page svelte-18y4z1i"><h1 class="svelte-18y4z1i">Start your journey. <p class="blue svelte-18y4z1i">Today.</p></h1> <div class="sign-up-contact-container svelte-18y4z1i"><button class="big-get-started-btn svelte-18y4z1i"><a href="./#/app/signup/" class="svelte-18y4z1i">Get started! â</a></button> <button class="big-contact-btn svelte-18y4z1i"><span class="material-symbols-rounded svelte-18y4z1i">login</span><a href="./#/app/login/" class="contact-p svelte-18y4z1i">Sign in</a></button></div></section></main>`);function df(s,e){Ce(e,!0);const t=()=>$s(Us,"$location",r),[r,n]=Rs(),i={events:[{tStartMs:10791,dDurationMs:1508,segs:[{utf8:"Herr Vogelscheuche"}]},{tStartMs:15535,dDurationMs:4067,segs:[{utf8:"Peppa und Schorsch sind heute zu Besuch bei Oma und Opa Wutz."}]},{tStartMs:23350,dDurationMs:1641,segs:[{utf8:"Hallo Opa Wutz."}]},{tStartMs:25960,dDurationMs:3547,segs:[{utf8:"Huhu Hallo Peppa Hallo Schorsch."}]},{tStartMs:29571,dDurationMs:2317,segs:[{utf8:"Opa was machst du denn da?"}]},{tStartMs:31897,dDurationMs:2158,segs:[{utf8:"Ich pflanze einen Blumengarten."}]},{tStartMs:34072,dDurationMs:1579,segs:[{utf8:"Oh!"}]},{tStartMs:35675,dDurationMs:3720,segs:[{utf8:"Aus diesen Samen wachsen wunderschÃ¶ne Blumen."}]},{tStartMs:40090,dDurationMs:3153,segs:[{utf8:"Ich streue die SamenkÃ¶rner auf den Boden."}]},{tStartMs:44163,dDurationMs:2722,segs:[{utf8:"Dann decke ich sie mit Erde zu."}]},{tStartMs:47211,dDurationMs:1841,segs:[{utf8:"Oh wo sind sie denn?"}]},{tStartMs:49110,dDurationMs:1865,segs:[{utf8:"Die SamenkÃ¶rner sind verschwunden."}]},{tStartMs:50999,dDurationMs:4049,segs:[{utf8:`Wie merkwÃ¼rdig! 
Ich bin sicher dass ich hier Samen verstaut hatte.`}]},{tStartMs:55076,dDurationMs:2456,segs:[{utf8:`Ja Opa.
Wir haben es gesehen.`}]},{tStartMs:57932,dDurationMs:1598,segs:[{utf8:`Ja!
Jetzt sind sie weg.`}]},{tStartMs:60167,dDurationMs:3047,segs:[{utf8:"Na gut dann muss ich eben noch welche nehmen."}]},{tStartMs:63522,dDurationMs:4459,segs:[{utf8:"Wie schon sagte, ich treue die SamenkÃ¶rner einfach auf den Boden."}]},{tStartMs:70334,dDurationMs:3534,segs:[{utf8:"Ein kleiner Vogel pickt die SamenkÃ¶rner von Opa Wutz auf."}]},{tStartMs:73960,dDurationMs:765,segs:[{utf8:"Heyy!"}]},{tStartMs:74776,dDurationMs:1962,segs:[{utf8:"Lass meine SamenkÃ¶rner!"}]},{tStartMs:77137,dDurationMs:2561,segs:[{utf8:"Also da sind meine ganzen Samen hin."}]},{tStartMs:79709,dDurationMs:3240,segs:[{utf8:"Im Bauch von dem kleinen Vogel."}]},{tStartMs:83320,dDurationMs:3741,segs:[{utf8:"Und noch zwei kleine VÃ¶gel picken Opa wird SamenkÃ¶rner auf."}]},{tStartMs:87180,dDurationMs:1319,segs:[{utf8:"Oh Guck!"}]},{tStartMs:88507,dDurationMs:1987,segs:[{utf8:"Ah! Weg da Weg da!"}]},{tStartMs:91405,dDurationMs:1666,segs:[{utf8:"Was ist das fÃ¼r ein LÃ¤rm."}]},{tStartMs:93256,dDurationMs:3800,segs:[{utf8:`Oma Wutz!
Die VÃ¶gel picken meine ganzen Blumensamen weg.`}]},{tStartMs:97138,dDurationMs:2397,segs:[{utf8:"Und jetzt werden die VÃ¶gel weg."}]},{tStartMs:99765,dDurationMs:3239,segs:[{utf8:"Wegjagen hat keinen Zweck! Sie kommen einfach wieder."}]},{tStartMs:103020,dDurationMs:959,segs:[{utf8:"Guck!"}]},{tStartMs:104823,dDurationMs:2133,segs:[{utf8:"Wir brauchen eine Vogelscheuche."}]},{tStartMs:106990,dDurationMs:1964,segs:[{utf8:"Was ist eine Vogelscheuche?"}]},{tStartMs:109017,dDurationMs:3719,segs:[{utf8:"Eine Vogelscheuche ist ein Mann aus Stroh der den VÃ¶geln Angst macht."}]},{tStartMs:112761,dDurationMs:2916,segs:[{utf8:"Das ist eine gute Idee Oma Wutz."}]},{tStartMs:115697,dDurationMs:1305,segs:[{utf8:"Ich baue eine."}]},{tStartMs:117038,dDurationMs:1663,segs:[{utf8:"Kommt alle mit."}]},{tStartMs:119901,dDurationMs:6213,segs:[{utf8:"Wiedersehen kleine VÃ¶gel. Wir bauen eine Vogelscheuche."}]},{tStartMs:126387,dDurationMs:2133,segs:[{utf8:"Das ist Opa Wutz Gartenschuppen."}]},{tStartMs:128928,dDurationMs:4022,segs:[{utf8:"Hier drin gibt es eine Menge Sachen um eine Vogelscheuche zu bauen."}]},{tStartMs:133306,dDurationMs:3583,segs:[{utf8:"Zuerst brauchen wir zwei StÃ¶cke und etwas Kordel."}]},{tStartMs:136913,dDurationMs:2023,segs:[{utf8:"Das besorgen wir."}]},{tStartMs:140720,dDurationMs:4139,segs:[{utf8:"Peppa hat zwei StÃ¼cke gefunden Schorsch hat etwas Kordel gefunden."}]},{tStartMs:144900,dDurationMs:1090,segs:[{utf8:"Gut!"}]},{tStartMs:146042,dDurationMs:3400,segs:[{utf8:"Ich binde die StÃ¶cke zusammen. Das wird der KÃ¶rper."}]},{tStartMs:149529,dDurationMs:3666,segs:[{utf8:"Oma Wutz hat etwas Stroh gefunden und einen alten Sack."}]},{tStartMs:153237,dDurationMs:5544,segs:[{utf8:`GroÃartig!
Ich stecke das Stroh in den Sack. Das wird der Kopf.`}]},{tStartMs:158817,dDurationMs:3276,segs:[{utf8:"Jetzt braucht die Vogelscheuche was zum anziehen."}]},{tStartMs:162146,dDurationMs:2129,segs:[{utf8:"Hier ist eine Tasche mit alten Kleidern."}]},{tStartMs:164334,dDurationMs:5122,segs:[{utf8:`Oh!
Schorsch hat ein Kleid gefunden.`}]},{tStartMs:170717,dDurationMs:6222,segs:[{utf8:`Dumber Schorsch!
Herr Vogelscheuche hat doch kein Kleid an.`}]},{tStartMs:177184,dDurationMs:2503,segs:[{utf8:"Peppa hat einen Mantel gefunden."}]},{tStartMs:179918,dDurationMs:1875,segs:[{utf8:"Sehr gut Peppa!"}]},{tStartMs:183037,dDurationMs:1961,segs:[{utf8:"Schorsch hat einen Hut gefunden."}]},{tStartMs:185023,dDurationMs:1709,segs:[{utf8:"Sehr gut Schorsch."}]},{tStartMs:187126,dDurationMs:2881,segs:[{utf8:"Herr Vogelscheuche braucht ein Gesicht."}]},{tStartMs:190015,dDurationMs:1e3,segs:[{utf8:"Das Stimmt."}]},{tStartMs:191285,dDurationMs:2564,segs:[{utf8:"Willst du mit Schorch ein Gesicht fÃ¼r ihn malen."}]},{tStartMs:193911,dDurationMs:2596,segs:[{utf8:"Ja bitte."}]},{tStartMs:196794,dDurationMs:2467,segs:[{utf8:"Schorsch malt die Augen und die Nase."}]},{tStartMs:199643,dDurationMs:2004,segs:[{utf8:"Peppa malt den Mund."}]},{tStartMs:202331,dDurationMs:1949,segs:[{utf8:"Fantastisch!"}]},{tStartMs:204305,dDurationMs:1352,segs:[{utf8:"Herr Vogelscheuche ist fertig."}]},{tStartMs:205689,dDurationMs:1750,segs:[{utf8:"Hurraa"}]},{tStartMs:208970,dDurationMs:2877,segs:[{utf8:"Die kleinen VÃ¶gel suchen nach Opa Wutz Blumensamen."}]},{tStartMs:211985,dDurationMs:2704,segs:[{utf8:`Guck!
Die kleinen VÃ¶gel sind wieder da.`}]},{tStartMs:214706,dDurationMs:1327,segs:[{utf8:"Keine Sorge Peppa."}]},{tStartMs:216041,dDurationMs:2345,segs:[{utf8:"Die Vogelscheuche wird sie feucht."}]},{tStartMs:223868,dDurationMs:1266,segs:[{utf8:"Es funktioniert!"}]},{tStartMs:225194,dDurationMs:2491,segs:[{utf8:"Die Vogelscheuche hat die VÃ¶gel verscheucht."}]},{tStartMs:227757,dDurationMs:1528,segs:[{utf8:"Hurra!"}]},{tStartMs:229296,dDurationMs:726,segs:[{utf8:" Gut!"}]},{tStartMs:230099,dDurationMs:3049,segs:[{utf8:"Jetzt werden meine Blumensamen nicht mehr gefressen."}]},{tStartMs:234964,dDurationMs:4325,segs:[{utf8:"Oh Opa die kleinen VÃ¶gel sehen sehr traurig aus."}]},{tStartMs:239329,dDurationMs:2435,segs:[{utf8:"Ja sie haben sicher Hunger."}]},{tStartMs:241820,dDurationMs:1730,segs:[{utf8:"DafÃ¼r habe ich das hier."}]},{tStartMs:243594,dDurationMs:1951,segs:[{utf8:"Das ist das Oma?"}]},{tStartMs:245561,dDurationMs:1721,segs:[{utf8:"Eine Futterstation."}]},{tStartMs:247307,dDurationMs:5499,segs:[{utf8:"Opa gibst du mir bitte etwas von den Samen."}]},{tStartMs:254689,dDurationMs:3828,segs:[{utf8:"Kommt ihr VÃ¶gelchen. Essen Zeit."}]},{tStartMs:259175,dDurationMs:2599,segs:[{utf8:"Jetzt haben die VÃ¶gel ihre eigenen Samen."}]},{tStartMs:262604,dDurationMs:2274,segs:[{utf8:"Die kleinen VÃ¶gel sind wieder glÃ¼cklich."}]},{tStartMs:264903,dDurationMs:3639,segs:[{utf8:"Peppa ist froh dass Opas Blumensamen nicht gefressen werden."}]},{tStartMs:268644,dDurationMs:8125,segs:[{utf8:"Aber noch vor ist sie dass die kleinen VÃ¶gel auch etwas zu fressen haben."}]}]}.events;console.log(i);let o=j(void 0),l=j(void 0),u=j(void 0),d=j(void 0);H([]);let h,f=j("Peppa Wutz");be(()=>{t().split("/").pop()==="welcome"&&(p(),window.YT?v():window.onYouTubeIframeAPIReady=v)});function p(){Ls({particleCount:1e3,spread:150,origin:{y:0}})}function v(){h=new YT.Player("player",{events:{onReady:()=>{setInterval(()=>{const D=h.getCurrentTime(),L=Math.round(D*1e3);k(L)},1)}}})}function k(D){let L=0;i.forEach(Q=>{D>Q.tStartMs&&D<i[L+1].tStartMs&&Q.segs.forEach(re=>{c(f)!==re.utf8&&(m(f,re.utf8,!0),console.log(re.utf8))}),L++})}var _=uf();zn(D=>{var L=nf();y(Oe(L)),U(D,L)});var O=y(w(_),2),C=y(w(O),6),T=w(C);Ue(T,"src","https://www.youtube.com/embed/Q_sqR4aLLu0?enablejsapi=1"),Ue(T,"title","peppapig");var E=y(T,2);Gn(E,{get currentLine(){return c(f)},targetLanguage:"de"});var x=y(O,4),S=y(w(x),2),A=w(S);A.__click=[af,o];var P=y(A,2);P.__click=[of,l];var M=y(P,2);M.__click=[lf,u];var B=y(M,2);B.__click=[cf,d];var J=y(x,4),K=y(w(J),6);ht(K,D=>m(l,D),()=>c(l));var I=y(K,8);ht(I,D=>m(u,D),()=>c(u));var z=y(I,10);ht(z,D=>m(d,D),()=>c(d)),ht(J,D=>m(o,D),()=>c(o)),U(s,_),Ie(),n()}is(["click"]);var hf=()=>{window.open("#/app/home")},ff=W('<head><link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:wght@400" rel="stylesheet"/></head> <main class="svelte-1n46o8q"><dialog class="svelte-1n46o8q"><form class="svelte-1n46o8q"><label class="username-header svelte-1n46o8q">ð¤ Set a username:</label> <span class="input-container svelte-1n46o8q"><p class="at-symbol svelte-1n46o8q">@</p><input placeholder="username" class="username-input svelte-1n46o8q"/></span> <input type="Submit" class="svelte-1n46o8q"/> <button class="close-button-username svelte-1n46o8q">Close</button> <!></form></dialog> <dialog open class="auth-notice svelte-1n46o8q"><h2>Already logged in</h2> <p>You already have a user session saved.</p> <button class="dialog-auth-btn svelte-1n46o8q">Continue anyway</button> <button class="dialog-auth-btn svelte-1n46o8q">Go to user homepage</button></dialog> <!></main>',1);function vf(s,e){Ce(e,!0);const t=()=>$s(Us,"$location",r),[r,n]=Rs(),a={"/app/welcome":df,"/app/ai-chat/:slug":rf,"/app/ai-chat":Nh,"/app/videos/:slug":Oh,"/app/videos":Eh,"/app/flashcards/:slug":_h,"/app/flashcards":sh,"/app/upload":Yd,"/app/music/:slug":Wd,"/app/music":Pd,"/app/login":_d,"/app/login/:slug":wd,"/app/signup":vd,"/app/home":cd};let i=j(""),o=j(""),l="",u=j(H(l.statusMessage)),d=j(H(l.statusType)),h=j(""),f,p,v=j(H(t()));et(()=>{f==null||f.close(),m(v,t(),!0)}),be(()=>{m(v,t(),!0),c(h)&&(c(v)==="/app/login"||c(v)==="/app/signup")?p==null||p.showModal():c(h)&&c(v)==="/"?window.location.replace("/#/app/home"):!c(h)&&c(v)==="/"?window.location.replace("/#/app/welcome"):(c(h)&&(c(v)==="/app/login"||c(v)),p==null||p.close())}),be(async()=>{console.log(c(v)),await _(),k()});function k(){!c(i)&&c(h)?f==null||f.showModal():f==null||f.close()}async function _(){var me,b;const{data:L,error:Q}=await de.auth.getSession(),re=L;if(Q)console.error("Error fetching session:",Q);else if(re){m(h,(b=(me=re==null?void 0:re.session)==null?void 0:me.user)==null?void 0:b.id,!0);const{data:g,error:R}=await de.from("profiles").select("username").eq("user_id",c(h)).single();g&&(console.log(g),m(i,g.username,!0),console.log("User: ",c(i)))}}async function O(L){if(L){const{error:Q}=await de.from("profiles").update({username:L}).eq("user_id",c(h));Q?(console.error(Q.message),m(u,""),m(d,""),Q.message.includes("duplicate")&&Q.message.includes("username")?(m(u,""),m(d,""),m(u,"Account with username already exists"),m(d,"error")):(m(u,""),m(d,""),m(u,Q.message,!0),m(d,"error")),Q.message==='Column "username" cannot be modified once set'&&(m(u,""),m(d,""),m(u,"Username already set!"),m(d,"warn"))):(m(u,""),m(d,""),m(u,"success"),m(d,"success"),m(i,L,!0))}else m(u,""),m(d,""),m(u,"No username typed"),m(d,"warn")}var C=ff(),T=y(Oe(C),2),E=w(T),x=w(E),S=y(w(x),2),A=y(w(S)),P=y(S,4),M=js(k);P.__click=function(...L){var Q;(Q=c(M))==null||Q.apply(this,L)};var B=y(P,2);{var J=L=>{At(L,{get message(){return c(u)},get type(){return c(d)}})};ce(B,L=>{c(u)&&L(J)})}ht(E,L=>f=L,()=>f);var K=y(E,2),I=y(w(K),4);I.__click=()=>{p==null||p.close()};var z=y(I,2);z.__click=[hf],ht(K,L=>p=L,()=>p);var D=y(K,2);Nd(D,{get routes(){return a}}),Xe("submit",x,L=>{L.preventDefault(),O(c(o))}),pt(A,()=>c(o),L=>m(o,L)),U(s,C),Ie(),n()}is(["click"]);jl(vf,{target:document.getElementById("app")})});export default pf();
