var ul=Object.defineProperty;var La=r=>{throw TypeError(r)};var dl=(r,e,t)=>e in r?ul(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var hl=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports);var is=(r,e,t)=>dl(r,typeof e!="symbol"?e+"":e,t),xn=(r,e,t)=>e.has(r)||La("Cannot "+t);var Ee=(r,e,t)=>(xn(r,e,"read from private field"),t?t.call(r):e.get(r)),it=(r,e,t)=>e.has(r)?La("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),vt=(r,e,t,s)=>(xn(r,e,"write to private field"),s?s.call(r,t):e.set(r,t),t),sr=(r,e,t)=>(xn(r,e,"access private method"),t);var Dv=hl((Bv,Ds)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function t(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(n){if(n.ep)return;n.ep=!0;const a=t(n);fetch(n.href,a)}})();const Ri=!1;var Jr=Array.isArray,fl=Array.prototype.indexOf,sa=Array.from,Qs=Object.defineProperty,Yt=Object.getOwnPropertyDescriptor,Di=Object.getOwnPropertyDescriptors,vl=Object.prototype,pl=Array.prototype,na=Object.getPrototypeOf,$a=Object.isExtensible;function $r(r){return typeof r=="function"}const dt=()=>{};function gl(r){return r()}function gs(r){for(var e=0;e<r.length;e++)r[e]()}function _l(){var r,e,t=new Promise((s,n)=>{r=s,e=n});return{promise:t,resolve:r,reject:e}}function ml(r,e){if(Array.isArray(r))return r;if(!(Symbol.iterator in r))return Array.from(r);const t=[];for(const s of r)if(t.push(s),t.length===e)break;return t}const ht=2,aa=4,ln=8,pr=16,Ut=32,gr=64,Li=128,gt=256,Zs=512,Ge=1024,_t=2048,zt=4096,wt=8192,_r=16384,cn=32768,Os=65536,Ua=1<<17,$i=1<<18,js=1<<19,Ui=1<<20,zn=1<<21,ia=1<<22,cr=1<<23,At=Symbol("$state"),zi=Symbol("legacy props"),yl=Symbol(""),oa=new class extends Error{constructor(){super(...arguments);is(this,"name","StaleReactionError");is(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}},bl=11;function wl(){throw new Error("https://svelte.dev/e/await_outside_boundary")}function un(r){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function kl(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Sl(r){throw new Error("https://svelte.dev/e/effect_in_teardown")}function El(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function xl(r){throw new Error("https://svelte.dev/e/effect_orphan")}function Tl(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Ol(r){throw new Error("https://svelte.dev/e/lifecycle_legacy_only")}function jl(r){throw new Error("https://svelte.dev/e/props_invalid_value")}function Al(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Pl(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Cl(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}const dn=1,hn=2,qi=4,Ml=8,Il=16,Rl=1,Dl=2,Ll=4,$l=8,Ul=16,zl=4,ql=1,Nl=2,Je=Symbol(),Fl="http://www.w3.org/1999/xhtml";function Bl(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}let Wl=!1;function Ni(r){return r===this.v}function Fi(r,e){return r!=r?e==e:r!==e||r!==null&&typeof r=="object"||typeof r=="function"}function Bi(r){return!Fi(r,this.v)}let Kr=!1,Vl=!1;function Hl(){Kr=!0}let Pe=null;function Xs(r){Pe=r}function Le(r,e=!1,t){Pe={p:Pe,c:null,e:null,s:r,x:null,l:Kr&&!e?{s:null,u:null,$:[]}:null}}function $e(r){var e=Pe,t=e.e;if(t!==null){e.e=null;for(var s of t)no(s)}return Pe=e.p,{}}function As(){return!Kr||Pe!==null&&Pe.l===null}const Jl=new WeakMap;function Kl(r){var e=ye;if(e===null)return be.f|=cr,r;if((e.f&cn)===0){if((e.f&Li)===0)throw!e.parent&&r instanceof Error&&Wi(r),r;e.b.error(r)}else la(r,e)}function la(r,e){for(;e!==null;){if((e.f&Li)!==0)try{e.b.error(r);return}catch(t){r=t}e=e.parent}throw r instanceof Error&&Wi(r),r}function Wi(r){const e=Jl.get(r);e&&(Qs(r,"message",{value:e.message}),Qs(r,"stack",{value:e.stack}))}let Kt=[],en=[];function Vi(){var r=Kt;Kt=[],gs(r)}function Gl(){var r=en;en=[],gs(r)}function Yl(){return Kt.length>0||en.length>0}function Ps(r){if(Kt.length===0&&!ds){var e=Kt;queueMicrotask(()=>{e===Kt&&Vi()})}Kt.push(r)}function Ql(){Kt.length>0&&Vi(),en.length>0&&Gl()}function Zl(){const r=ye.b;return r===null&&wl(),r}function Cs(r){var e=ht|_t,t=be!==null&&(be.f&ht)!==0?be:null;return ye===null||t!==null&&(t.f&gt)!==0?e|=gt:ye.f|=js,{ctx:Pe,deps:null,effects:null,equals:Ni,f:e,fn:r,reactions:null,rv:0,v:Je,wv:0,parent:t??ye,ac:null}}function Xl(r,e){let t=ye;t===null&&kl();var s=t.b,n=void 0,a=ms(Je),i=null,o=!be;return vc(()=>{try{var c=r();i&&Promise.resolve(c).catch(()=>{})}catch(_){c=Promise.reject(_)}var u=()=>c;n=(i==null?void 0:i.then(u,u))??Promise.resolve(c),i=n;var d=Ae,h=s.is_pending();o&&(s.update_pending_count(1),h||d.increment());const f=(_,p=void 0)=>{i=null,h||d.activate(),p?p!==oa&&(a.f|=cr,ys(a,p)):((a.f&cr)!==0&&(a.f^=cr),ys(a,_)),o&&(s.update_pending_count(-1),h||d.decrement()),Ki()};if(n.then(f,_=>f(null,_||"unknown")),d)return()=>{queueMicrotask(()=>d.neuter())}}),new Promise(c=>{function u(d){function h(){d===n?c(a):u(n)}d.then(h,h)}u(n)})}function fr(r){const e=Cs(r);return uo(e),e}function fn(r){const e=Cs(r);return e.equals=Bi,e}function Hi(r){var e=r.effects;if(e!==null){r.effects=null;for(var t=0;t<e.length;t+=1)$t(e[t])}}function ec(r){for(var e=r.parent;e!==null;){if((e.f&ht)===0)return e;e=e.parent}return null}function ca(r){var e,t=ye;Xt(ec(r));try{Hi(r),e=po(r)}finally{Xt(t)}return e}function Ji(r){var e=ca(r);if(r.equals(e)||(r.v=e,r.wv=fo()),!yr){var t=(Gt||(r.f&gt)!==0)&&r.deps!==null?zt:Ge;nt(r,t)}}function tc(r,e,t){const s=As()?Cs:fn;if(e.length===0){t(r.map(s));return}var n=Ae,a=ye,i=rc(),o=Zl();Promise.all(e.map(c=>Xl(c))).then(c=>{n==null||n.activate(),i();try{t([...r.map(s),...c])}catch(u){(a.f&_r)===0&&la(u,a)}n==null||n.deactivate(),Ki()}).catch(c=>{o.error(c)})}function rc(){var r=ye,e=be,t=Pe,s=Ae;return function(){Xt(r),Pt(e),Xs(t),s==null||s.activate()}}function Ki(){Xt(null),Pt(null),Xs(null)}const Tn=new Set;let Ae=null,Gs=null,za=new Set,vr=[],vn=null,qn=!1,ds=!1;var ks,Nr,Ht,Ss,Es,or,Fr,lr,Jt,Br,xs,Ts,kt,Gi,Ys,Nn;const on=class on{constructor(){it(this,kt);is(this,"current",new Map);it(this,ks,new Map);it(this,Nr,new Set);it(this,Ht,0);it(this,Ss,null);it(this,Es,!1);it(this,or,[]);it(this,Fr,[]);it(this,lr,[]);it(this,Jt,[]);it(this,Br,[]);it(this,xs,[]);it(this,Ts,[]);is(this,"skipped_effects",new Set)}process(e){var n;vr=[],Gs=null;for(const a of e)sr(this,kt,Gi).call(this,a);if(Ee(this,or).length===0&&Ee(this,Ht)===0){sr(this,kt,Nn).call(this);var t=Ee(this,lr),s=Ee(this,Jt);vt(this,lr,[]),vt(this,Jt,[]),vt(this,Br,[]),Gs=Ae,Ae=null,qa(t),qa(s),Ae===null?Ae=this:Tn.delete(this),(n=Ee(this,Ss))==null||n.resolve()}else sr(this,kt,Ys).call(this,Ee(this,lr)),sr(this,kt,Ys).call(this,Ee(this,Jt)),sr(this,kt,Ys).call(this,Ee(this,Br));for(const a of Ee(this,or))hr(a);for(const a of Ee(this,Fr))hr(a);vt(this,or,[]),vt(this,Fr,[])}capture(e,t){Ee(this,ks).has(e)||Ee(this,ks).set(e,t),this.current.set(e,e.v)}activate(){Ae=this}deactivate(){Ae=null,Gs=null;for(const e of za)if(za.delete(e),e(),Ae!==null)break}neuter(){vt(this,Es,!0)}flush(){vr.length>0?Yi():sr(this,kt,Nn).call(this),Ae===this&&(Ee(this,Ht)===0&&Tn.delete(this),this.deactivate())}increment(){vt(this,Ht,Ee(this,Ht)+1)}decrement(){if(vt(this,Ht,Ee(this,Ht)-1),Ee(this,Ht)===0){for(const e of Ee(this,xs))nt(e,_t),Wr(e);for(const e of Ee(this,Ts))nt(e,zt),Wr(e);vt(this,lr,[]),vt(this,Jt,[]),this.flush()}else this.deactivate()}add_callback(e){Ee(this,Nr).add(e)}settled(){return(Ee(this,Ss)??vt(this,Ss,_l())).promise}static ensure(){if(Ae===null){const e=Ae=new on;Tn.add(Ae),ds||on.enqueue(()=>{Ae===e&&e.flush()})}return Ae}static enqueue(e){Ps(e)}};ks=new WeakMap,Nr=new WeakMap,Ht=new WeakMap,Ss=new WeakMap,Es=new WeakMap,or=new WeakMap,Fr=new WeakMap,lr=new WeakMap,Jt=new WeakMap,Br=new WeakMap,xs=new WeakMap,Ts=new WeakMap,kt=new WeakSet,Gi=function(e){var d;e.f^=Ge;for(var t=e.first;t!==null;){var s=t.f,n=(s&(Ut|gr))!==0,a=n&&(s&Ge)!==0,i=a||(s&wt)!==0||this.skipped_effects.has(t);if(!i&&t.fn!==null){if(n)t.f^=Ge;else if((s&aa)!==0)Ee(this,Jt).push(t);else if((s&Ge)===0)if((s&ia)!==0){var o=(d=t.b)!=null&&d.is_pending()?Ee(this,Fr):Ee(this,or);o.push(t)}else Ms(t)&&((t.f&pr)!==0&&Ee(this,Br).push(t),hr(t));var c=t.first;if(c!==null){t=c;continue}}var u=t.parent;for(t=t.next;t===null&&u!==null;)t=u.next,u=u.parent}},Ys=function(e){for(const t of e)((t.f&_t)!==0?Ee(this,xs):Ee(this,Ts)).push(t),nt(t,Ge);e.length=0},Nn=function(){if(!Ee(this,Es))for(const e of Ee(this,Nr))e();Ee(this,Nr).clear()};let _s=on;function sc(r){var e=ds;ds=!0;try{for(var t;;){if(Ql(),vr.length===0&&!Yl()&&(Ae==null||Ae.flush(),vr.length===0))return vn=null,t;Yi()}}finally{ds=e}}function Yi(){var r=zr;qn=!0;try{var e=0;for(Wa(!0);vr.length>0;){var t=_s.ensure();if(e++>1e3){var s,n;nc()}t.process(vr),Qt.clear()}}finally{qn=!1,Wa(r),vn=null}}function nc(){try{Tl()}catch(r){la(r,vn)}}let Rt=null;function qa(r){var e=r.length;if(e!==0){for(var t=0;t<e;){var s=r[t++];if((s.f&(_r|wt))===0&&Ms(s)&&(Rt=[],hr(s),s.deps===null&&s.first===null&&s.nodes_start===null&&(s.teardown===null&&s.ac===null?oo(s):s.fn=null),(Rt==null?void 0:Rt.length)>0)){Qt.clear();for(const n of Rt)hr(n);Rt=[]}}Rt=null}}function Wr(r){for(var e=vn=r;e.parent!==null;){e=e.parent;var t=e.f;if(qn&&e===ye&&(t&pr)!==0)return;if((t&(gr|Ut))!==0){if((t&Ge)===0)return;e.f^=Ge}}vr.push(e)}const Qt=new Map;function ms(r,e){var t={f:0,v:r,reactions:null,equals:Ni,rv:0,wv:0};return t}function S(r,e){const t=ms(r);return uo(t),t}function ur(r,e=!1,t=!0){var n;const s=ms(r);return e||(s.equals=Bi),Kr&&t&&Pe!==null&&Pe.l!==null&&((n=Pe.l).s??(n.s=[])).push(s),s}function v(r,e,t=!1){be!==null&&(!jt||(be.f&Ua)!==0)&&As()&&(be.f&(ht|pr|ia|Ua))!==0&&!(st!=null&&st.includes(r))&&Cl();let s=t?F(e):e;return ys(r,s)}function ys(r,e){if(!r.equals(e)){var t=r.v;yr?Qt.set(r,e):Qt.set(r,t),r.v=e;var s=_s.ensure();s.capture(r,t),(r.f&ht)!==0&&((r.f&_t)!==0&&ca(r),nt(r,(r.f&gt)===0?Ge:zt)),r.wv=fo(),Zi(r,_t),As()&&ye!==null&&(ye.f&Ge)!==0&&(ye.f&(Ut|gr))===0&&(pt===null?_c([r]):pt.push(r))}return e}function Qi(r,e=1){var t=l(r),s=e===1?t++:t--;return v(r,t),s}function On(r){v(r,r.v+1)}function Zi(r,e){var t=r.reactions;if(t!==null)for(var s=As(),n=t.length,a=0;a<n;a++){var i=t[a],o=i.f;if(!(!s&&i===ye)){var c=(o&_t)===0;c&&nt(i,e),(o&ht)!==0?Zi(i,zt):c&&((o&pr)!==0&&Rt!==null&&Rt.push(i),Wr(i))}}}function F(r){if(typeof r!="object"||r===null||At in r)return r;const e=na(r);if(e!==vl&&e!==pl)return r;var t=new Map,s=Jr(r),n=S(0),a=dr,i=o=>{if(dr===a)return o();var c=be,u=dr;Pt(null),Ha(a);var d=o();return Pt(c),Ha(u),d};return s&&t.set("length",S(r.length)),new Proxy(r,{defineProperty(o,c,u){(!("value"in u)||u.configurable===!1||u.enumerable===!1||u.writable===!1)&&Al();var d=t.get(c);return d===void 0?d=i(()=>{var h=S(u.value);return t.set(c,h),h}):v(d,u.value,!0),!0},deleteProperty(o,c){var u=t.get(c);if(u===void 0){if(c in o){const d=i(()=>S(Je));t.set(c,d),On(n)}}else v(u,Je),On(n);return!0},get(o,c,u){var _;if(c===At)return r;var d=t.get(c),h=c in o;if(d===void 0&&(!h||(_=Yt(o,c))!=null&&_.writable)&&(d=i(()=>{var p=F(h?o[c]:Je),k=S(p);return k}),t.set(c,d)),d!==void 0){var f=l(d);return f===Je?void 0:f}return Reflect.get(o,c,u)},getOwnPropertyDescriptor(o,c){var u=Reflect.getOwnPropertyDescriptor(o,c);if(u&&"value"in u){var d=t.get(c);d&&(u.value=l(d))}else if(u===void 0){var h=t.get(c),f=h==null?void 0:h.v;if(h!==void 0&&f!==Je)return{enumerable:!0,configurable:!0,value:f,writable:!0}}return u},has(o,c){var f;if(c===At)return!0;var u=t.get(c),d=u!==void 0&&u.v!==Je||Reflect.has(o,c);if(u!==void 0||ye!==null&&(!d||(f=Yt(o,c))!=null&&f.writable)){u===void 0&&(u=i(()=>{var _=d?F(o[c]):Je,p=S(_);return p}),t.set(c,u));var h=l(u);if(h===Je)return!1}return d},set(o,c,u,d){var O;var h=t.get(c),f=c in o;if(s&&c==="length")for(var _=u;_<h.v;_+=1){var p=t.get(_+"");p!==void 0?v(p,Je):_ in o&&(p=i(()=>S(Je)),t.set(_+"",p))}if(h===void 0)(!f||(O=Yt(o,c))!=null&&O.writable)&&(h=i(()=>S(void 0)),v(h,F(u)),t.set(c,h));else{f=h.v!==Je;var k=i(()=>F(u));v(h,k)}var y=Reflect.getOwnPropertyDescriptor(o,c);if(y!=null&&y.set&&y.set.call(d,u),!f){if(s&&typeof c=="string"){var j=t.get("length"),P=Number(c);Number.isInteger(P)&&P>=j.v&&v(j,P+1)}On(n)}return!0},ownKeys(o){l(n);var c=Reflect.ownKeys(o).filter(h=>{var f=t.get(h);return f===void 0||f.v!==Je});for(var[u,d]of t)d.v!==Je&&!(u in o)&&c.push(u);return c},setPrototypeOf(){Pl()}})}function Na(r){try{if(r!==null&&typeof r=="object"&&At in r)return r[At]}catch{}return r}function ac(r,e){return Object.is(Na(r),Na(e))}var Fa,Xi,eo,to;function ic(){if(Fa===void 0){Fa=window,Xi=/Firefox/.test(navigator.userAgent);var r=Element.prototype,e=Node.prototype,t=Text.prototype;eo=Yt(e,"firstChild").get,to=Yt(e,"nextSibling").get,$a(r)&&(r.__click=void 0,r.__className=void 0,r.__attributes=null,r.__style=void 0,r.__e=void 0),$a(t)&&(t.__t=void 0)}}function mr(r=""){return document.createTextNode(r)}function tn(r){return eo.call(r)}function pn(r){return to.call(r)}function b(r,e){return tn(r)}function Ie(r,e){{var t=tn(r);return t instanceof Comment&&t.data===""?pn(t):t}}function g(r,e=1,t=!1){let s=r;for(;e--;)s=pn(s);return s}function oc(r){r.textContent=""}function ua(){return!1}let Ba=!1;function lc(){Ba||(Ba=!0,document.addEventListener("reset",r=>{Promise.resolve().then(()=>{var e;if(!r.defaultPrevented)for(const t of r.target.elements)(e=t.__on_r)==null||e.call(t)})},{capture:!0}))}function Gr(r){var e=be,t=ye;Pt(null),Xt(null);try{return r()}finally{Pt(e),Xt(t)}}function ro(r,e,t,s=t){r.addEventListener(e,()=>Gr(t));const n=r.__on_r;n?r.__on_r=()=>{n(),s(!0)}:r.__on_r=()=>s(!0),lc()}function so(r){ye===null&&be===null&&xl(),be!==null&&(be.f&gt)!==0&&ye===null&&El(),yr&&Sl()}function cc(r,e){var t=e.last;t===null?e.last=e.first=r:(t.next=r,r.prev=t,e.last=r)}function Ct(r,e,t,s=!0){var n=ye;n!==null&&(n.f&wt)!==0&&(r|=wt);var a={ctx:Pe,deps:null,nodes_start:null,nodes_end:null,f:r|_t,first:null,fn:e,last:null,next:null,parent:n,b:n&&n.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(t)try{hr(a),a.f|=cn}catch(c){throw $t(a),c}else e!==null&&Wr(a);if(s){var i=a;if(t&&i.deps===null&&i.teardown===null&&i.nodes_start===null&&i.first===i.last&&(i.f&js)===0&&(i=i.first),i!==null&&(i.parent=n,n!==null&&cc(i,n),be!==null&&(be.f&ht)!==0&&(r&gr)===0)){var o=be;(o.effects??(o.effects=[])).push(i)}}return a}function da(r){const e=Ct(ln,null,!1);return nt(e,Ge),e.teardown=r,e}function Te(r){so();var e=ye.f,t=!be&&(e&Ut)!==0&&(e&cn)===0;if(t){var s=Pe;(s.e??(s.e=[])).push(r)}else return no(r)}function no(r){return Ct(aa|Ui,r,!1)}function uc(r){return so(),Ct(ln|Ui,r,!0)}function dc(r){_s.ensure();const e=Ct(gr|js,r,!0);return(t={})=>new Promise(s=>{t.outro?mn(e,()=>{$t(e),s(void 0)}):($t(e),s(void 0))})}function ha(r){return Ct(aa,r,!1)}function hc(r,e){var t=Pe,s={effect:null,ran:!1,deps:r};t.l.$.push(s),s.effect=gn(()=>{r(),!s.ran&&(s.ran=!0,qt(e))})}function fc(){var r=Pe;gn(()=>{for(var e of r.l.$){e.deps();var t=e.effect;(t.f&Ge)!==0&&nt(t,zt),Ms(t)&&hr(t),e.ran=!1}})}function vc(r){return Ct(ia|js,r,!0)}function gn(r,e=0){return Ct(ln|e,r,!0)}function ce(r,e=[],t=[]){tc(e,t,s=>{Ct(ln,()=>r(...s.map(l)),!0)})}function _n(r,e=0){var t=Ct(pr|e,r,!0);return t}function Vr(r,e=!0){return Ct(Ut|js,r,!0,e)}function ao(r){var e=r.teardown;if(e!==null){const t=yr,s=be;Va(!0),Pt(null);try{e.call(null)}finally{Va(t),Pt(s)}}}function io(r,e=!1){var t=r.first;for(r.first=r.last=null;t!==null;){const n=t.ac;n!==null&&Gr(()=>{n.abort(oa)});var s=t.next;(t.f&gr)!==0?t.parent=null:$t(t,e),t=s}}function pc(r){for(var e=r.first;e!==null;){var t=e.next;(e.f&Ut)===0&&$t(e),e=t}}function $t(r,e=!0){var t=!1;(e||(r.f&$i)!==0)&&r.nodes_start!==null&&r.nodes_end!==null&&(gc(r.nodes_start,r.nodes_end),t=!0),io(r,e&&!t),rn(r,0),nt(r,_r);var s=r.transitions;if(s!==null)for(const a of s)a.stop();ao(r);var n=r.parent;n!==null&&n.first!==null&&oo(r),r.next=r.prev=r.teardown=r.ctx=r.deps=r.fn=r.nodes_start=r.nodes_end=r.ac=null}function gc(r,e){for(;r!==null;){var t=r===e?null:pn(r);r.remove(),r=t}}function oo(r){var e=r.parent,t=r.prev,s=r.next;t!==null&&(t.next=s),s!==null&&(s.prev=t),e!==null&&(e.first===r&&(e.first=s),e.last===r&&(e.last=t))}function mn(r,e){var t=[];fa(r,t,!0),lo(t,()=>{$t(r),e&&e()})}function lo(r,e){var t=r.length;if(t>0){var s=()=>--t||e();for(var n of r)n.out(s)}else e()}function fa(r,e,t){if((r.f&wt)===0){if(r.f^=wt,r.transitions!==null)for(const i of r.transitions)(i.is_global||t)&&e.push(i);for(var s=r.first;s!==null;){var n=s.next,a=(s.f&Os)!==0||(s.f&Ut)!==0;fa(s,e,a?t:!1),s=n}}}function va(r){co(r,!0)}function co(r,e){if((r.f&wt)!==0){r.f^=wt,(r.f&Ge)===0&&(nt(r,_t),Wr(r));for(var t=r.first;t!==null;){var s=t.next,n=(t.f&Os)!==0||(t.f&Ut)!==0;co(t,n?e:!1),t=s}if(r.transitions!==null)for(const a of r.transitions)(a.is_global||e)&&a.in()}}let zr=!1;function Wa(r){zr=r}let yr=!1;function Va(r){yr=r}let be=null,jt=!1;function Pt(r){be=r}let ye=null;function Xt(r){ye=r}let st=null;function uo(r){be!==null&&(st===null?st=[r]:st.push(r))}let et=null,ct=0,pt=null;function _c(r){pt=r}let ho=1,bs=0,dr=bs;function Ha(r){dr=r}let Gt=!1;function fo(){return++ho}function Ms(r){var h;var e=r.f;if((e&_t)!==0)return!0;if((e&zt)!==0){var t=r.deps,s=(e&gt)!==0;if(t!==null){var n,a,i=(e&Zs)!==0,o=s&&ye!==null&&!Gt,c=t.length;if((i||o)&&(ye===null||(ye.f&_r)===0)){var u=r,d=u.parent;for(n=0;n<c;n++)a=t[n],(i||!((h=a==null?void 0:a.reactions)!=null&&h.includes(u)))&&(a.reactions??(a.reactions=[])).push(u);i&&(u.f^=Zs),o&&d!==null&&(d.f&gt)===0&&(u.f^=gt)}for(n=0;n<c;n++)if(a=t[n],Ms(a)&&Ji(a),a.wv>r.wv)return!0}(!s||ye!==null&&!Gt)&&nt(r,Ge)}return!1}function vo(r,e,t=!0){var s=r.reactions;if(s!==null&&!(st!=null&&st.includes(r)))for(var n=0;n<s.length;n++){var a=s[n];(a.f&ht)!==0?vo(a,e,!1):e===a&&(t?nt(a,_t):(a.f&Ge)!==0&&nt(a,zt),Wr(a))}}function po(r){var k;var e=et,t=ct,s=pt,n=be,a=Gt,i=st,o=Pe,c=jt,u=dr,d=r.f;et=null,ct=0,pt=null,Gt=(d&gt)!==0&&(jt||!zr||be===null),be=(d&(Ut|gr))===0?r:null,st=null,Xs(r.ctx),jt=!1,dr=++bs,r.ac!==null&&(Gr(()=>{r.ac.abort(oa)}),r.ac=null);try{r.f|=zn;var h=r.fn,f=h(),_=r.deps;if(et!==null){var p;if(rn(r,ct),_!==null&&ct>0)for(_.length=ct+et.length,p=0;p<et.length;p++)_[ct+p]=et[p];else r.deps=_=et;if(!Gt||(d&ht)!==0&&r.reactions!==null)for(p=ct;p<_.length;p++)((k=_[p]).reactions??(k.reactions=[])).push(r)}else _!==null&&ct<_.length&&(rn(r,ct),_.length=ct);if(As()&&pt!==null&&!jt&&_!==null&&(r.f&(ht|zt|_t))===0)for(p=0;p<pt.length;p++)vo(pt[p],r);return n!==null&&n!==r&&(bs++,pt!==null&&(s===null?s=pt:s.push(...pt))),(r.f&cr)!==0&&(r.f^=cr),f}catch(y){return Kl(y)}finally{r.f^=zn,et=e,ct=t,pt=s,be=n,Gt=a,st=i,Xs(o),jt=c,dr=u}}function mc(r,e){let t=e.reactions;if(t!==null){var s=fl.call(t,r);if(s!==-1){var n=t.length-1;n===0?t=e.reactions=null:(t[s]=t[n],t.pop())}}t===null&&(e.f&ht)!==0&&(et===null||!et.includes(e))&&(nt(e,zt),(e.f&(gt|Zs))===0&&(e.f^=Zs),Hi(e),rn(e,0))}function rn(r,e){var t=r.deps;if(t!==null)for(var s=e;s<t.length;s++)mc(r,t[s])}function hr(r){var e=r.f;if((e&_r)===0){nt(r,Ge);var t=ye,s=zr;ye=r,zr=!0;try{(e&pr)!==0?pc(r):io(r),ao(r);var n=po(r);r.teardown=typeof n=="function"?n:null,r.wv=ho;var a;Ri&&Vl&&(r.f&_t)!==0&&r.deps}finally{zr=s,ye=t}}}async function go(){await Promise.resolve(),sc()}function l(r){var e=r.f,t=(e&ht)!==0;if(be!==null&&!jt){var s=ye!==null&&(ye.f&_r)!==0;if(!s&&!(st!=null&&st.includes(r))){var n=be.deps;if((be.f&zn)!==0)r.rv<bs&&(r.rv=bs,et===null&&n!==null&&n[ct]===r?ct++:et===null?et=[r]:(!Gt||!et.includes(r))&&et.push(r));else{(be.deps??(be.deps=[])).push(r);var a=r.reactions;a===null?r.reactions=[be]:a.includes(be)||a.push(be)}}}else if(t&&r.deps===null&&r.effects===null){var i=r,o=i.parent;o!==null&&(o.f&gt)===0&&(i.f^=gt)}if(yr){if(Qt.has(r))return Qt.get(r);if(t){i=r;var c=i.v;return((i.f&Ge)===0&&i.reactions!==null||_o(i))&&(c=ca(i)),Qt.set(i,c),c}}else t&&(i=r,Ms(i)&&Ji(i));if((r.f&cr)!==0)throw r.v;return r.v}function _o(r){if(r.v===Je)return!0;if(r.deps===null)return!1;for(const e of r.deps)if(Qt.has(e)||(e.f&ht)!==0&&_o(e))return!0;return!1}function qt(r){var e=jt;try{return jt=!0,r()}finally{jt=e}}const yc=-7169;function nt(r,e){r.f=r.f&yc|e}function mo(r){if(!(typeof r!="object"||!r||r instanceof EventTarget)){if(At in r)Fn(r);else if(!Array.isArray(r))for(let e in r){const t=r[e];typeof t=="object"&&t&&At in t&&Fn(t)}}}function Fn(r,e=new Set){if(typeof r=="object"&&r!==null&&!(r instanceof EventTarget)&&!e.has(r)){e.add(r),r instanceof Date&&r.getTime();for(let s in r)try{Fn(r[s],e)}catch{}const t=na(r);if(t!==Object.prototype&&t!==Array.prototype&&t!==Map.prototype&&t!==Set.prototype&&t!==Date.prototype){const s=Di(t);for(let n in s){const a=s[n].get;if(a)try{a.call(r)}catch{}}}}}const bc=["touchstart","touchmove"];function wc(r){return bc.includes(r)}const yo=new Set,Bn=new Set;function kc(r,e,t,s={}){function n(a){if(s.capture||cs.call(e,a),!a.cancelBubble)return Gr(()=>t==null?void 0:t.call(this,a))}return r.startsWith("pointer")||r.startsWith("touch")||r==="wheel"?Ps(()=>{e.addEventListener(r,n,s)}):e.addEventListener(r,n,s),n}function tt(r,e,t,s,n){var a={capture:s,passive:n},i=kc(r,e,t,a);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&da(()=>{e.removeEventListener(r,i,a)})}function br(r){for(var e=0;e<r.length;e++)yo.add(r[e]);for(var t of Bn)t(r)}let Ja=null;function cs(r){var P;var e=this,t=e.ownerDocument,s=r.type,n=((P=r.composedPath)==null?void 0:P.call(r))||[],a=n[0]||r.target;Ja=r;var i=0,o=Ja===r&&r.__root;if(o){var c=n.indexOf(o);if(c!==-1&&(e===document||e===window)){r.__root=e;return}var u=n.indexOf(e);if(u===-1)return;c<=u&&(i=c)}if(a=n[i]||r.target,a!==e){Qs(r,"currentTarget",{configurable:!0,get(){return a||t}});var d=be,h=ye;Pt(null),Xt(null);try{for(var f,_=[];a!==null;){var p=a.assignedSlot||a.parentNode||a.host||null;try{var k=a["__"+s];if(k!=null&&(!a.disabled||r.target===a))if(Jr(k)){var[y,...j]=k;y.apply(a,[r,...j])}else k.call(a,r)}catch(O){f?_.push(O):f=O}if(r.cancelBubble||p===e||p===null)break;a=p}if(f){for(let O of _)queueMicrotask(()=>{throw O});throw f}}finally{r.__root=e,delete r.currentTarget,Pt(d),Xt(h)}}}function pa(r){var e;e=document.head.appendChild(mr());try{_n(()=>r(e),$i)}finally{}}function Sc(r){var e=document.createElement("template");return e.innerHTML=r.replaceAll("<!>","<!---->"),e.content}function Wn(r,e){var t=ye;t.nodes_start===null&&(t.nodes_start=r,t.nodes_end=e)}function N(r,e){var t=(e&ql)!==0,s=(e&Nl)!==0,n,a=!r.startsWith("<!>");return()=>{n===void 0&&(n=Sc(a?r:"<!>"+r),t||(n=tn(n)));var i=s||Xi?document.importNode(n,!0):n.cloneNode(!0);if(t){var o=tn(i),c=i.lastChild;Wn(o,c)}else Wn(i,i);return i}}function ga(r){return()=>Ec(r())}function Ec(r){const e=r.nodeType===bl,t=r.tagName==="SCRIPT"?[r]:r.querySelectorAll("script"),s=ye;for(const a of t){const i=document.createElement("script");for(var n of a.attributes)i.setAttribute(n.name,n.value);i.textContent=a.textContent,(e?r.firstChild===a:r===a)&&(s.nodes_start=i),(e?r.lastChild===a:r===a)&&(s.nodes_end=i),a.replaceWith(i)}return r}function Zt(){var r=document.createDocumentFragment(),e=document.createComment(""),t=mr();return r.append(e,t),Wn(e,t),r}function D(r,e){r!==null&&r.before(e)}let Vn=!0;function te(r,e){var t=e==null?"":typeof e=="object"?e+"":e;t!==(r.__t??(r.__t=r.nodeValue))&&(r.__t=t,r.nodeValue=t+"")}function xc(r,e){return Tc(r,e)}const Tr=new Map;function Tc(r,{target:e,anchor:t,props:s={},events:n,context:a,intro:i=!0}){ic();var o=new Set,c=h=>{for(var f=0;f<h.length;f++){var _=h[f];if(!o.has(_)){o.add(_);var p=wc(_);e.addEventListener(_,cs,{passive:p});var k=Tr.get(_);k===void 0?(document.addEventListener(_,cs,{passive:p}),Tr.set(_,1)):Tr.set(_,k+1)}}};c(sa(yo)),Bn.add(c);var u=void 0,d=dc(()=>{var h=t??e.appendChild(mr());return Vr(()=>{if(a){Le({});var f=Pe;f.c=a}n&&(s.$$events=n),Vn=i,u=r(h,s)||{},Vn=!0,a&&$e()}),()=>{var p;for(var f of o){e.removeEventListener(f,cs);var _=Tr.get(f);--_===0?(document.removeEventListener(f,cs),Tr.delete(f)):Tr.set(f,_)}Bn.delete(c),h!==t&&((p=h.parentNode)==null||p.removeChild(h))}});return Oc.set(u,d),u}let Oc=new WeakMap;function se(r,e,t=!1){var s=r,n=null,a=null,i=Je,o=t?Os:0,c=!1;const u=(_,p=!0)=>{c=!0,f(p,_)};var d=null;function h(){d!==null&&(d.lastChild.remove(),s.before(d),d=null);var _=i?n:a,p=i?a:n;_&&va(_),p&&mn(p,()=>{i?a=null:n=null})}const f=(_,p)=>{if(i!==(i=_)){var k=ua(),y=s;if(k&&(d=document.createDocumentFragment(),d.append(y=mr())),i?n??(n=p&&Vr(()=>p(y))):a??(a=p&&Vr(()=>p(y))),k){var j=Ae,P=i?n:a,O=i?a:n;P&&j.skipped_effects.delete(P),O&&j.skipped_effects.add(O),j.add_callback(h)}else h()}};_n(()=>{c=!1,e(u),c||f(null,null)},o)}function Re(r,e){return e}function jc(r,e,t){for(var s=r.items,n=[],a=e.length,i=0;i<a;i++)fa(e[i].e,n,!0);var o=a>0&&n.length===0&&t!==null;if(o){var c=t.parentNode;oc(c),c.append(t),s.clear(),Ot(r,e[0].prev,e[a-1].next)}lo(n,()=>{for(var u=0;u<a;u++){var d=e[u];o||(s.delete(d.k),Ot(r,d.prev,d.next)),$t(d.e,!o)}})}function De(r,e,t,s,n,a=null){var i=r,o={flags:e,items:new Map,first:null},c=(e&qi)!==0;if(c){var u=r;i=u.appendChild(mr())}var d=null,h=!1,f=new Map,_=fn(()=>{var j=t();return Jr(j)?j:j==null?[]:sa(j)}),p,k;function y(){Ac(k,p,o,f,i,n,e,s,t),a!==null&&(p.length===0?d?va(d):d=Vr(()=>a(i)):d!==null&&mn(d,()=>{d=null}))}_n(()=>{k??(k=ye),p=l(_);var j=p.length;if(!(h&&j===0)){h=j===0;var P,O,x,T;if(ua()){var E=new Set,C=Ae;for(O=0;O<j;O+=1){x=p[O],T=s(x,O);var A=o.items.get(T)??f.get(T);A?(e&(dn|hn))!==0&&bo(A,x,O,e):(P=wo(null,o,null,null,x,T,O,n,e,t,!0),f.set(T,P)),E.add(T)}for(const[M,W]of o.items)E.has(M)||C.skipped_effects.add(W.e);C.add_callback(y)}else y();l(_)}})}function Ac(r,e,t,s,n,a,i,o,c){var oe,w,m,$;var u=(i&Ml)!==0,d=(i&(dn|hn))!==0,h=e.length,f=t.items,_=t.first,p=_,k,y=null,j,P=[],O=[],x,T,E,C;if(u)for(C=0;C<h;C+=1)x=e[C],T=o(x,C),E=f.get(T),E!==void 0&&((oe=E.a)==null||oe.measure(),(j??(j=new Set)).add(E));for(C=0;C<h;C+=1){if(x=e[C],T=o(x,C),E=f.get(T),E===void 0){var A=s.get(T);if(A!==void 0){s.delete(T),f.set(T,A);var M=y?y.next:p;Ot(t,y,A),Ot(t,A,M),jn(A,M,n),y=A}else{var W=p?p.e.nodes_start:n;y=wo(W,t,y,y===null?t.first:y.next,x,T,C,a,i,c)}f.set(T,y),P=[],O=[],p=y.next;continue}if(d&&bo(E,x,C,i),(E.e.f&wt)!==0&&(va(E.e),u&&((w=E.a)==null||w.unfix(),(j??(j=new Set)).delete(E))),E!==p){if(k!==void 0&&k.has(E)){if(P.length<O.length){var le=O[0],J;y=le.prev;var z=P[0],I=P[P.length-1];for(J=0;J<P.length;J+=1)jn(P[J],le,n);for(J=0;J<O.length;J+=1)k.delete(O[J]);Ot(t,z.prev,I.next),Ot(t,y,z),Ot(t,I,le),p=le,y=I,C-=1,P=[],O=[]}else k.delete(E),jn(E,p,n),Ot(t,E.prev,E.next),Ot(t,E,y===null?t.first:y.next),Ot(t,y,E),y=E;continue}for(P=[],O=[];p!==null&&p.k!==T;)(p.e.f&wt)===0&&(k??(k=new Set)).add(p),O.push(p),p=p.next;if(p===null)continue;E=p}P.push(E),y=E,p=E.next}if(p!==null||k!==void 0){for(var R=k===void 0?[]:sa(k);p!==null;)(p.e.f&wt)===0&&R.push(p),p=p.next;var L=R.length;if(L>0){var V=(i&qi)!==0&&h===0?n:null;if(u){for(C=0;C<L;C+=1)(m=R[C].a)==null||m.measure();for(C=0;C<L;C+=1)($=R[C].a)==null||$.fix()}jc(t,R,V)}}u&&Ps(()=>{var B;if(j!==void 0)for(E of j)(B=E.a)==null||B.apply()}),r.first=t.first&&t.first.e,r.last=y&&y.e;for(var X of s.values())$t(X.e);s.clear()}function bo(r,e,t,s){(s&dn)!==0&&ys(r.v,e),(s&hn)!==0?ys(r.i,t):r.i=t}function wo(r,e,t,s,n,a,i,o,c,u,d){var h=(c&dn)!==0,f=(c&Il)===0,_=h?f?ur(n,!1,!1):ms(n):n,p=(c&hn)===0?i:ms(i),k={i:p,v:_,k:a,a:null,e:null,prev:t,next:s};try{if(r===null){var y=document.createDocumentFragment();y.append(r=mr())}return k.e=Vr(()=>o(r,_,p,u),Wl),k.e.prev=t&&t.e,k.e.next=s&&s.e,t===null?d||(e.first=k):(t.next=k,t.e.next=k.e),s!==null&&(s.prev=k,s.e.prev=k.e),k}finally{}}function jn(r,e,t){for(var s=r.next?r.next.e.nodes_start:t,n=e?e.e.nodes_start:t,a=r.e.nodes_start;a!==null&&a!==s;){var i=pn(a);n.before(a),a=i}}function Ot(r,e,t){e===null?r.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function Ka(r,e,t){var s=r,n,a,i=null,o=null;function c(){a&&(mn(a),a=null),i&&(i.lastChild.remove(),s.before(i),i=null),a=o,o=null}_n(()=>{if(n!==(n=e())){var u=ua();if(n){var d=s;u&&(i=document.createDocumentFragment(),i.append(d=mr()),a&&Ae.skipped_effects.add(a)),o=Vr(()=>t(d,n))}u?Ae.add_callback(c):c()}},Os)}function ko(r){var e,t,s="";if(typeof r=="string"||typeof r=="number")s+=r;else if(typeof r=="object")if(Array.isArray(r)){var n=r.length;for(e=0;e<n;e++)r[e]&&(t=ko(r[e]))&&(s&&(s+=" "),s+=t)}else for(t in r)r[t]&&(s&&(s+=" "),s+=t);return s}function Pc(){for(var r,e,t=0,s="",n=arguments.length;t<n;t++)(r=arguments[t])&&(e=ko(r))&&(s&&(s+=" "),s+=e);return s}function sn(r){return typeof r=="object"?Pc(r):r??""}const Ga=[...` 	
\r\fÂ \v\uFEFF`];function Cc(r,e,t){var s=r==null?"":""+r;if(e&&(s=s?s+" "+e:e),t){for(var n in t)if(t[n])s=s?s+" "+n:n;else if(s.length)for(var a=n.length,i=0;(i=s.indexOf(n,i))>=0;){var o=i+a;(i===0||Ga.includes(s[i-1]))&&(o===s.length||Ga.includes(s[o]))?s=(i===0?"":s.substring(0,i))+s.substring(o+1):i=o}}return s===""?null:s}function Mc(r,e){return r==null?null:String(r)}function ut(r,e,t,s,n,a){var i=r.__className;if(i!==t||i===void 0){var o=Cc(t,s,a);o==null?r.removeAttribute("class"):r.className=o,r.__className=t}else if(a&&n!==a)for(var c in a){var u=!!a[c];(n==null||u!==!!n[c])&&r.classList.toggle(c,u)}return a}function Ic(r,e,t,s){var n=r.__style;if(n!==e){var a=Mc(e);a==null?r.removeAttribute("style"):r.style.cssText=a,r.__style=e}return s}function So(r,e,t=!1){if(r.multiple){if(e==null)return;if(!Jr(e))return Bl();for(var s of r.options)s.selected=e.includes(hs(s));return}for(s of r.options){var n=hs(s);if(ac(n,e)){s.selected=!0;return}}(!t||e!==void 0)&&(r.selectedIndex=-1)}function Rc(r){var e=new MutationObserver(()=>{So(r,r.__value)});e.observe(r,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),da(()=>{e.disconnect()})}function Ye(r,e,t=e){var s=!0;ro(r,"change",n=>{var a=n?"[selected]":":checked",i;if(r.multiple)i=[].map.call(r.querySelectorAll(a),hs);else{var o=r.querySelector(a)??r.querySelector("option:not([disabled])");i=o&&hs(o)}t(i)}),ha(()=>{var n=e();if(So(r,n,s),s&&n===void 0){var a=r.querySelector(":checked");a!==null&&(n=hs(a),t(n))}r.__value=n,s=!1}),Rc(r)}function hs(r){return"__value"in r?r.__value:r.value}const Dc=Symbol("is custom element"),Lc=Symbol("is html");function qs(r,e){var t=Eo(r);t.value===(t.value=e??void 0)||r.value===e&&(e!==0||r.nodeName!=="PROGRESS")||(r.value=e??"")}function Be(r,e,t,s){var n=Eo(r);n[e]!==(n[e]=t)&&(e==="loading"&&(r[yl]=t),t==null?r.removeAttribute(e):typeof t!="string"&&$c(r).includes(e)?r[e]=t:r.setAttribute(e,t))}function Eo(r){return r.__attributes??(r.__attributes={[Dc]:r.nodeName.includes("-"),[Lc]:r.namespaceURI===Fl})}var Ya=new Map;function $c(r){var e=r.getAttribute("is")||r.nodeName,t=Ya.get(e);if(t)return t;Ya.set(e,t=[]);for(var s,n=r,a=Element.prototype;a!==n;){s=Di(n);for(var i in s)s[i].set&&t.push(i);n=na(n)}return t}const Uc=()=>performance.now(),Lt={tick:r=>requestAnimationFrame(r),now:()=>Uc(),tasks:new Set};function xo(){const r=Lt.now();Lt.tasks.forEach(e=>{e.c(r)||(Lt.tasks.delete(e),e.f())}),Lt.tasks.size!==0&&Lt.tick(xo)}function zc(r){let e;return Lt.tasks.size===0&&Lt.tick(xo),{promise:new Promise(t=>{Lt.tasks.add(e={c:r,f:t})}),abort(){Lt.tasks.delete(e)}}}function Ns(r,e){Gr(()=>{r.dispatchEvent(new CustomEvent(e))})}function qc(r){if(r==="float")return"cssFloat";if(r==="offset")return"cssOffset";if(r.startsWith("--"))return r;const e=r.split("-");return e.length===1?e[0]:e[0]+e.slice(1).map(t=>t[0].toUpperCase()+t.slice(1)).join("")}function Qa(r){const e={},t=r.split(";");for(const s of t){const[n,a]=s.split(":");if(!n||a===void 0)break;const i=qc(n.trim());e[i]=a.trim()}return e}const Nc=r=>r;function Fc(r,e,t,s){var n=(r&zl)!==0,a="both",i,o=e.inert,c=e.style.overflow,u,d;function h(){return Gr(()=>i??(i=t()(e,(s==null?void 0:s())??{},{direction:a})))}var f={is_global:n,in(){e.inert=o,Ns(e,"introstart"),u=Hn(e,h(),d,1,()=>{Ns(e,"introend"),u==null||u.abort(),u=i=void 0,e.style.overflow=c})},out(y){e.inert=!0,Ns(e,"outrostart"),d=Hn(e,h(),u,0,()=>{Ns(e,"outroend"),y==null||y()})},stop:()=>{u==null||u.abort(),d==null||d.abort()}},_=ye;if((_.transitions??(_.transitions=[])).push(f),Vn){var p=n;if(!p){for(var k=_.parent;k&&(k.f&Os)!==0;)for(;(k=k.parent)&&(k.f&pr)===0;);p=!k||(k.f&cn)!==0}p&&ha(()=>{qt(()=>f.in())})}}function Hn(r,e,t,s,n){var a=s===1;if($r(e)){var i,o=!1;return Ps(()=>{if(!o){var y=e({direction:a?"in":"out"});i=Hn(r,y,t,s,n)}}),{abort:()=>{o=!0,i==null||i.abort()},deactivate:()=>i.deactivate(),reset:()=>i.reset(),t:()=>i.t()}}if(t==null||t.deactivate(),!(e!=null&&e.duration))return n(),{abort:dt,deactivate:dt,reset:dt,t:()=>s};const{delay:c=0,css:u,tick:d,easing:h=Nc}=e;var f=[];if(a&&t===void 0&&(d&&d(0,1),u)){var _=Qa(u(0,1));f.push(_,_)}var p=()=>1-s,k=r.animate(f,{duration:c,fill:"forwards"});return k.onfinish=()=>{k.cancel();var y=(t==null?void 0:t.t())??1-s;t==null||t.abort();var j=s-y,P=e.duration*Math.abs(j),O=[];if(P>0){var x=!1;if(u)for(var T=Math.ceil(P/16.666666666666668),E=0;E<=T;E+=1){var C=y+j*h(E/T),A=Qa(u(C,1-C));O.push(A),x||(x=A.overflow==="hidden")}x&&(r.style.overflow="hidden"),p=()=>{var M=k.currentTime;return y+j*h(M/P)},d&&zc(()=>{if(k.playState!=="running")return!1;var M=p();return d(M,1-M),!0})}k=r.animate(O,{duration:P,fill:"forwards"}),k.onfinish=()=>{p=()=>s,d==null||d(s,1-s),n()}},{abort:()=>{k&&(k.cancel(),k.effect=null,k.onfinish=dt)},deactivate:()=>{n=dt},reset:()=>{s===0&&(d==null||d(1,0))},t:()=>p()}}function Fe(r,e,t=e){var s=new WeakSet;ro(r,"input",async n=>{var a=n?r.defaultValue:r.value;if(a=An(r)?Pn(a):a,t(a),Ae!==null&&s.add(Ae),await go(),a!==(a=e())){var i=r.selectionStart,o=r.selectionEnd;r.value=a??"",o!==null&&(r.selectionStart=i,r.selectionEnd=Math.min(o,r.value.length))}}),qt(e)==null&&r.value&&(t(An(r)?Pn(r.value):r.value),Ae!==null&&s.add(Ae)),gn(()=>{var n=e();if(r===document.activeElement){var a=Gs??Ae;if(s.has(a))return}An(r)&&n===Pn(r.value)||r.type==="date"&&!n&&!r.value||n!==r.value&&(r.value=n??"")})}function An(r){var e=r.type;return e==="number"||e==="range"}function Pn(r){return r===""?null:+r}function Za(r,e){return r===e||(r==null?void 0:r[At])===e}function rt(r={},e,t,s){return ha(()=>{var n,a;return gn(()=>{n=a,a=[],qt(()=>{r!==t(...a)&&(e(r,...a),n&&Za(t(...n),r)&&e(null,...n))})}),()=>{Ps(()=>{a&&Za(t(...a),r)&&e(null,...a)})}}),r}function _a(r=!1){const e=Pe,t=e.l.u;if(!t)return;let s=()=>mo(e.s);if(r){let n=0,a={};const i=Cs(()=>{let o=!1;const c=e.s;for(const u in c)c[u]!==a[u]&&(a[u]=c[u],o=!0);return o&&n++,n});s=()=>l(i)}t.b.length&&uc(()=>{Xa(e,s),gs(t.b)}),Te(()=>{const n=qt(()=>t.m.map(gl));return()=>{for(const a of n)typeof a=="function"&&a()}}),t.a.length&&Te(()=>{Xa(e,s),gs(t.a)})}function Xa(r,e){if(r.l.s)for(const t of r.l.s)l(t);e()}function ei(r,e){var a;var t=(a=r.$$events)==null?void 0:a[e.type],s=Jr(t)?t.slice():t==null?[]:[t];for(var n of s)n.call(this,e)}function ma(r,e,t){if(r==null)return e(void 0),t&&t(void 0),dt;const s=qt(()=>r.subscribe(e,t));return s.unsubscribe?()=>s.unsubscribe():s}const Or=[];function To(r,e){return{subscribe:Oo(r,e).subscribe}}function Oo(r,e=dt){let t=null;const s=new Set;function n(o){if(Fi(r,o)&&(r=o,t)){const c=!Or.length;for(const u of s)u[1](),Or.push(u,r);if(c){for(let u=0;u<Or.length;u+=2)Or[u][0](Or[u+1]);Or.length=0}}}function a(o){n(o(r))}function i(o,c=dt){const u=[o,c];return s.add(u),s.size===1&&(t=e(n,a)||dt),o(r),()=>{s.delete(u),s.size===0&&t&&(t(),t=null)}}return{set:n,update:a,subscribe:i}}function jo(r,e,t){const s=!Array.isArray(r),n=s?[r]:r;if(!n.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const a=e.length<2;return To(t,(i,o)=>{let c=!1;const u=[];let d=0,h=dt;const f=()=>{if(d)return;h();const p=e(s?u[0]:u,i,o);a?i(p):h=typeof p=="function"?p:dt},_=n.map((p,k)=>ma(p,y=>{u[k]=y,d&=~(1<<k),c&&f()},()=>{d|=1<<k}));return c=!0,f(),function(){gs(_),h(),c=!1}})}function Bc(r){let e;return ma(r,t=>e=t)(),e}let Fs=!1,Jn=Symbol();function Yr(r,e,t){const s=t[e]??(t[e]={store:null,source:ur(void 0),unsubscribe:dt});if(s.store!==r&&!(Jn in t))if(s.unsubscribe(),s.store=r??null,r==null)s.source.v=void 0,s.unsubscribe=dt;else{var n=!0;s.unsubscribe=ma(r,a=>{n?s.source.v=a:v(s.source,a)}),n=!1}return r&&Jn in t?Bc(r):l(s.source)}function Qr(){const r={};function e(){da(()=>{for(var t in r)r[t].unsubscribe();Qs(r,Jn,{enumerable:!1,value:!0})})}return[r,e]}function Wc(r){var e=Fs;try{return Fs=!1,[r(),Fs]}finally{Fs=e}}const Vc={get(r,e){let t=r.props.length;for(;t--;){let s=r.props[t];if($r(s)&&(s=s()),typeof s=="object"&&s!==null&&e in s)return s[e]}},set(r,e,t){let s=r.props.length;for(;s--;){let n=r.props[s];$r(n)&&(n=n());const a=Yt(n,e);if(a&&a.set)return a.set(t),!0}return!1},getOwnPropertyDescriptor(r,e){let t=r.props.length;for(;t--;){let s=r.props[t];if($r(s)&&(s=s()),typeof s=="object"&&s!==null&&e in s){const n=Yt(s,e);return n&&!n.configurable&&(n.configurable=!0),n}}},has(r,e){if(e===At||e===zi)return!1;for(let t of r.props)if($r(t)&&(t=t()),t!=null&&e in t)return!0;return!1},ownKeys(r){const e=[];for(let t of r.props)if($r(t)&&(t=t()),!!t){for(const s in t)e.includes(s)||e.push(s);for(const s of Object.getOwnPropertySymbols(t))e.includes(s)||e.push(s)}return e}};function ti(...r){return new Proxy({props:r},Vc)}function Se(r,e,t,s){var O;var n=!Kr||(t&Dl)!==0,a=(t&$l)!==0,i=(t&Ul)!==0,o=s,c=!0,u=()=>(c&&(c=!1,o=i?qt(s):s),o),d;if(a){var h=At in r||zi in r;d=((O=Yt(r,e))==null?void 0:O.set)??(h&&e in r?x=>r[e]=x:void 0)}var f,_=!1;a?[f,_]=Wc(()=>r[e]):f=r[e],f===void 0&&s!==void 0&&(f=u(),d&&(n&&jl(),d(f)));var p;if(n?p=()=>{var x=r[e];return x===void 0?u():(c=!0,x)}:p=()=>{var x=r[e];return x!==void 0&&(o=void 0),x===void 0?o:x},n&&(t&Ll)===0)return p;if(d){var k=r.$$legacy;return function(x,T){return arguments.length>0?((!n||!T||k||_)&&d(T?p():x),x):p()}}var y=!1,j=((t&Rl)!==0?Cs:fn)(()=>(y=!1,p()));a&&l(j);var P=ye;return function(x,T){if(arguments.length>0){const E=T?l(j):n&&a?F(x):x;return v(j,E),y=!0,o!==void 0&&(o=E),x}return yr&&y||(P.f&_r)!==0?j.v:l(j)}}function lt(r){Pe===null&&un(),Kr&&Pe.l!==null?Ao(Pe).m.push(r):Te(()=>{const e=qt(r);if(typeof e=="function")return e})}function Hc(r){Pe===null&&un(),lt(()=>()=>qt(r))}function Jc(r,e,{bubbles:t=!1,cancelable:s=!1}={}){return new CustomEvent(r,{detail:e,bubbles:t,cancelable:s})}function Kc(){const r=Pe;return r===null&&un(),(e,t,s)=>{var a;const n=(a=r.s.$$events)==null?void 0:a[e];if(n){const i=Jr(n)?n.slice():[n],o=Jc(e,t,s);for(const c of i)c.call(r.x,o);return!o.defaultPrevented}return!0}}function Gc(r){Pe===null&&un(),Pe.l===null&&Ol(),Ao(Pe).a.push(r)}function Ao(r){var e=r.l;return e.u??(e.u={a:[],b:[],m:[]})}const Yc="5";var Ii;typeof window<"u"&&((Ii=window.__svelte??(window.__svelte={})).v??(Ii.v=new Set)).add(Yc);const Qc="modulepreload",Zc=function(r){return"/"+r},ri={},Is=function(e,t,s){let n=Promise.resolve();if(t&&t.length>0){let i=function(u){return Promise.all(u.map(d=>Promise.resolve(d).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));n=i(t.map(u=>{if(u=Zc(u),u in ri)return;ri[u]=!0;const d=u.endsWith(".css"),h=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${h}`))return;const f=document.createElement("link");if(f.rel=d?"stylesheet":Qc,d||(f.as="script"),f.crossOrigin="",f.href=u,c&&f.setAttribute("nonce",c),document.head.appendChild(f),d)return new Promise((_,p)=>{f.addEventListener("load",_),f.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${u}`)))})}))}function a(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return n.then(i=>{for(const o of i||[])o.status==="rejected"&&a(o.reason);return e().catch(a)})},Xc=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>Is(async()=>{const{default:s}=await Promise.resolve().then(()=>Zr);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)};class ya extends Error{constructor(e,t="FunctionsError",s){super(e),this.name=t,this.context=s}}class eu extends ya{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class tu extends ya{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class ru extends ya{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Kn;(function(r){r.Any="any",r.ApNortheast1="ap-northeast-1",r.ApNortheast2="ap-northeast-2",r.ApSouth1="ap-south-1",r.ApSoutheast1="ap-southeast-1",r.ApSoutheast2="ap-southeast-2",r.CaCentral1="ca-central-1",r.EuCentral1="eu-central-1",r.EuWest1="eu-west-1",r.EuWest2="eu-west-2",r.EuWest3="eu-west-3",r.SaEast1="sa-east-1",r.UsEast1="us-east-1",r.UsWest1="us-west-1",r.UsWest2="us-west-2"})(Kn||(Kn={}));var su=function(r,e,t,s){function n(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(d){try{u(s.next(d))}catch(h){i(h)}}function c(d){try{u(s.throw(d))}catch(h){i(h)}}function u(d){d.done?a(d.value):n(d.value).then(o,c)}u((s=s.apply(r,e||[])).next())})};class nu{constructor(e,{headers:t={},customFetch:s,region:n=Kn.Any}={}){this.url=e,this.headers=t,this.region=n,this.fetch=Xc(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var s;return su(this,void 0,void 0,function*(){try{const{headers:n,method:a,body:i}=t;let o={},{region:c}=t;c||(c=this.region),c&&c!=="any"&&(o["x-region"]=c);let u;i&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&(typeof Blob<"u"&&i instanceof Blob||i instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",u=i):typeof i=="string"?(o["Content-Type"]="text/plain",u=i):typeof FormData<"u"&&i instanceof FormData?u=i:(o["Content-Type"]="application/json",u=JSON.stringify(i)));const d=yield this.fetch(`${this.url}/${e}`,{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),n),body:u}).catch(p=>{throw new eu(p)}),h=d.headers.get("x-relay-error");if(h&&h==="true")throw new tu(d);if(!d.ok)throw new ru(d);let f=((s=d.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),_;return f==="application/json"?_=yield d.json():f==="application/octet-stream"?_=yield d.blob():f==="text/event-stream"?_=d:f==="multipart/form-data"?_=yield d.formData():_=yield d.text(),{data:_,error:null}}catch(n){return{data:null,error:n}}})}}function au(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function iu(r){if(Object.prototype.hasOwnProperty.call(r,"__esModule"))return r;var e=r.default;if(typeof e=="function"){var t=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(r).forEach(function(s){var n=Object.getOwnPropertyDescriptor(r,s);Object.defineProperty(t,s,n.get?n:{enumerable:!0,get:function(){return r[s]}})}),t}var We={},jr={},Ar={},Pr={},Cr={},Mr={},ou=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Hr=ou();const lu=Hr.fetch,Po=Hr.fetch.bind(Hr),Co=Hr.Headers,cu=Hr.Request,uu=Hr.Response,Zr=Object.freeze(Object.defineProperty({__proto__:null,Headers:Co,Request:cu,Response:uu,default:Po,fetch:lu},Symbol.toStringTag,{value:"Module"})),du=iu(Zr);var Bs={},si;function Mo(){if(si)return Bs;si=1,Object.defineProperty(Bs,"__esModule",{value:!0});class r extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return Bs.default=r,Bs}var ni;function Io(){if(ni)return Mr;ni=1;var r=Mr&&Mr.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Mr,"__esModule",{value:!0});const e=r(du),t=r(Mo());class s{constructor(a){this.shouldThrowOnError=!1,this.method=a.method,this.url=a.url,this.headers=a.headers,this.schema=a.schema,this.body=a.body,this.shouldThrowOnError=a.shouldThrowOnError,this.signal=a.signal,this.isMaybeSingle=a.isMaybeSingle,a.fetch?this.fetch=a.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(a,i){return this.headers=Object.assign({},this.headers),this.headers[a]=i,this}then(a,i){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const o=this.fetch;let c=o(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async u=>{var d,h,f;let _=null,p=null,k=null,y=u.status,j=u.statusText;if(u.ok){if(this.method!=="HEAD"){const T=await u.text();T===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?p=T:p=JSON.parse(T))}const O=(d=this.headers.Prefer)===null||d===void 0?void 0:d.match(/count=(exact|planned|estimated)/),x=(h=u.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");O&&x&&x.length>1&&(k=parseInt(x[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(p)&&(p.length>1?(_={code:"PGRST116",details:`Results contain ${p.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},p=null,k=null,y=406,j="Not Acceptable"):p.length===1?p=p[0]:p=null)}else{const O=await u.text();try{_=JSON.parse(O),Array.isArray(_)&&u.status===404&&(p=[],_=null,y=200,j="OK")}catch{u.status===404&&O===""?(y=204,j="No Content"):_={message:O}}if(_&&this.isMaybeSingle&&(!((f=_==null?void 0:_.details)===null||f===void 0)&&f.includes("0 rows"))&&(_=null,y=200,j="OK"),_&&this.shouldThrowOnError)throw new t.default(_)}return{error:_,data:p,count:k,status:y,statusText:j}});return this.shouldThrowOnError||(c=c.catch(u=>{var d,h,f;return{error:{message:`${(d=u==null?void 0:u.name)!==null&&d!==void 0?d:"FetchError"}: ${u==null?void 0:u.message}`,details:`${(h=u==null?void 0:u.stack)!==null&&h!==void 0?h:""}`,hint:"",code:`${(f=u==null?void 0:u.code)!==null&&f!==void 0?f:""}`},data:null,count:null,status:0,statusText:""}})),c.then(a,i)}returns(){return this}overrideTypes(){return this}}return Mr.default=s,Mr}var ai;function Ro(){if(ai)return Cr;ai=1;var r=Cr&&Cr.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Cr,"__esModule",{value:!0});const e=r(Io());class t extends e.default{select(n){let a=!1;const i=(n??"*").split("").map(o=>/\s/.test(o)&&!a?"":(o==='"'&&(a=!a),o)).join("");return this.url.searchParams.set("select",i),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(n,{ascending:a=!0,nullsFirst:i,foreignTable:o,referencedTable:c=o}={}){const u=c?`${c}.order`:"order",d=this.url.searchParams.get(u);return this.url.searchParams.set(u,`${d?`${d},`:""}${n}.${a?"asc":"desc"}${i===void 0?"":i?".nullsfirst":".nullslast"}`),this}limit(n,{foreignTable:a,referencedTable:i=a}={}){const o=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(o,`${n}`),this}range(n,a,{foreignTable:i,referencedTable:o=i}={}){const c=typeof o>"u"?"offset":`${o}.offset`,u=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(c,`${n}`),this.url.searchParams.set(u,`${a-n+1}`),this}abortSignal(n){return this.signal=n,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:n=!1,verbose:a=!1,settings:i=!1,buffers:o=!1,wal:c=!1,format:u="text"}={}){var d;const h=[n?"analyze":null,a?"verbose":null,i?"settings":null,o?"buffers":null,c?"wal":null].filter(Boolean).join("|"),f=(d=this.headers.Accept)!==null&&d!==void 0?d:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${u}; for="${f}"; options=${h};`,u==="json"?this:this}rollback(){var n;return((n=this.headers.Prefer)!==null&&n!==void 0?n:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return Cr.default=t,Cr}var ii;function ba(){if(ii)return Pr;ii=1;var r=Pr&&Pr.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Pr,"__esModule",{value:!0});const e=r(Ro());class t extends e.default{eq(n,a){return this.url.searchParams.append(n,`eq.${a}`),this}neq(n,a){return this.url.searchParams.append(n,`neq.${a}`),this}gt(n,a){return this.url.searchParams.append(n,`gt.${a}`),this}gte(n,a){return this.url.searchParams.append(n,`gte.${a}`),this}lt(n,a){return this.url.searchParams.append(n,`lt.${a}`),this}lte(n,a){return this.url.searchParams.append(n,`lte.${a}`),this}like(n,a){return this.url.searchParams.append(n,`like.${a}`),this}likeAllOf(n,a){return this.url.searchParams.append(n,`like(all).{${a.join(",")}}`),this}likeAnyOf(n,a){return this.url.searchParams.append(n,`like(any).{${a.join(",")}}`),this}ilike(n,a){return this.url.searchParams.append(n,`ilike.${a}`),this}ilikeAllOf(n,a){return this.url.searchParams.append(n,`ilike(all).{${a.join(",")}}`),this}ilikeAnyOf(n,a){return this.url.searchParams.append(n,`ilike(any).{${a.join(",")}}`),this}is(n,a){return this.url.searchParams.append(n,`is.${a}`),this}in(n,a){const i=Array.from(new Set(a)).map(o=>typeof o=="string"&&new RegExp("[,()]").test(o)?`"${o}"`:`${o}`).join(",");return this.url.searchParams.append(n,`in.(${i})`),this}contains(n,a){return typeof a=="string"?this.url.searchParams.append(n,`cs.${a}`):Array.isArray(a)?this.url.searchParams.append(n,`cs.{${a.join(",")}}`):this.url.searchParams.append(n,`cs.${JSON.stringify(a)}`),this}containedBy(n,a){return typeof a=="string"?this.url.searchParams.append(n,`cd.${a}`):Array.isArray(a)?this.url.searchParams.append(n,`cd.{${a.join(",")}}`):this.url.searchParams.append(n,`cd.${JSON.stringify(a)}`),this}rangeGt(n,a){return this.url.searchParams.append(n,`sr.${a}`),this}rangeGte(n,a){return this.url.searchParams.append(n,`nxl.${a}`),this}rangeLt(n,a){return this.url.searchParams.append(n,`sl.${a}`),this}rangeLte(n,a){return this.url.searchParams.append(n,`nxr.${a}`),this}rangeAdjacent(n,a){return this.url.searchParams.append(n,`adj.${a}`),this}overlaps(n,a){return typeof a=="string"?this.url.searchParams.append(n,`ov.${a}`):this.url.searchParams.append(n,`ov.{${a.join(",")}}`),this}textSearch(n,a,{config:i,type:o}={}){let c="";o==="plain"?c="pl":o==="phrase"?c="ph":o==="websearch"&&(c="w");const u=i===void 0?"":`(${i})`;return this.url.searchParams.append(n,`${c}fts${u}.${a}`),this}match(n){return Object.entries(n).forEach(([a,i])=>{this.url.searchParams.append(a,`eq.${i}`)}),this}not(n,a,i){return this.url.searchParams.append(n,`not.${a}.${i}`),this}or(n,{foreignTable:a,referencedTable:i=a}={}){const o=i?`${i}.or`:"or";return this.url.searchParams.append(o,`(${n})`),this}filter(n,a,i){return this.url.searchParams.append(n,`${a}.${i}`),this}}return Pr.default=t,Pr}var oi;function Do(){if(oi)return Ar;oi=1;var r=Ar&&Ar.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Ar,"__esModule",{value:!0});const e=r(ba());class t{constructor(n,{headers:a={},schema:i,fetch:o}){this.url=n,this.headers=a,this.schema=i,this.fetch=o}select(n,{head:a=!1,count:i}={}){const o=a?"HEAD":"GET";let c=!1;const u=(n??"*").split("").map(d=>/\s/.test(d)&&!c?"":(d==='"'&&(c=!c),d)).join("");return this.url.searchParams.set("select",u),i&&(this.headers.Prefer=`count=${i}`),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(n,{count:a,defaultToNull:i=!0}={}){const o="POST",c=[];if(this.headers.Prefer&&c.push(this.headers.Prefer),a&&c.push(`count=${a}`),i||c.push("missing=default"),this.headers.Prefer=c.join(","),Array.isArray(n)){const u=n.reduce((d,h)=>d.concat(Object.keys(h)),[]);if(u.length>0){const d=[...new Set(u)].map(h=>`"${h}"`);this.url.searchParams.set("columns",d.join(","))}}return new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}upsert(n,{onConflict:a,ignoreDuplicates:i=!1,count:o,defaultToNull:c=!0}={}){const u="POST",d=[`resolution=${i?"ignore":"merge"}-duplicates`];if(a!==void 0&&this.url.searchParams.set("on_conflict",a),this.headers.Prefer&&d.push(this.headers.Prefer),o&&d.push(`count=${o}`),c||d.push("missing=default"),this.headers.Prefer=d.join(","),Array.isArray(n)){const h=n.reduce((f,_)=>f.concat(Object.keys(_)),[]);if(h.length>0){const f=[...new Set(h)].map(_=>`"${_}"`);this.url.searchParams.set("columns",f.join(","))}}return new e.default({method:u,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}update(n,{count:a}={}){const i="PATCH",o=[];return this.headers.Prefer&&o.push(this.headers.Prefer),a&&o.push(`count=${a}`),this.headers.Prefer=o.join(","),new e.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}delete({count:n}={}){const a="DELETE",i=[];return n&&i.push(`count=${n}`),this.headers.Prefer&&i.unshift(this.headers.Prefer),this.headers.Prefer=i.join(","),new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return Ar.default=t,Ar}var os={},ls={},li;function hu(){return li||(li=1,Object.defineProperty(ls,"__esModule",{value:!0}),ls.version=void 0,ls.version="0.0.0-automated"),ls}var ci;function fu(){if(ci)return os;ci=1,Object.defineProperty(os,"__esModule",{value:!0}),os.DEFAULT_HEADERS=void 0;const r=hu();return os.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${r.version}`},os}var ui;function vu(){if(ui)return jr;ui=1;var r=jr&&jr.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(jr,"__esModule",{value:!0});const e=r(Do()),t=r(ba()),s=fu();class n{constructor(i,{headers:o={},schema:c,fetch:u}={}){this.url=i,this.headers=Object.assign(Object.assign({},s.DEFAULT_HEADERS),o),this.schemaName=c,this.fetch=u}from(i){const o=new URL(`${this.url}/${i}`);return new e.default(o,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(i){return new n(this.url,{headers:this.headers,schema:i,fetch:this.fetch})}rpc(i,o={},{head:c=!1,get:u=!1,count:d}={}){let h;const f=new URL(`${this.url}/rpc/${i}`);let _;c||u?(h=c?"HEAD":"GET",Object.entries(o).filter(([k,y])=>y!==void 0).map(([k,y])=>[k,Array.isArray(y)?`{${y.join(",")}}`:`${y}`]).forEach(([k,y])=>{f.searchParams.append(k,y)})):(h="POST",_=o);const p=Object.assign({},this.headers);return d&&(p.Prefer=`count=${d}`),new t.default({method:h,url:f,headers:p,schema:this.schemaName,body:_,fetch:this.fetch,allowEmpty:!1})}}return jr.default=n,jr}var di;function pu(){if(di)return We;di=1;var r=We&&We.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(We,"__esModule",{value:!0}),We.PostgrestError=We.PostgrestBuilder=We.PostgrestTransformBuilder=We.PostgrestFilterBuilder=We.PostgrestQueryBuilder=We.PostgrestClient=void 0;const e=r(vu());We.PostgrestClient=e.default;const t=r(Do());We.PostgrestQueryBuilder=t.default;const s=r(ba());We.PostgrestFilterBuilder=s.default;const n=r(Ro());We.PostgrestTransformBuilder=n.default;const a=r(Io());We.PostgrestBuilder=a.default;const i=r(Mo());return We.PostgrestError=i.default,We.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:s.default,PostgrestTransformBuilder:n.default,PostgrestBuilder:a.default,PostgrestError:i.default},We}var gu=pu();const _u=au(gu),{PostgrestClient:mu,PostgrestQueryBuilder:Uv,PostgrestFilterBuilder:zv,PostgrestTransformBuilder:qv,PostgrestBuilder:Nv,PostgrestError:Fv}=_u;let Gn;typeof window>"u"?Gn=require("ws"):Gn=window.WebSocket;const yu="2.11.10",bu={"X-Client-Info":`realtime-js/${yu}`},wu="1.0.0",Lo=1e4,ku=1e3;var qr;(function(r){r[r.connecting=0]="connecting",r[r.open=1]="open",r[r.closing=2]="closing",r[r.closed=3]="closed"})(qr||(qr={}));var Xe;(function(r){r.closed="closed",r.errored="errored",r.joined="joined",r.joining="joining",r.leaving="leaving"})(Xe||(Xe={}));var bt;(function(r){r.close="phx_close",r.error="phx_error",r.join="phx_join",r.reply="phx_reply",r.leave="phx_leave",r.access_token="access_token"})(bt||(bt={}));var Yn;(function(r){r.websocket="websocket"})(Yn||(Yn={}));var ir;(function(r){r.Connecting="connecting",r.Open="open",r.Closing="closing",r.Closed="closed"})(ir||(ir={}));class Su{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,t,s)}_decodeBroadcast(e,t,s){const n=t.getUint8(1),a=t.getUint8(2);let i=this.HEADER_LENGTH+2;const o=s.decode(e.slice(i,i+n));i=i+n;const c=s.decode(e.slice(i,i+a));i=i+a;const u=JSON.parse(s.decode(e.slice(i,e.byteLength)));return{ref:null,topic:o,event:c,payload:u}}}class $o{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ce;(function(r){r.abstime="abstime",r.bool="bool",r.date="date",r.daterange="daterange",r.float4="float4",r.float8="float8",r.int2="int2",r.int4="int4",r.int4range="int4range",r.int8="int8",r.int8range="int8range",r.json="json",r.jsonb="jsonb",r.money="money",r.numeric="numeric",r.oid="oid",r.reltime="reltime",r.text="text",r.time="time",r.timestamp="timestamp",r.timestamptz="timestamptz",r.timetz="timetz",r.tsrange="tsrange",r.tstzrange="tstzrange"})(Ce||(Ce={}));const hi=(r,e,t={})=>{var s;const n=(s=t.skipTypes)!==null&&s!==void 0?s:[];return Object.keys(e).reduce((a,i)=>(a[i]=Eu(i,r,e,n),a),{})},Eu=(r,e,t,s)=>{const n=e.find(o=>o.name===r),a=n==null?void 0:n.type,i=t[r];return a&&!s.includes(a)?Uo(a,i):Qn(i)},Uo=(r,e)=>{if(r.charAt(0)==="_"){const t=r.slice(1,r.length);return ju(e,t)}switch(r){case Ce.bool:return xu(e);case Ce.float4:case Ce.float8:case Ce.int2:case Ce.int4:case Ce.int8:case Ce.numeric:case Ce.oid:return Tu(e);case Ce.json:case Ce.jsonb:return Ou(e);case Ce.timestamp:return Au(e);case Ce.abstime:case Ce.date:case Ce.daterange:case Ce.int4range:case Ce.int8range:case Ce.money:case Ce.reltime:case Ce.text:case Ce.time:case Ce.timestamptz:case Ce.timetz:case Ce.tsrange:case Ce.tstzrange:return Qn(e);default:return Qn(e)}},Qn=r=>r,xu=r=>{switch(r){case"t":return!0;case"f":return!1;default:return r}},Tu=r=>{if(typeof r=="string"){const e=parseFloat(r);if(!Number.isNaN(e))return e}return r},Ou=r=>{if(typeof r=="string")try{return JSON.parse(r)}catch(e){return console.log(`JSON parse error: ${e}`),r}return r},ju=(r,e)=>{if(typeof r!="string")return r;const t=r.length-1,s=r[t];if(r[0]==="{"&&s==="}"){let a;const i=r.slice(1,t);try{a=JSON.parse("["+i+"]")}catch{a=i?i.split(","):[]}return a.map(o=>Uo(e,o))}return r},Au=r=>typeof r=="string"?r.replace(" ","T"):r,zo=r=>{let e=r;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class Cn{constructor(e,t,s={},n=Lo){this.channel=e,this.event=t,this.payload=s,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var s;return this._hasReceived(e)&&t((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var fi;(function(r){r.SYNC="sync",r.JOIN="join",r.LEAVE="leave"})(fi||(fi={}));class fs{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},n=>{const{onJoin:a,onLeave:i,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=fs.syncState(this.state,n,a,i),this.pendingDiffs.forEach(c=>{this.state=fs.syncDiff(this.state,c,a,i)}),this.pendingDiffs=[],o()}),this.channel._on(s.diff,{},n=>{const{onJoin:a,onLeave:i,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=fs.syncDiff(this.state,n,a,i),o())}),this.onJoin((n,a,i)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:a,newPresences:i})}),this.onLeave((n,a,i)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:a,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,s,n){const a=this.cloneDeep(e),i=this.transformState(t),o={},c={};return this.map(a,(u,d)=>{i[u]||(c[u]=d)}),this.map(i,(u,d)=>{const h=a[u];if(h){const f=d.map(y=>y.presence_ref),_=h.map(y=>y.presence_ref),p=d.filter(y=>_.indexOf(y.presence_ref)<0),k=h.filter(y=>f.indexOf(y.presence_ref)<0);p.length>0&&(o[u]=p),k.length>0&&(c[u]=k)}else o[u]=d}),this.syncDiff(a,{joins:o,leaves:c},s,n)}static syncDiff(e,t,s,n){const{joins:a,leaves:i}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return s||(s=()=>{}),n||(n=()=>{}),this.map(a,(o,c)=>{var u;const d=(u=e[o])!==null&&u!==void 0?u:[];if(e[o]=this.cloneDeep(c),d.length>0){const h=e[o].map(_=>_.presence_ref),f=d.filter(_=>h.indexOf(_.presence_ref)<0);e[o].unshift(...f)}s(o,d,c)}),this.map(i,(o,c)=>{let u=e[o];if(!u)return;const d=c.map(h=>h.presence_ref);u=u.filter(h=>d.indexOf(h.presence_ref)<0),e[o]=u,n(o,u,c),u.length===0&&delete e[o]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(s=>t(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,s)=>{const n=e[s];return"metas"in n?t[s]=n.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):t[s]=n,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var vi;(function(r){r.ALL="*",r.INSERT="INSERT",r.UPDATE="UPDATE",r.DELETE="DELETE"})(vi||(vi={}));var pi;(function(r){r.BROADCAST="broadcast",r.PRESENCE="presence",r.POSTGRES_CHANGES="postgres_changes",r.SYSTEM="system"})(pi||(pi={}));var Dt;(function(r){r.SUBSCRIBED="SUBSCRIBED",r.TIMED_OUT="TIMED_OUT",r.CLOSED="CLOSED",r.CHANNEL_ERROR="CHANNEL_ERROR"})(Dt||(Dt={}));class wa{constructor(e,t={config:{}},s){this.topic=e,this.params=t,this.socket=s,this.bindings={},this.state=Xe.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Cn(this,bt.join,this.params,this.timeout),this.rejoinTimer=new $o(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Xe.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(n=>n.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Xe.closed,this.socket._remove(this)}),this._onError(n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=Xe.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Xe.errored,this.rejoinTimer.scheduleTimeout())}),this._on(bt.reply,{},(n,a)=>{this._trigger(this._replyEventName(a),n)}),this.presence=new fs(this),this.broadcastEndpointURL=zo(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var s,n;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:a,presence:i,private:o}}=this.params;this._onError(d=>e==null?void 0:e(Dt.CHANNEL_ERROR,d)),this._onClose(()=>e==null?void 0:e(Dt.CLOSED));const c={},u={broadcast:a,presence:i,postgres_changes:(n=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(d=>d.filter))!==null&&n!==void 0?n:[],private:o};this.socket.accessTokenValue&&(c.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:u},c)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:d})=>{var h;if(this.socket.setAuth(),d===void 0){e==null||e(Dt.SUBSCRIBED);return}else{const f=this.bindings.postgres_changes,_=(h=f==null?void 0:f.length)!==null&&h!==void 0?h:0,p=[];for(let k=0;k<_;k++){const y=f[k],{filter:{event:j,schema:P,table:O,filter:x}}=y,T=d&&d[k];if(T&&T.event===j&&T.schema===P&&T.table===O&&T.filter===x)p.push(Object.assign(Object.assign({},y),{id:T.id}));else{this.unsubscribe(),this.state=Xe.errored,e==null||e(Dt.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=p,e&&e(Dt.SUBSCRIBED);return}}).receive("error",d=>{this.state=Xe.errored,e==null||e(Dt.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(d).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Dt.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,s){return this._on(e,t,s)}async send(e,t={}){var s,n;if(!this._canPush()&&e.type==="broadcast"){const{event:a,payload:i}=e,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:i,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(s=t.timeout)!==null&&s!==void 0?s:this.timeout);return await((n=u.body)===null||n===void 0?void 0:n.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var i,o,c;const u=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(o=(i=this.params)===null||i===void 0?void 0:i.config)===null||o===void 0?void 0:o.broadcast)===null||c===void 0)&&c.ack)&&a("ok"),u.receive("ok",()=>a("ok")),u.receive("error",()=>a("error")),u.receive("timeout",()=>a("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Xe.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(bt.close,"leave",this._joinRef())};return this.joinPush.destroy(),new Promise(s=>{const n=new Cn(this,bt.leave,{},e);n.receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,t,s){const n=new AbortController,a=setTimeout(()=>n.abort(),s),i=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:n.signal}));return clearTimeout(a),i}_push(e,t,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new Cn(this,e,t,s);return this._canPush()?n.send():(n.startTimeout(),this.pushBuffer.push(n)),n}_onMessage(e,t,s){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,s){var n,a;const i=e.toLocaleLowerCase(),{close:o,error:c,leave:u,join:d}=bt;if(s&&[o,c,u,d].indexOf(i)>=0&&s!==this._joinRef())return;let f=this._onMessage(i,t,s);if(t&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(_=>{var p,k,y;return((p=_.filter)===null||p===void 0?void 0:p.event)==="*"||((y=(k=_.filter)===null||k===void 0?void 0:k.event)===null||y===void 0?void 0:y.toLocaleLowerCase())===i}).map(_=>_.callback(f,s)):(a=this.bindings[i])===null||a===void 0||a.filter(_=>{var p,k,y,j,P,O;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in _){const x=_.id,T=(p=_.filter)===null||p===void 0?void 0:p.event;return x&&((k=t.ids)===null||k===void 0?void 0:k.includes(x))&&(T==="*"||(T==null?void 0:T.toLocaleLowerCase())===((y=t.data)===null||y===void 0?void 0:y.type.toLocaleLowerCase()))}else{const x=(P=(j=_==null?void 0:_.filter)===null||j===void 0?void 0:j.event)===null||P===void 0?void 0:P.toLocaleLowerCase();return x==="*"||x===((O=t==null?void 0:t.event)===null||O===void 0?void 0:O.toLocaleLowerCase())}else return _.type.toLocaleLowerCase()===i}).map(_=>{if(typeof f=="object"&&"ids"in f){const p=f.data,{schema:k,table:y,commit_timestamp:j,type:P,errors:O}=p;f=Object.assign(Object.assign({},{schema:k,table:y,commit_timestamp:j,eventType:P,new:{},old:{},errors:O}),this._getPayloadRecords(p))}_.callback(f,s)})}_isClosed(){return this.state===Xe.closed}_isJoined(){return this.state===Xe.joined}_isJoining(){return this.state===Xe.joining}_isLeaving(){return this.state===Xe.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,s){const n=e.toLocaleLowerCase(),a={type:n,filter:t,callback:s};return this.bindings[n]?this.bindings[n].push(a):this.bindings[n]=[a],this}_off(e,t){const s=e.toLocaleLowerCase();return this.bindings[s]=this.bindings[s].filter(n=>{var a;return!(((a=n.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===s&&wa.isEqual(n.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(bt.close,{},e)}_onError(e){this._on(bt.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Xe.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=hi(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=hi(e.columns,e.old_record)),t}}const gi=()=>{},Pu=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Cu{constructor(e,t){var s;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers=bu,this.params={},this.timeout=Lo,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=gi,this.ref=0,this.logger=gi,this.conn=null,this.sendBuffer=[],this.serializer=new Su,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=a=>{let i;return a?i=a:typeof fetch>"u"?i=(...o)=>Is(async()=>{const{default:c}=await Promise.resolve().then(()=>Zr);return{default:c}},void 0).then(({default:c})=>c(...o)):i=fetch,(...o)=>i(...o)},this.endPoint=`${e}/${Yn.websocket}`,this.httpEndpoint=zo(e),t!=null&&t.transport?this.transport=t.transport:this.transport=null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.headers&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const n=(s=t==null?void 0:t.params)===null||s===void 0?void 0:s.apikey;if(n&&(this.accessTokenValue=n,this.apiKey=n),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:a=>[1e3,2e3,5e3,1e4][a-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(a,i)=>i(JSON.stringify(a)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new $o(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t==null?void 0:t.fetch),t!=null&&t.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(t==null?void 0:t.worker)||!1,this.workerUrl=t==null?void 0:t.workerUrl}this.accessToken=(t==null?void 0:t.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=Gn),this.transport){typeof window<"u"&&this.transport===window.WebSocket?this.conn=new this.transport(this.endpointURL()):this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection();return}this.conn=new Mu(this.endpointURL(),void 0,{close:()=>{this.conn=null}})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:wu}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(s=>s.teardown()))}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels=this.channels.filter(s=>s._joinRef!==e._joinRef),this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,s){this.logger(e,t,s)}connectionState(){switch(this.conn&&this.conn.readyState){case qr.connecting:return ir.Connecting;case qr.open:return ir.Open;case qr.closing:return ir.Closing;default:return ir.Closed}}isConnected(){return this.connectionState()===ir.Open}channel(e,t={config:{}}){const s=`realtime:${e}`,n=this.getChannels().find(a=>a.topic===s);if(n)return n;{const a=new wa(`realtime:${e}`,t,this);return this.channels.push(a),a}}push(e){const{topic:t,event:s,payload:n,ref:a}=e,i=()=>{this.encode(e,o=>{var c;(c=this.conn)===null||c===void 0||c.send(o)})};this.log("push",`${t} ${s} (${a})`,n),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(s=>{t&&s.updateJoinPayload({access_token:t,version:this.headers&&this.headers["X-Client-Info"]}),s.joinedOnce&&s._isJoined()&&s._push(bt.access_token,{access_token:t})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close(ku,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:s,event:n,payload:a,ref:i}=t;s==="phoenix"&&n==="phx_reply"&&this.heartbeatCallback(t.payload.status=="ok"?"ok":"error"),i&&i===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${a.status||""} ${s} ${n} ${i&&"("+i+")"||""}`,a),Array.from(this.channels).filter(o=>o._isMember(s)).forEach(o=>o._trigger(n,a,i)),this.stateChangeCallbacks.message.forEach(o=>o(t))})}_onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(bt.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const s=e.match(/\?/)?"&":"?",n=new URLSearchParams(t);return`${e}${s}${n}`}_workerObjectUrl(e){let t;if(e)t=e;else{const s=new Blob([Pu],{type:"application/javascript"});t=URL.createObjectURL(s)}return t}}class Mu{constructor(e,t,s){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=qr.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=s.close}}class ka extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Ve(r){return typeof r=="object"&&r!==null&&"__isStorageError"in r}class Iu extends ka{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Zn extends ka{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var Ru=function(r,e,t,s){function n(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(d){try{u(s.next(d))}catch(h){i(h)}}function c(d){try{u(s.throw(d))}catch(h){i(h)}}function u(d){d.done?a(d.value):n(d.value).then(o,c)}u((s=s.apply(r,e||[])).next())})};const qo=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>Is(async()=>{const{default:s}=await Promise.resolve().then(()=>Zr);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)},Du=()=>Ru(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Is(()=>Promise.resolve().then(()=>Zr),void 0)).Response:Response}),Xn=r=>{if(Array.isArray(r))return r.map(t=>Xn(t));if(typeof r=="function"||r!==Object(r))return r;const e={};return Object.entries(r).forEach(([t,s])=>{const n=t.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));e[n]=Xn(s)}),e};var wr=function(r,e,t,s){function n(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(d){try{u(s.next(d))}catch(h){i(h)}}function c(d){try{u(s.throw(d))}catch(h){i(h)}}function u(d){d.done?a(d.value):n(d.value).then(o,c)}u((s=s.apply(r,e||[])).next())})};const Mn=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),Lu=(r,e,t)=>wr(void 0,void 0,void 0,function*(){const s=yield Du();r instanceof s&&!(t!=null&&t.noResolveJson)?r.json().then(n=>{e(new Iu(Mn(n),r.status||500))}).catch(n=>{e(new Zn(Mn(n),n))}):e(new Zn(Mn(r),r))}),$u=(r,e,t,s)=>{const n={method:r,headers:(e==null?void 0:e.headers)||{}};return r==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),s&&(n.body=JSON.stringify(s)),Object.assign(Object.assign({},n),t))};function Rs(r,e,t,s,n,a){return wr(this,void 0,void 0,function*(){return new Promise((i,o)=>{r(t,$u(e,s,n,a)).then(c=>{if(!c.ok)throw c;return s!=null&&s.noResolveJson?c:c.json()}).then(c=>i(c)).catch(c=>Lu(c,o,s))})})}function nn(r,e,t,s){return wr(this,void 0,void 0,function*(){return Rs(r,"GET",e,t,s)})}function Wt(r,e,t,s,n){return wr(this,void 0,void 0,function*(){return Rs(r,"POST",e,s,n,t)})}function Uu(r,e,t,s,n){return wr(this,void 0,void 0,function*(){return Rs(r,"PUT",e,s,n,t)})}function zu(r,e,t,s){return wr(this,void 0,void 0,function*(){return Rs(r,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),s)})}function No(r,e,t,s,n){return wr(this,void 0,void 0,function*(){return Rs(r,"DELETE",e,s,n,t)})}var ot=function(r,e,t,s){function n(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(d){try{u(s.next(d))}catch(h){i(h)}}function c(d){try{u(s.throw(d))}catch(h){i(h)}}function u(d){d.done?a(d.value):n(d.value).then(o,c)}u((s=s.apply(r,e||[])).next())})};const qu={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},_i={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Nu{constructor(e,t={},s,n){this.url=e,this.headers=t,this.bucketId=s,this.fetch=qo(n)}uploadOrUpdate(e,t,s,n){return ot(this,void 0,void 0,function*(){try{let a;const i=Object.assign(Object.assign({},_i),n);let o=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(i.upsert)});const c=i.metadata;typeof Blob<"u"&&s instanceof Blob?(a=new FormData,a.append("cacheControl",i.cacheControl),c&&a.append("metadata",this.encodeMetadata(c)),a.append("",s)):typeof FormData<"u"&&s instanceof FormData?(a=s,a.append("cacheControl",i.cacheControl),c&&a.append("metadata",this.encodeMetadata(c))):(a=s,o["cache-control"]=`max-age=${i.cacheControl}`,o["content-type"]=i.contentType,c&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),n!=null&&n.headers&&(o=Object.assign(Object.assign({},o),n.headers));const u=this._removeEmptyFolders(t),d=this._getFinalPath(u),h=yield this.fetch(`${this.url}/object/${d}`,Object.assign({method:e,body:a,headers:o},i!=null&&i.duplex?{duplex:i.duplex}:{})),f=yield h.json();return h.ok?{data:{path:u,id:f.Id,fullPath:f.Key},error:null}:{data:null,error:f}}catch(a){if(Ve(a))return{data:null,error:a};throw a}})}upload(e,t,s){return ot(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,s)})}uploadToSignedUrl(e,t,s,n){return ot(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(e),i=this._getFinalPath(a),o=new URL(this.url+`/object/upload/sign/${i}`);o.searchParams.set("token",t);try{let c;const u=Object.assign({upsert:_i.upsert},n),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&s instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",s)):typeof FormData<"u"&&s instanceof FormData?(c=s,c.append("cacheControl",u.cacheControl)):(c=s,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType);const h=yield this.fetch(o.toString(),{method:"PUT",body:c,headers:d}),f=yield h.json();return h.ok?{data:{path:a,fullPath:f.Key},error:null}:{data:null,error:f}}catch(c){if(Ve(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(e,t){return ot(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const n=Object.assign({},this.headers);t!=null&&t.upsert&&(n["x-upsert"]="true");const a=yield Wt(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:n}),i=new URL(this.url+a.url),o=i.searchParams.get("token");if(!o)throw new ka("No token returned by API");return{data:{signedUrl:i.toString(),path:e,token:o},error:null}}catch(s){if(Ve(s))return{data:null,error:s};throw s}})}update(e,t,s){return ot(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,s)})}move(e,t,s){return ot(this,void 0,void 0,function*(){try{return{data:yield Wt(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(Ve(n))return{data:null,error:n};throw n}})}copy(e,t,s){return ot(this,void 0,void 0,function*(){try{return{data:{path:(yield Wt(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(Ve(n))return{data:null,error:n};throw n}})}createSignedUrl(e,t,s){return ot(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e),a=yield Wt(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:t},s!=null&&s.transform?{transform:s.transform}:{}),{headers:this.headers});const i=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${i}`)},{data:a,error:null}}catch(n){if(Ve(n))return{data:null,error:n};throw n}})}createSignedUrls(e,t,s){return ot(this,void 0,void 0,function*(){try{const n=yield Wt(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),a=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return{data:n.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${a}`):null})),error:null}}catch(n){if(Ve(n))return{data:null,error:n};throw n}})}download(e,t){return ot(this,void 0,void 0,function*(){const n=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),i=a?`?${a}`:"";try{const o=this._getFinalPath(e);return{data:yield(yield nn(this.fetch,`${this.url}/${n}/${o}${i}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(Ve(o))return{data:null,error:o};throw o}})}info(e){return ot(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const s=yield nn(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:Xn(s),error:null}}catch(s){if(Ve(s))return{data:null,error:s};throw s}})}exists(e){return ot(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield zu(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(Ve(s)&&s instanceof Zn){const n=s.originalError;if([400,404].includes(n==null?void 0:n.status))return{data:!1,error:s}}throw s}})}getPublicUrl(e,t){const s=this._getFinalPath(e),n=[],a=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";a!==""&&n.push(a);const o=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});c!==""&&n.push(c);let u=n.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${s}${u}`)}}}remove(e){return ot(this,void 0,void 0,function*(){try{return{data:yield No(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(Ve(t))return{data:null,error:t};throw t}})}list(e,t,s){return ot(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},qu),t),{prefix:e||""});return{data:yield Wt(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},s),error:null}}catch(n){if(Ve(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const Fu="2.7.1",Bu={"X-Client-Info":`storage-js/${Fu}`};var Ir=function(r,e,t,s){function n(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(d){try{u(s.next(d))}catch(h){i(h)}}function c(d){try{u(s.throw(d))}catch(h){i(h)}}function u(d){d.done?a(d.value):n(d.value).then(o,c)}u((s=s.apply(r,e||[])).next())})};class Wu{constructor(e,t={},s){this.url=e,this.headers=Object.assign(Object.assign({},Bu),t),this.fetch=qo(s)}listBuckets(){return Ir(this,void 0,void 0,function*(){try{return{data:yield nn(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Ve(e))return{data:null,error:e};throw e}})}getBucket(e){return Ir(this,void 0,void 0,function*(){try{return{data:yield nn(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(Ve(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return Ir(this,void 0,void 0,function*(){try{return{data:yield Wt(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(Ve(s))return{data:null,error:s};throw s}})}updateBucket(e,t){return Ir(this,void 0,void 0,function*(){try{return{data:yield Uu(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(Ve(s))return{data:null,error:s};throw s}})}emptyBucket(e){return Ir(this,void 0,void 0,function*(){try{return{data:yield Wt(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(Ve(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Ir(this,void 0,void 0,function*(){try{return{data:yield No(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(Ve(t))return{data:null,error:t};throw t}})}}class Vu extends Wu{constructor(e,t={},s){super(e,t,s)}from(e){return new Nu(this.url,this.headers,e,this.fetch)}}const Hu="2.50.0";let us="";typeof Deno<"u"?us="deno":typeof document<"u"?us="web":typeof navigator<"u"&&navigator.product==="ReactNative"?us="react-native":us="node";const Ju={"X-Client-Info":`supabase-js-${us}/${Hu}`},Ku={headers:Ju},Gu={schema:"public"},Yu={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Qu={};var Zu=function(r,e,t,s){function n(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(d){try{u(s.next(d))}catch(h){i(h)}}function c(d){try{u(s.throw(d))}catch(h){i(h)}}function u(d){d.done?a(d.value):n(d.value).then(o,c)}u((s=s.apply(r,e||[])).next())})};const Xu=r=>{let e;return r?e=r:typeof fetch>"u"?e=Po:e=fetch,(...t)=>e(...t)},ed=()=>typeof Headers>"u"?Co:Headers,td=(r,e,t)=>{const s=Xu(t),n=ed();return(a,i)=>Zu(void 0,void 0,void 0,function*(){var o;const c=(o=yield e())!==null&&o!==void 0?o:r;let u=new n(i==null?void 0:i.headers);return u.has("apikey")||u.set("apikey",r),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),s(a,Object.assign(Object.assign({},i),{headers:u}))})};var rd=function(r,e,t,s){function n(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(d){try{u(s.next(d))}catch(h){i(h)}}function c(d){try{u(s.throw(d))}catch(h){i(h)}}function u(d){d.done?a(d.value):n(d.value).then(o,c)}u((s=s.apply(r,e||[])).next())})};function sd(r){return r.endsWith("/")?r:r+"/"}function nd(r,e){var t,s;const{db:n,auth:a,realtime:i,global:o}=r,{db:c,auth:u,realtime:d,global:h}=e,f={db:Object.assign(Object.assign({},c),n),auth:Object.assign(Object.assign({},u),a),realtime:Object.assign(Object.assign({},d),i),global:Object.assign(Object.assign(Object.assign({},h),o),{headers:Object.assign(Object.assign({},(t=h==null?void 0:h.headers)!==null&&t!==void 0?t:{}),(s=o==null?void 0:o.headers)!==null&&s!==void 0?s:{})}),accessToken:()=>rd(this,void 0,void 0,function*(){return""})};return r.accessToken?f.accessToken=r.accessToken:delete f.accessToken,f}const Fo="2.70.0",Ur=30*1e3,ea=3,In=ea*Ur,ad="http://localhost:9999",id="supabase.auth.token",od={"X-Client-Info":`gotrue-js/${Fo}`},ta="X-Supabase-Api-Version",Bo={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},ld=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,cd=6e5;class Sa extends Error{constructor(e,t,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=s}}function he(r){return typeof r=="object"&&r!==null&&"__isAuthError"in r}class ud extends Sa{constructor(e,t,s){super(e,t,s),this.name="AuthApiError",this.status=t,this.code=s}}function dd(r){return he(r)&&r.name==="AuthApiError"}class Wo extends Sa{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class er extends Sa{constructor(e,t,s,n){super(e,s,n),this.name=t,this.status=s}}class Bt extends er{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function hd(r){return he(r)&&r.name==="AuthSessionMissingError"}class Ws extends er{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Vs extends er{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Hs extends er{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function fd(r){return he(r)&&r.name==="AuthImplicitGrantRedirectError"}class mi extends er{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ra extends er{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Rn(r){return he(r)&&r.name==="AuthRetryableFetchError"}class yi extends er{constructor(e,t,s){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=s}}class vs extends er{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const an="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),bi=` 	
\r=`.split(""),vd=(()=>{const r=new Array(128);for(let e=0;e<r.length;e+=1)r[e]=-1;for(let e=0;e<bi.length;e+=1)r[bi[e].charCodeAt(0)]=-2;for(let e=0;e<an.length;e+=1)r[an[e].charCodeAt(0)]=e;return r})();function wi(r,e,t){if(r!==null)for(e.queue=e.queue<<8|r,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;t(an[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;t(an[s]),e.queuedBits-=6}}function Vo(r,e,t){const s=vd[r];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(r)}"`)}}function ki(r){const e=[],t=i=>{e.push(String.fromCodePoint(i))},s={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},a=i=>{_d(i,s,t)};for(let i=0;i<r.length;i+=1)Vo(r.charCodeAt(i),n,a);return e.join("")}function pd(r,e){if(r<=127){e(r);return}else if(r<=2047){e(192|r>>6),e(128|r&63);return}else if(r<=65535){e(224|r>>12),e(128|r>>6&63),e(128|r&63);return}else if(r<=1114111){e(240|r>>18),e(128|r>>12&63),e(128|r>>6&63),e(128|r&63);return}throw new Error(`Unrecognized Unicode codepoint: ${r.toString(16)}`)}function gd(r,e){for(let t=0;t<r.length;t+=1){let s=r.charCodeAt(t);if(s>55295&&s<=56319){const n=(s-55296)*1024&65535;s=(r.charCodeAt(t+1)-56320&65535|n)+65536,t+=1}pd(s,e)}}function _d(r,e,t){if(e.utf8seq===0){if(r<=127){t(r);return}for(let s=1;s<6;s+=1)if((r>>7-s&1)===0){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=r&31;else if(e.utf8seq===3)e.codepoint=r&15;else if(e.utf8seq===4)e.codepoint=r&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(r<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|r&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function md(r){const e=[],t={queue:0,queuedBits:0},s=n=>{e.push(n)};for(let n=0;n<r.length;n+=1)Vo(r.charCodeAt(n),t,s);return new Uint8Array(e)}function yd(r){const e=[];return gd(r,t=>e.push(t)),new Uint8Array(e)}function bd(r){const e=[],t={queue:0,queuedBits:0},s=n=>{e.push(n)};return r.forEach(n=>wi(n,t,s)),wi(null,t,s),e.join("")}function wd(r){return Math.round(Date.now()/1e3)+r}function kd(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){const e=Math.random()*16|0;return(r=="x"?e:e&3|8).toString(16)})}const yt=()=>typeof window<"u"&&typeof document<"u",nr={tested:!1,writable:!1},ps=()=>{if(!yt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(nr.tested)return nr.writable;const r=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(r,r),globalThis.localStorage.removeItem(r),nr.tested=!0,nr.writable=!0}catch{nr.tested=!0,nr.writable=!1}return nr.writable};function Sd(r){const e={},t=new URL(r);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((n,a)=>{e[a]=n})}catch{}return t.searchParams.forEach((s,n)=>{e[n]=s}),e}const Ho=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>Is(async()=>{const{default:s}=await Promise.resolve().then(()=>Zr);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)},Ed=r=>typeof r=="object"&&r!==null&&"status"in r&&"ok"in r&&"json"in r&&typeof r.json=="function",Jo=async(r,e,t)=>{await r.setItem(e,JSON.stringify(t))},Js=async(r,e)=>{const t=await r.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Ks=async(r,e)=>{await r.removeItem(e)};class yn{constructor(){this.promise=new yn.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}yn.promiseConstructor=Promise;function Dn(r){const e=r.split(".");if(e.length!==3)throw new vs("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!ld.test(e[s]))throw new vs("JWT not in base64url format");return{header:JSON.parse(ki(e[0])),payload:JSON.parse(ki(e[1])),signature:md(e[2]),raw:{header:e[0],payload:e[1]}}}async function xd(r){return await new Promise(e=>{setTimeout(()=>e(null),r)})}function Td(r,e){return new Promise((s,n)=>{(async()=>{for(let a=0;a<1/0;a++)try{const i=await r(a);if(!e(a,null,i)){s(i);return}}catch(i){if(!e(a,i)){n(i);return}}})()})}function Od(r){return("0"+r.toString(16)).substr(-2)}function jd(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=t.length;let n="";for(let a=0;a<56;a++)n+=t.charAt(Math.floor(Math.random()*s));return n}return crypto.getRandomValues(e),Array.from(e,Od).join("")}async function Ad(r){const t=new TextEncoder().encode(r),s=await crypto.subtle.digest("SHA-256",t),n=new Uint8Array(s);return Array.from(n).map(a=>String.fromCharCode(a)).join("")}async function Pd(r){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),r;const t=await Ad(r);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Rr(r,e,t=!1){const s=jd();let n=s;t&&(n+="/PASSWORD_RECOVERY"),await Jo(r,`${e}-code-verifier`,n);const a=await Pd(s);return[a,s===a?"plain":"s256"]}const Cd=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Md(r){const e=r.headers.get(ta);if(!e||!e.match(Cd))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Id(r){if(!r)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(r<=e)throw new Error("JWT has expired")}function Rd(r){switch(r){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Dd=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Dr(r){if(!Dd.test(r))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}var Ld=function(r,e){var t={};for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&e.indexOf(s)<0&&(t[s]=r[s]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(r);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(r,s[n])&&(t[s[n]]=r[s[n]]);return t};const ar=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),$d=[502,503,504];async function Si(r){var e;if(!Ed(r))throw new ra(ar(r),0);if($d.includes(r.status))throw new ra(ar(r),r.status);let t;try{t=await r.json()}catch(a){throw new Wo(ar(a),a)}let s;const n=Md(r);if(n&&n.getTime()>=Bo["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?s=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(s=t.error_code),s){if(s==="weak_password")throw new yi(ar(t),r.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new Bt}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((a,i)=>a&&typeof i=="string",!0))throw new yi(ar(t),r.status,t.weak_password.reasons);throw new ud(ar(t),r.status||500,s)}const Ud=(r,e,t,s)=>{const n={method:r,headers:(e==null?void 0:e.headers)||{}};return r==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),n.body=JSON.stringify(s),Object.assign(Object.assign({},n),t))};async function _e(r,e,t,s){var n;const a=Object.assign({},s==null?void 0:s.headers);a[ta]||(a[ta]=Bo["2024-01-01"].name),s!=null&&s.jwt&&(a.Authorization=`Bearer ${s.jwt}`);const i=(n=s==null?void 0:s.query)!==null&&n!==void 0?n:{};s!=null&&s.redirectTo&&(i.redirect_to=s.redirectTo);const o=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",c=await zd(r,e,t+o,{headers:a,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(c):{data:Object.assign({},c),error:null}}async function zd(r,e,t,s,n,a){const i=Ud(e,s,n,a);let o;try{o=await r(t,Object.assign({},i))}catch(c){throw console.error(c),new ra(ar(c),0)}if(o.ok||await Si(o),s!=null&&s.noResolveJson)return o;try{return await o.json()}catch(c){await Si(c)}}function It(r){var e;let t=null;Bd(r)&&(t=Object.assign({},r),r.expires_at||(t.expires_at=wd(r.expires_in)));const s=(e=r.user)!==null&&e!==void 0?e:r;return{data:{session:t,user:s},error:null}}function Ei(r){const e=It(r);return!e.error&&r.weak_password&&typeof r.weak_password=="object"&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.message&&typeof r.weak_password.message=="string"&&r.weak_password.reasons.reduce((t,s)=>t&&typeof s=="string",!0)&&(e.data.weak_password=r.weak_password),e}function Vt(r){var e;return{data:{user:(e=r.user)!==null&&e!==void 0?e:r},error:null}}function qd(r){return{data:r,error:null}}function Nd(r){const{action_link:e,email_otp:t,hashed_token:s,redirect_to:n,verification_type:a}=r,i=Ld(r,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:e,email_otp:t,hashed_token:s,redirect_to:n,verification_type:a},c=Object.assign({},i);return{data:{properties:o,user:c},error:null}}function Fd(r){return r}function Bd(r){return r.access_token&&r.refresh_token&&r.expires_in}const Ln=["global","local","others"];var Wd=function(r,e){var t={};for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&e.indexOf(s)<0&&(t[s]=r[s]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(r);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(r,s[n])&&(t[s[n]]=r[s[n]]);return t};class Vd{constructor({url:e="",headers:t={},fetch:s}){this.url=e,this.headers=t,this.fetch=Ho(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=Ln[0]){if(Ln.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Ln.join(", ")}`);try{return await _e(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(he(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,t={}){try{return await _e(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Vt})}catch(s){if(he(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:t}=e,s=Wd(e,["options"]),n=Object.assign(Object.assign({},s),t);return"newEmail"in s&&(n.new_email=s==null?void 0:s.newEmail,delete n.newEmail),await _e(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:Nd,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(he(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await _e(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Vt})}catch(t){if(he(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,s,n,a,i,o,c;try{const u={nextPage:null,lastPage:0,total:0},d=await _e(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&s!==void 0?s:"",per_page:(a=(n=e==null?void 0:e.perPage)===null||n===void 0?void 0:n.toString())!==null&&a!==void 0?a:""},xform:Fd});if(d.error)throw d.error;const h=await d.json(),f=(i=d.headers.get("x-total-count"))!==null&&i!==void 0?i:0,_=(c=(o=d.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&c!==void 0?c:[];return _.length>0&&(_.forEach(p=>{const k=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(p.split(";")[1].split("=")[1]);u[`${y}Page`]=k}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(he(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){Dr(e);try{return await _e(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Vt})}catch(t){if(he(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Dr(e);try{return await _e(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Vt})}catch(s){if(he(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,t=!1){Dr(e);try{return await _e(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Vt})}catch(s){if(he(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){Dr(e.userId);try{const{data:t,error:s}=await _e(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:t,error:s}}catch(t){if(he(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Dr(e.userId),Dr(e.id);try{return{data:await _e(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(he(t))return{data:null,error:t};throw t}}}const Hd={getItem:r=>ps()?globalThis.localStorage.getItem(r):null,setItem:(r,e)=>{ps()&&globalThis.localStorage.setItem(r,e)},removeItem:r=>{ps()&&globalThis.localStorage.removeItem(r)}};function xi(r={}){return{getItem:e=>r[e]||null,setItem:(e,t)=>{r[e]=t},removeItem:e=>{delete r[e]}}}function Jd(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Lr={debug:!!(globalThis&&ps()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Ko extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Kd extends Ko{}async function Gd(r,e,t){Lr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",r,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),Lr.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",r)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(r,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async n=>{if(n){Lr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",r,n.name);try{return await t()}finally{Lr.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",r,n.name)}}else{if(e===0)throw Lr.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",r),new Kd(`Acquiring an exclusive Navigator LockManager lock "${r}" immediately failed`);if(Lr.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}Jd();const Yd={url:ad,storageKey:id,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:od,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Ti(r,e,t){return await t()}class ws{constructor(e){var t,s;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=ws.nextInstanceID,ws.nextInstanceID+=1,this.instanceID>0&&yt()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},Yd),e);if(this.logDebugMessages=!!n.debug,typeof n.debug=="function"&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new Vd({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=Ho(n.fetch),this.lock=n.lock||Ti,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:yt()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=Gd:this.lock=Ti,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?n.storage?this.storage=n.storage:ps()?this.storage=Hd:(this.memoryStorage={},this.storage=xi(this.memoryStorage)):(this.memoryStorage={},this.storage=xi(this.memoryStorage)),yt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Fo}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=Sd(window.location.href);let s="none";if(this._isImplicitGrantCallback(t)?s="implicit":await this._isPKCECallback(t)&&(s="pkce"),yt()&&this.detectSessionInUrl&&s!=="none"){const{data:n,error:a}=await this._getSessionFromURL(t,s);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),fd(a)){const c=(e=a.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:i,redirectType:o}=n;return this._debug("#_initialize()","detected session in URL",i,"redirect type",o),await this._saveSession(i),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return he(t)?{error:t}:{error:new Wo("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,s,n;try{const a=await _e(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.captchaToken}},xform:It}),{data:i,error:o}=a;if(o||!i)return{data:{user:null,session:null},error:o};const c=i.session,u=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(a){if(he(a))return{data:{user:null,session:null},error:a};throw a}}async signUp(e){var t,s,n;try{let a;if("email"in e){const{email:d,password:h,options:f}=e;let _=null,p=null;this.flowType==="pkce"&&([_,p]=await Rr(this.storage,this.storageKey)),a=await _e(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:d,password:h,data:(t=f==null?void 0:f.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:_,code_challenge_method:p},xform:It})}else if("phone"in e){const{phone:d,password:h,options:f}=e;a=await _e(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:h,data:(s=f==null?void 0:f.data)!==null&&s!==void 0?s:{},channel:(n=f==null?void 0:f.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:It})}else throw new Vs("You must provide either an email or phone number and a password");const{data:i,error:o}=a;if(o||!i)return{data:{user:null,session:null},error:o};const c=i.session,u=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(a){if(he(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithPassword(e){try{let t;if("email"in e){const{email:a,password:i,options:o}=e;t=await _e(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Ei})}else if("phone"in e){const{phone:a,password:i,options:o}=e;t=await _e(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Ei})}else throw new Vs("You must provide either an email or phone number and a password");const{data:s,error:n}=t;return n?{data:{user:null,session:null},error:n}:!s||!s.session||!s.user?{data:{user:null,session:null},error:new Ws}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:n})}catch(t){if(he(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,s,n,a;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(a=e.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if(t==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,s,n,a,i,o,c,u,d,h,f,_;let p,k;if("message"in e)p=e.message,k=e.signature;else{const{chain:y,wallet:j,statement:P,options:O}=e;let x;if(yt())if(typeof j=="object")x=j;else{const E=window;if("solana"in E&&typeof E.solana=="object"&&("signIn"in E.solana&&typeof E.solana.signIn=="function"||"signMessage"in E.solana&&typeof E.solana.signMessage=="function"))x=E.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof j!="object"||!(O!=null&&O.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");x=j}const T=new URL((t=O==null?void 0:O.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in x&&x.signIn){const E=await x.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},O==null?void 0:O.signInWithSolana),{version:"1",domain:T.host,uri:T.href}),P?{statement:P}:null));let C;if(Array.isArray(E)&&E[0]&&typeof E[0]=="object")C=E[0];else if(E&&typeof E=="object"&&"signedMessage"in E&&"signature"in E)C=E;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in C&&"signature"in C&&(typeof C.signedMessage=="string"||C.signedMessage instanceof Uint8Array)&&C.signature instanceof Uint8Array)p=typeof C.signedMessage=="string"?C.signedMessage:new TextDecoder().decode(C.signedMessage),k=C.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in x)||typeof x.signMessage!="function"||!("publicKey"in x)||typeof x!="object"||!x.publicKey||!("toBase58"in x.publicKey)||typeof x.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");p=[`${T.host} wants you to sign in with your Solana account:`,x.publicKey.toBase58(),...P?["",P,""]:[""],"Version: 1",`URI: ${T.href}`,`Issued At: ${(n=(s=O==null?void 0:O.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((a=O==null?void 0:O.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${O.signInWithSolana.notBefore}`]:[],...!((i=O==null?void 0:O.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${O.signInWithSolana.expirationTime}`]:[],...!((o=O==null?void 0:O.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${O.signInWithSolana.chainId}`]:[],...!((c=O==null?void 0:O.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${O.signInWithSolana.nonce}`]:[],...!((u=O==null?void 0:O.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${O.signInWithSolana.requestId}`]:[],...!((h=(d=O==null?void 0:O.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||h===void 0)&&h.length?["Resources",...O.signInWithSolana.resources.map(C=>`- ${C}`)]:[]].join(`
`);const E=await x.signMessage(new TextEncoder().encode(p),"utf8");if(!E||!(E instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");k=E}}try{const{data:y,error:j}=await _e(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:p,signature:bd(k)},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(_=e.options)===null||_===void 0?void 0:_.captchaToken}}:null),xform:It});if(j)throw j;return!y||!y.session||!y.user?{data:{user:null,session:null},error:new Ws}:(y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",y.session)),{data:Object.assign({},y),error:j})}catch(y){if(he(y))return{data:{user:null,session:null},error:y};throw y}}async _exchangeCodeForSession(e){const t=await Js(this.storage,`${this.storageKey}-code-verifier`),[s,n]=(t??"").split("/");try{const{data:a,error:i}=await _e(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:It});if(await Ks(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return!a||!a.session||!a.user?{data:{user:null,session:null,redirectType:null},error:new Ws}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign(Object.assign({},a),{redirectType:n??null}),error:i})}catch(a){if(he(a))return{data:{user:null,session:null,redirectType:null},error:a};throw a}}async signInWithIdToken(e){try{const{options:t,provider:s,token:n,access_token:a,nonce:i}=e,o=await _e(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:n,access_token:a,nonce:i,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:It}),{data:c,error:u}=o;return u?{data:{user:null,session:null},error:u}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new Ws}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:u})}catch(t){if(he(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,s,n,a,i;try{if("email"in e){const{email:o,options:c}=e;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await Rr(this.storage,this.storageKey));const{error:h}=await _e(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(t=c==null?void 0:c.data)!==null&&t!==void 0?t:{},create_user:(s=c==null?void 0:c.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:o,options:c}=e,{data:u,error:d}=await _e(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(n=c==null?void 0:c.data)!==null&&n!==void 0?n:{},create_user:(a=c==null?void 0:c.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(i=c==null?void 0:c.channel)!==null&&i!==void 0?i:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:d}}throw new Vs("You must provide either an email or phone number.")}catch(o){if(he(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(e){var t,s;try{let n,a;"options"in e&&(n=(t=e.options)===null||t===void 0?void 0:t.redirectTo,a=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:i,error:o}=await _e(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:n,xform:It});if(o)throw o;if(!i)throw new Error("An error occurred on token verification.");const c=i.session,u=i.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(n){if(he(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(e){var t,s,n;try{let a=null,i=null;return this.flowType==="pkce"&&([a,i]=await Rr(this.storage,this.storageKey)),await _e(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&s!==void 0?s:void 0}),!((n=e==null?void 0:e.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:i}),headers:this.headers,xform:qd})}catch(a){if(he(a))return{data:null,error:a};throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:s}=e;if(s)throw s;if(!t)throw new Bt;const{error:n}=await _e(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:n}})}catch(e){if(he(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:s,type:n,options:a}=e,{error:i}=await _e(this.fetch,"POST",t,{headers:this.headers,body:{email:s,type:n,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},redirectTo:a==null?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:i}}else if("phone"in e){const{phone:s,type:n,options:a}=e,{data:i,error:o}=await _e(this.fetch,"POST",t,{headers:this.headers,body:{phone:s,type:n,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}}});return{data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:o}}throw new Vs("You must provide either an email or phone number and a type")}catch(t){if(he(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await s,await t()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=t();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Js(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<In:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.storage.isServer){let i=this.suppressGetSessionWarning;e=new Proxy(e,{get:(c,u,d)=>(!i&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),i=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,u,d))})}return{data:{session:e},error:null}}const{session:n,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{session:null},error:a}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await _e(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Vt}):await this._useSession(async t=>{var s,n,a;const{data:i,error:o}=t;if(o)throw o;return!(!((s=i.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Bt}:await _e(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0,xform:Vt})})}catch(t){if(he(t))return hd(t)&&(await this._removeSession(),await Ks(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async s=>{const{data:n,error:a}=s;if(a)throw a;if(!n.session)throw new Bt;const i=n.session;let o=null,c=null;this.flowType==="pkce"&&e.email!=null&&([o,c]=await Rr(this.storage,this.storageKey));const{data:u,error:d}=await _e(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:c}),jwt:i.access_token,xform:Vt});if(d)throw d;return i.user=u.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(s){if(he(s))return{data:{user:null},error:s};throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Bt;const t=Date.now()/1e3;let s=t,n=!0,a=null;const{payload:i}=Dn(e.access_token);if(i.exp&&(s=i.exp,n=s<=t),n){const{session:o,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!o)return{data:{user:null,session:null},error:null};a=o}else{const{data:o,error:c}=await this._getUser(e.access_token);if(c)throw c;a={access_token:e.access_token,refresh_token:e.refresh_token,user:o.user,token_type:"bearer",expires_in:s-t,expires_at:s},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(t){if(he(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var s;if(!e){const{data:i,error:o}=t;if(o)throw o;e=(s=i.session)!==null&&s!==void 0?s:void 0}if(!(e!=null&&e.refresh_token))throw new Bt;const{session:n,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{user:null,session:null},error:a}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(he(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!yt())throw new Hs("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Hs(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new mi("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Hs("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new mi("No code detected.");const{data:P,error:O}=await this._exchangeCodeForSession(e.code);if(O)throw O;const x=new URL(window.location.href);return x.searchParams.delete("code"),window.history.replaceState(window.history.state,"",x.toString()),{data:{session:P.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:n,access_token:a,refresh_token:i,expires_in:o,expires_at:c,token_type:u}=e;if(!a||!o||!i||!u)throw new Hs("No session defined in URL");const d=Math.round(Date.now()/1e3),h=parseInt(o);let f=d+h;c&&(f=parseInt(c));const _=f-d;_*1e3<=Ur&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${_}s, should have been closer to ${h}s`);const p=f-h;d-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,f,d):d-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,f,d);const{data:k,error:y}=await this._getUser(a);if(y)throw y;const j={provider_token:s,provider_refresh_token:n,access_token:a,expires_in:h,expires_at:f,refresh_token:i,token_type:u,user:k.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:j,redirectType:e.type},error:null}}catch(s){if(he(s))return{data:{session:null,redirectType:null},error:s};throw s}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Js(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var s;const{data:n,error:a}=t;if(a)return{error:a};const i=(s=n.session)===null||s===void 0?void 0:s.access_token;if(i){const{error:o}=await this.admin.signOut(i,e);if(o&&!(dd(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return e!=="others"&&(await this._removeSession(),await Ks(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=kd(),s={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async t=>{var s,n;try{const{data:{session:a},error:i}=t;if(i)throw i;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",e,"session",a)}catch(a){await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a),console.error(a)}})}async resetPasswordForEmail(e,t={}){let s=null,n=null;this.flowType==="pkce"&&([s,n]=await Rr(this.storage,this.storageKey,!0));try{return await _e(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:n,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(a){if(he(a))return{data:null,error:a};throw a}}async getUserIdentities(){var e;try{const{data:t,error:s}=await this.getUser();if(s)throw s;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(he(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:s,error:n}=await this._useSession(async a=>{var i,o,c,u,d;const{data:h,error:f}=a;if(f)throw f;const _=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(i=e.options)===null||i===void 0?void 0:i.redirectTo,scopes:(o=e.options)===null||o===void 0?void 0:o.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await _e(this.fetch,"GET",_,{headers:this.headers,jwt:(d=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(n)throw n;return yt()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),{data:{provider:e.provider,url:s==null?void 0:s.url},error:null}}catch(s){if(he(s))return{data:{provider:e.provider,url:null},error:s};throw s}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var s,n;const{data:a,error:i}=t;if(i)throw i;return await _e(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(s=a.session)===null||s===void 0?void 0:s.access_token)!==null&&n!==void 0?n:void 0})})}catch(t){if(he(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const s=Date.now();return await Td(async n=>(n>0&&await xd(200*Math.pow(2,n-1)),this._debug(t,"refreshing attempt",n),await _e(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:It})),(n,a)=>{const i=200*Math.pow(2,n);return a&&Rn(a)&&Date.now()+i-s<Ur})}catch(s){if(this._debug(t,"error",s),he(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",s),yt()&&!t.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const s=await Js(this.storage,this.storageKey);if(this._debug(t,"session from storage",s),!this._isValidSession(s)){this._debug(t,"session is not valid"),s!==null&&await this._removeSession();return}const n=((e=s.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<In;if(this._debug(t,`session has${n?"":" not"} expired with margin of ${In}s`),n){if(this.autoRefreshToken&&s.refresh_token){const{error:a}=await this._callRefreshToken(s.refresh_token);a&&(console.error(a),Rn(a)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(t,"error",s),console.error(s);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,s;if(!e)throw new Bt;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new yn;const{data:a,error:i}=await this._refreshAccessToken(e);if(i)throw i;if(!a.session)throw new Bt;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const o={session:a.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(a){if(this._debug(n,"error",a),he(a)){const i={session:null,error:a};return Rn(a)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(i),i}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(a),a}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,t,s=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",t,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:t});const a=[],i=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(e,t)}catch(c){a.push(c)}});if(await Promise.all(i),a.length>0){for(let o=0;o<a.length;o+=1)console.error(a[o]);throw a[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await Jo(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await Ks(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&yt()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Ur);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:s}}=t;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((s.expires_at*1e3-e)/Ur);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${Ur}ms, refresh threshold is ${ea} ticks`),n<=ea&&await this._callRefreshToken(s.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Ko)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!yt()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,s){const n=[`provider=${encodeURIComponent(t)}`];if(s!=null&&s.redirectTo&&n.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&n.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[a,i]=await Rr(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(i)}`});n.push(o.toString())}if(s!=null&&s.queryParams){const a=new URLSearchParams(s.queryParams);n.push(a.toString())}return s!=null&&s.skipBrowserRedirect&&n.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var s;const{data:n,error:a}=t;return a?{data:null,error:a}:await _e(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(he(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var s,n;const{data:a,error:i}=t;if(i)return{data:null,error:i};const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:c,error:u}=await _e(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(s=a==null?void 0:a.session)===null||s===void 0?void 0:s.access_token});return u?{data:null,error:u}:(e.factorType==="totp"&&(!((n=c==null?void 0:c.totp)===null||n===void 0)&&n.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(t){if(he(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:n,error:a}=t;if(a)return{data:null,error:a};const{data:i,error:o}=await _e(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:o})})}catch(t){if(he(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:n,error:a}=t;return a?{data:null,error:a}:await _e(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(he(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const s=(e==null?void 0:e.factors)||[],n=s.filter(i=>i.factor_type==="totp"&&i.status==="verified"),a=s.filter(i=>i.factor_type==="phone"&&i.status==="verified");return{data:{all:s,totp:n,phone:a},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,s;const{data:{session:n},error:a}=e;if(a)return{data:null,error:a};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=Dn(n.access_token);let o=null;i.aal&&(o=i.aal);let c=o;((s=(t=n.user.factors)===null||t===void 0?void 0:t.filter(h=>h.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(c="aal2");const d=i.amr||[];return{data:{currentLevel:o,nextLevel:c,currentAuthenticationMethods:d},error:null}}))}async fetchJwk(e,t={keys:[]}){let s=t.keys.find(i=>i.kid===e);if(s||(s=this.jwks.keys.find(i=>i.kid===e),s&&this.jwks_cached_at+cd>Date.now()))return s;const{data:n,error:a}=await _e(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;if(!n.keys||n.keys.length===0)throw new vs("JWKS is empty");if(this.jwks=n,this.jwks_cached_at=Date.now(),s=n.keys.find(i=>i.kid===e),!s)throw new vs("No matching signing key found in JWKS");return s}async getClaims(e,t={keys:[]}){try{let s=e;if(!s){const{data:_,error:p}=await this.getSession();if(p||!_.session)return{data:null,error:p};s=_.session.access_token}const{header:n,payload:a,signature:i,raw:{header:o,payload:c}}=Dn(s);if(Id(a.exp),!n.kid||n.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:_}=await this.getUser(s);if(_)throw _;return{data:{claims:a,header:n,signature:i},error:null}}const u=Rd(n.alg),d=await this.fetchJwk(n.kid,t),h=await crypto.subtle.importKey("jwk",d,u,!0,["verify"]);if(!await crypto.subtle.verify(u,h,i,yd(`${o}.${c}`)))throw new vs("Invalid JWT signature");return{data:{claims:a,header:n,signature:i},error:null}}catch(s){if(he(s))return{data:null,error:s};throw s}}}ws.nextInstanceID=0;const Qd=ws;class Zd extends Qd{constructor(e){super(e)}}var Xd=function(r,e,t,s){function n(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(d){try{u(s.next(d))}catch(h){i(h)}}function c(d){try{u(s.throw(d))}catch(h){i(h)}}function u(d){d.done?a(d.value):n(d.value).then(o,c)}u((s=s.apply(r,e||[])).next())})};class eh{constructor(e,t,s){var n,a,i;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const o=sd(e),c=new URL(o);this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const u=`sb-${c.hostname.split(".")[0]}-auth-token`,d={db:Gu,realtime:Qu,auth:Object.assign(Object.assign({},Yu),{storageKey:u}),global:Ku},h=nd(s??{},d);this.storageKey=(n=h.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(a=h.global.headers)!==null&&a!==void 0?a:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(f,_)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(_)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=h.auth)!==null&&i!==void 0?i:{},this.headers,h.global.fetch),this.fetch=td(t,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new mu(new URL("rest/v1",c).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),h.accessToken||this._listenForAuthEvents()}get functions(){return new nu(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Vu(this.storageUrl.href,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},s={}){return this.rest.rpc(e,t,s)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return Xd(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return(t=(e=s.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:n,storageKey:a,flowType:i,lock:o,debug:c},u,d){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Zd({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),u),storageKey:a,autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:n,flowType:i,lock:o,debug:c,fetch:d,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new Cu(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,s)=>{this._handleTokenChanged(t,"CLIENT",s==null?void 0:s.access_token)})}_handleTokenChanged(e,t,s){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==s?this.changedAccessToken=s:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const th=(r,e,t)=>new eh(r,e,t),rh="https://ibgkltqlgbafpoljizdu.supabase.co",sh="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImliZ2tsdHFsZ2JhZnBvbGppemR1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDkzMjU1NzksImV4cCI6MjA2NDkwMTU3OX0.Awa-Gdd3b4uR_1MnQySyA5s6hfVfyZB6jlVS1Jj_Afk",ie=th(rh,sh);Hl();function Oi(r,e){v(e,!l(e))}var nh=N('<button class="open-sidebar-icon icon svelte-1hv2e3s">â¡</button> <aside><div class="sidebar-header svelte-1hv2e3s"><img src="https://raw.githubusercontent.com/Ewan-Dev/ewan.is-a.dev/refs/heads/main/frontend/static/loquela.png" class="logo svelte-1hv2e3s" alt="loquela logo"/> <button class="close-sidebar-icon icon svelte-1hv2e3s">X</button></div> <nav class="sidebar-nav svelte-1hv2e3s"><a href="./#/app/home"><span class="material-symbols-rounded svelte-1hv2e3s">home</span> Home</a> <a href="./#/app/music"><span class="material-symbols-rounded svelte-1hv2e3s">music_note</span> Music</a> <a href="./#/app/videos"><span class="material-symbols-rounded svelte-1hv2e3s">movie</span> Videos</a> <a href="./#/app/upload"><span class="material-symbols-rounded svelte-1hv2e3s">upload</span> Upload</a> <a href="./#/app/flashcards"><span class="material-symbols-rounded svelte-1hv2e3s">cards_star</span> Flashcards</a> <a href="./#/app/ai-chat"><span class="material-symbols-rounded svelte-1hv2e3s">chat</span> AI Chat</a></nav></aside>',1);function Mt(r,e){let t=Se(e,"currentPage",8,""),s=ur(!1);var n=nh(),a=Ie(n);a.__click=[Oi,s];var i=g(a,2);let o;var c=b(i),u=g(b(c),2);u.__click=[Oi,s];var d=g(c,2),h=b(d);let f;var _=g(h,2);let p;var k=g(_,2);let y;var j=g(k,2);let P;var O=g(j,2);let x;var T=g(O,2);let E;ce((C,A,M,W,le,J,z)=>{o=ut(i,1,"sidebar svelte-1hv2e3s",null,o,C),f=ut(h,1,"svelte-1hv2e3s",null,f,A),p=ut(_,1,"svelte-1hv2e3s",null,p,M),y=ut(k,1,"svelte-1hv2e3s",null,y,W),P=ut(j,1,"svelte-1hv2e3s",null,P,le),x=ut(O,1,"svelte-1hv2e3s",null,x,J),E=ut(T,1,"svelte-1hv2e3s",null,E,z)},[()=>({show:l(s)}),()=>({selected:t()==="/home"}),()=>({selected:t()==="/music"}),()=>({selected:t()==="/videos"}),()=>({selected:t()==="/upload"}),()=>({selected:t()==="/flashcards"}),()=>({selected:t()==="/ai-chat"})]),D(r,n)}br(["click"]);var ah=N('<div><span class="material-symbols-rounded svelte-hct3vs"> </span> <p> </p></div>');function ih(r,e){let t=Se(e,"type",8,""),s=Se(e,"message",8,""),n=Se(e,"symbol",8,"");var a=ah(),i=b(a),o=b(i),c=g(i,2),u=b(c);ce(()=>{ut(a,1,`media-tag ${t()}`,"svelte-hct3vs"),te(o,n()),te(u,s())}),D(r,a)}var oh=N('<div><img alt="Album cover"/> <span class="svelte-1pu170t"><!></span> <a class="svelte-1pu170t"><b> </b></a> <a class="svelte-1pu170t"> </a></div>');function Ea(r,e){Le(e,!1);let t=Se(e,"name",12,null),s=Se(e,"artist",12,null),n=Se(e,"cover",8,null),a=Se(e,"level",8,null);Se(e,"rating",8,null);let i=Se(e,"link",8,null),o=Se(e,"type",8,null);t().length>45&&t(t().slice(0,37)+"..."),s().length>23&&s(s().slice(0,20)+"..."),_a();var c=oh(),u=b(c),d=g(u,2),h=b(d);ih(h,{type:"level",get message(){return a()}});var f=g(d,2),_=b(f),p=b(_),k=g(f,2),y=b(k);ce(()=>{ut(c,1,sn(o()),"svelte-1pu170t"),Be(u,"src",n()),ut(u,1,sn(o()),"svelte-1pu170t"),Be(f,"href",i()),te(p,t()),te(y,s())}),D(r,c),$e()}var lh=N('<main class="route svelte-1nmp6pz"><!> <section class="main-page svelte-1nmp6pz"><h1 class="page-header">Home</h1> <section class="main-content svelte-1nmp6pz"><h2 class="home-page-main-section-head svelte-1nmp6pz">Recent videos</h2> <div class="media-list svelte-1nmp6pz"></div></section></section></main>');function ch(r,e){Le(e,!1);let t=ur([]);lt(async()=>{const{data:{user:c}}=await ie.auth.getUser();console.log(c);const{data:u,error:d}=await ie.from("profiles").select("recent_videos");v(t,u[0].recent_videos),console.log(l(t))}),_a();var s=lh(),n=b(s);Mt(n,{currentPage:"/home"});var a=g(n,2),i=g(b(a),2),o=g(b(i),2);De(o,5,()=>l(t),Re,(c,u)=>{{let d=fn(()=>`#/app/videos/${l(u).id}`);Ea(c,{get name(){return l(u).name},get artist(){return l(u).artist},get cover(){return l(u).cover},get level(){return l(u).level},get rating(){return l(u).rating},get link(){return l(d)},type:"video"})}}),D(r,s),$e()}const uh=r=>r;function dh(r,{delay:e=0,duration:t=400,easing:s=uh}={}){const n=+getComputedStyle(r).opacity;return{delay:e,duration:t,easing:s,css:a=>`opacity: ${a*n}`}}var hh=N('<section role="status"><span> </span> <p> </p></section>');function Ke(r,e){Le(e,!0);let t=Se(e,"type",3,"info"),s=Se(e,"message",3,"Information"),n=Se(e,"width",3,"100%"),a={info:"info",error:"error",success:"check_circle",warn:"warning"},i,o=S(!0);Te(()=>(v(o,!1),s()&&(v(o,!0),clearTimeout(i),i=setTimeout(()=>{v(o,!1)},5e3)),()=>{v(o,!1),clearTimeout(i)}));var c=Zt(),u=Ie(c);{var d=h=>{var f=hh(),_=b(f),p=b(_),k=g(_,2),y=b(k);ce(()=>{Ic(f,`width:${n()??""};`),ut(f,1,sn(t()),"svelte-1o9ullj"),ut(_,1,`${t()} material-symbols-rounded`,"svelte-1o9ullj"),te(p,a[t()]),ut(k,1,sn(t()),"svelte-1o9ullj"),te(y,s())}),Fc(3,f,()=>dh,()=>({duration:400})),D(h,f)};se(u,h=>{l(o)&&h(d)})}D(r,c),$e()}var Ds={};(function r(e,t,s,n){var a=!!(e.Worker&&e.Blob&&e.Promise&&e.OffscreenCanvas&&e.OffscreenCanvasRenderingContext2D&&e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype.transferControlToOffscreen&&e.URL&&e.URL.createObjectURL),i=typeof Path2D=="function"&&typeof DOMMatrix=="function",o=function(){if(!e.OffscreenCanvas)return!1;var w=new OffscreenCanvas(1,1),m=w.getContext("2d");m.fillRect(0,0,1,1);var $=w.transferToImageBitmap();try{m.createPattern($,"no-repeat")}catch{return!1}return!0}();function c(){}function u(w){var m=t.exports.Promise,$=m!==void 0?m:e.Promise;return typeof $=="function"?new $(w):(w(c,c),null)}var d=function(w,m){return{transform:function($){if(w)return $;if(m.has($))return m.get($);var B=new OffscreenCanvas($.width,$.height),G=B.getContext("2d");return G.drawImage($,0,0),m.set($,B),B},clear:function(){m.clear()}}}(o,new Map),h=function(){var w=Math.floor(16.666666666666668),m,$,B={},G=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(m=function(Z){var K=Math.random();return B[K]=requestAnimationFrame(function H(ae){G===ae||G+w-1<ae?(G=ae,delete B[K],Z()):B[K]=requestAnimationFrame(H)}),K},$=function(Z){B[Z]&&cancelAnimationFrame(B[Z])}):(m=function(Z){return setTimeout(Z,w)},$=function(Z){return clearTimeout(Z)}),{frame:m,cancel:$}}(),f=function(){var w,m,$={};function B(G){function Z(K,H){G.postMessage({options:K||{},callback:H})}G.init=function(H){var ae=H.transferControlToOffscreen();G.postMessage({canvas:ae},[ae])},G.fire=function(H,ae,fe){if(m)return Z(H,null),m;var pe=Math.random().toString(36).slice(2);return m=u(function(ge){function Y(ne){ne.data.callback===pe&&(delete $[pe],G.removeEventListener("message",Y),m=null,d.clear(),fe(),ge())}G.addEventListener("message",Y),Z(H,pe),$[pe]=Y.bind(null,{data:{callback:pe}})}),m},G.reset=function(){G.postMessage({reset:!0});for(var H in $)$[H](),delete $[H]}}return function(){if(w)return w;if(!s&&a){var G=["var CONFETTI, SIZE = {}, module = {};","("+r.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{w=new Worker(URL.createObjectURL(new Blob([G])))}catch(Z){return typeof console!==void 0&&typeof console.warn=="function"&&console.warn("ð Could not load worker",Z),null}B(w)}return w}}(),_={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function p(w,m){return m?m(w):w}function k(w){return w!=null}function y(w,m,$){return p(w&&k(w[m])?w[m]:_[m],$)}function j(w){return w<0?0:Math.floor(w)}function P(w,m){return Math.floor(Math.random()*(m-w))+w}function O(w){return parseInt(w,16)}function x(w){return w.map(T)}function T(w){var m=String(w).replace(/[^0-9a-f]/gi,"");return m.length<6&&(m=m[0]+m[0]+m[1]+m[1]+m[2]+m[2]),{r:O(m.substring(0,2)),g:O(m.substring(2,4)),b:O(m.substring(4,6))}}function E(w){var m=y(w,"origin",Object);return m.x=y(m,"x",Number),m.y=y(m,"y",Number),m}function C(w){w.width=document.documentElement.clientWidth,w.height=document.documentElement.clientHeight}function A(w){var m=w.getBoundingClientRect();w.width=m.width,w.height=m.height}function M(w){var m=document.createElement("canvas");return m.style.position="fixed",m.style.top="0px",m.style.left="0px",m.style.pointerEvents="none",m.style.zIndex=w,m}function W(w,m,$,B,G,Z,K,H,ae){w.save(),w.translate(m,$),w.rotate(Z),w.scale(B,G),w.arc(0,0,1,K,H,ae),w.restore()}function le(w){var m=w.angle*(Math.PI/180),$=w.spread*(Math.PI/180);return{x:w.x,y:w.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:w.startVelocity*.5+Math.random()*w.startVelocity,angle2D:-m+(.5*$-Math.random()*$),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:w.color,shape:w.shape,tick:0,totalTicks:w.ticks,decay:w.decay,drift:w.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:w.gravity*3,ovalScalar:.6,scalar:w.scalar,flat:w.flat}}function J(w,m){m.x+=Math.cos(m.angle2D)*m.velocity+m.drift,m.y+=Math.sin(m.angle2D)*m.velocity+m.gravity,m.velocity*=m.decay,m.flat?(m.wobble=0,m.wobbleX=m.x+10*m.scalar,m.wobbleY=m.y+10*m.scalar,m.tiltSin=0,m.tiltCos=0,m.random=1):(m.wobble+=m.wobbleSpeed,m.wobbleX=m.x+10*m.scalar*Math.cos(m.wobble),m.wobbleY=m.y+10*m.scalar*Math.sin(m.wobble),m.tiltAngle+=.1,m.tiltSin=Math.sin(m.tiltAngle),m.tiltCos=Math.cos(m.tiltAngle),m.random=Math.random()+2);var $=m.tick++/m.totalTicks,B=m.x+m.random*m.tiltCos,G=m.y+m.random*m.tiltSin,Z=m.wobbleX+m.random*m.tiltCos,K=m.wobbleY+m.random*m.tiltSin;if(w.fillStyle="rgba("+m.color.r+", "+m.color.g+", "+m.color.b+", "+(1-$)+")",w.beginPath(),i&&m.shape.type==="path"&&typeof m.shape.path=="string"&&Array.isArray(m.shape.matrix))w.fill(V(m.shape.path,m.shape.matrix,m.x,m.y,Math.abs(Z-B)*.1,Math.abs(K-G)*.1,Math.PI/10*m.wobble));else if(m.shape.type==="bitmap"){var H=Math.PI/10*m.wobble,ae=Math.abs(Z-B)*.1,fe=Math.abs(K-G)*.1,pe=m.shape.bitmap.width*m.scalar,ge=m.shape.bitmap.height*m.scalar,Y=new DOMMatrix([Math.cos(H)*ae,Math.sin(H)*ae,-Math.sin(H)*fe,Math.cos(H)*fe,m.x,m.y]);Y.multiplySelf(new DOMMatrix(m.shape.matrix));var ne=w.createPattern(d.transform(m.shape.bitmap),"no-repeat");ne.setTransform(Y),w.globalAlpha=1-$,w.fillStyle=ne,w.fillRect(m.x-pe/2,m.y-ge/2,pe,ge),w.globalAlpha=1}else if(m.shape==="circle")w.ellipse?w.ellipse(m.x,m.y,Math.abs(Z-B)*m.ovalScalar,Math.abs(K-G)*m.ovalScalar,Math.PI/10*m.wobble,0,2*Math.PI):W(w,m.x,m.y,Math.abs(Z-B)*m.ovalScalar,Math.abs(K-G)*m.ovalScalar,Math.PI/10*m.wobble,0,2*Math.PI);else if(m.shape==="star")for(var Q=Math.PI/2*3,de=4*m.scalar,we=8*m.scalar,xe=m.x,Ue=m.y,Ne=5,ze=Math.PI/Ne;Ne--;)xe=m.x+Math.cos(Q)*we,Ue=m.y+Math.sin(Q)*we,w.lineTo(xe,Ue),Q+=ze,xe=m.x+Math.cos(Q)*de,Ue=m.y+Math.sin(Q)*de,w.lineTo(xe,Ue),Q+=ze;else w.moveTo(Math.floor(m.x),Math.floor(m.y)),w.lineTo(Math.floor(m.wobbleX),Math.floor(G)),w.lineTo(Math.floor(Z),Math.floor(K)),w.lineTo(Math.floor(B),Math.floor(m.wobbleY));return w.closePath(),w.fill(),m.tick<m.totalTicks}function z(w,m,$,B,G){var Z=m.slice(),K=w.getContext("2d"),H,ae,fe=u(function(pe){function ge(){H=ae=null,K.clearRect(0,0,B.width,B.height),d.clear(),G(),pe()}function Y(){s&&!(B.width===n.width&&B.height===n.height)&&(B.width=w.width=n.width,B.height=w.height=n.height),!B.width&&!B.height&&($(w),B.width=w.width,B.height=w.height),K.clearRect(0,0,B.width,B.height),Z=Z.filter(function(ne){return J(K,ne)}),Z.length?H=h.frame(Y):ge()}H=h.frame(Y),ae=ge});return{addFettis:function(pe){return Z=Z.concat(pe),fe},canvas:w,promise:fe,reset:function(){H&&h.cancel(H),ae&&ae()}}}function I(w,m){var $=!w,B=!!y(m||{},"resize"),G=!1,Z=y(m,"disableForReducedMotion",Boolean),K=a&&!!y(m||{},"useWorker"),H=K?f():null,ae=$?C:A,fe=w&&H?!!w.__confetti_initialized:!1,pe=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,ge;function Y(Q,de,we){for(var xe=y(Q,"particleCount",j),Ue=y(Q,"angle",Number),Ne=y(Q,"spread",Number),ze=y(Q,"startVelocity",Number),re=y(Q,"decay",Number),ue=y(Q,"gravity",Number),me=y(Q,"drift",Number),q=y(Q,"colors",x),ee=y(Q,"ticks",Number),ve=y(Q,"shapes"),Oe=y(Q,"scalar"),ke=!!y(Q,"flat"),Me=E(Q),qe=xe,je=[],ft=w.width*Me.x,Qe=w.height*Me.y;qe--;)je.push(le({x:ft,y:Qe,angle:Ue,spread:Ne,startVelocity:ze,color:q[qe%q.length],shape:ve[P(0,ve.length)],ticks:ee,decay:re,gravity:ue,drift:me,scalar:Oe,flat:ke}));return ge?ge.addFettis(je):(ge=z(w,je,ae,de,we),ge.promise)}function ne(Q){var de=Z||y(Q,"disableForReducedMotion",Boolean),we=y(Q,"zIndex",Number);if(de&&pe)return u(function(ze){ze()});$&&ge?w=ge.canvas:$&&!w&&(w=M(we),document.body.appendChild(w)),B&&!fe&&ae(w);var xe={width:w.width,height:w.height};H&&!fe&&H.init(w),fe=!0,H&&(w.__confetti_initialized=!0);function Ue(){if(H){var ze={getBoundingClientRect:function(){if(!$)return w.getBoundingClientRect()}};ae(ze),H.postMessage({resize:{width:ze.width,height:ze.height}});return}xe.width=xe.height=null}function Ne(){ge=null,B&&(G=!1,e.removeEventListener("resize",Ue)),$&&w&&(document.body.contains(w)&&document.body.removeChild(w),w=null,fe=!1)}return B&&!G&&(G=!0,e.addEventListener("resize",Ue,!1)),H?H.fire(Q,xe,Ne):Y(Q,xe,Ne)}return ne.reset=function(){H&&H.reset(),ge&&ge.reset()},ne}var R;function L(){return R||(R=I(null,{useWorker:!0,resize:!0})),R}function V(w,m,$,B,G,Z,K){var H=new Path2D(w),ae=new Path2D;ae.addPath(H,new DOMMatrix(m));var fe=new Path2D;return fe.addPath(ae,new DOMMatrix([Math.cos(K)*G,Math.sin(K)*G,-Math.sin(K)*Z,Math.cos(K)*Z,$,B])),fe}function X(w){if(!i)throw new Error("path confetti are not supported in this browser");var m,$;typeof w=="string"?m=w:(m=w.path,$=w.matrix);var B=new Path2D(m),G=document.createElement("canvas"),Z=G.getContext("2d");if(!$){for(var K=1e3,H=K,ae=K,fe=0,pe=0,ge,Y,ne=0;ne<K;ne+=2)for(var Q=0;Q<K;Q+=2)Z.isPointInPath(B,ne,Q,"nonzero")&&(H=Math.min(H,ne),ae=Math.min(ae,Q),fe=Math.max(fe,ne),pe=Math.max(pe,Q));ge=fe-H,Y=pe-ae;var de=10,we=Math.min(de/ge,de/Y);$=[we,0,0,we,-Math.round(ge/2+H)*we,-Math.round(Y/2+ae)*we]}return{type:"path",path:m,matrix:$}}function oe(w){var m,$=1,B="#000000",G='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof w=="string"?m=w:(m=w.text,$="scalar"in w?w.scalar:$,G="fontFamily"in w?w.fontFamily:G,B="color"in w?w.color:B);var Z=10*$,K=""+Z+"px "+G,H=new OffscreenCanvas(Z,Z),ae=H.getContext("2d");ae.font=K;var fe=ae.measureText(m),pe=Math.ceil(fe.actualBoundingBoxRight+fe.actualBoundingBoxLeft),ge=Math.ceil(fe.actualBoundingBoxAscent+fe.actualBoundingBoxDescent),Y=2,ne=fe.actualBoundingBoxLeft+Y,Q=fe.actualBoundingBoxAscent+Y;pe+=Y+Y,ge+=Y+Y,H=new OffscreenCanvas(pe,ge),ae=H.getContext("2d"),ae.font=K,ae.fillStyle=B,ae.fillText(m,ne,Q);var de=1/$;return{type:"bitmap",bitmap:H.transferToImageBitmap(),matrix:[de,0,0,de,-pe*de/2,-ge*de/2]}}t.exports=function(){return L().apply(this,arguments)},t.exports.reset=function(){L().reset()},t.exports.create=I,t.exports.shapeFromPath=X,t.exports.shapeFromText=oe})(function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}}(),Ds,!1);const Xr=Ds.exports;Ds.exports.create;var fh=N('<main class="svelte-1lzp8li"><h1>Signup</h1> <form class="svelte-1lzp8li"><label for="email" class="svelte-1lzp8li">Email:</label> <input class="email svelte-1lzp8li" type="email"/> <label for="password" class="svelte-1lzp8li">Password:</label> <input class="password svelte-1lzp8li" type="password"/> <button class="sign-up svelte-1lzp8li" type="submit">Sign up</button> <!></form></main>');function vh(r,e){Le(e,!0);let t="",s="",n="",a=S(F(n.statusError)),i=S(F(n.statusType));async function o(){await c()}async function c(){console.log("Signing up...");let{data:y,error:j}=await ie.auth.signUp({email:t,password:s,options:{emailRedirectTo:"https://ewan.is-a.dev/#/app/login/"}});j&&j.message.includes("Password should contain at least one character of each")?(v(a,""),v(i,""),v(a,"Password must contain capital letters, lowercase letters, numbers and special characters."),v(i,"warn")):j&&j.message?(v(i,""),v(i,"error"),v(a,""),v(a,j.message,!0)):y&&!j&&(v(a,"Signup successful! Try logging in with your details!."),v(i,"success"),console.log("User signed up successfully",y),u())}function u(){Xr({particleCount:200,spread:70,origin:{y:.6}})}var d=fh(),h=g(b(d),2),f=g(b(h),2),_=g(f,4),p=g(_,4);{var k=y=>{Ke(y,{get type(){return l(i)},get message(){return l(a)}})};se(p,y=>{l(a)&&l(i)&&y(k)})}tt("submit",h,y=>{y.preventDefault(),o()}),Fe(f,()=>t,y=>t=y),Fe(_,()=>s,y=>s=y),D(r,d),$e()}var ph=N('<!> <a class="continue svelte-1x05zx6" href="./#/app/home">Continue here</a>',1),gh=N('<main class="route svelte-1x05zx6"><section class="main-page"><h1 class="page-header">Login</h1> <section class="main-content"><form class="svelte-1x05zx6"><label for="email" class="svelte-1x05zx6">Email:</label> <input class="email svelte-1x05zx6" type="email"/> <label for="password" class="svelte-1x05zx6">Password:</label> <input class="password svelte-1x05zx6" type="password"/> <button class="log-in svelte-1x05zx6" type="submit">Sign in</button> <!> <!></form></section></section></main>');function _h(r,e){Le(e,!0);let t=S(""),s=S(""),n="",a=S(""),i=S("");async function o(){let{data:x,error:T}=await ie.auth.signInWithPassword({email:l(t),password:l(s)});T?(T&&T.message.includes("profiles_email_key")&&v(a,""),v(a,T.message,!0)):(v(i,x,!0),console.log("Login successful",n),v(a,""),u(),c(x.user.email))}async function c(x){const{error:T}=await ie.from("profiles").insert({email:x});T&&T.message?console.error(T.message):T||(v(a,""),console.log("User added to profiles table"))}function u(){Xr({particleCount:200,spread:70,origin:{y:.6}})}var d=gh(),h=b(d),f=g(b(h),2),_=b(f),p=g(b(_),2),k=g(p,4),y=g(k,4);{var j=x=>{Ke(x,{type:"error",get message(){return l(a)},width:"100%"})};se(y,x=>{l(a)&&x(j)})}var P=g(y,2);{var O=x=>{var T=ph(),E=Ie(T);Ke(E,{type:"success",message:"Login successful!",width:"100%"}),D(x,T)};se(P,x=>{!l(a)&&l(i)&&x(O)})}tt("submit",_,x=>{x.preventDefault(),o()}),Fe(p,()=>l(t),x=>v(t,x)),Fe(k,()=>l(s),x=>v(s,x)),D(r,d),$e()}var mh=N('<!> <a class="continue svelte-6jdv1j" href="./#/app/home">Continue here</a>',1),yh=N('<main class="route svelte-6jdv1j"><section class="main-page"><h1 class="page-header">Login</h1> <section class="main-content"><form class="svelte-6jdv1j"><label for="email" class="svelte-6jdv1j">Email:</label> <input class="email svelte-6jdv1j" type="email"/> <label for="password" class="svelte-6jdv1j">Password:</label> <input class="password svelte-6jdv1j" type="password"/> <button class="log-in svelte-6jdv1j" type="submit">Sign in</button> <!> <!></form></section></section></main>');function bh(r,e){Le(e,!0);let t=S(""),s=S(""),n="",a=S(""),i=S("");async function o(){let{data:x,error:T}=await ie.auth.signInWithPassword({email:l(t),password:l(s)});T?(T&&T.message.includes("profiles_email_key")&&v(a,""),v(a,T.message,!0)):(v(i,x,!0),console.log("Login successful",n),v(a,""),u(),c(x.user.email))}async function c(x){const{error:T}=await ie.from("profiles").insert({email:x});T&&T.message?console.error(T.message):T||(v(a,""),console.log("User added to profiles table"))}function u(){Xr({particleCount:200,spread:70,origin:{y:.6}})}var d=yh(),h=b(d),f=g(b(h),2),_=b(f),p=g(b(_),2),k=g(p,4),y=g(k,4);{var j=x=>{Ke(x,{type:"error",get message(){return l(a)},width:"100%"})};se(y,x=>{l(a)&&x(j)})}var P=g(y,2);{var O=x=>{var T=mh(),E=Ie(T);Ke(E,{type:"success",message:"Login successful!",width:"100%"}),D(x,T)};se(P,x=>{!l(a)&&l(i)&&x(O)})}tt("submit",_,x=>{x.preventDefault(),o()}),Fe(p,()=>l(t),x=>v(t,x)),Fe(k,()=>l(s),x=>v(s,x)),D(r,d),$e()}var wh=N("<option> </option>"),kh=N("<option> </option>"),Sh=N('<span><label for="language">Select further detail:</label> <select class="language svelte-1d376ng" required><option>--Select--</option><!></select></span>'),Eh=N('<p class="not-found svelte-1d376ng">:/ Oops! No songs found; try uploading your own or try again later.</p>'),xh=N("<p>Try selecting a language to show media. If no languages show up, come back later as the servers may be down.</p>"),Th=N('<main class="route svelte-1d376ng"><!> <section class="main-page svelte-1d376ng"><h1 class="page-header svelte-1d376ng">Songs</h1> <section class="main-content svelte-1d376ng"><select class="svelte-1d376ng"></select> <!> <section class="media-container svelte-1d376ng"><!> <!> <!></section></section></section></main>');function Oh(r,e){Le(e,!0);let t=S(F([])),s=S(F([])),n=S(""),a=S(""),i=S("");async function o(A){const{data:M,error:W}=await ie.from("media").select("*").eq("language",A).eq("media_type","music");W?console.error("Error fetching songs:",W):(console.log(l(t)),console.log(M),M.forEach(le=>{l(t).push(le||[])}),console.log(l(t)))}Te(()=>{console.log(l(t))});async function c(){const{data:A,error:M}=await ie.from("languages").select("*");if(A)return v(s,A,!0),console.log(l(s)),A;if(M)throw M}lt(()=>{c()}),Te(()=>{v(t,[],!0),Array.isArray(l(n))&&l(n).forEach(A=>{console.log(A),o(A)})});let u=S(void 0),d=S(void 0);Te(()=>{var A;v(u,l(s).find(M=>M.short===l(a)),!0),v(d,(A=l(u))==null?void 0:A.sub_options,!0),console.log(l(d))}),Te(()=>{l(a).length===1?v(n,l(a),!0):v(n,l(i),!0)}),Te(()=>{console.log(l(n))});var h=Th(),f=b(h);Mt(f,{currentPage:"/music"});var _=g(f,2),p=g(b(_),2),k=b(p);De(k,21,()=>l(s),Re,(A,M,W,le)=>{var J=wh(),z=b(J),I={};ce(()=>{te(z,`${l(M).emoji??""} ${l(M).name??""}`),I!==(I=l(M).short)&&(J.value=(J.__value=l(M).short)??"")}),D(A,J)});var y=g(k,2);{var j=A=>{var M=Sh(),W=g(b(M),2),le=b(W);le.value=le.__value="";var J=g(le);De(J,17,()=>l(d),Re,(z,I)=>{var R=kh(),L=b(R),V={};ce(()=>{te(L,l(I).name),V!==(V=l(I).codes)&&(R.value=(R.__value=l(I).codes)??"")}),D(z,R)}),Ye(W,()=>l(i),z=>v(i,z)),D(A,M)};se(y,A=>{l(a).length>1&&A(j)})}var P=g(y,2),O=b(P);{var x=A=>{var M=Eh();D(A,M)};se(O,A=>{!l(t)[0]&&l(n)&&A(x)})}var T=g(O,2);{var E=A=>{var M=xh();D(A,M)};se(T,A=>{l(a)||A(E)})}var C=g(T,2);De(C,17,()=>l(t),Re,(A,M)=>{{let W=fr(()=>`#/app/songs/${l(M).id}`);Ea(A,{get name(){return l(M).name},get artist(){return l(M).artist},get cover(){return l(M).cover},get level(){return l(M).level},get rating(){return l(M).rating},get link(){return l(W)},type:"song"})}}),Ye(k,()=>l(a),A=>v(a,A)),D(r,h),$e()}var jh=N('<span class="svelte-1wzg23z"><h1 class="song svelte-1wzg23z"> </h1><h1 class="artist svelte-1wzg23z"> </h1></span>');function Go(r,e){let t=Se(e,"song",8,"Loading..."),s=Se(e,"artist",8,"Loading...");var n=jh(),a=b(n),i=b(a),o=g(a),c=b(o);ce(()=>{te(i,t()),te(c,s())}),D(r,n)}var Ah=N('<i><p class="phoneticAnnotation svelte-1m7wp3l"> </p></i>'),Ph=N("<option> </option>"),Ch=N(`<span class="flashcard-functions svelte-1m7wp3l"><span class="flashcard-upload svelte-1m7wp3l"><button class="add-to-deck flashcard-btn svelte-1m7wp3l"><span class="material-symbols-rounded svelte-1m7wp3l">library_add</span></button> <select class="svelte-1m7wp3l"></select></span> <button class="info-flashcards-btn flashcard-btn svelte-1m7wp3l"><span class="material-symbols-rounded svelte-1m7wp3l">info</span></button></span> <dialog class="info-flashcards-container svelte-1m7wp3l"><strong class="definition-info-header">Where's my deck?</strong> <p class="definition-info-body svelte-1m7wp3l">This is as you may not yet have a deck for the language you are curretly studying; You can only add words to decks of the same language</p> <button class="close-dialog svelte-1m7wp3l">OK</button></dialog>`,1),Mh=N('<section class="definition svelte-1m7wp3l"><div class="header svelte-1m7wp3l"><h1 class="svelte-1m7wp3l"> </h1> <button class="close-btn svelte-1m7wp3l">â</button></div> <!> <p class="part-of-speech svelte-1m7wp3l"> </p> <p class="svelte-1m7wp3l"> </p> <!> <!></section>'),Ih=N('<section class="definition-container svelte-1m7wp3l"><!></section>');function Yo(r,e){Le(e,!0);let t=Se(e,"word",7),s=Se(e,"language",7),n=S(F({message:"",type:""})),a=S(void 0),i=S(F([])),o=S(F(HTMLObjectElement));F(HTMLObjectElement);let c=S("");lt(async()=>{f()}),Te(async()=>{l(c)?(v(i,await h(l(c)),!0),console.log(l(i))):v(i,[],!0)});async function u(y){const{data:j,error:P}=await ie.from("flashcard_decks").select("content").eq("id",y);return P?(v(n,{type:"error",message:P.message},!0),[]):j[0].content}async function d(y){const j=await u(y);j.push({word:t(),definition:e.definition,partOfSpeech:e.partOfSpeech,phoneticAnnotation:e.phoneticAnnotation});const{error:P}=await ie.from("flashcard_decks").update({content:j}).eq("id",y);if(P&&P.message==='invalid input syntax for type bigint: "undefined"')return v(n,{type:"error",message:"You haven't selected a deck. Try making one on 'Flashcards' page"},!0),P;if(P)return v(n,{type:"error",message:gerror.message},!0),P;v(n,{type:"success",message:"Added!"},!0)}async function h(y){s("language");const{data:j,error:P}=await ie.from("flashcard_decks").select("*").eq("author",y);return P?(console.error(P),v(n,{type:"error",message:P.message},!0),P):(console.log(j),j)}async function f(){const{data:y,error:j}=await ie.auth.getSession(),P=y;j?console.error("Error fetching session:",j):P&&v(c,P.session.user.id,!0)}var _=Ih(),p=b(_);{var k=y=>{var j=Mh(),P=b(j),O=b(P),x=b(O),T=g(O,2),E=g(P,2);{var C=R=>{var L=Ah(),V=b(L),X=b(V);ce(()=>te(X,e.phoneticAnnotation)),D(R,L)};se(E,R=>{e.phoneticAnnotation&&R(C)})}var A=g(E,2),M=b(A),W=g(A,2),le=b(W),J=g(W,2);{var z=R=>{var L=Ch(),V=Ie(L),X=b(V),oe=b(X),w=g(oe,2);De(w,21,()=>l(i),Re,(K,H)=>{var ae=Ph(),fe=b(ae),pe={};ce(()=>{te(fe,l(H).name),pe!==(pe=l(H).id)&&(ae.value=(ae.__value=l(H).id)??"")}),D(K,ae)});var m=g(X,2),$=fr(()=>l(o).showModal()),B=g(V,2),G=g(b(B),4),Z=fr(()=>l(o).close());rt(B,K=>v(o,K),()=>l(o)),tt("click",oe,()=>d(l(a))),Ye(w,()=>l(a),K=>v(a,K)),tt("click",m,function(...K){var H;(H=l($))==null||H.apply(this,K)}),tt("click",G,function(...K){var H;(H=l(Z))==null||H.apply(this,K)}),D(R,L)};se(J,R=>{l(i)&&R(z)})}var I=g(J,2);Ke(I,{get type(){return l(n).type},get message(){return l(n).message}}),ce(()=>{te(x,t()),te(M,e.partOfSpeech),te(le,e.definition)}),tt("click",T,function(...R){var L;(L=t(""))==null||L.apply(this,R)}),D(y,j)};se(p,y=>{t()&&y(k)})}D(r,_),$e()}var $n={},Un={},ji;function Rh(){return ji||(ji=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.TARGET_URL_HEADER=void 0,r.withMiddleware=e,r.withProxy=t;function e(...s){return n=>s.reduce((a,i)=>a.then(o=>i(o)),Promise.resolve(n))}r.TARGET_URL_HEADER="x-fal-target-url";function t(s){return typeof window>"u"?n=>Promise.resolve(n):n=>Promise.resolve(Object.assign(Object.assign({},n),{url:s.targetUrl,headers:Object.assign(Object.assign({},n.headers||{}),{[r.TARGET_URL_HEADER]:n.url})}))}}(Un)),Un}var Tt={},Ai;function Dh(){if(Ai)return Tt;Ai=1;var r=Tt&&Tt.__awaiter||function(n,a,i,o){function c(u){return u instanceof i?u:new i(function(d){d(u)})}return new(i||(i=Promise))(function(u,d){function h(p){try{_(o.next(p))}catch(k){d(k)}}function f(p){try{_(o.throw(p))}catch(k){d(k)}}function _(p){p.done?u(p.value):c(p.value).then(h,f)}_((o=o.apply(n,a||[])).next())})};Object.defineProperty(Tt,"__esModule",{value:!0}),Tt.ValidationError=Tt.ApiError=void 0,Tt.defaultResponseHandler=s;class e extends Error{constructor({message:a,status:i,body:o}){super(a),this.name="ApiError",this.status=i,this.body=o}}Tt.ApiError=e;class t extends e{constructor(a){super(a),this.name="ValidationError"}get fieldErrors(){return typeof this.body.detail=="string"?[{loc:["body"],msg:this.body.detail,type:"value_error"}]:this.body.detail||[]}getFieldErrors(a){return this.fieldErrors.filter(i=>i.loc[i.loc.length-1]===a)}}Tt.ValidationError=t;function s(n){return r(this,void 0,void 0,function*(){var a;const{status:i,statusText:o}=n,c=(a=n.headers.get("Content-Type"))!==null&&a!==void 0?a:"";if(!n.ok){if(c.includes("application/json")){const u=yield n.json(),d=i===422?t:e;throw new d({message:u.message||o,status:i,body:u})}throw new e({message:`HTTP ${i}: ${o}`,status:i})}return c.includes("application/json")?n.json():c.includes("text/html")?n.text():c.includes("application/octet-stream")?n.arrayBuffer():n.text()})}return Tt}var Pi;function Lh(){return Pi||(Pi=1,function(r){var e={};Object.defineProperty(r,"__esModule",{value:!0}),r.credentialsFromEnv=void 0,r.resolveDefaultFetch=n,r.config=u,r.getConfig=d,r.getRestApiUrl=h;const t=Rh(),s=Dh();function n(){if(typeof fetch>"u")throw new Error("Your environment does not support fetch. Please provide your own fetch implementation.");return fetch}function a(){return typeof process<"u"&&e&&(typeof e.FAL_KEY<"u"||typeof e.FAL_KEY_ID<"u"&&typeof e.FAL_KEY_SECRET<"u")}const i=()=>{if(a())return typeof e.FAL_KEY<"u"?e.FAL_KEY:`${e.FAL_KEY_ID}:${e.FAL_KEY_SECRET}`};r.credentialsFromEnv=i;const o={credentials:r.credentialsFromEnv,suppressLocalCredentialsWarning:!1,requestMiddleware:f=>Promise.resolve(f),responseHandler:s.defaultResponseHandler};let c;function u(f){var _;c=Object.assign(Object.assign(Object.assign({},o),f),{fetch:(_=f.fetch)!==null&&_!==void 0?_:n()}),f.proxyUrl&&(c=Object.assign(Object.assign({},c),{requestMiddleware:(0,t.withMiddleware)((0,t.withProxy)({targetUrl:f.proxyUrl}),c.requestMiddleware)}));const{credentials:p,suppressLocalCredentialsWarning:k}=c,y=typeof p=="function"?p():p;typeof window<"u"&&y&&!k&&console.warn("The fal credentials are exposed in the browser's environment. That's not recommended for production use cases.")}function d(){return c||(console.info("Using default configuration for the fal client"),Object.assign(Object.assign({},o),{fetch:n()}))}function h(){return"https://rest.alpha.fal.ai"}}($n)),$n}Lh();var $h=N('<img class="throbber svelte-61xipn" src="https://upload.wikimedia.org/wikipedia/commons/7/7a/Ajax_loader_metal_512.gif"/>'),Uh=N('<p class="current-line svelte-61xipn"> </p>'),zh=N('<!> <!> <span class="svelte-61xipn"><span class="main-subtitles svelte-61xipn"></span> <p class="full-translate svelte-61xipn"> </p> <button class="show-translations-btn svelte-61xipn">Show translations</button></span>',1);function xa(r,e){Le(e,!0);const t=Se(e,"currentLine",3,"Play the video to see live subtitles. Click on an individual word for a definition!"),s=Se(e,"targetLanguage",3,""),n=Se(e,"nativeLanguage",3,"en");let a="",i=S(F(a.term)),o=S(F(a.definition)),c=S(F(a.partOfSpeech)),u=S(F(a.original)),d=S(F(a.translated)),h=S(F(a.phoneticAnnotation)),f=!0,_=S(F([])),p=S(!0),k=!0;Te(()=>{const J=new Intl.Segmenter("zh",{granularity:"word"});v(_,[...J.segment(t())].map(z=>z.segment),!0),j(t())});async function y(J,z){v(p,!1),console.log("Fetching definition for ",J);try{const I=z.join(" "),L=await(await fetch("/.netlify/functions/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:"Translate this word based on context. Return raw JSON only (no tags or extra characters, markdown) with string keys: `word`(original), `partOfSpeech`, `definition`, and `phoneticAnnotation` (include only when needed, e.g., non-Latin scripts; include all possible readings in context such as furigana for Japanese).",word:J,context:I,originalWordLanguageISO6391:s(),translatedWordLanguageISO6391:n()})})).json(),V=JSON.parse(L.reply);console.log(V),v(p,!0),v(i,V.word,!0),v(o,V.definition,!0),v(c,V.partOfSpeech,!0),v(h,V.phoneticAnnotation,!0)}catch(I){console.error(I)}}async function j(J,z,I){if(k)try{const L=await(await fetch("/.netlify/functions/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:"Translate this sentence and return no tags, no markup, just raw JSON with keys `original` and `translated` }",originalSentence:I,originalSentenceLanguageISO6391:J,translatedSentenceLanguageISO6391:z})})).json(),V=JSON.parse(L.reply);console.log(V),v(u,V.original,!0),v(d,V.translated,!0)}catch(R){console.error(R)}else console.log("Subtitle translations turned off!")}async function P(){const J=document.getElementsByClassName("full-translate"),z=document.getElementsByClassName("show-translations-btn");f=!f,Array.from(J).forEach(I=>{f===!0?(k=!0,I.style.display="block"):(k=!1,I.style.display="none")}),Array.from(z).forEach(I=>{f===!0?I.style.display="none":I.style.display="block"})}var O=zh(),x=Ie(O);{var T=J=>{var z=$h();D(J,z)};se(x,J=>{l(p)||J(T)})}var E=g(x,2);Yo(E,{get word(){return l(i)},get definition(){return l(o)},get partOfSpeech(){return l(c)},get phoneticAnnotation(){return l(h)},get language(){return s()}});var C=g(E,2),A=b(C);De(A,21,()=>l(_),Re,(J,z)=>{var I=Uh(),R=b(I);ce(()=>te(R,l(z))),tt("click",I,()=>y(l(z),l(_))),D(J,I)});var M=g(A,2),W=b(M),le=g(M,2);ce(()=>te(W,l(d))),tt("click",M,()=>P()),tt("click",le,()=>P()),D(r,O),$e()}var qh=N('<span class="author-tag svelte-2mqmtf"><span class="material-symbols-rounded svelte-2mqmtf">person</span> <span class="author-text-container svelte-2mqmtf"><p class="svelte-2mqmtf">Uploaded by:</p> <p class="author svelte-2mqmtf"> </p></span></span>');function Qo(r,e){Le(e,!0);let t=Se(e,"author",7,"Loading...");t()&&t(t().slice(0,17)+"...");var s=qh(),n=g(b(s),2),a=g(b(n),2),i=b(a);ce(()=>te(i,t())),D(r,s),$e()}function Nh(r,e){if(r instanceof RegExp)return{keys:!1,pattern:r};var t,s,n,a,i=[],o="",c=r.split("/");for(c[0]||c.shift();n=c.shift();)t=n[0],t==="*"?(i.push("wild"),o+="/(.*)"):t===":"?(s=n.indexOf("?",1),a=n.indexOf(".",1),i.push(n.substring(1,~s?s:~a?a:n.length)),o+=~s&&!~a?"(?:/([^/]+?))?":"/([^/]+?)",~a&&(o+=(~s?"?":"")+"\\"+n.substring(a))):o+="/"+n;return{keys:i,pattern:new RegExp("^"+o+"/?$","i")}}function Ci(){const r=window.location.href.indexOf("#/");let e=r>-1?window.location.href.substr(r+1):"/";const t=e.indexOf("?");let s="";return t>-1&&(s=e.substr(t+1),e=e.substr(0,t)),{location:e,querystring:s}}const Ta=To(null,function(e){e(Ci());const t=()=>{e(Ci())};return window.addEventListener("hashchange",t,!1),function(){window.removeEventListener("hashchange",t,!1)}}),es=jo(Ta,r=>r.location);jo(Ta,r=>r.querystring);const Mi=Oo(void 0);function Fh(r){r?window.scrollTo(r.__svelte_spa_router_scrollX,r.__svelte_spa_router_scrollY):window.scrollTo(0,0)}function Bh(r,e){Le(e,!1);let t=Se(e,"routes",24,()=>({})),s=Se(e,"prefix",8,""),n=Se(e,"restoreScrollState",8,!1);class a{constructor(E,C){if(!C||typeof C!="function"&&(typeof C!="object"||C._sveltesparouter!==!0))throw Error("Invalid component object");if(!E||typeof E=="string"&&(E.length<1||E.charAt(0)!="/"&&E.charAt(0)!="*")||typeof E=="object"&&!(E instanceof RegExp))throw Error('Invalid value for "path" argument - strings must start with / or *');const{pattern:A,keys:M}=Nh(E);this.path=E,typeof C=="object"&&C._sveltesparouter===!0?(this.component=C.component,this.conditions=C.conditions||[],this.userData=C.userData,this.props=C.props||{}):(this.component=()=>Promise.resolve(C),this.conditions=[],this.props={}),this._pattern=A,this._keys=M}match(E){if(s()){if(typeof s()=="string")if(E.startsWith(s()))E=E.substr(s().length)||"/";else return null;else if(s()instanceof RegExp){const W=E.match(s());if(W&&W[0])E=E.substr(W[0].length)||"/";else return null}}const C=this._pattern.exec(E);if(C===null)return null;if(this._keys===!1)return C;const A={};let M=0;for(;M<this._keys.length;){try{A[this._keys[M]]=decodeURIComponent(C[M+1]||"")||null}catch{A[this._keys[M]]=null}M++}return A}async checkConditions(E){for(let C=0;C<this.conditions.length;C++)if(!await this.conditions[C](E))return!1;return!0}}const i=[];t()instanceof Map?t().forEach((T,E)=>{i.push(new a(E,T))}):Object.keys(t()).forEach(T=>{i.push(new a(T,t()[T]))});let o=ur(null),c=ur(null),u=ur({});const d=Kc();async function h(T,E){await go(),d(T,E)}let f=null,_=null;n()&&(_=T=>{T.state&&(T.state.__svelte_spa_router_scrollY||T.state.__svelte_spa_router_scrollX)?f=T.state:f=null},window.addEventListener("popstate",_),Gc(()=>{Fh(f)}));let p=null,k=null;const y=Ta.subscribe(async T=>{p=T;let E=0;for(;E<i.length;){const C=i[E].match(T.location);if(!C){E++;continue}const A={route:i[E].path,location:T.location,querystring:T.querystring,userData:i[E].userData,params:C&&typeof C=="object"&&Object.keys(C).length?C:null};if(!await i[E].checkConditions(A)){v(o,null),k=null,h("conditionsFailed",A);return}h("routeLoading",Object.assign({},A));const M=i[E].component;if(k!=M){M.loading?(v(o,M.loading),k=M,v(c,M.loadingParams),v(u,{}),h("routeLoaded",Object.assign({},A,{component:l(o),name:l(o).name,params:l(c)}))):(v(o,null),k=null);const W=await M();if(T!=p)return;v(o,W&&W.default||W),k=M}C&&typeof C=="object"&&Object.keys(C).length?v(c,C):v(c,null),v(u,i[E].props),h("routeLoaded",Object.assign({},A,{component:l(o),name:l(o).name,params:l(c)})).then(()=>{Mi.set(l(c))});return}v(o,null),k=null,Mi.set(void 0)});Hc(()=>{y(),_&&window.removeEventListener("popstate",_)}),hc(()=>mo(n()),()=>{history.scrollRestoration=n()?"manual":"auto"}),fc(),_a();var j=Zt(),P=Ie(j);{var O=T=>{var E=Zt(),C=Ie(E);Ka(C,()=>l(o),(A,M)=>{M(A,ti({get params(){return l(c)}},()=>l(u),{$$events:{routeEvent(W){ei.call(this,e,W)}}}))}),D(T,E)},x=T=>{var E=Zt(),C=Ie(E);Ka(C,()=>l(o),(A,M)=>{M(A,ti(()=>l(u),{$$events:{routeEvent(W){ei.call(this,e,W)}}}))}),D(T,E)};se(P,T=>{l(c)?T(O):T(x,!1)})}D(r,j),$e()}var Wh=ga(N('<script src="https://www.youtube.com/iframe_api"><\/script><!>',1)),Vh=N('<main class="route svelte-bcry69"><!> <section class="main-page svelte-bcry69"><h1 class="page-header svelte-bcry69">Music</h1> <section class="main-content svelte-bcry69"><span class="heading svelte-bcry69"><!> <!></span> <iframe id="player" frameborder="0" allowfullscreen="" class="svelte-bcry69"></iframe> <!></section></section></main>');function Hh(r,e){Le(e,!0);const t=()=>Yr(es,"$location",s),[s,n]=Qr();let a=S(F(t().split("/").pop())),i,o=S("Loading..."),c=S("Loading..."),u=S("Loading..."),d=S("https://img.youtube.com/vi/loquela/maxresdefault.jpg"),h=S("Unknown Level"),f=S("No Rating"),_=S(""),p=S(F([])),k=S(void 0),y=S("https://youtu.be/zabswqP6xEM");Te(()=>{const I=t().split("/").pop();I!=l(a)&&v(a,I,!0),j().then(()=>{window.YT?O():window.onYouTubeIframeAPIReady=O})}),lt(()=>{fetchLanguages()});async function j(){const{data:I,error:R}=await ie.from("media").select("*").eq("id",l(a)).single();if(I){const L=I;v(o,L.name,!0),v(c,L.artist,!0),v(u,L.author_username,!0),v(d,L.cover,!0),v(h,L.level,!0),v(f,L.rating,!0),v(_,L.language,!0),v(y,L.embed_link,!0),v(p,L.content.events,!0),console.log(l(p)),console.log(`${l(y)}?enablejsapi=1`);const V={name:l(o),artist:l(c),cover:l(d),level:l(h),rating:l(f),id:l(a)};x(V)}else v(o,"Unknown Song"),v(c,"Unknown Artist"),v(d,"https://img.youtube.com/vi/loquela/maxresdefault.jpg"),v(h,"Unknown Level"),v(f,"No Rating"),v(y,"https://youtu.be/zabswqP6xEM")}function P(I){let R=0;l(p).forEach(L=>{I>L.tStartMs&&I<l(p)[R+1].tStartMs&&L.segs.forEach(V=>{l(k)!==V.utf8&&v(k,V.utf8,!0)}),R++})}function O(){i=new YT.Player("player",{events:{onReady:()=>{setInterval(()=>{const I=i.getCurrentTime(),R=Math.round(I*1e3);P(R)},1)}}})}async function x(I){const{data:R,readError:L}=await ie.from("profiles").select("recent_music").eq("user_id",uid).single();console.log(R.recent_music);const V=R.recent_music;V.includes(I)&&V.pop(I),V.length===10&&V.splice(0,1),V.push(I),console.log(V);const{updateData:X,updateError:oe}=await ie.from("profiles").update({recent_music:V}).eq("user_id",uid);oe&&console.error(oe),X&&console.log(X)}var T=Vh();pa(I=>{var R=Wh();g(Ie(R)),D(I,R)});var E=b(T);Mt(E,{currentPage:"/music"});var C=g(E,2),A=g(b(C),2),M=b(A),W=b(M);Go(W,{get song(){return l(o)},get artist(){return l(c)}});var le=g(W,2);Qo(le,{get author(){return l(u)}});var J=g(M,2),z=g(J,2);xa(z,{get currentLine(){return l(k)},get targetLanguage(){return l(_)}}),ce(()=>{Be(J,"src",`${l(y)}?enablejsapi=1`),Be(J,"title",l(o))}),D(r,T),$e(),n()}var Jh=N('<option class="svelte-1xupfpx"> </option>'),Kh=N('<option class="svelte-1xupfpx"> </option>'),Gh=N('<span class="svelte-1xupfpx"><label for="language">* Select further detail:</label> <select class="language svelte-1xupfpx" required><option class="svelte-1xupfpx">--Select--</option><!></select></span>'),Yh=N('<option class="svelte-1xupfpx"> </option>'),Qh=N('<main class="route  svelte-1xupfpx"><!> <section class="main-page svelte-1xupfpx"><h1 class="page-header svelte-1xupfpx">Upload</h1> <section class="notice svelte-1xupfpx"><h3 class="notice-text svelte-1xupfpx">Notice</h3> <p class="notice-text svelte-1xupfpx">Please ensure video has subtitles enabled by creator!</p></section> <section class="main-content svelte-1xupfpx"><form class="svelte-1xupfpx"><div class="vertical-container svelte-1xupfpx"><span class="svelte-1xupfpx"><label for="media">* Select media type:</label> <select class="media svelte-1xupfpx" required><option class="svelte-1xupfpx">--Pick the medium category--</option><option class="svelte-1xupfpx">ðº YT Video</option><option class="svelte-1xupfpx">ð§ Music</option></select></span> <span class="svelte-1xupfpx"><label for="language">* Select language of content:</label> <select class="language svelte-1xupfpx" required><option class="svelte-1xupfpx">--Select language--</option><!></select></span> <!> <span class="svelte-1xupfpx"><label for="level">* Select level of content:</label> <select class="level svelte-1xupfpx" required><option class="svelte-1xupfpx">--Select a level--</option><option class="svelte-1xupfpx">ð£ A1</option><option class="svelte-1xupfpx">ð¥ A2</option><option class="svelte-1xupfpx">ð¦ B1</option><option class="svelte-1xupfpx">ð¦ B2</option><option class="svelte-1xupfpx">ð¦ C1</option><option class="svelte-1xupfpx">ð¦ C2</option></select></span> <span class="svelte-1xupfpx"><label for="category">* Select category of content:</label> <select class="category svelte-1xupfpx" required><option class="svelte-1xupfpx">--Select category--</option><!></select></span></div> <span class="svelte-1xupfpx"><label for="url">Link to medium:</label> <input class="url svelte-1xupfpx" type="url" placeholder="Enter media URL"/></span> <button type="submit" class="push-btn svelte-1xupfpx"><span class="front-push-btn svelte-1xupfpx">Upload</span></button> <!></form></section></section></main>');function Zh(r,e){Le(e,!0);let t=S(F({name:"",type:""})),s="",n="",a=S(""),i=S(""),o="",c="",u=S(F([])),d=S(F([])),h=S(""),f=S(""),_=S(void 0),p=S(void 0);Te(()=>{var re;v(_,l(u).find(ue=>ue.short===l(a)),!0),v(p,(re=l(_))==null?void 0:re.sub_options,!0),console.log(l(p))});async function k(){const{data:re,error:ue}=await ie.from("categories").select("*");v(d,re,!0)}k();function y(){Xr({particleCount:600,spread:100,origin:{y:0}})}lt(async()=>{E(),j()});async function j(){const{data:re,error:ue}=await ie.from("languages").select("*");if(re)return v(u,re,!0),console.log(l(u)),re;if(ue)throw ue}async function P(re,ue,me,q,ee){try{if(await x(ue)){v(t,{type:"warn",name:"This has already been uploaded"},!0);return}re==="video"||re==="music"?(await O(ue,me,re,q,ee),v(t,{type:"success",name:"Beginning upload..."},!0),y()):v(t,{type:"error",name:"Error in link validation"},!0)}catch(ve){console.error("Upload error:",ve),v(t,{type:"error",name:"Error in upload process"},!0)}}async function O(re,ue,me,q,ee){const ve=ie.channel("subtitles");await ve.subscribe();const Oe=await ve.send({type:"broadcast",event:"subtitle-update",payload:{id:1,url:re,lang:ue,type:me,level:q,author:l(h),author_username:l(f),category:ee}});console.log("Broadcast result:",Oe)}async function x(re){const{data:ue,error:me}=await ie.from("media").select("*").eq("video_link",re).single();if(me){if(me.details&&me.details.includes("0 rows"))return!1;console.error("Database error:",me)}return!!ue}async function T(re,ue,me,q,ee){try{const ve=await fetch(`https://www.youtube.com/oembed?url=${encodeURIComponent(re)}&format=json`);return console.log(ve),console.log(re),!ve.ok||!re.startsWith("https://www.youtube.com/watch?v=")?(v(t,{type:"error",name:"Invalid URL. Must be in format 'https://www.youtube.com/watch?v='"},!0),!1):(await P(ue,re,me,q,ee),!0)}catch(ve){return console.error("Validation error:",ve),v(t,{type:"error",name:"Error validating URL"},!0),!1}}async function E(){const{data:re,error:ue}=await ie.auth.getSession(),me=re;if(ue)console.error("Error fetching session:",ue);else if(me){v(h,me.session.user.id,!0);const{data:q,error:ee}=await ie.from("profiles").select("username").eq("user_id",l(h)).single();q&&v(f,q.username,!0),ee&&console.log(ee)}ue&&console.error("Error fetching userID:",ue)}Te(()=>{l(i)?v(i,l(i),!0):v(i,l(a),!0)});var C=Qh(),A=b(C);Mt(A,{currentPage:"/upload"});var M=g(A,2),W=g(b(M),4),le=b(W),J=b(le),z=b(J),I=g(b(z),2),R=b(I);R.value=R.__value="";var L=g(R);L.value=L.__value="video";var V=g(L);V.value=V.__value="music";var X=g(z,2),oe=g(b(X),2),w=b(oe);w.value=w.__value="";var m=g(w);De(m,17,()=>l(u),Re,(re,ue)=>{var me=Jh(),q=b(me),ee={};ce(()=>{te(q,`${l(ue).emoji??""} ${l(ue).name??""}`),ee!==(ee=l(ue).short)&&(me.value=(me.__value=l(ue).short)??"")}),D(re,me)});var $=g(X,2);{var B=re=>{var ue=Gh(),me=g(b(ue),2),q=b(me);q.value=q.__value="";var ee=g(q);De(ee,17,()=>l(p),Re,(ve,Oe)=>{var ke=Kh(),Me=b(ke),qe={};ce(()=>{te(Me,l(Oe).name),qe!==(qe=l(Oe).codes)&&(ke.value=(ke.__value=l(Oe).codes)??"")}),D(ve,ke)}),Ye(me,()=>l(i),ve=>v(i,ve)),D(re,ue)};se($,re=>{l(a).length>1&&re(B)})}var G=g($,2),Z=g(b(G),2),K=b(Z);K.value=K.__value="";var H=g(K);H.value=H.__value="A1";var ae=g(H);ae.value=ae.__value="A2";var fe=g(ae);fe.value=fe.__value="B1";var pe=g(fe);pe.value=pe.__value="B2";var ge=g(pe);ge.value=ge.__value="C1";var Y=g(ge);Y.value=Y.__value="C2";var ne=g(G,2),Q=g(b(ne),2),de=b(Q);de.value=de.__value="";var we=g(de);De(we,17,()=>l(d),Re,(re,ue)=>{var me=Yh(),q=b(me),ee={};ce(()=>{te(q,`${l(ue).emoji??""} ${l(ue).name??""}`),ee!==(ee=l(ue).name)&&(me.value=(me.__value=l(ue).name)??"")}),D(re,me)});var xe=g(J,2),Ue=g(b(xe),2),Ne=g(xe,4);{var ze=re=>{Ke(re,{get type(){return l(t).type},get message(){return l(t).name},width:"17em"})};se(Ne,re=>{l(t).name&&re(ze)})}tt("submit",le,re=>{re.preventDefault(),T(n,s,l(i),o,c)}),Ye(I,()=>s,re=>s=re),Ye(oe,()=>l(a),re=>v(a,re)),Ye(Z,()=>o,re=>o=re),Ye(Q,()=>c,re=>c=re),Fe(Ue,()=>n,re=>n=re),D(r,C),$e()}var Xh=N('<section class="svelte-i5t88f"><span class="text-container svelte-i5t88f"><a class="svelte-i5t88f"><h1 class="name svelte-i5t88f"> </h1></a> <p class="terms svelte-i5t88f"> </p> <p class="author svelte-i5t88f"> </p></span> <span class="language-image-container svelte-i5t88f"><img class="svelte-i5t88f"/></span></section>');function ef(r,e){var t=Xh(),s=b(t),n=b(s),a=b(n),i=b(a),o=g(n,2),c=b(o),u=g(o,2),d=b(u),h=g(s,2),f=b(h);ce(()=>{Be(n,"href",`#/app/flashcards/${e.id}`),te(i,e.name),te(c,`Terms: ${e.terms??""}`),te(d,`@${e.author??""}`),Be(f,"src",`https://hatscripts.github.io/circle-flags/flags/${e.country??""}.svg`)}),D(r,t)}var tf=N('<p class="not-found svelte-3pf8ly">:/ Oops! No flashcards found; try uploading your own or try again later.</p>'),rf=N("<option> </option>"),sf=N('<main class="route svelte-3pf8ly"><!> <section class="main-page svelte-3pf8ly"><h1 class="page-header svelte-3pf8ly">Flashcards</h1> <section class="main-content svelte-3pf8ly"><button class="create-flashcard-deck svelte-3pf8ly">+ Create Flashcard Deck</button> <section class="flashcard-decks svelte-3pf8ly"><!> <!></section></section></section></main> <dialog class="svelte-3pf8ly"><div class="dialog-container svelte-3pf8ly"><div><h2 class="svelte-3pf8ly">Create Flashcard Deck</h2> <h1 class="svelte-3pf8ly"> </h1> <form class="svelte-3pf8ly"><span class="svelte-3pf8ly"><label>Deck name:</label> <input class="name svelte-3pf8ly"/></span> <span class="svelte-3pf8ly"><label>Language:</label> <select class="language svelte-3pf8ly"><option>--Select language--</option><!></select></span> <input class="submit-btn svelte-3pf8ly" type="Submit"/></form></div> <button class="close-dialog-button svelte-3pf8ly">Close</button></div></dialog>',1);function nf(r,e){Le(e,!0);let t,s,n,a=S(F([])),i=S(void 0),o=S(""),c=S(F([]));lt(async()=>{h(),u(),t.close()}),Te(async()=>{if(l(i)){const{data:w,error:m}=await ie.from("flashcard_decks").select("*");m&&console.error("Error fetching flashcard decks:",m),v(c,w||[],!0),console.log(l(c))}});async function u(){const{data:w,error:m}=await ie.from("languages").select("*");if(w)return v(a,w,!0),console.log(l(a)),w;if(m)throw m}async function d(w,m,$,B,G){const{error:Z}=await ie.from("flashcard_decks").insert({name:w,author:m,author_username:G,language:$,country_code:B,content:[]});console.log(Z),location.reload()}async function h(){const{data:w,error:m}=await ie.auth.getSession(),$=w;if(m)console.error("Error fetching session:",m);else if($){v(i,$.session.user.id,!0);const{data:B,error:G}=await ie.from("profiles").select("username").eq("user_id",l(i)).single();B&&v(o,B.username,!0),G&&console.log(G)}}var f=sf(),_=Ie(f),p=b(_);Mt(p,{currentPage:"/flashcards"});var k=g(p,2),y=g(b(k),2),j=b(y);j.__click=()=>t.showModal();var P=g(j,2),O=b(P);{var x=w=>{var m=tf();D(w,m)};se(O,w=>{l(c)[0]||w(x)})}var T=g(O,2);De(T,17,()=>l(c),Re,(w,m)=>{ef(w,{get name(){return l(m).name},get author(){return l(m).author_username},get terms(){return l(m).content.length},get country(){return l(m).country_code},get id(){return l(m).id}})});var E=g(_,2),C=b(E),A=b(C),M=g(b(A),2),W=b(M),le=g(M,2),J=b(le),z=g(b(J),2),I=g(J,2),R=g(b(I),2),L=b(R);L.value=L.__value="";var V=g(L);{var X=w=>{var m=Zt(),$=Ie(m);De($,17,()=>l(a),Re,(B,G,Z)=>{var K=rf(),H=b(K);K.value=K.__value=Z,ce(()=>te(H,`${l(G).emoji??""} ${l(G).name??""}`)),D(B,K)}),D(w,m)};se(V,w=>{l(a)&&w(X)})}var oe=g(A,2);oe.__click=()=>t.close(),rt(E,w=>t=w,()=>t),ce(()=>te(W,l(a)[n])),tt("submit",le,w=>{d(s,l(i),l(a)[n].short,l(a)[n].country_code,l(o))}),Fe(z,()=>s,w=>s=w),Ye(R,()=>n,w=>n=w),D(r,f),$e()}br(["click"]);function af(r,e){e().forEach(t=>{const s=document.getElementsByClassName(t);s&&Array.from(s).forEach(n=>{n.classList.remove("hidden")})})}function of(r,e,t,s){e.content[l(t)]&&(l(s).push(e.content[l(t)]),Qi(t))}function lf(r,e,t,s,n,a){e.content[l(t)]&&(l(s).push(e.content[l(t)]),Qi(t)),l(n)===100&&a()}function cf(r,e,t,s,n){v(e,0),v(t,[],!0),l(s).forEach(a=>{n.content.splice(n.content.indexOf(a),1)}),v(s,[],!0)}async function uf(r,e,t,s,n,a,i,o,c,u){v(e,""),v(t,"update"),console.log(s.content);const d=s.content[l(n)],h=s.originalDeck.indexOf(d),f=JSON.stringify({word:l(a),definition:l(i),partOfSpeech:l(o),phoneticAnnotation:l(c)});v(u,[...s.originalDeck.slice(0,h),f,...s.originalDeck.slice(h+1)],!0),console.log(d),console.log(f),console.log(l(u));try{const{data:_,error:p}=await ie.from("flashcard_decks").update({content:l(u)}).eq("id",s.id).select();_&&v(e,"success")}catch(_){console.error(_),v(e,"error")}}async function df(r,e,t){v(e,"");try{const{data:s,error:n}=await ie.from("flashcard_decks").delete().eq("id",t.id);s||v(e,"success")}catch(s){console.error(s),v(e,"error")}}async function hf(r,e,t,s,n,a,i,o,c){v(e,""),v(t,"add"),console.log("cards",s.originalDeck);const u=JSON.stringify({word:l(n),definition:l(a),partOfSpeech:l(i),phoneticAnnotation:l(o)});v(c,[u,...s.originalDeck],!0),console.log(l(c));try{const{data:d,error:h}=await ie.from("flashcard_decks").update({content:l(c)}).eq("id",s.id).select();d&&v(e,"success")}catch(d){console.error(d),v(e,"error")}}async function ff(r,e,t,s,n,a,i,o,c){v(e,""),v(t,!0),v(s,"delete");const u=n.content[l(a)],d=n.originalDeck.indexOf(u);v(i,n.originalDeck,!0),v(o,l(c),!0),console.log(l(o)),console.log(u),console.log(n.originalDeck),l(i).splice(d,1);try{const{data:h,error:f}=await ie.from("flashcard_decks").update({content:l(i)}).eq("id",n.id).select();h&&(v(e,"success"),v(t,!1))}catch(h){console.error(h),v(e,"error"),v(t,!1)}v(t,!1)}var vf=(r,e)=>{l(e).show()},pf=(r,e)=>{l(e).show()},gf=(r,e,t,s)=>{l(e).show(),v(t,l(s),!0)},_f=(r,e)=>{l(e).show()},mf=N('<span class="deck-edit-buttons svelte-baker"><button class="edit-btn svelte-baker"><span class="material-symbols-rounded edit svelte-baker">edit</span></button> <button class="edit-btn svelte-baker"><span class="material-symbols-rounded edit svelte-baker">add_circle</span></button> <button class="edit-btn delete svelte-baker"><span class="material-symbols-rounded edit svelte-baker">tab_close</span></button> <button class="edit-btn delete svelte-baker"><span class="material-symbols-rounded edit svelte-baker">delete</span></button></span>'),yf=N('<div class="title-author-container svelte-baker"><h1 class="deck-name-heading svelte-baker"> </h1> <p class="deck-name-author svelte-baker">Uploaded by: <b> </b></p> <!></div>'),bf=N('<i><p class="phonetic-annotation svelte-baker"> </p></i>'),wf=N('<div class="flashcard svelte-baker"><h1 class="word svelte-baker"> </h1> <span class="word-details svelte-baker"><!> <p class="part-of-speech svelte-baker"> </p></span> <p class="definition svelte-baker"> </p></div>'),kf=N('<span class="card-count-container svelte-baker"><span class="unsure-count card-count svelte-baker"> </span> <span class="known-count card-count svelte-baker"> </span></span> <!> <span class="buttons svelte-baker"><button class="dont-know flashcard-button svelte-baker"><span class="material-symbols-rounded svelte-baker">do_not_disturb</span>Unsure</button> <button class="flip flashcard-button svelte-baker"><span class="material-symbols-rounded svelte-baker">autorenew</span>Flip</button> <button class="know flashcard-button svelte-baker"><span class="material-symbols-rounded svelte-baker">check_circle</span>Know</button></span>',1),Sf=N('<div class="flashcard svelte-baker"><p class="svelte-baker">Deck is empty!</p></div>'),Ef=N('<button class="flashcard-continue svelte-baker"><span class="material-symbols-rounded svelte-baker">expand_circle_right</span> Continue with unknown terms</button>'),xf=N('<p class="svelte-baker">Congratulations! You know all the terms in this deck!</p>'),Tf=N('<div class="flashcard svelte-baker"><p class="known-percentage svelte-baker"> </p> <!> <!></div>'),Of=(r,e)=>{l(e).close()},jf=(r,e)=>{l(e).close()},Af=N('<img class="throbber svelte-baker" src="https://upload.wikimedia.org/wikipedia/commons/7/7a/Ajax_loader_metal_512.gif"/>'),Pf=(r,e)=>{l(e).close()},Cf=N('<img class="throbber svelte-baker" src="https://upload.wikimedia.org/wikipedia/commons/7/7a/Ajax_loader_metal_512.gif"/>'),Mf=(r,e)=>{l(e).close()},If=N('<main class="svelte-baker"><!> <!> <!> <!></main> <dialog class="svelte-baker"><h2 class="svelte-baker">Editing card: <i> </i></h2> <div class="dialog-inputs svelte-baker"><label class="svelte-baker">Term:</label> <textarea class="small-t-area svelte-baker"></textarea> <label class="svelte-baker">Phonetic Annotation (optional):</label> <textarea class="small-t-area svelte-baker"></textarea> <label class="svelte-baker">Part of speech:</label> <textarea class="small-t-area svelte-baker"></textarea> <label class="svelte-baker">Definition:</label> <textarea c="" class="svelte-baker"></textarea></div> <button class="update-btn dialog-btn svelte-baker">Update</button> <button class="cancel-btn dialog-btn svelte-baker">Cancel</button> <!> <!></dialog> <dialog class="svelte-baker"><h2 class="svelte-baker">Creating card: <i> </i></h2> <div class="dialog-inputs svelte-baker"><label class="svelte-baker">Term:</label> <textarea class="small-t-area svelte-baker"></textarea> <label class="svelte-baker">Phonetic Annotation (optional):</label> <textarea class="small-t-area svelte-baker"></textarea> <label class="svelte-baker">Part of speech:</label> <textarea class="small-t-area svelte-baker"></textarea> <label class="svelte-baker">Definition:</label> <textarea class="svelte-baker"></textarea></div> <button class="update-btn dialog-btn svelte-baker">Add</button> <button class="cancel-btn dialog-btn svelte-baker">Cancel</button> <!> <!></dialog> <dialog class="svelte-baker"><h2 class="svelte-baker">Delete</h2> <p class="svelte-baker">Are you sure you want to delete the card <i> </i>?</p> <!> <button class="update-btn dialog-btn svelte-baker">Delete</button> <button class="cancel-btn dialog-btn svelte-baker">Cancel</button> <!> <!></dialog> <dialog class="svelte-baker"><h2 class="svelte-baker">Delete</h2> <p class="svelte-baker">Are you sure you want to delete this deck?</p> <!> <button class="update-btn dialog-btn svelte-baker">Delete</button> <button class="cancel-btn dialog-btn svelte-baker">Cancel</button> <!> <!></dialog>',1);function Rf(r,e){Le(e,!0);const t=Se(e,"backContent",19,()=>[]),s=Se(e,"author",3,"");let n=S(0),a=S(F([])),i=S(F([])),o="",c=S(F(o.word)),u=S(F(o.definition)),d=S(F(o.partOfSpeech)),h=S(F(o.phoneticAnnotation));F({});let f=S(0),_=S(F(e.originalDeck)),p=S(F(l(c))),k=S(F(l(u))),y=S(F(l(d))),j=S(F(l(h))),P=S(""),O=S(""),x=S(""),T=S(""),E=S(F(HTMLDialogElement)),C=S(F(HTMLDialogElement)),A=S(F(HTMLDialogElement)),M=S(F(HTMLDialogElement)),W=S(""),le=S(""),J=S(!1),z=S(F(l(c)));Te(()=>{v(f,Math.round(l(i).length/(l(a).length+l(i).length)*100),!0)}),lt(()=>{console.log("DECK"),console.log(e.content),Te(()=>{if(e.content&&Array.isArray(e.content)&&e.content[l(n)]){const U=JSON.parse(e.content[l(n)]);console.log(U),v(c,U.word,!0),v(u,U.definition,!0),v(d,U.partOfSpeech,!0),v(h,U.phoneticAnnotation,!0),v(p,l(c),!0),v(k,l(u),!0),v(y,l(d),!0),v(j,l(h),!0),I()}})});function I(){t().forEach(U=>{const He=document.getElementsByClassName(U);He&&Array.from(He).forEach(Et=>{Et.classList.add("hidden")})})}function R(){Xr({particleCount:200,spread:70,origin:{y:0}})}var L=If(),V=Ie(L),X=b(V);{var oe=U=>{var He=yf(),Et=b(He),Sr=b(Et),rr=g(Et,2),rs=g(b(rr)),ss=b(rs),Er=g(rr,2);{var mt=xt=>{var ns=mf(),as=b(ns);as.__click=[vf,E];var Us=g(as,2);Us.__click=[pf,C];var xr=g(Us,2);xr.__click=[gf,A,z,c];var zs=g(xr,2);zs.__click=[_f,M],D(xt,ns)};se(Er,xt=>{e.isUsers&&xt(mt)})}ce(()=>{te(Sr,e.deckName),te(ss,`@${s()??""}`)}),D(U,He)};se(X,U=>{s()&&e.deckName&&U(oe)})}var w=g(X,2);{var m=U=>{var He=kf(),Et=Ie(He),Sr=b(Et),rr=b(Sr),rs=g(Sr,2),ss=b(rs),Er=g(Et,2);{var mt=xr=>{var zs=wf(),Ma=b(zs),rl=b(Ma),Ia=g(Ma,2),Ra=b(Ia);{var sl=En=>{var Da=bf(),ll=b(Da),cl=b(ll);ce(()=>te(cl,l(h))),D(En,Da)};se(Ra,En=>{l(h)&&En(sl)})}var nl=g(Ra,2),al=b(nl),il=g(Ia,2),ol=b(il);ce(()=>{te(rl,l(c)),te(al,l(d)),te(ol,l(u))}),D(xr,zs)};se(Er,xr=>{e.content&&xr(mt)})}var xt=g(Er,2),ns=b(xt);ns.__click=[of,e,n,a];var as=g(ns,2);as.__click=[af,t];var Us=g(as,2);Us.__click=[lf,e,n,i,f,R],ce(()=>{te(rr,l(a).length),te(ss,l(i).length)}),D(U,He)};se(w,U=>{l(n)!==e.content.length&&U(m)})}var $=g(w,2);{var B=U=>{var He=Sf();D(U,He)};se($,U=>{e.content.length==0&&U(B)})}var G=g($,2);{var Z=U=>{var He=Tf(),Et=b(He),Sr=b(Et),rr=g(Et,2);{var rs=mt=>{var xt=Ef();xt.__click=[cf,n,a,i,e],D(mt,xt)};se(rr,mt=>{l(f)!==100&&mt(rs)})}var ss=g(rr,2);{var Er=mt=>{var xt=xf();D(mt,xt)};se(ss,mt=>{l(f)===100&&mt(Er)})}ce(()=>te(Sr,`Known: ${l(f)??""}%`)),D(U,He)};se(G,U=>{l(n)===e.content.length&&e.content.length>0&&U(Z)})}var K=g(V,2),H=b(K),ae=g(b(H)),fe=b(ae),pe=g(H,2),ge=g(b(pe),2),Y=g(ge,4),ne=g(Y,4),Q=g(ne,4),de=g(pe,2);de.__click=[uf,W,le,e,n,p,k,y,j,_];var we=g(de,2);we.__click=[Of,E];var xe=g(we,2);{var Ue=U=>{Ke(U,{type:"success",message:"Card updated! Reload to see changes!",width:"100%"})};se(xe,U=>{l(W)=="success"&&U(Ue)})}var Ne=g(xe,2);{var ze=U=>{Ke(U,{type:"error",message:"Error changing card.",width:"100%"})};se(Ne,U=>{l(W)=="error"&&U(ze)})}rt(K,U=>v(E,U),()=>l(E));var re=g(K,2),ue=b(re),me=g(b(ue)),q=b(me),ee=g(ue,2),ve=g(b(ee),2),Oe=g(ve,4),ke=g(Oe,4),Me=g(ke,4),qe=g(ee,2);qe.__click=[hf,W,le,e,P,O,x,T,_];var je=g(qe,2);je.__click=[jf,C];var ft=g(je,2);{var Qe=U=>{Ke(U,{type:"success",message:"Card added! Reload to see changes!",width:"100%"})};se(ft,U=>{l(W)=="success"&&U(Qe)})}var bn=g(ft,2);{var Ze=U=>{Ke(U,{type:"error",message:"Error changing card.",width:"100%"})};se(bn,U=>{l(W)=="error"&&U(Ze)})}rt(re,U=>v(C,U),()=>l(C));var at=g(re,2),tr=g(b(at),2),kr=g(b(tr)),wn=b(kr),Ls=g(tr,2);{var kn=U=>{var He=Af();D(U,He)};se(Ls,U=>{l(J)&&U(kn)})}var St=g(Ls,2);St.__click=[ff,W,J,le,e,n,_,z,c];var Nt=g(St,2);Nt.__click=[Pf,A];var Ft=g(Nt,2);{var $s=U=>{Ke(U,{type:"success",get message(){return`Card ${l(z)??""} deleted! Reload to see changes!`},width:"100%"})};se(Ft,U=>{l(W)=="success"&&U($s)})}var ts=g(Ft,2);{var Sn=U=>{Ke(U,{type:"error",message:"Error changing card.",width:"100%"})};se(ts,U=>{l(W)=="error"&&U(Sn)})}rt(at,U=>v(A,U),()=>l(A));var Oa=g(at,2),ja=g(b(Oa),4);{var Zo=U=>{var He=Cf();D(U,He)};se(ja,U=>{l(J)&&U(Zo)})}var Aa=g(ja,2);Aa.__click=[df,W,e];var Pa=g(Aa,2);Pa.__click=[Mf,M];var Ca=g(Pa,2);{var Xo=U=>{Ke(U,{type:"success",message:"Deck deleted! Reload to see changes!",width:"100%"})};se(Ca,U=>{l(W)=="success"&&U(Xo)})}var el=g(Ca,2);{var tl=U=>{Ke(U,{type:"error",message:"Error changing card.",width:"100%"})};se(el,U=>{l(W)=="error"&&U(tl)})}rt(Oa,U=>v(M,U),()=>l(M)),ce(()=>{te(fe,l(p)),qs(ge,l(c)),qs(Y,l(h)),qs(ne,l(d)),qs(Q,l(u)),te(q,l(P)),te(wn,l(c))}),Fe(ge,()=>l(p),U=>v(p,U)),Fe(Y,()=>l(j),U=>v(j,U)),Fe(ne,()=>l(y),U=>v(y,U)),Fe(Q,()=>l(k),U=>v(k,U)),Fe(ve,()=>l(P),U=>v(P,U)),Fe(Oe,()=>l(T),U=>v(T,U)),Fe(ke,()=>l(x),U=>v(x,U)),Fe(Me,()=>l(O),U=>v(O,U)),D(r,L),$e()}br(["click"]);var Df=N("<h3>Oops! Looks like there are no cards in this deck. Try going to a video, song or AI Chat and add some!</h3>"),Lf=N('<main class="route svelte-967ptl"><!> <section class="main-page svelte-967ptl"><h1 class="page-header svelte-967ptl">Flashcards</h1> <section class="main-content svelte-967ptl"><p> </p> <!> <!></section></section></main>');function $f(r,e){Le(e,!0);const t=()=>Yr(es,"$location",s),[s,n]=Qr();let a=F(t().split("/").pop()),i=S(F([])),o=S(0),c="",u=S(F(c.flashcardDeckName)),d=S(F(c.flashcardDeckAuthor)),h=S(F(c.flashcardDeckAuthorUID)),f=S(void 0);lt(async()=>{_();const A=await p(a);A?(v(u,A.name,!0),v(h,A.author,!0),v(d,A.author_username,!0),v(i,A.content,!0),v(o,l(i).length,!0),console.log(l(o))):console.error("Flashcards not found")});async function _(){const{data:A,error:M}=await ie.auth.getSession(),W=A;M?console.error("Error fetching session:",M):W&&v(f,W.session.user.id,!0)}async function p(A){const{data:M,error:W}=await ie.from("flashcard_decks").select("*").eq("id",A).single();if(W){console.error(W);return}return M}var k=Lf(),y=b(k);Mt(y,{currentPage:"/flashcards"});var j=g(y,2),P=g(b(j),2),O=b(P),x=b(O),T=g(O,2);{let A=fr(()=>l(f)===l(h));Rf(T,{get content(){return l(i)},get originalDeck(){return l(i)},get id(){return a},backContent:["phonetic-annotation","part-of-speech","definition"],get deckName(){return l(u)},get author(){return l(d)},get isUsers(){return l(A)}})}var E=g(T,2);{var C=A=>{var M=Df();D(A,M)};se(E,A=>{l(i)||A(C)})}ce(A=>te(x,A),[()=>JSON.stringify(l(i))]),D(r,k),$e(),n()}var Uf=N("<option> </option>"),zf=N("<option> </option>"),qf=N('<span><label for="language">Select further detail:</label> <select class="language svelte-yxunt" required><option>--Select--</option><!></select></span>'),Nf=N("<p>Try selecting a language to show media. If no languages show up, come back later as the servers may be down.</p>"),Ff=N('<h1 class="category-title svelte-yxunt"> </h1> <section class="category-section svelte-yxunt"></section>',1),Bf=N('<main class="route svelte-yxunt"><!> <section class="main-page svelte-yxunt"><h1 class="page-header svelte-yxunt">Videos</h1> <section class="main-content svelte-yxunt"><select class="language-select svelte-yxunt"></select> <!> <section class="media-container svelte-yxunt"><!> <!> <section class="categories-section svelte-yxunt"></section></section></section></section></main>');function Wf(r,e){Le(e,!0);let t=S(F([])),s=S(F([])),n="",a=S(""),i=S(""),o=S(""),c=S(""),u=S(F({}));async function d(){const{data:z,error:I}=await ie.from("categories").select("*");v(c,z,!0)}lt(()=>{d()}),Te(()=>{console.log(l(c))});async function h(z){const{data:I,error:R}=await ie.from("media").select("*").eq("language",z).eq("media_type","video");R?console.error("Error fetching videos:",R):(console.log(l(t)),console.log(I),I.forEach(L=>{l(t).push(L||[])}),console.log(l(t)),v(u,[],!0),await _(l(t)))}function f(z){const I=l(c).find(R=>R.name===z);return I?I.emoji:"ð·ï¸"}async function _(z){z.forEach(I=>{if(I){let R=I.category;R||(R="Uncategorised"),!l(u)[R]&&R&&(l(u)[R]=[]),l(u)[R].push(I)}console.log(l(u))})}Te(()=>{console.log(l(t))});async function p(){const{data:z,error:I}=await ie.from("languages").select("*");if(z)return v(s,z,!0),console.log(l(s)),z;if(I)throw I}lt(()=>{p()}),Te(()=>{v(t,[],!0),Array.isArray(l(a))&&l(a).forEach(z=>{console.log(z),h(z)})});let k=S(void 0),y=S(void 0);Te(()=>{var z;v(k,l(s).find(I=>I.short===l(i)),!0),v(y,(z=l(k))==null?void 0:z.sub_options,!0),console.log(l(y))}),Te(()=>{l(i).length===1?v(a,l(i),!0):v(a,l(o),!0)});var j=Bf(),P=b(j);Mt(P,{currentPage:"/videos"});var O=g(P,2),x=g(b(O),2),T=b(x);De(T,21,()=>l(s),Re,(z,I,R,L)=>{var V=Uf(),X=b(V),oe={};ce(()=>{te(X,`${l(I).emoji??""} ${l(I).name??""}`),oe!==(oe=l(I).short)&&(V.value=(V.__value=l(I).short)??"")}),D(z,V)});var E=g(T,2);{var C=z=>{var I=qf(),R=g(b(I),2),L=b(R);L.value=L.__value="";var V=g(L);De(V,17,()=>l(y),Re,(X,oe)=>{var w=zf(),m=b(w),$={};ce(()=>{te(m,l(oe).name),$!==($=l(oe).codes)&&(w.value=(w.__value=l(oe).codes)??"")}),D(X,w)}),Ye(R,()=>l(o),X=>v(o,X)),D(z,I)};se(E,z=>{l(i).length>1&&z(C)})}var A=g(E,2),M=b(A);se(M,z=>{l(t)[0]});var W=g(M,2);{var le=z=>{var I=Nf();D(z,I)};se(W,z=>{l(i)||z(le)})}var J=g(W,2);De(J,21,()=>Object.entries(l(u)),Re,(z,I,R,L)=>{var V=fr(()=>ml(l(I),2));let X=()=>l(V)[0],oe=()=>l(V)[1];var w=Ff(),m=Ie(w),$=b(m),B=g(m,2);De(B,21,oe,Re,(G,Z)=>{{let K=fr(()=>`#/app/videos/${l(Z).id}`);Ea(G,{get name(){return l(Z).name},get artist(){return l(Z).artist},get cover(){return l(Z).cover},get level(){return l(Z).level},get rating(){return l(Z).rating},get link(){return l(K)},type:"video"})}}),ce(G=>te($,`${G??""} ${X()??""}`),[()=>f(X())]),D(z,w)}),Ye(T,()=>l(i),z=>v(i,z)),D(r,j),$e()}var Vf=ga(N('<script src="https://www.youtube.com/iframe_api"><\/script><!>',1)),Hf=N("<p>Oops. Loquelis is struggling to the media - it may be invalid or unavailable.</p>"),Jf=N('<main class="route svelte-1ml0pbe"><!> <section class="main-page svelte-1ml0pbe"><h1 class="page-header svelte-1ml0pbe">Videos</h1> <section class="main-content svelte-1ml0pbe"><span class="heading svelte-1ml0pbe"><!> <!></span> <iframe id="player" frameborder="0" allowfullscreen="" class="svelte-1ml0pbe"></iframe> <!> <!></section></section></main>');function Kf(r,e){Le(e,!0);const t=()=>Yr(es,"$location",s),[s,n]=Qr();let a=S(F(t().split("/").pop())),i,o=S("Loading..."),c=S("Loading..."),u=S("Loading..."),d=S("Loading..."),h=S("https://img.youtube.com/vi/loquela/maxresdefault.jpg"),f=S("Unknown Level"),_=S("No Rating"),p=S(""),k=S(F([])),y=S(void 0),j=S("https://youtu.be/zabswqP6xEM"),P;Te(async()=>{var $,B;const X=t().split("/").pop();X!=l(a)&&v(a,X,!0),O().then(()=>{window.YT?T():window.onYouTubeIframeAPIReady=T});const{data:oe,error:w}=await ie.auth.getSession(),m=oe;w?console.error("Error fetching session:",w):m&&(P=(B=($=m==null?void 0:m.session)==null?void 0:$.user)==null?void 0:B.id)});async function O(){const{data:X,error:oe}=await ie.from("media").select("*").eq("id",l(a)).single();if(X){const w=X;v(o,w.name,!0),v(d,w.artist,!0),v(c,w.author_username,!0),v(u,w.author_username,!0),v(h,w.cover,!0),v(f,w.level,!0),v(_,w.rating,!0),v(p,w.language,!0),v(j,w.embed_link,!0),v(k,w.content.events,!0),console.log(l(k)),console.log(`${l(j)}?enablejsapi=1`);const m={name:l(o),artist:l(d),cover:l(h),level:l(f),rating:l(_),id:l(a)};E(m)}else v(o,"Unknown Video"),v(d,"Unknown Artist"),v(h,"https://img.youtube.com/vi/loquela/maxresdefault.jpg"),v(f,"Unknown Level"),v(_,"No Rating"),v(j,"https://youtu.be/zabswqP6xEM")}function x(X){let oe=0;l(k).forEach(w=>{X>w.tStartMs&&X<l(k)[oe+1].tStartMs&&w.segs.forEach(m=>{l(y)!==m.utf8&&v(y,m.utf8,!0)}),oe++})}function T(){i=new YT.Player("player",{events:{onReady:()=>{setInterval(()=>{const X=i.getCurrentTime(),oe=Math.round(X*1e3);x(oe)},1)}}})}async function E(X){const{data:oe,readError:w}=await ie.from("profiles").select("recent_videos").eq("user_id",P).single();console.log(oe.recent_videos);let $=oe.recent_videos.filter(Z=>Z.id!==X.id);$.length===10&&$.splice(0,1),$.push(X),console.log($);const{updateData:B,updateError:G}=await ie.from("profiles").update({recent_videos:$}).eq("user_id",P);G&&console.error(G),B&&console.log(B)}var C=Jf();pa(X=>{var oe=Vf();g(Ie(oe)),D(X,oe)});var A=b(C);Mt(A,{currentPage:"/videos"});var M=g(A,2),W=g(b(M),2),le=b(W),J=b(le);Go(J,{get song(){return l(o)},get artist(){return l(d)}});var z=g(J,2);Qo(z,{get author(){return l(c)}});var I=g(le,2),R=g(I,2);{var L=X=>{var oe=Hf();D(X,oe)};se(R,X=>{l(j)==="https://youtu.be/zabswqP6xEM"&&X(L)})}var V=g(R,2);xa(V,{get currentLine(){return l(y)},get targetLanguage(){return l(p)}}),ce(()=>{Be(I,"src",`${l(j)}?enablejsapi=1`),Be(I,"title",l(o))}),D(r,C),$e(),n()}var Gf=N('<img class="svelte-1afzn3p"/>'),Yf=N('<section class="ai-chat-box svelte-1afzn3p"><div class="pfp-name-occupation-container svelte-1afzn3p"><!> <div class="text svelte-1afzn3p"><a class="svelte-1afzn3p"><h2 class="svelte-1afzn3p"> </h2></a> <p class="occupation svelte-1afzn3p"> </p></div></div> <div class="flag-tags-container svelte-1afzn3p"><img class="lang-flag svelte-1afzn3p"/> <span class="traits svelte-1afzn3p"><p class="trait-tag svelte-1afzn3p"> </p></span></div></section>');function Qf(r,e){var t=Yf(),s=b(t),n=b(s);{var a=j=>{var P=Gf();ce(()=>{Be(P,"src",e.image),Be(P,"alt",e.firstName)}),D(j,P)};se(n,j=>{e.image&&j(a)})}var i=g(n,2),o=b(i),c=b(o),u=b(c),d=g(o,2),h=b(d),f=g(s,2),_=b(f),p=g(_,2),k=b(p),y=b(k);ce(()=>{Be(o,"href",`/#/app/ai-chat/${e.id}`),te(u,e.firstName),te(h,e.occupation),Be(_,"src",`https://hatscripts.github.io/circle-flags/flags/${e.lang}.svg`),Be(_,"alt",e.lang),te(y,e.trait)}),D(r,t)}var Zf=(r,e)=>l(e).showModal(),Xf=N('<p class="not-found svelte-javkzk">:/ Oops! No flashcards found; try uploading your own or try again later.</p>'),ev=N("<option> </option>"),tv=N("<option> </option>"),rv=N('<span><label for="language" class="svelte-javkzk">* Select further detail:</label> <select class="language svelte-javkzk" required><option>--Select--</option><!></select></span>'),sv=N("<option> </option>"),nv=N("<option> </option>"),av=(r,e)=>l(e).close(),iv=N('<main class="route svelte-javkzk"><!> <section class="main-page svelte-javkzk"><h1 class="page-header svelte-javkzk">AI Chat</h1> <section class="main-content svelte-javkzk"><button class="create-ai-character svelte-javkzk"><span class="material-symbols-rounded svelte-javkzk">person_add</span>Create AI Character</button> <div class="chats svelte-javkzk"><!> <!></div></section></section></main> <dialog class="svelte-javkzk"><div class="dialog-container svelte-javkzk"><h2 class="dialog-header svelte-javkzk">Create AI Character</h2> <form class="svelte-javkzk"><label class="svelte-javkzk">ðªª Character name:</label> <input class="name svelte-javkzk" required/> <span class="label-input-container svelte-javkzk"><label class="svelte-javkzk">ð¬ Language:</label> <select class="language svelte-javkzk" required><option>--Select language--</option><!></select></span> <!> <span class="label-input-container svelte-javkzk"><label class="svelte-javkzk">ð Occupation:</label> <select class="occupation svelte-javkzk" required><option>--Select occupation--</option><!></select></span> <span class="label-input-container svelte-javkzk"><label class="svelte-javkzk">ð§  Trait:</label> <select class="traits svelte-javkzk" required><option>--Select trait--</option><!></select></span> <!> <input class="submit-btn svelte-javkzk" type="Submit"/></form> <button class="close-dialog-btn svelte-javkzk">Close</button></div></dialog>',1);function ov(r,e){Le(e,!0),Se(e,"occupation",3,"Knight"),Se(e,"image",3,"https://image.pollinations.ai/prompt/Generate%20a%20pixar-style%20image%20of%20a%20knight%20called%20Hansel%20with%20traits%20of%20brave,%20adventurous%20who%20is%20dressed%20in%20traditional%20attire%20of%20German"),Se(e,"firstName",3,"Hansel"),Se(e,"trait",3,"Friendly"),Se(e,"lang",3,"de");let t="",s=S(F(t.characterName)),n=S(F(t.characterTrait)),a=S(F(t.characterOccupation)),i=S(F([])),o=S(F([])),c=S(null),u=S(F([])),d=F([]),h=F([]),f=S(F([])),_=S(F([])),p=S(F([])),k="",y=S(F(k.characterCreateStatus)),j=S(F(k.characterCreateMessage));lt(async()=>{await E(),await C(),O(),x(),P()});async function P(){const{data:q,error:ee}=await ie.from("ai_characters").select("*");q&&v(f,q,!0),ee&&console.error(ee)}function O(){Array.from(l(u)).forEach(q=>{console.log("gabo"),q.type==="occupation"?d.push(q.name):console.error("Error finding occupations")})}function x(){Array.from(l(u)).forEach(q=>{console.log("gabo"),q.type==="trait"?h.push(q.name):console.error("Error finding traits")})}async function T(q,ee,ve,Oe,ke){v(y,""),v(j,""),console.log(ke);const{error:Me}=await ie.from("ai_characters").insert([{name:q,trait:ee,occupation:ve,language:Oe,country:ke,image:`https://image.pollinations.ai/prompt/Generate a pixar-style image of a ${ve} called ${q} with trait of ${ee} who is dressed in traditional attire of ${Oe}.`}]);Me||(v(y,"success"),v(j,"Created! Reload the page to see your character!")),Me&&(v(y,"error"),v(j,"Error adding character"),console.error(Me))}async function E(){const{data:q,error:ee}=await ie.from("languages").select("*");if(q)return v(o,q,!0),console.log(l(o)),q;if(ee)throw ee}async function C(){const{data:q,error:ee}=await ie.from("character_fields").select("*");if(q)return v(u,q,!0),console.log(l(u)),q;if(ee)throw ee}let A=S(void 0),M=S(void 0),W=S("");Te(()=>{var q,ee;v(A,l(o).find(ve=>ve.short===l(i)),!0),v(M,(q=l(A))==null?void 0:q.sub_options,!0),v(W,(ee=l(A))==null?void 0:ee.country_code,!0),console.log(l(W))}),Te(()=>{l(i).length===1?v(_,l(i),!0):v(_,l(p),!0),console.log(l(_))});var le=iv(),J=Ie(le),z=b(J);Mt(z,{currentPage:"/ai-chat"});var I=g(z,2),R=g(b(I),2),L=b(R);L.__click=[Zf,c];var V=g(L,2),X=b(V);{var oe=q=>{var ee=Xf();D(q,ee)};se(X,q=>{l(f)[0]||q(oe)})}var w=g(X,2);De(w,17,()=>l(f),Re,(q,ee)=>{Qf(q,{get id(){return l(ee).id},get image(){return l(ee).image},get firstName(){return l(ee).name},get trait(){return l(ee).trait},get lang(){return l(ee).country},get occupation(){return l(ee).occupation}})});var m=g(J,2),$=b(m),B=g(b($),2),G=g(b(B),2),Z=g(G,2),K=g(b(Z),2),H=b(K);H.value=H.__value="";var ae=g(H);{var fe=q=>{var ee=Zt(),ve=Ie(ee);De(ve,17,()=>l(o),Re,(Oe,ke)=>{var Me=ev(),qe=b(Me),je={};ce(()=>{te(qe,`${l(ke).emoji??""} ${l(ke).name??""}`),je!==(je=l(ke).short)&&(Me.value=(Me.__value=l(ke).short)??"")}),D(Oe,Me)}),D(q,ee)};se(ae,q=>{l(o)&&q(fe)})}var pe=g(Z,2);{var ge=q=>{var ee=rv(),ve=g(b(ee),2),Oe=b(ve);Oe.value=Oe.__value="";var ke=g(Oe);De(ke,17,()=>l(M),Re,(Me,qe)=>{var je=tv(),ft=b(je),Qe={};ce(()=>{te(ft,l(qe).name),Qe!==(Qe=l(qe).codes)&&(je.value=(je.__value=l(qe).codes)??"")}),D(Me,je)}),Ye(ve,()=>l(p),Me=>v(p,Me)),D(q,ee)};se(pe,q=>{l(i).length>1&&q(ge)})}var Y=g(pe,2),ne=g(b(Y),2),Q=b(ne);Q.value=Q.__value="";var de=g(Q);{var we=q=>{var ee=Zt(),ve=Ie(ee);De(ve,17,()=>d,Re,(Oe,ke,Me,qe)=>{var je=sv(),ft=b(je),Qe={};ce(()=>{te(ft,l(ke)),Qe!==(Qe=l(ke))&&(je.value=(je.__value=l(ke))??"")}),D(Oe,je)}),D(q,ee)};se(de,q=>{d&&q(we)})}var xe=g(Y,2),Ue=g(b(xe),2),Ne=b(Ue);Ne.value=Ne.__value="";var ze=g(Ne);{var re=q=>{var ee=Zt(),ve=Ie(ee);De(ve,17,()=>h,Re,(Oe,ke,Me,qe)=>{var je=nv(),ft=b(je),Qe={};ce(()=>{te(ft,l(ke)),Qe!==(Qe=l(ke))&&(je.value=(je.__value=l(ke))??"")}),D(Oe,je)}),D(q,ee)};se(ze,q=>{h&&q(re)})}var ue=g(xe,2);Ke(ue,{get type(){return l(y)},get message(){return l(j)}});var me=g(B,2);me.__click=[av,c],rt(m,q=>v(c,q),()=>l(c)),tt("submit",B,q=>{q.preventDefault(),T(l(s),l(n),l(a),l(_),l(W))}),Fe(G,()=>l(s),q=>v(s,q)),Ye(K,()=>l(i),q=>v(i,q)),Ye(ne,()=>l(a),q=>v(a,q)),Ye(Ue,()=>l(n),q=>v(n,q)),D(r,le),$e()}br(["click"]);var lv=async(r,e)=>await e(),cv=N('<p class="svelte-1g4eeoh">Loading...</p>'),uv=(r,e)=>{e()},dv=(r,e,t,s)=>e(l(t),l(s).content),hv=N('<p class="ai-word svelte-1g4eeoh"> </p>'),fv=N('<div class="message ai-sent svelte-1g4eeoh"></div>'),vv=N('<div class="message user-sent svelte-1g4eeoh"> </div>'),pv=N("<!> <!>",1),gv=N('<span class="deck-label svelte-1g4eeoh">Deck: <b> </b></span>'),_v=(r,e,t,s)=>e(l(t),s),mv=N('<div class="chat-container svelte-1g4eeoh"><section class="header-messages-container svelte-1g4eeoh"><span class="chat-header svelte-1g4eeoh"><span class="pfp-name-container svelte-1g4eeoh"><img class="character-header-image svelte-1g4eeoh"/> <h3 class="svelte-1g4eeoh"> </h3> <p class="svelte-1g4eeoh"> </p> <p class="trait-tag svelte-1g4eeoh"> </p></span> <button class="ai-analysis-btn svelte-1g4eeoh">Get AI analysis of chat</button> <!></span> <button class="test-deck-btn svelte-1g4eeoh"><span class="material-symbols-rounded get-tested-on-deck svelte-1g4eeoh">cards_star</span></button> <div class="messages-container svelte-1g4eeoh"></div></section> <div class="input-deck-label-container svelte-1g4eeoh"><!> <span class="send-container svelte-1g4eeoh"><input class="send-message-input svelte-1g4eeoh"/> <button class="send-message-btn svelte-1g4eeoh"><span class="material-symbols-rounded">send</span></button></span></div></div>'),yv=N('<span class="sentence-container svelte-1g4eeoh"><span class="corrected_sentence_label_container svelte-1g4eeoh">ð <p class="original_sentence_label svelte-1g4eeoh">Original sentence:</p></span> <p class="original_sentence svelte-1g4eeoh"> </p></span> <span class="sentence-container svelte-1g4eeoh"><span class="corrected_sentence_label_container svelte-1g4eeoh">â <p class="corrected_sentence_label svelte-1g4eeoh">Corrected sentence:</p></span> <p class="corrected_sentence svelte-1g4eeoh"> </p></span>',1),bv=N('<section class="ai-analysis-page svelte-1g4eeoh"><span class="analysis-character-container svelte-1g4eeoh"><img class="analysis-image svelte-1g4eeoh"/> <h1 class="analysis-header svelte-1g4eeoh"> </h1></span> <div class="stats-container svelte-1g4eeoh"><div class="ai-chat-analysis-container svelte-1g4eeoh"><h3 class="ai-chat-analysis-header svelte-1g4eeoh">ð¡ AI Chat Analysis</h3> <p class="ai-chat-analysis svelte-1g4eeoh"> </p></div> <!></div></section>'),wv=N("<option required> </option>"),kv=(r,e)=>l(e).close(),Sv=N('<main class="route svelte-1g4eeoh"><!> <section class="main-page svelte-1g4eeoh"><section class="main-content svelte-1g4eeoh"><!> <div class="definition svelte-1g4eeoh"><!></div> <!></section></section></main> <dialog class="svelte-1g4eeoh"><div class="dialog-container svelte-1g4eeoh"><h2 class="dialog-header svelte-1g4eeoh">Select deck to be tested on:</h2> <form class="svelte-1g4eeoh"><select class="deck-select svelte-1g4eeoh"></select> <span class="deck-buttons-container svelte-1g4eeoh"><input type="Submit" class="submit-deck-btn svelte-1g4eeoh"/> <button class="close-deck-btn svelte-1g4eeoh">Close</button></span></form></div></dialog>',1);function Ev(r,e){Le(e,!0);const t=()=>Yr(es,"$location",s),[s,n]=Qr();let a="en",i=F(t().split("/").pop()),o=S(F(Object)),c=S(""),u=S(F([])),d=F([]),h=S(""),f=HTMLObjectElement,_=S(F(f.messagesContainer)),p=S(F(f.dialogBox)),k=S(void 0),y="",j=S(F(y.term)),P=S(F(y.definition)),O=S(F(y.partOfSpeech)),x=S(F(y.phoneticAnnotation)),T=S(""),E=!0,C=S(!1);lt(async()=>{await A()}),Te(async()=>{const{data:Y,error:ne}=await ie.from("ai_characters").select("*").eq("id",i).single();ne&&console.error(ne),Y&&v(o,Y,!0)});async function A(){const{data:Y,error:ne}=await ie.auth.getSession(),Q=Y;ne?console.error("Error fetching session:",ne):Q&&v(T,Q.session.user.id,!0),ne&&console.error("Error fetching username:",ne)}async function M(Y,ne){let Q="";ne.push({sender:"User",content:Y}),console.log(Q);const de=await fetch("/.netlify/functions/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:"You are an AI chatbot roleplaying a character for a language learning app. Keep it chat-like and follow the character trait. Return just your response. No formatting. If a flashcard deck is submitted, relate your answers off that",characterName:l(o).name,characterLanguageISO6391:l(o).language,characterTrait:l(o).trait,characterOccupation:l(o).occupation,latestUserResponse:Y,chatHistory:ne.map(xe=>({user:xe.sender,message:xe.content})),flashcardDecks:l(u)[l(k)]})});de.ok?console.log(de):console.error("AI API error:",de.statusText);const we=await de.json();ne.push({sender:"AI",content:we.reply}),console.log("AI Response:",we)}async function W(){v(C,!0);try{const ne=await(await fetch("/.netlify/functions/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:"You are an AI for a language learning app. The user and AI are having a conversation. Return no tags, no markup, just raw JSON with keys `analysis` â A strict critique in English aimed at helping the user improve. Also if the flashcardDeck is truthy then tell the user how well he used the cards in the flashcard deck - and also return `mistakes` â An array of objects. Each mistakes object must include `original_sentence` and `corrected_sentence`",flashcardDeck:l(u),chatLanguageISO6391:l(o).language,chatHistory:d.map(Q=>({user:Q.sender,message:Q.content})),flashcardDecks:l(u)[l(k)]})})).json();v(h,JSON.parse(ne.reply),!0),v(C,!1),console.log(l(h))}catch(Y){console.error(Y)}}async function le(){if(A(),l(p).showModal(),l(u).length===0){const{data:Y,error:ne}=await ie.from("flashcard_decks").select("*").eq("author",l(T));ne&&console.error("Error fetching flashcard decks:",ne),Y?(v(u,Y,!0),console.log("DECKS"),console.log(l(u))):v(u,[],!0)}}function J(){l(p).close()}const z=new Intl.Segmenter("zh",{granularity:"word"});async function I(Y,ne){E=!1,console.log(ne),console.log("Fetching definition for ",Y);try{const Q=await fetch("/.netlify/functions/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:"Translate this word based of context. Return no tags, no markup, simply just raw JSON with keys `word` (original), `partOfSpeech`, `phoneticAnnotation` (IMPORTANT: depsite the tag, return all possible readings as a string based of context in whatever is used for the language, such as phonetic-annotation, furigana etc. ) and `definition` (meaning based off context and also simple, normal person-readable info about conjugation) but ONLY return `phoneticAnnotation` where it is not necessary. For example non-Latin scripts",word:Y,context:ne,originalWordLanguageISO6391:l(o).language,translatedWordLanguageISO6391:a})});console.log(Q);const de=await Q.json(),we=JSON.parse(de.reply);console.log(we),E=!0,v(j,we.word,!0),v(P,we.definition,!0),v(O,we.partOfSpeech,!0),v(x,we.phoneticAnnotation,!0)}catch(Q){console.error(Q)}}var R=Sv(),L=Ie(R),V=b(L);Mt(V,{currentPage:"/ai-chat"});var X=g(V,2),oe=b(X),w=b(oe);{var m=Y=>{var ne=mv(),Q=b(ne),de=b(Q),we=b(de),xe=b(we),Ue=g(xe,2),Ne=b(Ue),ze=g(Ue,2),re=b(ze),ue=g(ze,2),me=b(ue),q=g(we,2);q.__click=[lv,W];var ee=g(q,2);{var ve=Ze=>{var at=cv();D(Ze,at)};se(ee,Ze=>{l(C)&&Ze(ve)})}var Oe=g(de,2);Oe.__click=[uv,le];var ke=g(Oe,2);De(ke,21,()=>d,Re,(Ze,at)=>{var tr=pv(),kr=Ie(tr);{var wn=St=>{var Nt=fv();De(Nt,21,()=>[...z.segment(l(at).content)].map(Ft=>Ft.segment),Re,(Ft,$s)=>{var ts=hv();ts.__click=[dv,I,$s,at];var Sn=b(ts);ce(()=>te(Sn,l($s))),D(Ft,ts)}),D(St,Nt)};se(kr,St=>{l(at).sender==="AI"&&St(wn)})}var Ls=g(kr,2);{var kn=St=>{var Nt=vv(),Ft=b(Nt);ce(()=>te(Ft,l(at).content)),D(St,Nt)};se(Ls,St=>{l(at).sender==="User"&&St(kn)})}D(Ze,tr)}),rt(ke,Ze=>v(_,Ze),()=>l(_));var Me=g(Q,2),qe=b(Me);{var je=Ze=>{var at=gv(),tr=g(b(at)),kr=b(tr);ce(()=>te(kr,l(u)[l(k)].name)),D(Ze,at)};se(qe,Ze=>{(l(k)||l(k)===0)&&Ze(je)})}var ft=g(qe,2),Qe=b(ft),bn=g(Qe,2);bn.__click=[_v,M,c,d],ce(()=>{Be(xe,"src",l(o).image),Be(xe,"alt",`Image of charater ${l(o).name}`),te(Ne,l(o).name),te(re,l(o).occupation),te(me,l(o).trait)}),Fe(Qe,()=>l(c),Ze=>v(c,Ze)),D(Y,ne)};se(w,Y=>{l(h)||Y(m)})}var $=g(w,2),B=b($);Yo(B,{get word(){return l(j)},get definition(){return l(P)},get partOfSpeech(){return l(O)},get phoneticAnnotation(){return l(x)},get language(){return l(o).language}});var G=g($,2);{var Z=Y=>{var ne=bv(),Q=b(ne),de=b(Q),we=g(de,2),xe=b(we),Ue=g(Q,2),Ne=b(Ue),ze=g(b(Ne),2),re=b(ze),ue=g(Ne,2);De(ue,17,()=>l(h).mistakes,Re,(me,q)=>{var ee=yv(),ve=Ie(ee),Oe=g(b(ve),2),ke=b(Oe),Me=g(ve,2),qe=g(b(Me),2),je=b(qe);ce(()=>{te(ke,l(q).original_sentence),te(je,l(q).corrected_sentence)}),D(me,ee)}),ce(()=>{Be(de,"src",l(o).image),Be(de,"alt",l(o).name),te(xe,l(o).name),te(re,l(h).analysis)}),D(Y,ne)};se(G,Y=>{l(h)&&Y(Z)})}var K=g(L,2),H=b(K),ae=g(b(H),2),fe=b(ae);De(fe,21,()=>l(u),Re,(Y,ne,Q)=>{var de=wv(),we=b(de);de.value=de.__value=Q,ce(()=>te(we,l(ne).name)),D(Y,de)});var pe=g(fe,2),ge=g(b(pe),2);ge.__click=[kv,p],rt(K,Y=>v(p,Y),()=>l(p)),tt("submit",ae,Y=>{Y.preventDefault(),J()}),Ye(fe,()=>l(k),Y=>v(k,Y)),D(r,R),$e(),n()}br(["click"]);var xv=ga(N('<script src="https://www.youtube.com/iframe_api" class="svelte-18y4z1i"><\/script><!>',1)),Tv=(r,e)=>l(e).scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),Ov=(r,e)=>l(e).scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),jv=(r,e)=>l(e).scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),Av=(r,e)=>l(e).scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),Pv=N(`<main class="svelte-18y4z1i"><section class="page-1 page svelte-18y4z1i"><div class="media-scroller svelte-18y4z1i"><div class="media-list svelte-18y4z1i"><span class="media-box music-media-box svelte-18y4z1i"><span class="emoji music-emoji svelte-18y4z1i">ð§</span> Music</span> <span class="media-box videos-media-box svelte-18y4z1i"><span class="emoji videos-emoji svelte-18y4z1i">ð¹</span> Videos</span> <span class="media-box flashcards-media-box svelte-18y4z1i"><span class="emoji flashcards-emoji svelte-18y4z1i">ðï¸</span> Flashcards</span> <span class="media-box ai-chats-media-box svelte-18y4z1i"><span class="emoji ai-chats-emoji svelte-18y4z1i">ð¬</span> AI Chats</span> <span class="media-box music-media-box svelte-18y4z1i"><span class="emoji music-emoji svelte-18y4z1i">ð§</span> Music</span> <span class="media-box videos-media-box svelte-18y4z1i"><span class="emoji videos-emoji svelte-18y4z1i">ð¹</span> Videos</span> <span class="media-box flashcards-media-box svelte-18y4z1i"><span class="emoji flashcards-emoji svelte-18y4z1i">ðï¸</span> Flashcards</span> <span class="media-box ai-chats-media-box svelte-18y4z1i"><span class="emoji ai-chats-emoji svelte-18y4z1i">ð¬</span> AI Chats</span></div></div> <section class="hero-1 svelte-18y4z1i"><h1 class="welcome svelte-18y4z1i">Welcome to Loquelis!</h1> <p class="welcome-message svelte-18y4z1i">ð¬ Learn languages from live subtitles, videos, music, AI characters & flashcards</p></section> <a href="./#/app/signup/" class="get-started-btn shadow svelte-18y4z1i">Let's get started! â</a></section> <section class="page-2 page svelte-18y4z1i"><h1 class="svelte-18y4z1i">Let's get started with a language-learning favourite - Peppa Pig! ð·</h1> <span class="video-info-box info-box svelte-18y4z1i"><p class="icon svelte-18y4z1i">ð¡</p>Click on a word for a definition based off context, part of speech and phonetic-annotation.</span> <span class="video-info-box info-box svelte-18y4z1i"><p class="icon svelte-18y4z1i">ð</p>Play the video and watch the live subtitles flow through!</span> <section class="video-container svelte-18y4z1i"><iframe id="player" frameborder="0" allowfullscreen="" class="svelte-18y4z1i"></iframe> <!></section></section> <hr class="svelte-18y4z1i"/> <section class="page-3 page svelte-18y4z1i"><h2 class="svelte-18y4z1i">Learn with user curated/ custom:</h2> <div class="media-container svelte-18y4z1i"><span class="media-box music-media-box svelte-18y4z1i"><span class="emoji music-emoji svelte-18y4z1i">ð§</span> Music</span> <span class="media-box videos-media-box svelte-18y4z1i"><span class="emoji videos-emoji svelte-18y4z1i">ð¹</span> Videos</span> <span class="media-box flashcards-media-box svelte-18y4z1i"><span class="emoji flashcards-emoji svelte-18y4z1i">ðï¸</span> Flashcards</span> <span class="media-box ai-chats-media-box svelte-18y4z1i"><span class="emoji ai-chats-emoji svelte-18y4z1i">ð¬</span> AI Chats</span></div></section> <hr class="svelte-18y4z1i"/> <section class="page-4 page svelte-18y4z1i"><h1 class="media-header svelte-18y4z1i">ð§ Music</h1> <p class="media-p svelte-18y4z1i">Learn through user curated music options and immerse yourself in the culture of the region of your chosen language</p> <div class="media-image-container svelte-18y4z1i"><img src="https://upload.wikimedia.org/wikipedia/en/b/bc/Molchat_Doma_-_Etazhi.png" alt="Molchat Doma music" class="media-img svelte-18y4z1i"/> <img src="https://upload.wikimedia.org/wikipedia/en/4/40/99_Luftballons_single_cover.jpg" alt="99 Luftballons Music" class="media-img svelte-18y4z1i"/> <img src="https://upload.wikimedia.org/wikipedia/en/f/fa/RammsteinRadioSingleCover.jpg" alt="Rammstein Music" class="media-img svelte-18y4z1i"/> <img src="https://upload.wikimedia.org/wikipedia/en/2/20/Fortuna_Wheel.jpg" alt="Rammstein Music" class="media-img svelte-18y4z1i"/></div> <hr class="svelte-18y4z1i"/> <h1 class="media-header svelte-18y4z1i">ð¹ Video</h1> <p class="media-p svelte-18y4z1i">Learn through user curated video options and finally switch from textbooks to shows, documentaries, news and YouTubers</p> <div class="media-image-container svelte-18y4z1i"><img src="https://i.ytimg.com/vi/WYqIlqp2_9c/sddefault.jpg" alt="coca cola documentary in german" class="vid-media-img media-img svelte-18y4z1i"/> <img src="https://i.ytimg.com/vi/_fPXQnfCWqI/sddefault.jpg" class="vid-media-img media-img svelte-18y4z1i" alt="french news"/> <img src="https://i.ytimg.com/vi/ZzfeHWgEVDs/sddefault.jpg" alt="vlog video" class="vid-media-img media-img svelte-18y4z1i"/></div> <hr class="svelte-18y4z1i"/> <h1 class="media-header svelte-18y4z1i">ðï¸ Flashcards</h1> <p class="media-p svelte-18y4z1i">Create your own decks from words saved from songs, videos and AI Chats</p> <div class="media-image-container svelte-18y4z1i"><img src="https://raw.githubusercontent.com/Ewan-Dev/ewan.is-a.dev/refs/heads/main/frontend/static/food-deck.png" class="deck-media-img media-img svelte-18y4z1i" alt="deck"/> <img src="https://raw.githubusercontent.com/Ewan-Dev/ewan.is-a.dev/refs/heads/main/frontend/static/animals-deck.png" alt="deck" class="deck-media-img media-img svelte-18y4z1i"/> <img src="https://raw.githubusercontent.com/Ewan-Dev/ewan.is-a.dev/refs/heads/main/frontend/static/flashcards.png" alt="flashcards" class="deck-media-img media-img svelte-18y4z1i"/></div> <hr class="svelte-18y4z1i"/> <h1 class="media-header svelte-18y4z1i">ð¬ AI Chat</h1> <p class="media-p svelte-18y4z1i">Create your own AI character to practise your language skills and decks with.</p> <div class="media-image-container svelte-18y4z1i"><img src="https://raw.githubusercontent.com/Ewan-Dev/ewan.is-a.dev/refs/heads/main/frontend/static/ai-chat.png" alt="ai chat" class="ai-chat-img media-img svelte-18y4z1i"/></div></section> <hr class="svelte-18y4z1i"/> <section class="page-5 page svelte-18y4z1i"><h1 class="svelte-18y4z1i">Start your journey. <p class="blue svelte-18y4z1i">Today.</p></h1> <div class="sign-up-contact-container svelte-18y4z1i"><a href="./#/app/signup/" class="big-get-started-btn shadow svelte-18y4z1i">Get started! â</a> <a class="big-contact-btn shadow svelte-18y4z1i" href="./#/app/login/"><span class="material-symbols-rounded svelte-18y4z1i">login</span>Sign in</a></div></section></main>`);function Cv(r,e){Le(e,!0);const t=()=>Yr(es,"$location",s),[s,n]=Qr(),i={events:[{tStartMs:10791,dDurationMs:1508,segs:[{utf8:"Herr Vogelscheuche"}]},{tStartMs:15535,dDurationMs:4067,segs:[{utf8:"Peppa und Schorsch sind heute zu Besuch bei Oma und Opa Wutz."}]},{tStartMs:23350,dDurationMs:1641,segs:[{utf8:"Hallo Opa Wutz."}]},{tStartMs:25960,dDurationMs:3547,segs:[{utf8:"Huhu Hallo Peppa Hallo Schorsch."}]},{tStartMs:29571,dDurationMs:2317,segs:[{utf8:"Opa was machst du denn da?"}]},{tStartMs:31897,dDurationMs:2158,segs:[{utf8:"Ich pflanze einen Blumengarten."}]},{tStartMs:34072,dDurationMs:1579,segs:[{utf8:"Oh!"}]},{tStartMs:35675,dDurationMs:3720,segs:[{utf8:"Aus diesen Samen wachsen wunderschÃ¶ne Blumen."}]},{tStartMs:40090,dDurationMs:3153,segs:[{utf8:"Ich streue die SamenkÃ¶rner auf den Boden."}]},{tStartMs:44163,dDurationMs:2722,segs:[{utf8:"Dann decke ich sie mit Erde zu."}]},{tStartMs:47211,dDurationMs:1841,segs:[{utf8:"Oh wo sind sie denn?"}]},{tStartMs:49110,dDurationMs:1865,segs:[{utf8:"Die SamenkÃ¶rner sind verschwunden."}]},{tStartMs:50999,dDurationMs:4049,segs:[{utf8:`Wie merkwÃ¼rdig! 
Ich bin sicher dass ich hier Samen verstaut hatte.`}]},{tStartMs:55076,dDurationMs:2456,segs:[{utf8:`Ja Opa.
Wir haben es gesehen.`}]},{tStartMs:57932,dDurationMs:1598,segs:[{utf8:`Ja!
Jetzt sind sie weg.`}]},{tStartMs:60167,dDurationMs:3047,segs:[{utf8:"Na gut dann muss ich eben noch welche nehmen."}]},{tStartMs:63522,dDurationMs:4459,segs:[{utf8:"Wie schon sagte, ich treue die SamenkÃ¶rner einfach auf den Boden."}]},{tStartMs:70334,dDurationMs:3534,segs:[{utf8:"Ein kleiner Vogel pickt die SamenkÃ¶rner von Opa Wutz auf."}]},{tStartMs:73960,dDurationMs:765,segs:[{utf8:"Heyy!"}]},{tStartMs:74776,dDurationMs:1962,segs:[{utf8:"Lass meine SamenkÃ¶rner!"}]},{tStartMs:77137,dDurationMs:2561,segs:[{utf8:"Also da sind meine ganzen Samen hin."}]},{tStartMs:79709,dDurationMs:3240,segs:[{utf8:"Im Bauch von dem kleinen Vogel."}]},{tStartMs:83320,dDurationMs:3741,segs:[{utf8:"Und noch zwei kleine VÃ¶gel picken Opa wird SamenkÃ¶rner auf."}]},{tStartMs:87180,dDurationMs:1319,segs:[{utf8:"Oh Guck!"}]},{tStartMs:88507,dDurationMs:1987,segs:[{utf8:"Ah! Weg da Weg da!"}]},{tStartMs:91405,dDurationMs:1666,segs:[{utf8:"Was ist das fÃ¼r ein LÃ¤rm."}]},{tStartMs:93256,dDurationMs:3800,segs:[{utf8:`Oma Wutz!
Die VÃ¶gel picken meine ganzen Blumensamen weg.`}]},{tStartMs:97138,dDurationMs:2397,segs:[{utf8:"Und jetzt werden die VÃ¶gel weg."}]},{tStartMs:99765,dDurationMs:3239,segs:[{utf8:"Wegjagen hat keinen Zweck! Sie kommen einfach wieder."}]},{tStartMs:103020,dDurationMs:959,segs:[{utf8:"Guck!"}]},{tStartMs:104823,dDurationMs:2133,segs:[{utf8:"Wir brauchen eine Vogelscheuche."}]},{tStartMs:106990,dDurationMs:1964,segs:[{utf8:"Was ist eine Vogelscheuche?"}]},{tStartMs:109017,dDurationMs:3719,segs:[{utf8:"Eine Vogelscheuche ist ein Mann aus Stroh der den VÃ¶geln Angst macht."}]},{tStartMs:112761,dDurationMs:2916,segs:[{utf8:"Das ist eine gute Idee Oma Wutz."}]},{tStartMs:115697,dDurationMs:1305,segs:[{utf8:"Ich baue eine."}]},{tStartMs:117038,dDurationMs:1663,segs:[{utf8:"Kommt alle mit."}]},{tStartMs:119901,dDurationMs:6213,segs:[{utf8:"Wiedersehen kleine VÃ¶gel. Wir bauen eine Vogelscheuche."}]},{tStartMs:126387,dDurationMs:2133,segs:[{utf8:"Das ist Opa Wutz Gartenschuppen."}]},{tStartMs:128928,dDurationMs:4022,segs:[{utf8:"Hier drin gibt es eine Menge Sachen um eine Vogelscheuche zu bauen."}]},{tStartMs:133306,dDurationMs:3583,segs:[{utf8:"Zuerst brauchen wir zwei StÃ¶cke und etwas Kordel."}]},{tStartMs:136913,dDurationMs:2023,segs:[{utf8:"Das besorgen wir."}]},{tStartMs:140720,dDurationMs:4139,segs:[{utf8:"Peppa hat zwei StÃ¼cke gefunden Schorsch hat etwas Kordel gefunden."}]},{tStartMs:144900,dDurationMs:1090,segs:[{utf8:"Gut!"}]},{tStartMs:146042,dDurationMs:3400,segs:[{utf8:"Ich binde die StÃ¶cke zusammen. Das wird der KÃ¶rper."}]},{tStartMs:149529,dDurationMs:3666,segs:[{utf8:"Oma Wutz hat etwas Stroh gefunden und einen alten Sack."}]},{tStartMs:153237,dDurationMs:5544,segs:[{utf8:`GroÃartig!
Ich stecke das Stroh in den Sack. Das wird der Kopf.`}]},{tStartMs:158817,dDurationMs:3276,segs:[{utf8:"Jetzt braucht die Vogelscheuche was zum anziehen."}]},{tStartMs:162146,dDurationMs:2129,segs:[{utf8:"Hier ist eine Tasche mit alten Kleidern."}]},{tStartMs:164334,dDurationMs:5122,segs:[{utf8:`Oh!
Schorsch hat ein Kleid gefunden.`}]},{tStartMs:170717,dDurationMs:6222,segs:[{utf8:`Dumber Schorsch!
Herr Vogelscheuche hat doch kein Kleid an.`}]},{tStartMs:177184,dDurationMs:2503,segs:[{utf8:"Peppa hat einen Mantel gefunden."}]},{tStartMs:179918,dDurationMs:1875,segs:[{utf8:"Sehr gut Peppa!"}]},{tStartMs:183037,dDurationMs:1961,segs:[{utf8:"Schorsch hat einen Hut gefunden."}]},{tStartMs:185023,dDurationMs:1709,segs:[{utf8:"Sehr gut Schorsch."}]},{tStartMs:187126,dDurationMs:2881,segs:[{utf8:"Herr Vogelscheuche braucht ein Gesicht."}]},{tStartMs:190015,dDurationMs:1e3,segs:[{utf8:"Das Stimmt."}]},{tStartMs:191285,dDurationMs:2564,segs:[{utf8:"Willst du mit Schorch ein Gesicht fÃ¼r ihn malen."}]},{tStartMs:193911,dDurationMs:2596,segs:[{utf8:"Ja bitte."}]},{tStartMs:196794,dDurationMs:2467,segs:[{utf8:"Schorsch malt die Augen und die Nase."}]},{tStartMs:199643,dDurationMs:2004,segs:[{utf8:"Peppa malt den Mund."}]},{tStartMs:202331,dDurationMs:1949,segs:[{utf8:"Fantastisch!"}]},{tStartMs:204305,dDurationMs:1352,segs:[{utf8:"Herr Vogelscheuche ist fertig."}]},{tStartMs:205689,dDurationMs:1750,segs:[{utf8:"Hurraa"}]},{tStartMs:208970,dDurationMs:2877,segs:[{utf8:"Die kleinen VÃ¶gel suchen nach Opa Wutz Blumensamen."}]},{tStartMs:211985,dDurationMs:2704,segs:[{utf8:`Guck!
Die kleinen VÃ¶gel sind wieder da.`}]},{tStartMs:214706,dDurationMs:1327,segs:[{utf8:"Keine Sorge Peppa."}]},{tStartMs:216041,dDurationMs:2345,segs:[{utf8:"Die Vogelscheuche wird sie feucht."}]},{tStartMs:223868,dDurationMs:1266,segs:[{utf8:"Es funktioniert!"}]},{tStartMs:225194,dDurationMs:2491,segs:[{utf8:"Die Vogelscheuche hat die VÃ¶gel verscheucht."}]},{tStartMs:227757,dDurationMs:1528,segs:[{utf8:"Hurra!"}]},{tStartMs:229296,dDurationMs:726,segs:[{utf8:" Gut!"}]},{tStartMs:230099,dDurationMs:3049,segs:[{utf8:"Jetzt werden meine Blumensamen nicht mehr gefressen."}]},{tStartMs:234964,dDurationMs:4325,segs:[{utf8:"Oh Opa die kleinen VÃ¶gel sehen sehr traurig aus."}]},{tStartMs:239329,dDurationMs:2435,segs:[{utf8:"Ja sie haben sicher Hunger."}]},{tStartMs:241820,dDurationMs:1730,segs:[{utf8:"DafÃ¼r habe ich das hier."}]},{tStartMs:243594,dDurationMs:1951,segs:[{utf8:"Das ist das Oma?"}]},{tStartMs:245561,dDurationMs:1721,segs:[{utf8:"Eine Futterstation."}]},{tStartMs:247307,dDurationMs:5499,segs:[{utf8:"Opa gibst du mir bitte etwas von den Samen."}]},{tStartMs:254689,dDurationMs:3828,segs:[{utf8:"Kommt ihr VÃ¶gelchen. Essen Zeit."}]},{tStartMs:259175,dDurationMs:2599,segs:[{utf8:"Jetzt haben die VÃ¶gel ihre eigenen Samen."}]},{tStartMs:262604,dDurationMs:2274,segs:[{utf8:"Die kleinen VÃ¶gel sind wieder glÃ¼cklich."}]},{tStartMs:264903,dDurationMs:3639,segs:[{utf8:"Peppa ist froh dass Opas Blumensamen nicht gefressen werden."}]},{tStartMs:268644,dDurationMs:8125,segs:[{utf8:"Aber noch vor ist sie dass die kleinen VÃ¶gel auch etwas zu fressen haben."}]}]}.events;console.log(i);let o=S(void 0),c=S(void 0),u=S(void 0),d=S(void 0);F([]);let h,f=S("Peppa Wutz");Te(()=>{t().split("/").pop()==="welcome"&&(_(),window.YT?p():window.onYouTubeIframeAPIReady=p)});function _(){Xr({particleCount:1e3,spread:150,origin:{y:0}})}function p(){h=new YT.Player("player",{events:{onReady:()=>{setInterval(()=>{const R=h.getCurrentTime(),L=Math.round(R*1e3);k(L)},1)}}})}function k(R){let L=0;i.forEach(V=>{R>V.tStartMs&&R<i[L+1].tStartMs&&V.segs.forEach(X=>{l(f)!==X.utf8&&(v(f,X.utf8,!0),console.log(X.utf8))}),L++})}var y=Pv();pa(R=>{var L=xv();g(Ie(L)),D(R,L)});var j=g(b(y),2),P=g(b(j),6),O=b(P);Be(O,"src","https://www.youtube.com/embed/Q_sqR4aLLu0?enablejsapi=1"),Be(O,"title","peppapig");var x=g(O,2);xa(x,{get currentLine(){return l(f)},targetLanguage:"de"});var T=g(j,4),E=g(b(T),2),C=b(E);C.__click=[Tv,o];var A=g(C,2);A.__click=[Ov,c];var M=g(A,2);M.__click=[jv,u];var W=g(M,2);W.__click=[Av,d];var le=g(T,4),J=g(b(le),6);rt(J,R=>v(c,R),()=>l(c));var z=g(J,8);rt(z,R=>v(u,R),()=>l(u));var I=g(z,10);rt(I,R=>v(d,R),()=>l(d)),rt(le,R=>v(o,R),()=>l(o)),D(r,y),$e(),n()}br(["click"]);var Mv=()=>{window.open("#/app/home")},Iv=N('<head><link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:wght@400" rel="stylesheet"/></head> <main class="svelte-1n46o8q"><dialog class="svelte-1n46o8q"><form class="svelte-1n46o8q"><label class="username-header svelte-1n46o8q">ð¤ Set a username:</label> <span class="input-container svelte-1n46o8q"><p class="at-symbol svelte-1n46o8q">@</p><input placeholder="username" class="username-input svelte-1n46o8q"/></span> <input type="Submit" class="svelte-1n46o8q"/> <button class="close-button-username svelte-1n46o8q">Close</button> <!></form></dialog> <dialog open class="auth-notice svelte-1n46o8q"><h2>Already logged in</h2> <p>You already have a user session saved.</p> <button class="dialog-auth-btn svelte-1n46o8q">Continue anyway</button> <button class="dialog-auth-btn svelte-1n46o8q">Go to user homepage</button></dialog> <!></main>',1);function Rv(r,e){Le(e,!0);const t=()=>Yr(es,"$location",s),[s,n]=Qr(),a={"/app/welcome":Cv,"/app/ai-chat/:slug":Ev,"/app/ai-chat":ov,"/app/videos/:slug":Kf,"/app/videos":Wf,"/app/flashcards/:slug":$f,"/app/flashcards":nf,"/app/upload":Zh,"/app/music/:slug":Hh,"/app/music":Oh,"/app/login":_h,"/app/login/:slug":bh,"/app/signup":vh,"/app/home":ch};let i=S(""),o=S(""),c="",u=S(F(c.statusMessage)),d=S(F(c.statusType)),h=S(""),f,_,p=S(F(t()));lt(()=>{f==null||f.close(),v(p,t(),!0)}),Te(()=>{v(p,t(),!0),l(h)&&(l(p)==="/app/login"||l(p)==="/app/signup")?_==null||_.showModal():l(h)&&l(p)==="/"?window.location.replace("/#/app/home"):!l(h)&&l(p)==="/"?window.location.replace("/#/app/welcome"):(l(h)&&(l(p)==="/app/login"||l(p)),_==null||_.close())}),Te(async()=>{console.log(l(p)),await y(),k()});function k(){!l(i)&&l(h)?f==null||f.showModal():f==null||f.close()}async function y(){var oe,w;const{data:L,error:V}=await ie.auth.getSession(),X=L;if(V)console.error("Error fetching session:",V);else if(X){v(h,(w=(oe=X==null?void 0:X.session)==null?void 0:oe.user)==null?void 0:w.id,!0);const{data:m,error:$}=await ie.from("profiles").select("username").eq("user_id",l(h)).single();m&&(console.log(m),v(i,m.username,!0),console.log("User: ",l(i)))}}async function j(L){if(L){const{error:V}=await ie.from("profiles").update({username:L}).eq("user_id",l(h));V?(console.error(V.message),v(u,""),v(d,""),V.message.includes("duplicate")&&V.message.includes("username")?(v(u,""),v(d,""),v(u,"Account with username already exists"),v(d,"error")):(v(u,""),v(d,""),v(u,V.message,!0),v(d,"error")),V.message==='Column "username" cannot be modified once set'&&(v(u,""),v(d,""),v(u,"Username already set!"),v(d,"warn"))):(v(u,""),v(d,""),v(u,"success"),v(d,"success"),v(i,L,!0))}else v(u,""),v(d,""),v(u,"No username typed"),v(d,"warn")}var P=Iv(),O=g(Ie(P),2),x=b(O),T=b(x),E=g(b(T),2),C=g(b(E)),A=g(E,4),M=fr(k);A.__click=function(...L){var V;(V=l(M))==null||V.apply(this,L)};var W=g(A,2);{var le=L=>{Ke(L,{get message(){return l(u)},get type(){return l(d)}})};se(W,L=>{l(u)&&L(le)})}rt(x,L=>f=L,()=>f);var J=g(x,2),z=g(b(J),4);z.__click=()=>{_==null||_.close()};var I=g(z,2);I.__click=[Mv],rt(J,L=>_=L,()=>_);var R=g(J,2);Bh(R,{get routes(){return a}}),tt("submit",T,L=>{L.preventDefault(),j(l(o))}),Fe(C,()=>l(o),L=>v(o,L)),D(r,P),$e(),n()}br(["click"]);xc(Rv,{target:document.getElementById("app")})});export default Dv();
