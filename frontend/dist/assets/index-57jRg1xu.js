var So=Object.defineProperty;var na=r=>{throw TypeError(r)};var Eo=(r,e,t)=>e in r?So(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var xo=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports);var Fr=(r,e,t)=>Eo(r,typeof e!="symbol"?e+"":e,t),en=(r,e,t)=>e.has(r)||na("Cannot "+t);var we=(r,e,t)=>(en(r,e,"read from private field"),t?t.call(r):e.get(r)),Xe=(r,e,t)=>e.has(r)?na("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),it=(r,e,t,s)=>(en(r,e,"write to private field"),s?s.call(r,t):e.set(r,t),t),Jt=(r,e,t)=>(en(r,e,"access private method"),t);var Mf=xo((qf,_s)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function t(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(n){if(n.ep)return;n.ep=!0;const a=t(n);fetch(n.href,a)}})();const ri=!1;var Ir=Array.isArray,To=Array.prototype.indexOf,In=Array.from,Ps=Object.defineProperty,Nt=Object.getOwnPropertyDescriptor,si=Object.getOwnPropertyDescriptors,Oo=Object.prototype,jo=Array.prototype,Rn=Object.getPrototypeOf,aa=Object.isExtensible;function kr(r){return typeof r=="function"}const nt=()=>{};function Ao(r){return r()}function Zr(r){for(var e=0;e<r.length;e++)r[e]()}function Po(){var r,e,t=new Promise((s,n)=>{r=s,e=n});return{promise:t,resolve:r,reject:e}}function Co(r,e){if(Array.isArray(r))return r;if(!(Symbol.iterator in r))return Array.from(r);const t=[];for(const s of r)if(t.push(s),t.length===e)break;return t}const at=2,Dn=4,qs=8,nr=16,Ct=32,ar=64,ni=128,lt=256,Cs=512,Ve=1024,ct=2048,Mt=4096,ft=8192,ir=16384,Ns=32768,cs=65536,ia=1<<17,ai=1<<18,us=1<<19,ii=1<<20,pn=1<<21,$n=1<<22,Xt=1<<23,wt=Symbol("$state"),oi=Symbol("legacy props"),Mo=Symbol(""),Ln=new class extends Error{constructor(){super(...arguments);Fr(this,"name","StaleReactionError");Fr(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}},Io=11;function Ro(){throw new Error("https://svelte.dev/e/await_outside_boundary")}function Fs(r){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Do(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function $o(r){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Lo(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Uo(r){throw new Error("https://svelte.dev/e/effect_orphan")}function zo(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function qo(r){throw new Error("https://svelte.dev/e/lifecycle_legacy_only")}function No(r){throw new Error("https://svelte.dev/e/props_invalid_value")}function Fo(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Bo(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Wo(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}const Bs=1,Ws=2,li=4,Vo=8,Ho=16,Jo=1,Ko=2,Go=4,Yo=8,Qo=16,Zo=4,Xo=1,el=2,We=Symbol(),tl="http://www.w3.org/1999/xhtml";function rl(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}let sl=!1;function ci(r){return r===this.v}function ui(r,e){return r!=r?e==e:r!==e||r!==null&&typeof r=="object"||typeof r=="function"}function di(r){return!ui(r,this.v)}let Rr=!1,nl=!1;function al(){Rr=!0}let xe=null;function Ms(r){xe=r}function Re(r,e=!1,t){xe={p:xe,c:null,e:null,s:r,x:null,l:Rr&&!e?{s:null,u:null,$:[]}:null}}function De(r){var e=xe,t=e.e;if(t!==null){e.e=null;for(var s of t)Ti(s)}return xe=e.p,{}}function ds(){return!Rr||xe!==null&&xe.l===null}const il=new WeakMap;function ol(r){var e=ge;if(e===null)return me.f|=Xt,r;if((e.f&Ns)===0){if((e.f&ni)===0)throw!e.parent&&r instanceof Error&&hi(r),r;e.b.error(r)}else Un(r,e)}function Un(r,e){for(;e!==null;){if((e.f&ni)!==0)try{e.b.error(r);return}catch(t){r=t}e=e.parent}throw r instanceof Error&&hi(r),r}function hi(r){const e=il.get(r);e&&(Ps(r,"message",{value:e.message}),Ps(r,"stack",{value:e.stack}))}let zt=[],Is=[];function fi(){var r=zt;zt=[],Zr(r)}function ll(){var r=Is;Is=[],Zr(r)}function cl(){return zt.length>0||Is.length>0}function hs(r){if(zt.length===0&&!Jr){var e=zt;queueMicrotask(()=>{e===zt&&fi()})}zt.push(r)}function ul(){zt.length>0&&fi(),Is.length>0&&ll()}function dl(){const r=ge.b;return r===null&&Ro(),r}function fs(r){var e=at|ct,t=me!==null&&(me.f&at)!==0?me:null;return ge===null||t!==null&&(t.f&lt)!==0?e|=lt:ge.f|=us,{ctx:xe,deps:null,effects:null,equals:ci,f:e,fn:r,reactions:null,rv:0,v:We,wv:0,parent:t??ge,ac:null}}function hl(r,e){let t=ge;t===null&&Do();var s=t.b,n=void 0,a=es(We),i=null,o=!me;return Ol(()=>{try{var l=r();i&&Promise.resolve(l).catch(()=>{})}catch(p){l=Promise.reject(p)}var u=()=>l;n=(i==null?void 0:i.then(u,u))??Promise.resolve(l),i=n;var d=Ee,h=s.is_pending();o&&(s.update_pending_count(1),h||d.increment());const f=(p,v=void 0)=>{i=null,h||d.activate(),v?v!==Ln&&(a.f|=Xt,ts(a,v)):((a.f&Xt)!==0&&(a.f^=Xt),ts(a,p)),o&&(s.update_pending_count(-1),h||d.decrement()),gi()};if(n.then(f,p=>f(null,p||"unknown")),d)return()=>{queueMicrotask(()=>d.neuter())}}),new Promise(l=>{function u(d){function h(){d===n?l(a):u(n)}d.then(h,h)}u(n)})}function Ar(r){const e=fs(r);return Mi(e),e}function Vs(r){const e=fs(r);return e.equals=di,e}function vi(r){var e=r.effects;if(e!==null){r.effects=null;for(var t=0;t<e.length;t+=1)At(e[t])}}function fl(r){for(var e=r.parent;e!==null;){if((e.f&at)===0)return e;e=e.parent}return null}function zn(r){var e,t=ge;Wt(fl(r));try{vi(r),e=$i(r)}finally{Wt(t)}return e}function pi(r){var e=zn(r);if(r.equals(e)||(r.v=e,r.wv=Ri()),!lr){var t=(qt||(r.f&lt)!==0)&&r.deps!==null?Mt:Ve;Ze(r,t)}}function vl(r,e,t){const s=ds()?fs:Vs;if(e.length===0){t(r.map(s));return}var n=Ee,a=ge,i=pl(),o=dl();Promise.all(e.map(l=>hl(l))).then(l=>{n==null||n.activate(),i();try{t([...r.map(s),...l])}catch(u){(a.f&ir)===0&&Un(u,a)}n==null||n.deactivate(),gi()}).catch(l=>{o.error(l)})}function pl(){var r=ge,e=me,t=xe,s=Ee;return function(){Wt(r),bt(e),Ms(t),s==null||s.activate()}}function gi(){Wt(null),bt(null),Ms(null)}const tn=new Set;let Ee=null,js=null,oa=new Set,sr=[],Hs=null,gn=!1,Jr=!1;var ns,Tr,Lt,as,is,Qt,Or,Zt,Ut,jr,os,ls,vt,_i,As,_n;const zs=class zs{constructor(){Xe(this,vt);Fr(this,"current",new Map);Xe(this,ns,new Map);Xe(this,Tr,new Set);Xe(this,Lt,0);Xe(this,as,null);Xe(this,is,!1);Xe(this,Qt,[]);Xe(this,Or,[]);Xe(this,Zt,[]);Xe(this,Ut,[]);Xe(this,jr,[]);Xe(this,os,[]);Xe(this,ls,[]);Fr(this,"skipped_effects",new Set)}process(e){var n;sr=[],js=null;for(const a of e)Jt(this,vt,_i).call(this,a);if(we(this,Qt).length===0&&we(this,Lt)===0){Jt(this,vt,_n).call(this);var t=we(this,Zt),s=we(this,Ut);it(this,Zt,[]),it(this,Ut,[]),it(this,jr,[]),js=Ee,Ee=null,la(t),la(s),Ee===null?Ee=this:tn.delete(this),(n=we(this,as))==null||n.resolve()}else Jt(this,vt,As).call(this,we(this,Zt)),Jt(this,vt,As).call(this,we(this,Ut)),Jt(this,vt,As).call(this,we(this,jr));for(const a of we(this,Qt))rr(a);for(const a of we(this,Or))rr(a);it(this,Qt,[]),it(this,Or,[])}capture(e,t){we(this,ns).has(e)||we(this,ns).set(e,t),this.current.set(e,e.v)}activate(){Ee=this}deactivate(){Ee=null,js=null;for(const e of oa)if(oa.delete(e),e(),Ee!==null)break}neuter(){it(this,is,!0)}flush(){sr.length>0?mi():Jt(this,vt,_n).call(this),Ee===this&&(we(this,Lt)===0&&tn.delete(this),this.deactivate())}increment(){it(this,Lt,we(this,Lt)+1)}decrement(){if(it(this,Lt,we(this,Lt)-1),we(this,Lt)===0){for(const e of we(this,os))Ze(e,ct),Pr(e);for(const e of we(this,ls))Ze(e,Mt),Pr(e);it(this,Zt,[]),it(this,Ut,[]),this.flush()}else this.deactivate()}add_callback(e){we(this,Tr).add(e)}settled(){return(we(this,as)??it(this,as,Po())).promise}static ensure(){if(Ee===null){const e=Ee=new zs;tn.add(Ee),Jr||zs.enqueue(()=>{Ee===e&&e.flush()})}return Ee}static enqueue(e){hs(e)}};ns=new WeakMap,Tr=new WeakMap,Lt=new WeakMap,as=new WeakMap,is=new WeakMap,Qt=new WeakMap,Or=new WeakMap,Zt=new WeakMap,Ut=new WeakMap,jr=new WeakMap,os=new WeakMap,ls=new WeakMap,vt=new WeakSet,_i=function(e){var d;e.f^=Ve;for(var t=e.first;t!==null;){var s=t.f,n=(s&(Ct|ar))!==0,a=n&&(s&Ve)!==0,i=a||(s&ft)!==0||this.skipped_effects.has(t);if(!i&&t.fn!==null){if(n)t.f^=Ve;else if((s&Dn)!==0)we(this,Ut).push(t);else if((s&Ve)===0)if((s&$n)!==0){var o=(d=t.b)!=null&&d.is_pending()?we(this,Or):we(this,Qt);o.push(t)}else vs(t)&&((t.f&nr)!==0&&we(this,jr).push(t),rr(t));var l=t.first;if(l!==null){t=l;continue}}var u=t.parent;for(t=t.next;t===null&&u!==null;)t=u.next,u=u.parent}},As=function(e){for(const t of e)((t.f&ct)!==0?we(this,os):we(this,ls)).push(t),Ze(t,Ve);e.length=0},_n=function(){if(!we(this,is))for(const e of we(this,Tr))e();we(this,Tr).clear()};let Xr=zs;function gl(r){var e=Jr;Jr=!0;try{for(var t;;){if(ul(),sr.length===0&&!cl()&&(Ee==null||Ee.flush(),sr.length===0))return Hs=null,t;mi()}}finally{Jr=e}}function mi(){var r=Er;gn=!0;try{var e=0;for(ha(!0);sr.length>0;){var t=Xr.ensure();if(e++>1e3){var s,n;_l()}t.process(sr),Ft.clear()}}finally{gn=!1,ha(r),Hs=null}}function _l(){try{zo()}catch(r){Un(r,Hs)}}let Tt=null;function la(r){var e=r.length;if(e!==0){for(var t=0;t<e;){var s=r[t++];if((s.f&(ir|ft))===0&&vs(s)&&(Tt=[],rr(s),s.deps===null&&s.first===null&&s.nodes_start===null&&(s.teardown===null&&s.ac===null?Ai(s):s.fn=null),(Tt==null?void 0:Tt.length)>0)){Ft.clear();for(const n of Tt)rr(n);Tt=[]}}Tt=null}}function Pr(r){for(var e=Hs=r;e.parent!==null;){e=e.parent;var t=e.f;if(gn&&e===ge&&(t&nr)!==0)return;if((t&(ar|Ct))!==0){if((t&Ve)===0)return;e.f^=Ve}}sr.push(e)}const Ft=new Map;function es(r,e){var t={f:0,v:r,reactions:null,equals:ci,rv:0,wv:0};return t}function O(r,e){const t=es(r);return Mi(t),t}function er(r,e=!1,t=!0){var n;const s=es(r);return e||(s.equals=di),Rr&&t&&xe!==null&&xe.l!==null&&((n=xe.l).s??(n.s=[])).push(s),s}function _(r,e,t=!1){me!==null&&(!yt||(me.f&ia)!==0)&&ds()&&(me.f&(at|nr|$n|ia))!==0&&!(Qe!=null&&Qe.includes(r))&&Wo();let s=t?W(e):e;return ts(r,s)}function ts(r,e){if(!r.equals(e)){var t=r.v;lr?Ft.set(r,e):Ft.set(r,t),r.v=e;var s=Xr.ensure();s.capture(r,t),(r.f&at)!==0&&((r.f&ct)!==0&&zn(r),Ze(r,(r.f&lt)===0?Ve:Mt)),r.wv=Ri(),wi(r,ct),ds()&&ge!==null&&(ge.f&Ve)!==0&&(ge.f&(Ct|ar))===0&&(ot===null?Pl([r]):ot.push(r))}return e}function yi(r,e=1){var t=c(r),s=e===1?t++:t--;return _(r,t),s}function rn(r){_(r,r.v+1)}function wi(r,e){var t=r.reactions;if(t!==null)for(var s=ds(),n=t.length,a=0;a<n;a++){var i=t[a],o=i.f;if(!(!s&&i===ge)){var l=(o&ct)===0;l&&Ze(i,e),(o&at)!==0?wi(i,Mt):l&&((o&nr)!==0&&Tt!==null&&Tt.push(i),Pr(i))}}}function W(r){if(typeof r!="object"||r===null||wt in r)return r;const e=Rn(r);if(e!==Oo&&e!==jo)return r;var t=new Map,s=Ir(r),n=O(0),a=tr,i=o=>{if(tr===a)return o();var l=me,u=tr;bt(null),va(a);var d=o();return bt(l),va(u),d};return s&&t.set("length",O(r.length)),new Proxy(r,{defineProperty(o,l,u){(!("value"in u)||u.configurable===!1||u.enumerable===!1||u.writable===!1)&&Fo();var d=t.get(l);return d===void 0?d=i(()=>{var h=O(u.value);return t.set(l,h),h}):_(d,u.value,!0),!0},deleteProperty(o,l){var u=t.get(l);if(u===void 0){if(l in o){const d=i(()=>O(We));t.set(l,d),rn(n)}}else _(u,We),rn(n);return!0},get(o,l,u){var p;if(l===wt)return r;var d=t.get(l),h=l in o;if(d===void 0&&(!h||(p=Nt(o,l))!=null&&p.writable)&&(d=i(()=>{var v=W(h?o[l]:We),k=O(v);return k}),t.set(l,d)),d!==void 0){var f=c(d);return f===We?void 0:f}return Reflect.get(o,l,u)},getOwnPropertyDescriptor(o,l){var u=Reflect.getOwnPropertyDescriptor(o,l);if(u&&"value"in u){var d=t.get(l);d&&(u.value=c(d))}else if(u===void 0){var h=t.get(l),f=h==null?void 0:h.v;if(h!==void 0&&f!==We)return{enumerable:!0,configurable:!0,value:f,writable:!0}}return u},has(o,l){var f;if(l===wt)return!0;var u=t.get(l),d=u!==void 0&&u.v!==We||Reflect.has(o,l);if(u!==void 0||ge!==null&&(!d||(f=Nt(o,l))!=null&&f.writable)){u===void 0&&(u=i(()=>{var p=d?W(o[l]):We,v=O(p);return v}),t.set(l,u));var h=c(u);if(h===We)return!1}return d},set(o,l,u,d){var x;var h=t.get(l),f=l in o;if(s&&l==="length")for(var p=u;p<h.v;p+=1){var v=t.get(p+"");v!==void 0?_(v,We):p in o&&(v=i(()=>O(We)),t.set(p+"",v))}if(h===void 0)(!f||(x=Nt(o,l))!=null&&x.writable)&&(h=i(()=>O(void 0)),_(h,W(u)),t.set(l,h));else{f=h.v!==We;var k=i(()=>W(u));_(h,k)}var w=Reflect.getOwnPropertyDescriptor(o,l);if(w!=null&&w.set&&w.set.call(d,u),!f){if(s&&typeof l=="string"){var j=t.get("length"),P=Number(l);Number.isInteger(P)&&P>=j.v&&_(j,P+1)}rn(n)}return!0},ownKeys(o){c(n);var l=Reflect.ownKeys(o).filter(h=>{var f=t.get(h);return f===void 0||f.v!==We});for(var[u,d]of t)d.v!==We&&!(u in o)&&l.push(u);return l},setPrototypeOf(){Bo()}})}function ca(r){try{if(r!==null&&typeof r=="object"&&wt in r)return r[wt]}catch{}return r}function ml(r,e){return Object.is(ca(r),ca(e))}var ua,bi,ki,Si;function yl(){if(ua===void 0){ua=window,bi=/Firefox/.test(navigator.userAgent);var r=Element.prototype,e=Node.prototype,t=Text.prototype;ki=Nt(e,"firstChild").get,Si=Nt(e,"nextSibling").get,aa(r)&&(r.__click=void 0,r.__className=void 0,r.__attributes=null,r.__style=void 0,r.__e=void 0),aa(t)&&(t.__t=void 0)}}function or(r=""){return document.createTextNode(r)}function Rs(r){return ki.call(r)}function Js(r){return Si.call(r)}function b(r,e){return Rs(r)}function Oe(r,e){{var t=Rs(r);return t instanceof Comment&&t.data===""?Js(t):t}}function y(r,e=1,t=!1){let s=r;for(;e--;)s=Js(s);return s}function wl(r){r.textContent=""}function qn(){return!1}let da=!1;function bl(){da||(da=!0,document.addEventListener("reset",r=>{Promise.resolve().then(()=>{var e;if(!r.defaultPrevented)for(const t of r.target.elements)(e=t.__on_r)==null||e.call(t)})},{capture:!0}))}function Dr(r){var e=me,t=ge;bt(null),Wt(null);try{return r()}finally{bt(e),Wt(t)}}function Ei(r,e,t,s=t){r.addEventListener(e,()=>Dr(t));const n=r.__on_r;n?r.__on_r=()=>{n(),s(!0)}:r.__on_r=()=>s(!0),bl()}function xi(r){ge===null&&me===null&&Uo(),me!==null&&(me.f&lt)!==0&&ge===null&&Lo(),lr&&$o()}function kl(r,e){var t=e.last;t===null?e.last=e.first=r:(t.next=r,r.prev=t,e.last=r)}function kt(r,e,t,s=!0){var n=ge;n!==null&&(n.f&ft)!==0&&(r|=ft);var a={ctx:xe,deps:null,nodes_start:null,nodes_end:null,f:r|ct,first:null,fn:e,last:null,next:null,parent:n,b:n&&n.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(t)try{rr(a),a.f|=Ns}catch(l){throw At(a),l}else e!==null&&Pr(a);if(s){var i=a;if(t&&i.deps===null&&i.teardown===null&&i.nodes_start===null&&i.first===i.last&&(i.f&us)===0&&(i=i.first),i!==null&&(i.parent=n,n!==null&&kl(i,n),me!==null&&(me.f&at)!==0&&(r&ar)===0)){var o=me;(o.effects??(o.effects=[])).push(i)}}return a}function Nn(r){const e=kt(qs,null,!1);return Ze(e,Ve),e.teardown=r,e}function Se(r){xi();var e=ge.f,t=!me&&(e&Ct)!==0&&(e&Ns)===0;if(t){var s=xe;(s.e??(s.e=[])).push(r)}else return Ti(r)}function Ti(r){return kt(Dn|ii,r,!1)}function Sl(r){return xi(),kt(qs|ii,r,!0)}function El(r){Xr.ensure();const e=kt(ar|us,r,!0);return(t={})=>new Promise(s=>{t.outro?Ys(e,()=>{At(e),s(void 0)}):(At(e),s(void 0))})}function Fn(r){return kt(Dn,r,!1)}function xl(r,e){var t=xe,s={effect:null,ran:!1,deps:r};t.l.$.push(s),s.effect=Ks(()=>{r(),!s.ran&&(s.ran=!0,It(e))})}function Tl(){var r=xe;Ks(()=>{for(var e of r.l.$){e.deps();var t=e.effect;(t.f&Ve)!==0&&Ze(t,Mt),vs(t)&&rr(t),e.ran=!1}})}function Ol(r){return kt($n|us,r,!0)}function Ks(r,e=0){return kt(qs|e,r,!0)}function fe(r,e=[],t=[]){vl(e,t,s=>{kt(qs,()=>r(...s.map(c)),!0)})}function Gs(r,e=0){var t=kt(nr|e,r,!0);return t}function Cr(r,e=!0){return kt(Ct|us,r,!0,e)}function Oi(r){var e=r.teardown;if(e!==null){const t=lr,s=me;fa(!0),bt(null);try{e.call(null)}finally{fa(t),bt(s)}}}function ji(r,e=!1){var t=r.first;for(r.first=r.last=null;t!==null;){const n=t.ac;n!==null&&Dr(()=>{n.abort(Ln)});var s=t.next;(t.f&ar)!==0?t.parent=null:At(t,e),t=s}}function jl(r){for(var e=r.first;e!==null;){var t=e.next;(e.f&Ct)===0&&At(e),e=t}}function At(r,e=!0){var t=!1;(e||(r.f&ai)!==0)&&r.nodes_start!==null&&r.nodes_end!==null&&(Al(r.nodes_start,r.nodes_end),t=!0),ji(r,e&&!t),Ds(r,0),Ze(r,ir);var s=r.transitions;if(s!==null)for(const a of s)a.stop();Oi(r);var n=r.parent;n!==null&&n.first!==null&&Ai(r),r.next=r.prev=r.teardown=r.ctx=r.deps=r.fn=r.nodes_start=r.nodes_end=r.ac=null}function Al(r,e){for(;r!==null;){var t=r===e?null:Js(r);r.remove(),r=t}}function Ai(r){var e=r.parent,t=r.prev,s=r.next;t!==null&&(t.next=s),s!==null&&(s.prev=t),e!==null&&(e.first===r&&(e.first=s),e.last===r&&(e.last=t))}function Ys(r,e){var t=[];Bn(r,t,!0),Pi(t,()=>{At(r),e&&e()})}function Pi(r,e){var t=r.length;if(t>0){var s=()=>--t||e();for(var n of r)n.out(s)}else e()}function Bn(r,e,t){if((r.f&ft)===0){if(r.f^=ft,r.transitions!==null)for(const i of r.transitions)(i.is_global||t)&&e.push(i);for(var s=r.first;s!==null;){var n=s.next,a=(s.f&cs)!==0||(s.f&Ct)!==0;Bn(s,e,a?t:!1),s=n}}}function Wn(r){Ci(r,!0)}function Ci(r,e){if((r.f&ft)!==0){r.f^=ft,(r.f&Ve)===0&&(Ze(r,ct),Pr(r));for(var t=r.first;t!==null;){var s=t.next,n=(t.f&cs)!==0||(t.f&Ct)!==0;Ci(t,n?e:!1),t=s}if(r.transitions!==null)for(const a of r.transitions)(a.is_global||e)&&a.in()}}let Er=!1;function ha(r){Er=r}let lr=!1;function fa(r){lr=r}let me=null,yt=!1;function bt(r){me=r}let ge=null;function Wt(r){ge=r}let Qe=null;function Mi(r){me!==null&&(Qe===null?Qe=[r]:Qe.push(r))}let Ge=null,rt=0,ot=null;function Pl(r){ot=r}let Ii=1,rs=0,tr=rs;function va(r){tr=r}let qt=!1;function Ri(){return++Ii}function vs(r){var h;var e=r.f;if((e&ct)!==0)return!0;if((e&Mt)!==0){var t=r.deps,s=(e&lt)!==0;if(t!==null){var n,a,i=(e&Cs)!==0,o=s&&ge!==null&&!qt,l=t.length;if((i||o)&&(ge===null||(ge.f&ir)===0)){var u=r,d=u.parent;for(n=0;n<l;n++)a=t[n],(i||!((h=a==null?void 0:a.reactions)!=null&&h.includes(u)))&&(a.reactions??(a.reactions=[])).push(u);i&&(u.f^=Cs),o&&d!==null&&(d.f&lt)===0&&(u.f^=lt)}for(n=0;n<l;n++)if(a=t[n],vs(a)&&pi(a),a.wv>r.wv)return!0}(!s||ge!==null&&!qt)&&Ze(r,Ve)}return!1}function Di(r,e,t=!0){var s=r.reactions;if(s!==null&&!(Qe!=null&&Qe.includes(r)))for(var n=0;n<s.length;n++){var a=s[n];(a.f&at)!==0?Di(a,e,!1):e===a&&(t?Ze(a,ct):(a.f&Ve)!==0&&Ze(a,Mt),Pr(a))}}function $i(r){var k;var e=Ge,t=rt,s=ot,n=me,a=qt,i=Qe,o=xe,l=yt,u=tr,d=r.f;Ge=null,rt=0,ot=null,qt=(d&lt)!==0&&(yt||!Er||me===null),me=(d&(Ct|ar))===0?r:null,Qe=null,Ms(r.ctx),yt=!1,tr=++rs,r.ac!==null&&(Dr(()=>{r.ac.abort(Ln)}),r.ac=null);try{r.f|=pn;var h=r.fn,f=h(),p=r.deps;if(Ge!==null){var v;if(Ds(r,rt),p!==null&&rt>0)for(p.length=rt+Ge.length,v=0;v<Ge.length;v++)p[rt+v]=Ge[v];else r.deps=p=Ge;if(!qt||(d&at)!==0&&r.reactions!==null)for(v=rt;v<p.length;v++)((k=p[v]).reactions??(k.reactions=[])).push(r)}else p!==null&&rt<p.length&&(Ds(r,rt),p.length=rt);if(ds()&&ot!==null&&!yt&&p!==null&&(r.f&(at|Mt|ct))===0)for(v=0;v<ot.length;v++)Di(ot[v],r);return n!==null&&n!==r&&(rs++,ot!==null&&(s===null?s=ot:s.push(...ot))),(r.f&Xt)!==0&&(r.f^=Xt),f}catch(w){return ol(w)}finally{r.f^=pn,Ge=e,rt=t,ot=s,me=n,qt=a,Qe=i,Ms(o),yt=l,tr=u}}function Cl(r,e){let t=e.reactions;if(t!==null){var s=To.call(t,r);if(s!==-1){var n=t.length-1;n===0?t=e.reactions=null:(t[s]=t[n],t.pop())}}t===null&&(e.f&at)!==0&&(Ge===null||!Ge.includes(e))&&(Ze(e,Mt),(e.f&(lt|Cs))===0&&(e.f^=Cs),vi(e),Ds(e,0))}function Ds(r,e){var t=r.deps;if(t!==null)for(var s=e;s<t.length;s++)Cl(r,t[s])}function rr(r){var e=r.f;if((e&ir)===0){Ze(r,Ve);var t=ge,s=Er;ge=r,Er=!0;try{(e&nr)!==0?jl(r):ji(r),Oi(r);var n=$i(r);r.teardown=typeof n=="function"?n:null,r.wv=Ii;var a;ri&&nl&&(r.f&ct)!==0&&r.deps}finally{Er=s,ge=t}}}async function Li(){await Promise.resolve(),gl()}function c(r){var e=r.f,t=(e&at)!==0;if(me!==null&&!yt){var s=ge!==null&&(ge.f&ir)!==0;if(!s&&!(Qe!=null&&Qe.includes(r))){var n=me.deps;if((me.f&pn)!==0)r.rv<rs&&(r.rv=rs,Ge===null&&n!==null&&n[rt]===r?rt++:Ge===null?Ge=[r]:(!qt||!Ge.includes(r))&&Ge.push(r));else{(me.deps??(me.deps=[])).push(r);var a=r.reactions;a===null?r.reactions=[me]:a.includes(me)||a.push(me)}}}else if(t&&r.deps===null&&r.effects===null){var i=r,o=i.parent;o!==null&&(o.f&lt)===0&&(i.f^=lt)}if(lr){if(Ft.has(r))return Ft.get(r);if(t){i=r;var l=i.v;return((i.f&Ve)===0&&i.reactions!==null||Ui(i))&&(l=zn(i)),Ft.set(i,l),l}}else t&&(i=r,vs(i)&&pi(i));if((r.f&Xt)!==0)throw r.v;return r.v}function Ui(r){if(r.v===We)return!0;if(r.deps===null)return!1;for(const e of r.deps)if(Ft.has(e)||(e.f&at)!==0&&Ui(e))return!0;return!1}function It(r){var e=yt;try{return yt=!0,r()}finally{yt=e}}const Ml=-7169;function Ze(r,e){r.f=r.f&Ml|e}function zi(r){if(!(typeof r!="object"||!r||r instanceof EventTarget)){if(wt in r)mn(r);else if(!Array.isArray(r))for(let e in r){const t=r[e];typeof t=="object"&&t&&wt in t&&mn(t)}}}function mn(r,e=new Set){if(typeof r=="object"&&r!==null&&!(r instanceof EventTarget)&&!e.has(r)){e.add(r),r instanceof Date&&r.getTime();for(let s in r)try{mn(r[s],e)}catch{}const t=Rn(r);if(t!==Object.prototype&&t!==Array.prototype&&t!==Map.prototype&&t!==Set.prototype&&t!==Date.prototype){const s=si(t);for(let n in s){const a=s[n].get;if(a)try{a.call(r)}catch{}}}}}const Il=["touchstart","touchmove"];function Rl(r){return Il.includes(r)}const qi=new Set,yn=new Set;function Dl(r,e,t,s={}){function n(a){if(s.capture||Vr.call(e,a),!a.cancelBubble)return Dr(()=>t==null?void 0:t.call(this,a))}return r.startsWith("pointer")||r.startsWith("touch")||r==="wheel"?hs(()=>{e.addEventListener(r,n,s)}):e.addEventListener(r,n,s),n}function Ye(r,e,t,s,n){var a={capture:s,passive:n},i=Dl(r,e,t,a);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&Nn(()=>{e.removeEventListener(r,i,a)})}function cr(r){for(var e=0;e<r.length;e++)qi.add(r[e]);for(var t of yn)t(r)}let pa=null;function Vr(r){var P;var e=this,t=e.ownerDocument,s=r.type,n=((P=r.composedPath)==null?void 0:P.call(r))||[],a=n[0]||r.target;pa=r;var i=0,o=pa===r&&r.__root;if(o){var l=n.indexOf(o);if(l!==-1&&(e===document||e===window)){r.__root=e;return}var u=n.indexOf(e);if(u===-1)return;l<=u&&(i=l)}if(a=n[i]||r.target,a!==e){Ps(r,"currentTarget",{configurable:!0,get(){return a||t}});var d=me,h=ge;bt(null),Wt(null);try{for(var f,p=[];a!==null;){var v=a.assignedSlot||a.parentNode||a.host||null;try{var k=a["__"+s];if(k!=null&&(!a.disabled||r.target===a))if(Ir(k)){var[w,...j]=k;w.apply(a,[r,...j])}else k.call(a,r)}catch(x){f?p.push(x):f=x}if(r.cancelBubble||v===e||v===null)break;a=v}if(f){for(let x of p)queueMicrotask(()=>{throw x});throw f}}finally{r.__root=e,delete r.currentTarget,bt(d),Wt(h)}}}function Vn(r){var e;e=document.head.appendChild(or());try{Gs(()=>r(e),ai)}finally{}}function $l(r){var e=document.createElement("template");return e.innerHTML=r.replaceAll("<!>","<!---->"),e.content}function wn(r,e){var t=ge;t.nodes_start===null&&(t.nodes_start=r,t.nodes_end=e)}function N(r,e){var t=(e&Xo)!==0,s=(e&el)!==0,n,a=!r.startsWith("<!>");return()=>{n===void 0&&(n=$l(a?r:"<!>"+r),t||(n=Rs(n)));var i=s||bi?document.importNode(n,!0):n.cloneNode(!0);if(t){var o=Rs(i),l=i.lastChild;wn(o,l)}else wn(i,i);return i}}function Hn(r){return()=>Ll(r())}function Ll(r){const e=r.nodeType===Io,t=r.tagName==="SCRIPT"?[r]:r.querySelectorAll("script"),s=ge;for(const a of t){const i=document.createElement("script");for(var n of a.attributes)i.setAttribute(n.name,n.value);i.textContent=a.textContent,(e?r.firstChild===a:r===a)&&(s.nodes_start=i),(e?r.lastChild===a:r===a)&&(s.nodes_end=i),a.replaceWith(i)}return r}function Bt(){var r=document.createDocumentFragment(),e=document.createComment(""),t=or();return r.append(e,t),wn(e,t),r}function U(r,e){r!==null&&r.before(e)}let bn=!0;function re(r,e){var t=e==null?"":typeof e=="object"?e+"":e;t!==(r.__t??(r.__t=r.nodeValue))&&(r.__t=t,r.nodeValue=t+"")}function Ul(r,e){return zl(r,e)}const dr=new Map;function zl(r,{target:e,anchor:t,props:s={},events:n,context:a,intro:i=!0}){yl();var o=new Set,l=h=>{for(var f=0;f<h.length;f++){var p=h[f];if(!o.has(p)){o.add(p);var v=Rl(p);e.addEventListener(p,Vr,{passive:v});var k=dr.get(p);k===void 0?(document.addEventListener(p,Vr,{passive:v}),dr.set(p,1)):dr.set(p,k+1)}}};l(In(qi)),yn.add(l);var u=void 0,d=El(()=>{var h=t??e.appendChild(or());return Cr(()=>{if(a){Re({});var f=xe;f.c=a}n&&(s.$$events=n),bn=i,u=r(h,s)||{},bn=!0,a&&De()}),()=>{var v;for(var f of o){e.removeEventListener(f,Vr);var p=dr.get(f);--p===0?(document.removeEventListener(f,Vr),dr.delete(f)):dr.set(f,p)}yn.delete(l),h!==t&&((v=h.parentNode)==null||v.removeChild(h))}});return ql.set(u,d),u}let ql=new WeakMap;function le(r,e,t=!1){var s=r,n=null,a=null,i=We,o=t?cs:0,l=!1;const u=(p,v=!0)=>{l=!0,f(v,p)};var d=null;function h(){d!==null&&(d.lastChild.remove(),s.before(d),d=null);var p=i?n:a,v=i?a:n;p&&Wn(p),v&&Ys(v,()=>{i?a=null:n=null})}const f=(p,v)=>{if(i!==(i=p)){var k=qn(),w=s;if(k&&(d=document.createDocumentFragment(),d.append(w=or())),i?n??(n=v&&Cr(()=>v(w))):a??(a=v&&Cr(()=>v(w))),k){var j=Ee,P=i?n:a,x=i?a:n;P&&j.skipped_effects.delete(P),x&&j.skipped_effects.add(x),j.add_callback(h)}else h()}};Gs(()=>{l=!1,e(u),l||f(null,null)},o)}function Ce(r,e){return e}function Nl(r,e,t){for(var s=r.items,n=[],a=e.length,i=0;i<a;i++)Bn(e[i].e,n,!0);var o=a>0&&n.length===0&&t!==null;if(o){var l=t.parentNode;wl(l),l.append(t),s.clear(),mt(r,e[0].prev,e[a-1].next)}Pi(n,()=>{for(var u=0;u<a;u++){var d=e[u];o||(s.delete(d.k),mt(r,d.prev,d.next)),At(d.e,!o)}})}function Me(r,e,t,s,n,a=null){var i=r,o={flags:e,items:new Map,first:null},l=(e&li)!==0;if(l){var u=r;i=u.appendChild(or())}var d=null,h=!1,f=new Map,p=Vs(()=>{var j=t();return Ir(j)?j:j==null?[]:In(j)}),v,k;function w(){Fl(k,v,o,f,i,n,e,s,t),a!==null&&(v.length===0?d?Wn(d):d=Cr(()=>a(i)):d!==null&&Ys(d,()=>{d=null}))}Gs(()=>{k??(k=ge),v=c(p);var j=v.length;if(!(h&&j===0)){h=j===0;var P,x,E,T;if(qn()){var S=new Set,A=Ee;for(x=0;x<j;x+=1){E=v[x],T=s(E,x);var M=o.items.get(T)??f.get(T);M?(e&(Bs|Ws))!==0&&Ni(M,E,x,e):(P=Fi(null,o,null,null,E,T,x,n,e,t,!0),f.set(T,P)),S.add(T)}for(const[I,G]of o.items)S.has(I)||A.skipped_effects.add(G.e);A.add_callback(w)}else w();c(p)}})}function Fl(r,e,t,s,n,a,i,o,l){var ne,m,g,$;var u=(i&Vo)!==0,d=(i&(Bs|Ws))!==0,h=e.length,f=t.items,p=t.first,v=p,k,w=null,j,P=[],x=[],E,T,S,A;if(u)for(A=0;A<h;A+=1)E=e[A],T=o(E,A),S=f.get(T),S!==void 0&&((ne=S.a)==null||ne.measure(),(j??(j=new Set)).add(S));for(A=0;A<h;A+=1){if(E=e[A],T=o(E,A),S=f.get(T),S===void 0){var M=s.get(T);if(M!==void 0){s.delete(T),f.set(T,M);var I=w?w.next:v;mt(t,w,M),mt(t,M,I),sn(M,I,n),w=M}else{var G=v?v.e.nodes_start:n;w=Fi(G,t,w,w===null?t.first:w.next,E,T,A,a,i,l)}f.set(T,w),P=[],x=[],v=w.next;continue}if(d&&Ni(S,E,A,i),(S.e.f&ft)!==0&&(Wn(S.e),u&&((m=S.a)==null||m.unfix(),(j??(j=new Set)).delete(S))),S!==v){if(k!==void 0&&k.has(S)){if(P.length<x.length){var ae=x[0],V;w=ae.prev;var L=P[0],C=P[P.length-1];for(V=0;V<P.length;V+=1)sn(P[V],ae,n);for(V=0;V<x.length;V+=1)k.delete(x[V]);mt(t,L.prev,C.next),mt(t,w,L),mt(t,C,ae),v=ae,w=C,A-=1,P=[],x=[]}else k.delete(S),sn(S,v,n),mt(t,S.prev,S.next),mt(t,S,w===null?t.first:w.next),mt(t,w,S),w=S;continue}for(P=[],x=[];v!==null&&v.k!==T;)(v.e.f&ft)===0&&(k??(k=new Set)).add(v),x.push(v),v=v.next;if(v===null)continue;S=v}P.push(S),w=S,v=S.next}if(v!==null||k!==void 0){for(var R=k===void 0?[]:In(k);v!==null;)(v.e.f&ft)===0&&R.push(v),v=v.next;var D=R.length;if(D>0){var q=(i&li)!==0&&h===0?n:null;if(u){for(A=0;A<D;A+=1)(g=R[A].a)==null||g.measure();for(A=0;A<D;A+=1)($=R[A].a)==null||$.fix()}Nl(t,R,q)}}u&&hs(()=>{var F;if(j!==void 0)for(S of j)(F=S.a)==null||F.apply()}),r.first=t.first&&t.first.e,r.last=w&&w.e;for(var Q of s.values())At(Q.e);s.clear()}function Ni(r,e,t,s){(s&Bs)!==0&&ts(r.v,e),(s&Ws)!==0?ts(r.i,t):r.i=t}function Fi(r,e,t,s,n,a,i,o,l,u,d){var h=(l&Bs)!==0,f=(l&Ho)===0,p=h?f?er(n,!1,!1):es(n):n,v=(l&Ws)===0?i:es(i),k={i:v,v:p,k:a,a:null,e:null,prev:t,next:s};try{if(r===null){var w=document.createDocumentFragment();w.append(r=or())}return k.e=Cr(()=>o(r,p,v,u),sl),k.e.prev=t&&t.e,k.e.next=s&&s.e,t===null?d||(e.first=k):(t.next=k,t.e.next=k.e),s!==null&&(s.prev=k,s.e.prev=k.e),k}finally{}}function sn(r,e,t){for(var s=r.next?r.next.e.nodes_start:t,n=e?e.e.nodes_start:t,a=r.e.nodes_start;a!==null&&a!==s;){var i=Js(a);n.before(a),a=i}}function mt(r,e,t){e===null?r.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function ga(r,e,t){var s=r,n,a,i=null,o=null;function l(){a&&(Ys(a),a=null),i&&(i.lastChild.remove(),s.before(i),i=null),a=o,o=null}Gs(()=>{if(n!==(n=e())){var u=qn();if(n){var d=s;u&&(i=document.createDocumentFragment(),i.append(d=or()),a&&Ee.skipped_effects.add(a)),o=Cr(()=>t(d,n))}u?Ee.add_callback(l):l()}},cs)}function Bi(r){var e,t,s="";if(typeof r=="string"||typeof r=="number")s+=r;else if(typeof r=="object")if(Array.isArray(r)){var n=r.length;for(e=0;e<n;e++)r[e]&&(t=Bi(r[e]))&&(s&&(s+=" "),s+=t)}else for(t in r)r[t]&&(s&&(s+=" "),s+=t);return s}function Bl(){for(var r,e,t=0,s="",n=arguments.length;t<n;t++)(r=arguments[t])&&(e=Bi(r))&&(s&&(s+=" "),s+=e);return s}function $s(r){return typeof r=="object"?Bl(r):r??""}const _a=[...` 	
\r\fÂ \v\uFEFF`];function Wl(r,e,t){var s=r==null?"":""+r;if(e&&(s=s?s+" "+e:e),t){for(var n in t)if(t[n])s=s?s+" "+n:n;else if(s.length)for(var a=n.length,i=0;(i=s.indexOf(n,i))>=0;){var o=i+a;(i===0||_a.includes(s[i-1]))&&(o===s.length||_a.includes(s[o]))?s=(i===0?"":s.substring(0,i))+s.substring(o+1):i=o}}return s===""?null:s}function Vl(r,e){return r==null?null:String(r)}function st(r,e,t,s,n,a){var i=r.__className;if(i!==t||i===void 0){var o=Wl(t,s,a);o==null?r.removeAttribute("class"):r.className=o,r.__className=t}else if(a&&n!==a)for(var l in a){var u=!!a[l];(n==null||u!==!!n[l])&&r.classList.toggle(l,u)}return a}function Hl(r,e,t,s){var n=r.__style;if(n!==e){var a=Vl(e);a==null?r.removeAttribute("style"):r.style.cssText=a,r.__style=e}return s}function Wi(r,e,t=!1){if(r.multiple){if(e==null)return;if(!Ir(e))return rl();for(var s of r.options)s.selected=e.includes(Kr(s));return}for(s of r.options){var n=Kr(s);if(ml(n,e)){s.selected=!0;return}}(!t||e!==void 0)&&(r.selectedIndex=-1)}function Jl(r){var e=new MutationObserver(()=>{Wi(r,r.__value)});e.observe(r,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Nn(()=>{e.disconnect()})}function He(r,e,t=e){var s=!0;Ei(r,"change",n=>{var a=n?"[selected]":":checked",i;if(r.multiple)i=[].map.call(r.querySelectorAll(a),Kr);else{var o=r.querySelector(a)??r.querySelector("option:not([disabled])");i=o&&Kr(o)}t(i)}),Fn(()=>{var n=e();if(Wi(r,n,s),s&&n===void 0){var a=r.querySelector(":checked");a!==null&&(n=Kr(a),t(n))}r.__value=n,s=!1}),Jl(r)}function Kr(r){return"__value"in r?r.__value:r.value}const Kl=Symbol("is custom element"),Gl=Symbol("is html");function ze(r,e,t,s){var n=Yl(r);n[e]!==(n[e]=t)&&(e==="loading"&&(r[Mo]=t),t==null?r.removeAttribute(e):typeof t!="string"&&Ql(r).includes(e)?r[e]=t:r.setAttribute(e,t))}function Yl(r){return r.__attributes??(r.__attributes={[Kl]:r.nodeName.includes("-"),[Gl]:r.namespaceURI===tl})}var ma=new Map;function Ql(r){var e=r.getAttribute("is")||r.nodeName,t=ma.get(e);if(t)return t;ma.set(e,t=[]);for(var s,n=r,a=Element.prototype;a!==n;){s=si(n);for(var i in s)s[i].set&&t.push(i);n=Rn(n)}return t}const Zl=()=>performance.now(),jt={tick:r=>requestAnimationFrame(r),now:()=>Zl(),tasks:new Set};function Vi(){const r=jt.now();jt.tasks.forEach(e=>{e.c(r)||(jt.tasks.delete(e),e.f())}),jt.tasks.size!==0&&jt.tick(Vi)}function Xl(r){let e;return jt.tasks.size===0&&jt.tick(Vi),{promise:new Promise(t=>{jt.tasks.add(e={c:r,f:t})}),abort(){jt.tasks.delete(e)}}}function ws(r,e){Dr(()=>{r.dispatchEvent(new CustomEvent(e))})}function ec(r){if(r==="float")return"cssFloat";if(r==="offset")return"cssOffset";if(r.startsWith("--"))return r;const e=r.split("-");return e.length===1?e[0]:e[0]+e.slice(1).map(t=>t[0].toUpperCase()+t.slice(1)).join("")}function ya(r){const e={},t=r.split(";");for(const s of t){const[n,a]=s.split(":");if(!n||a===void 0)break;const i=ec(n.trim());e[i]=a.trim()}return e}const tc=r=>r;function rc(r,e,t,s){var n=(r&Zo)!==0,a="both",i,o=e.inert,l=e.style.overflow,u,d;function h(){return Dr(()=>i??(i=t()(e,(s==null?void 0:s())??{},{direction:a})))}var f={is_global:n,in(){e.inert=o,ws(e,"introstart"),u=kn(e,h(),d,1,()=>{ws(e,"introend"),u==null||u.abort(),u=i=void 0,e.style.overflow=l})},out(w){e.inert=!0,ws(e,"outrostart"),d=kn(e,h(),u,0,()=>{ws(e,"outroend"),w==null||w()})},stop:()=>{u==null||u.abort(),d==null||d.abort()}},p=ge;if((p.transitions??(p.transitions=[])).push(f),bn){var v=n;if(!v){for(var k=p.parent;k&&(k.f&cs)!==0;)for(;(k=k.parent)&&(k.f&nr)===0;);v=!k||(k.f&Ns)!==0}v&&Fn(()=>{It(()=>f.in())})}}function kn(r,e,t,s,n){var a=s===1;if(kr(e)){var i,o=!1;return hs(()=>{if(!o){var w=e({direction:a?"in":"out"});i=kn(r,w,t,s,n)}}),{abort:()=>{o=!0,i==null||i.abort()},deactivate:()=>i.deactivate(),reset:()=>i.reset(),t:()=>i.t()}}if(t==null||t.deactivate(),!(e!=null&&e.duration))return n(),{abort:nt,deactivate:nt,reset:nt,t:()=>s};const{delay:l=0,css:u,tick:d,easing:h=tc}=e;var f=[];if(a&&t===void 0&&(d&&d(0,1),u)){var p=ya(u(0,1));f.push(p,p)}var v=()=>1-s,k=r.animate(f,{duration:l,fill:"forwards"});return k.onfinish=()=>{k.cancel();var w=(t==null?void 0:t.t())??1-s;t==null||t.abort();var j=s-w,P=e.duration*Math.abs(j),x=[];if(P>0){var E=!1;if(u)for(var T=Math.ceil(P/16.666666666666668),S=0;S<=T;S+=1){var A=w+j*h(S/T),M=ya(u(A,1-A));x.push(M),E||(E=M.overflow==="hidden")}E&&(r.style.overflow="hidden"),v=()=>{var I=k.currentTime;return w+j*h(I/P)},d&&Xl(()=>{if(k.playState!=="running")return!1;var I=v();return d(I,1-I),!0})}k=r.animate(x,{duration:P,fill:"forwards"}),k.onfinish=()=>{v=()=>s,d==null||d(s,1-s),n()}},{abort:()=>{k&&(k.cancel(),k.effect=null,k.onfinish=nt)},deactivate:()=>{n=nt},reset:()=>{s===0&&(d==null||d(1,0))},t:()=>v()}}function pt(r,e,t=e){var s=new WeakSet;Ei(r,"input",async n=>{var a=n?r.defaultValue:r.value;if(a=nn(r)?an(a):a,t(a),Ee!==null&&s.add(Ee),await Li(),a!==(a=e())){var i=r.selectionStart,o=r.selectionEnd;r.value=a??"",o!==null&&(r.selectionStart=i,r.selectionEnd=Math.min(o,r.value.length))}}),It(e)==null&&r.value&&(t(nn(r)?an(r.value):r.value),Ee!==null&&s.add(Ee)),Ks(()=>{var n=e();if(r===document.activeElement){var a=js??Ee;if(s.has(a))return}nn(r)&&n===an(r.value)||r.type==="date"&&!n&&!r.value||n!==r.value&&(r.value=n??"")})}function nn(r){var e=r.type;return e==="number"||e==="range"}function an(r){return r===""?null:+r}function wa(r,e){return r===e||(r==null?void 0:r[wt])===e}function ht(r={},e,t,s){return Fn(()=>{var n,a;return Ks(()=>{n=a,a=[],It(()=>{r!==t(...a)&&(e(r,...a),n&&wa(t(...n),r)&&e(null,...n))})}),()=>{hs(()=>{a&&wa(t(...a),r)&&e(null,...a)})}}),r}function Jn(r=!1){const e=xe,t=e.l.u;if(!t)return;let s=()=>zi(e.s);if(r){let n=0,a={};const i=fs(()=>{let o=!1;const l=e.s;for(const u in l)l[u]!==a[u]&&(a[u]=l[u],o=!0);return o&&n++,n});s=()=>c(i)}t.b.length&&Sl(()=>{ba(e,s),Zr(t.b)}),Se(()=>{const n=It(()=>t.m.map(Ao));return()=>{for(const a of n)typeof a=="function"&&a()}}),t.a.length&&Se(()=>{ba(e,s),Zr(t.a)})}function ba(r,e){if(r.l.s)for(const t of r.l.s)c(t);e()}function ka(r,e){var a;var t=(a=r.$$events)==null?void 0:a[e.type],s=Ir(t)?t.slice():t==null?[]:[t];for(var n of s)n.call(this,e)}function Kn(r,e,t){if(r==null)return e(void 0),t&&t(void 0),nt;const s=It(()=>r.subscribe(e,t));return s.unsubscribe?()=>s.unsubscribe():s}const hr=[];function Hi(r,e){return{subscribe:Ji(r,e).subscribe}}function Ji(r,e=nt){let t=null;const s=new Set;function n(o){if(ui(r,o)&&(r=o,t)){const l=!hr.length;for(const u of s)u[1](),hr.push(u,r);if(l){for(let u=0;u<hr.length;u+=2)hr[u][0](hr[u+1]);hr.length=0}}}function a(o){n(o(r))}function i(o,l=nt){const u=[o,l];return s.add(u),s.size===1&&(t=e(n,a)||nt),o(r),()=>{s.delete(u),s.size===0&&t&&(t(),t=null)}}return{set:n,update:a,subscribe:i}}function Ki(r,e,t){const s=!Array.isArray(r),n=s?[r]:r;if(!n.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const a=e.length<2;return Hi(t,(i,o)=>{let l=!1;const u=[];let d=0,h=nt;const f=()=>{if(d)return;h();const v=e(s?u[0]:u,i,o);a?i(v):h=typeof v=="function"?v:nt},p=n.map((v,k)=>Kn(v,w=>{u[k]=w,d&=~(1<<k),l&&f()},()=>{d|=1<<k}));return l=!0,f(),function(){Zr(p),h(),l=!1}})}function sc(r){let e;return Kn(r,t=>e=t)(),e}let bs=!1,Sn=Symbol();function $r(r,e,t){const s=t[e]??(t[e]={store:null,source:er(void 0),unsubscribe:nt});if(s.store!==r&&!(Sn in t))if(s.unsubscribe(),s.store=r??null,r==null)s.source.v=void 0,s.unsubscribe=nt;else{var n=!0;s.unsubscribe=Kn(r,a=>{n?s.source.v=a:_(s.source,a)}),n=!1}return r&&Sn in t?sc(r):c(s.source)}function Lr(){const r={};function e(){Nn(()=>{for(var t in r)r[t].unsubscribe();Ps(r,Sn,{enumerable:!1,value:!0})})}return[r,e]}function nc(r){var e=bs;try{return bs=!1,[r(),bs]}finally{bs=e}}const ac={get(r,e){let t=r.props.length;for(;t--;){let s=r.props[t];if(kr(s)&&(s=s()),typeof s=="object"&&s!==null&&e in s)return s[e]}},set(r,e,t){let s=r.props.length;for(;s--;){let n=r.props[s];kr(n)&&(n=n());const a=Nt(n,e);if(a&&a.set)return a.set(t),!0}return!1},getOwnPropertyDescriptor(r,e){let t=r.props.length;for(;t--;){let s=r.props[t];if(kr(s)&&(s=s()),typeof s=="object"&&s!==null&&e in s){const n=Nt(s,e);return n&&!n.configurable&&(n.configurable=!0),n}}},has(r,e){if(e===wt||e===oi)return!1;for(let t of r.props)if(kr(t)&&(t=t()),t!=null&&e in t)return!0;return!1},ownKeys(r){const e=[];for(let t of r.props)if(kr(t)&&(t=t()),!!t){for(const s in t)e.includes(s)||e.push(s);for(const s of Object.getOwnPropertySymbols(t))e.includes(s)||e.push(s)}return e}};function Sa(...r){return new Proxy({props:r},ac)}function ye(r,e,t,s){var x;var n=!Rr||(t&Ko)!==0,a=(t&Yo)!==0,i=(t&Qo)!==0,o=s,l=!0,u=()=>(l&&(l=!1,o=i?It(s):s),o),d;if(a){var h=wt in r||oi in r;d=((x=Nt(r,e))==null?void 0:x.set)??(h&&e in r?E=>r[e]=E:void 0)}var f,p=!1;a?[f,p]=nc(()=>r[e]):f=r[e],f===void 0&&s!==void 0&&(f=u(),d&&(n&&No(),d(f)));var v;if(n?v=()=>{var E=r[e];return E===void 0?u():(l=!0,E)}:v=()=>{var E=r[e];return E!==void 0&&(o=void 0),E===void 0?o:E},n&&(t&Go)===0)return v;if(d){var k=r.$$legacy;return function(E,T){return arguments.length>0?((!n||!T||k||p)&&d(T?v():E),E):v()}}var w=!1,j=((t&Jo)!==0?fs:Vs)(()=>(w=!1,v()));a&&c(j);var P=ge;return function(E,T){if(arguments.length>0){const S=T?c(j):n&&a?W(E):E;return _(j,S),w=!0,o!==void 0&&(o=S),E}return lr&&w||(P.f&ir)!==0?j.v:c(j)}}function tt(r){xe===null&&Fs(),Rr&&xe.l!==null?Gi(xe).m.push(r):Se(()=>{const e=It(r);if(typeof e=="function")return e})}function ic(r){xe===null&&Fs(),tt(()=>()=>It(r))}function oc(r,e,{bubbles:t=!1,cancelable:s=!1}={}){return new CustomEvent(r,{detail:e,bubbles:t,cancelable:s})}function lc(){const r=xe;return r===null&&Fs(),(e,t,s)=>{var a;const n=(a=r.s.$$events)==null?void 0:a[e];if(n){const i=Ir(n)?n.slice():[n],o=oc(e,t,s);for(const l of i)l.call(r.x,o);return!o.defaultPrevented}return!0}}function cc(r){xe===null&&Fs(),xe.l===null&&qo(),Gi(xe).a.push(r)}function Gi(r){var e=r.l;return e.u??(e.u={a:[],b:[],m:[]})}const uc="5";var ti;typeof window<"u"&&((ti=window.__svelte??(window.__svelte={})).v??(ti.v=new Set)).add(uc);const dc="modulepreload",hc=function(r){return"/"+r},Ea={},ps=function(e,t,s){let n=Promise.resolve();if(t&&t.length>0){let i=function(u){return Promise.all(u.map(d=>Promise.resolve(d).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));n=i(t.map(u=>{if(u=hc(u),u in Ea)return;Ea[u]=!0;const d=u.endsWith(".css"),h=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${h}`))return;const f=document.createElement("link");if(f.rel=d?"stylesheet":dc,d||(f.as="script"),f.crossOrigin="",f.href=u,l&&f.setAttribute("nonce",l),document.head.appendChild(f),d)return new Promise((p,v)=>{f.addEventListener("load",p),f.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${u}`)))})}))}function a(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return n.then(i=>{for(const o of i||[])o.status==="rejected"&&a(o.reason);return e().catch(a)})},fc=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>ps(async()=>{const{default:s}=await Promise.resolve().then(()=>Ur);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)};class Gn extends Error{constructor(e,t="FunctionsError",s){super(e),this.name=t,this.context=s}}class vc extends Gn{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class pc extends Gn{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class gc extends Gn{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var En;(function(r){r.Any="any",r.ApNortheast1="ap-northeast-1",r.ApNortheast2="ap-northeast-2",r.ApSouth1="ap-south-1",r.ApSoutheast1="ap-southeast-1",r.ApSoutheast2="ap-southeast-2",r.CaCentral1="ca-central-1",r.EuCentral1="eu-central-1",r.EuWest1="eu-west-1",r.EuWest2="eu-west-2",r.EuWest3="eu-west-3",r.SaEast1="sa-east-1",r.UsEast1="us-east-1",r.UsWest1="us-west-1",r.UsWest2="us-west-2"})(En||(En={}));var _c=function(r,e,t,s){function n(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(d){try{u(s.next(d))}catch(h){i(h)}}function l(d){try{u(s.throw(d))}catch(h){i(h)}}function u(d){d.done?a(d.value):n(d.value).then(o,l)}u((s=s.apply(r,e||[])).next())})};class mc{constructor(e,{headers:t={},customFetch:s,region:n=En.Any}={}){this.url=e,this.headers=t,this.region=n,this.fetch=fc(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var s;return _c(this,void 0,void 0,function*(){try{const{headers:n,method:a,body:i}=t;let o={},{region:l}=t;l||(l=this.region),l&&l!=="any"&&(o["x-region"]=l);let u;i&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&(typeof Blob<"u"&&i instanceof Blob||i instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",u=i):typeof i=="string"?(o["Content-Type"]="text/plain",u=i):typeof FormData<"u"&&i instanceof FormData?u=i:(o["Content-Type"]="application/json",u=JSON.stringify(i)));const d=yield this.fetch(`${this.url}/${e}`,{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),n),body:u}).catch(v=>{throw new vc(v)}),h=d.headers.get("x-relay-error");if(h&&h==="true")throw new pc(d);if(!d.ok)throw new gc(d);let f=((s=d.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),p;return f==="application/json"?p=yield d.json():f==="application/octet-stream"?p=yield d.blob():f==="text/event-stream"?p=d:f==="multipart/form-data"?p=yield d.formData():p=yield d.text(),{data:p,error:null}}catch(n){return{data:null,error:n}}})}}function yc(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function wc(r){if(Object.prototype.hasOwnProperty.call(r,"__esModule"))return r;var e=r.default;if(typeof e=="function"){var t=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(r).forEach(function(s){var n=Object.getOwnPropertyDescriptor(r,s);Object.defineProperty(t,s,n.get?n:{enumerable:!0,get:function(){return r[s]}})}),t}var Ne={},fr={},vr={},pr={},gr={},_r={},bc=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Mr=bc();const kc=Mr.fetch,Yi=Mr.fetch.bind(Mr),Qi=Mr.Headers,Sc=Mr.Request,Ec=Mr.Response,Ur=Object.freeze(Object.defineProperty({__proto__:null,Headers:Qi,Request:Sc,Response:Ec,default:Yi,fetch:kc},Symbol.toStringTag,{value:"Module"})),xc=wc(Ur);var ks={},xa;function Zi(){if(xa)return ks;xa=1,Object.defineProperty(ks,"__esModule",{value:!0});class r extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return ks.default=r,ks}var Ta;function Xi(){if(Ta)return _r;Ta=1;var r=_r&&_r.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(_r,"__esModule",{value:!0});const e=r(xc),t=r(Zi());class s{constructor(a){this.shouldThrowOnError=!1,this.method=a.method,this.url=a.url,this.headers=a.headers,this.schema=a.schema,this.body=a.body,this.shouldThrowOnError=a.shouldThrowOnError,this.signal=a.signal,this.isMaybeSingle=a.isMaybeSingle,a.fetch?this.fetch=a.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(a,i){return this.headers=Object.assign({},this.headers),this.headers[a]=i,this}then(a,i){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const o=this.fetch;let l=o(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async u=>{var d,h,f;let p=null,v=null,k=null,w=u.status,j=u.statusText;if(u.ok){if(this.method!=="HEAD"){const T=await u.text();T===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?v=T:v=JSON.parse(T))}const x=(d=this.headers.Prefer)===null||d===void 0?void 0:d.match(/count=(exact|planned|estimated)/),E=(h=u.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");x&&E&&E.length>1&&(k=parseInt(E[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(v)&&(v.length>1?(p={code:"PGRST116",details:`Results contain ${v.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},v=null,k=null,w=406,j="Not Acceptable"):v.length===1?v=v[0]:v=null)}else{const x=await u.text();try{p=JSON.parse(x),Array.isArray(p)&&u.status===404&&(v=[],p=null,w=200,j="OK")}catch{u.status===404&&x===""?(w=204,j="No Content"):p={message:x}}if(p&&this.isMaybeSingle&&(!((f=p==null?void 0:p.details)===null||f===void 0)&&f.includes("0 rows"))&&(p=null,w=200,j="OK"),p&&this.shouldThrowOnError)throw new t.default(p)}return{error:p,data:v,count:k,status:w,statusText:j}});return this.shouldThrowOnError||(l=l.catch(u=>{var d,h,f;return{error:{message:`${(d=u==null?void 0:u.name)!==null&&d!==void 0?d:"FetchError"}: ${u==null?void 0:u.message}`,details:`${(h=u==null?void 0:u.stack)!==null&&h!==void 0?h:""}`,hint:"",code:`${(f=u==null?void 0:u.code)!==null&&f!==void 0?f:""}`},data:null,count:null,status:0,statusText:""}})),l.then(a,i)}returns(){return this}overrideTypes(){return this}}return _r.default=s,_r}var Oa;function eo(){if(Oa)return gr;Oa=1;var r=gr&&gr.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(gr,"__esModule",{value:!0});const e=r(Xi());class t extends e.default{select(n){let a=!1;const i=(n??"*").split("").map(o=>/\s/.test(o)&&!a?"":(o==='"'&&(a=!a),o)).join("");return this.url.searchParams.set("select",i),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(n,{ascending:a=!0,nullsFirst:i,foreignTable:o,referencedTable:l=o}={}){const u=l?`${l}.order`:"order",d=this.url.searchParams.get(u);return this.url.searchParams.set(u,`${d?`${d},`:""}${n}.${a?"asc":"desc"}${i===void 0?"":i?".nullsfirst":".nullslast"}`),this}limit(n,{foreignTable:a,referencedTable:i=a}={}){const o=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(o,`${n}`),this}range(n,a,{foreignTable:i,referencedTable:o=i}={}){const l=typeof o>"u"?"offset":`${o}.offset`,u=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(l,`${n}`),this.url.searchParams.set(u,`${a-n+1}`),this}abortSignal(n){return this.signal=n,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:n=!1,verbose:a=!1,settings:i=!1,buffers:o=!1,wal:l=!1,format:u="text"}={}){var d;const h=[n?"analyze":null,a?"verbose":null,i?"settings":null,o?"buffers":null,l?"wal":null].filter(Boolean).join("|"),f=(d=this.headers.Accept)!==null&&d!==void 0?d:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${u}; for="${f}"; options=${h};`,u==="json"?this:this}rollback(){var n;return((n=this.headers.Prefer)!==null&&n!==void 0?n:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return gr.default=t,gr}var ja;function Yn(){if(ja)return pr;ja=1;var r=pr&&pr.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(pr,"__esModule",{value:!0});const e=r(eo());class t extends e.default{eq(n,a){return this.url.searchParams.append(n,`eq.${a}`),this}neq(n,a){return this.url.searchParams.append(n,`neq.${a}`),this}gt(n,a){return this.url.searchParams.append(n,`gt.${a}`),this}gte(n,a){return this.url.searchParams.append(n,`gte.${a}`),this}lt(n,a){return this.url.searchParams.append(n,`lt.${a}`),this}lte(n,a){return this.url.searchParams.append(n,`lte.${a}`),this}like(n,a){return this.url.searchParams.append(n,`like.${a}`),this}likeAllOf(n,a){return this.url.searchParams.append(n,`like(all).{${a.join(",")}}`),this}likeAnyOf(n,a){return this.url.searchParams.append(n,`like(any).{${a.join(",")}}`),this}ilike(n,a){return this.url.searchParams.append(n,`ilike.${a}`),this}ilikeAllOf(n,a){return this.url.searchParams.append(n,`ilike(all).{${a.join(",")}}`),this}ilikeAnyOf(n,a){return this.url.searchParams.append(n,`ilike(any).{${a.join(",")}}`),this}is(n,a){return this.url.searchParams.append(n,`is.${a}`),this}in(n,a){const i=Array.from(new Set(a)).map(o=>typeof o=="string"&&new RegExp("[,()]").test(o)?`"${o}"`:`${o}`).join(",");return this.url.searchParams.append(n,`in.(${i})`),this}contains(n,a){return typeof a=="string"?this.url.searchParams.append(n,`cs.${a}`):Array.isArray(a)?this.url.searchParams.append(n,`cs.{${a.join(",")}}`):this.url.searchParams.append(n,`cs.${JSON.stringify(a)}`),this}containedBy(n,a){return typeof a=="string"?this.url.searchParams.append(n,`cd.${a}`):Array.isArray(a)?this.url.searchParams.append(n,`cd.{${a.join(",")}}`):this.url.searchParams.append(n,`cd.${JSON.stringify(a)}`),this}rangeGt(n,a){return this.url.searchParams.append(n,`sr.${a}`),this}rangeGte(n,a){return this.url.searchParams.append(n,`nxl.${a}`),this}rangeLt(n,a){return this.url.searchParams.append(n,`sl.${a}`),this}rangeLte(n,a){return this.url.searchParams.append(n,`nxr.${a}`),this}rangeAdjacent(n,a){return this.url.searchParams.append(n,`adj.${a}`),this}overlaps(n,a){return typeof a=="string"?this.url.searchParams.append(n,`ov.${a}`):this.url.searchParams.append(n,`ov.{${a.join(",")}}`),this}textSearch(n,a,{config:i,type:o}={}){let l="";o==="plain"?l="pl":o==="phrase"?l="ph":o==="websearch"&&(l="w");const u=i===void 0?"":`(${i})`;return this.url.searchParams.append(n,`${l}fts${u}.${a}`),this}match(n){return Object.entries(n).forEach(([a,i])=>{this.url.searchParams.append(a,`eq.${i}`)}),this}not(n,a,i){return this.url.searchParams.append(n,`not.${a}.${i}`),this}or(n,{foreignTable:a,referencedTable:i=a}={}){const o=i?`${i}.or`:"or";return this.url.searchParams.append(o,`(${n})`),this}filter(n,a,i){return this.url.searchParams.append(n,`${a}.${i}`),this}}return pr.default=t,pr}var Aa;function to(){if(Aa)return vr;Aa=1;var r=vr&&vr.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(vr,"__esModule",{value:!0});const e=r(Yn());class t{constructor(n,{headers:a={},schema:i,fetch:o}){this.url=n,this.headers=a,this.schema=i,this.fetch=o}select(n,{head:a=!1,count:i}={}){const o=a?"HEAD":"GET";let l=!1;const u=(n??"*").split("").map(d=>/\s/.test(d)&&!l?"":(d==='"'&&(l=!l),d)).join("");return this.url.searchParams.set("select",u),i&&(this.headers.Prefer=`count=${i}`),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(n,{count:a,defaultToNull:i=!0}={}){const o="POST",l=[];if(this.headers.Prefer&&l.push(this.headers.Prefer),a&&l.push(`count=${a}`),i||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(n)){const u=n.reduce((d,h)=>d.concat(Object.keys(h)),[]);if(u.length>0){const d=[...new Set(u)].map(h=>`"${h}"`);this.url.searchParams.set("columns",d.join(","))}}return new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}upsert(n,{onConflict:a,ignoreDuplicates:i=!1,count:o,defaultToNull:l=!0}={}){const u="POST",d=[`resolution=${i?"ignore":"merge"}-duplicates`];if(a!==void 0&&this.url.searchParams.set("on_conflict",a),this.headers.Prefer&&d.push(this.headers.Prefer),o&&d.push(`count=${o}`),l||d.push("missing=default"),this.headers.Prefer=d.join(","),Array.isArray(n)){const h=n.reduce((f,p)=>f.concat(Object.keys(p)),[]);if(h.length>0){const f=[...new Set(h)].map(p=>`"${p}"`);this.url.searchParams.set("columns",f.join(","))}}return new e.default({method:u,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}update(n,{count:a}={}){const i="PATCH",o=[];return this.headers.Prefer&&o.push(this.headers.Prefer),a&&o.push(`count=${a}`),this.headers.Prefer=o.join(","),new e.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}delete({count:n}={}){const a="DELETE",i=[];return n&&i.push(`count=${n}`),this.headers.Prefer&&i.unshift(this.headers.Prefer),this.headers.Prefer=i.join(","),new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return vr.default=t,vr}var Br={},Wr={},Pa;function Tc(){return Pa||(Pa=1,Object.defineProperty(Wr,"__esModule",{value:!0}),Wr.version=void 0,Wr.version="0.0.0-automated"),Wr}var Ca;function Oc(){if(Ca)return Br;Ca=1,Object.defineProperty(Br,"__esModule",{value:!0}),Br.DEFAULT_HEADERS=void 0;const r=Tc();return Br.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${r.version}`},Br}var Ma;function jc(){if(Ma)return fr;Ma=1;var r=fr&&fr.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(fr,"__esModule",{value:!0});const e=r(to()),t=r(Yn()),s=Oc();class n{constructor(i,{headers:o={},schema:l,fetch:u}={}){this.url=i,this.headers=Object.assign(Object.assign({},s.DEFAULT_HEADERS),o),this.schemaName=l,this.fetch=u}from(i){const o=new URL(`${this.url}/${i}`);return new e.default(o,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(i){return new n(this.url,{headers:this.headers,schema:i,fetch:this.fetch})}rpc(i,o={},{head:l=!1,get:u=!1,count:d}={}){let h;const f=new URL(`${this.url}/rpc/${i}`);let p;l||u?(h=l?"HEAD":"GET",Object.entries(o).filter(([k,w])=>w!==void 0).map(([k,w])=>[k,Array.isArray(w)?`{${w.join(",")}}`:`${w}`]).forEach(([k,w])=>{f.searchParams.append(k,w)})):(h="POST",p=o);const v=Object.assign({},this.headers);return d&&(v.Prefer=`count=${d}`),new t.default({method:h,url:f,headers:v,schema:this.schemaName,body:p,fetch:this.fetch,allowEmpty:!1})}}return fr.default=n,fr}var Ia;function Ac(){if(Ia)return Ne;Ia=1;var r=Ne&&Ne.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(Ne,"__esModule",{value:!0}),Ne.PostgrestError=Ne.PostgrestBuilder=Ne.PostgrestTransformBuilder=Ne.PostgrestFilterBuilder=Ne.PostgrestQueryBuilder=Ne.PostgrestClient=void 0;const e=r(jc());Ne.PostgrestClient=e.default;const t=r(to());Ne.PostgrestQueryBuilder=t.default;const s=r(Yn());Ne.PostgrestFilterBuilder=s.default;const n=r(eo());Ne.PostgrestTransformBuilder=n.default;const a=r(Xi());Ne.PostgrestBuilder=a.default;const i=r(Zi());return Ne.PostgrestError=i.default,Ne.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:s.default,PostgrestTransformBuilder:n.default,PostgrestBuilder:a.default,PostgrestError:i.default},Ne}var Pc=Ac();const Cc=yc(Pc),{PostgrestClient:Mc,PostgrestQueryBuilder:Df,PostgrestFilterBuilder:$f,PostgrestTransformBuilder:Lf,PostgrestBuilder:Uf,PostgrestError:zf}=Cc;let xn;typeof window>"u"?xn=require("ws"):xn=window.WebSocket;const Ic="2.11.10",Rc={"X-Client-Info":`realtime-js/${Ic}`},Dc="1.0.0",ro=1e4,$c=1e3;var xr;(function(r){r[r.connecting=0]="connecting",r[r.open=1]="open",r[r.closing=2]="closing",r[r.closed=3]="closed"})(xr||(xr={}));var Ke;(function(r){r.closed="closed",r.errored="errored",r.joined="joined",r.joining="joining",r.leaving="leaving"})(Ke||(Ke={}));var dt;(function(r){r.close="phx_close",r.error="phx_error",r.join="phx_join",r.reply="phx_reply",r.leave="phx_leave",r.access_token="access_token"})(dt||(dt={}));var Tn;(function(r){r.websocket="websocket"})(Tn||(Tn={}));var Yt;(function(r){r.Connecting="connecting",r.Open="open",r.Closing="closing",r.Closed="closed"})(Yt||(Yt={}));class Lc{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,t,s)}_decodeBroadcast(e,t,s){const n=t.getUint8(1),a=t.getUint8(2);let i=this.HEADER_LENGTH+2;const o=s.decode(e.slice(i,i+n));i=i+n;const l=s.decode(e.slice(i,i+a));i=i+a;const u=JSON.parse(s.decode(e.slice(i,e.byteLength)));return{ref:null,topic:o,event:l,payload:u}}}class so{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Te;(function(r){r.abstime="abstime",r.bool="bool",r.date="date",r.daterange="daterange",r.float4="float4",r.float8="float8",r.int2="int2",r.int4="int4",r.int4range="int4range",r.int8="int8",r.int8range="int8range",r.json="json",r.jsonb="jsonb",r.money="money",r.numeric="numeric",r.oid="oid",r.reltime="reltime",r.text="text",r.time="time",r.timestamp="timestamp",r.timestamptz="timestamptz",r.timetz="timetz",r.tsrange="tsrange",r.tstzrange="tstzrange"})(Te||(Te={}));const Ra=(r,e,t={})=>{var s;const n=(s=t.skipTypes)!==null&&s!==void 0?s:[];return Object.keys(e).reduce((a,i)=>(a[i]=Uc(i,r,e,n),a),{})},Uc=(r,e,t,s)=>{const n=e.find(o=>o.name===r),a=n==null?void 0:n.type,i=t[r];return a&&!s.includes(a)?no(a,i):On(i)},no=(r,e)=>{if(r.charAt(0)==="_"){const t=r.slice(1,r.length);return Fc(e,t)}switch(r){case Te.bool:return zc(e);case Te.float4:case Te.float8:case Te.int2:case Te.int4:case Te.int8:case Te.numeric:case Te.oid:return qc(e);case Te.json:case Te.jsonb:return Nc(e);case Te.timestamp:return Bc(e);case Te.abstime:case Te.date:case Te.daterange:case Te.int4range:case Te.int8range:case Te.money:case Te.reltime:case Te.text:case Te.time:case Te.timestamptz:case Te.timetz:case Te.tsrange:case Te.tstzrange:return On(e);default:return On(e)}},On=r=>r,zc=r=>{switch(r){case"t":return!0;case"f":return!1;default:return r}},qc=r=>{if(typeof r=="string"){const e=parseFloat(r);if(!Number.isNaN(e))return e}return r},Nc=r=>{if(typeof r=="string")try{return JSON.parse(r)}catch(e){return console.log(`JSON parse error: ${e}`),r}return r},Fc=(r,e)=>{if(typeof r!="string")return r;const t=r.length-1,s=r[t];if(r[0]==="{"&&s==="}"){let a;const i=r.slice(1,t);try{a=JSON.parse("["+i+"]")}catch{a=i?i.split(","):[]}return a.map(o=>no(e,o))}return r},Bc=r=>typeof r=="string"?r.replace(" ","T"):r,ao=r=>{let e=r;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class on{constructor(e,t,s={},n=ro){this.channel=e,this.event=t,this.payload=s,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var s;return this._hasReceived(e)&&t((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Da;(function(r){r.SYNC="sync",r.JOIN="join",r.LEAVE="leave"})(Da||(Da={}));class Gr{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},n=>{const{onJoin:a,onLeave:i,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Gr.syncState(this.state,n,a,i),this.pendingDiffs.forEach(l=>{this.state=Gr.syncDiff(this.state,l,a,i)}),this.pendingDiffs=[],o()}),this.channel._on(s.diff,{},n=>{const{onJoin:a,onLeave:i,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=Gr.syncDiff(this.state,n,a,i),o())}),this.onJoin((n,a,i)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:a,newPresences:i})}),this.onLeave((n,a,i)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:a,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,s,n){const a=this.cloneDeep(e),i=this.transformState(t),o={},l={};return this.map(a,(u,d)=>{i[u]||(l[u]=d)}),this.map(i,(u,d)=>{const h=a[u];if(h){const f=d.map(w=>w.presence_ref),p=h.map(w=>w.presence_ref),v=d.filter(w=>p.indexOf(w.presence_ref)<0),k=h.filter(w=>f.indexOf(w.presence_ref)<0);v.length>0&&(o[u]=v),k.length>0&&(l[u]=k)}else o[u]=d}),this.syncDiff(a,{joins:o,leaves:l},s,n)}static syncDiff(e,t,s,n){const{joins:a,leaves:i}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return s||(s=()=>{}),n||(n=()=>{}),this.map(a,(o,l)=>{var u;const d=(u=e[o])!==null&&u!==void 0?u:[];if(e[o]=this.cloneDeep(l),d.length>0){const h=e[o].map(p=>p.presence_ref),f=d.filter(p=>h.indexOf(p.presence_ref)<0);e[o].unshift(...f)}s(o,d,l)}),this.map(i,(o,l)=>{let u=e[o];if(!u)return;const d=l.map(h=>h.presence_ref);u=u.filter(h=>d.indexOf(h.presence_ref)<0),e[o]=u,n(o,u,l),u.length===0&&delete e[o]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(s=>t(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,s)=>{const n=e[s];return"metas"in n?t[s]=n.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):t[s]=n,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var $a;(function(r){r.ALL="*",r.INSERT="INSERT",r.UPDATE="UPDATE",r.DELETE="DELETE"})($a||($a={}));var La;(function(r){r.BROADCAST="broadcast",r.PRESENCE="presence",r.POSTGRES_CHANGES="postgres_changes",r.SYSTEM="system"})(La||(La={}));var Ot;(function(r){r.SUBSCRIBED="SUBSCRIBED",r.TIMED_OUT="TIMED_OUT",r.CLOSED="CLOSED",r.CHANNEL_ERROR="CHANNEL_ERROR"})(Ot||(Ot={}));class Qn{constructor(e,t={config:{}},s){this.topic=e,this.params=t,this.socket=s,this.bindings={},this.state=Ke.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new on(this,dt.join,this.params,this.timeout),this.rejoinTimer=new so(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ke.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(n=>n.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ke.closed,this.socket._remove(this)}),this._onError(n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=Ke.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ke.errored,this.rejoinTimer.scheduleTimeout())}),this._on(dt.reply,{},(n,a)=>{this._trigger(this._replyEventName(a),n)}),this.presence=new Gr(this),this.broadcastEndpointURL=ao(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var s,n;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:a,presence:i,private:o}}=this.params;this._onError(d=>e==null?void 0:e(Ot.CHANNEL_ERROR,d)),this._onClose(()=>e==null?void 0:e(Ot.CLOSED));const l={},u={broadcast:a,presence:i,postgres_changes:(n=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(d=>d.filter))!==null&&n!==void 0?n:[],private:o};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:u},l)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:d})=>{var h;if(this.socket.setAuth(),d===void 0){e==null||e(Ot.SUBSCRIBED);return}else{const f=this.bindings.postgres_changes,p=(h=f==null?void 0:f.length)!==null&&h!==void 0?h:0,v=[];for(let k=0;k<p;k++){const w=f[k],{filter:{event:j,schema:P,table:x,filter:E}}=w,T=d&&d[k];if(T&&T.event===j&&T.schema===P&&T.table===x&&T.filter===E)v.push(Object.assign(Object.assign({},w),{id:T.id}));else{this.unsubscribe(),this.state=Ke.errored,e==null||e(Ot.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=v,e&&e(Ot.SUBSCRIBED);return}}).receive("error",d=>{this.state=Ke.errored,e==null||e(Ot.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(d).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Ot.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,s){return this._on(e,t,s)}async send(e,t={}){var s,n;if(!this._canPush()&&e.type==="broadcast"){const{event:a,payload:i}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:i,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(s=t.timeout)!==null&&s!==void 0?s:this.timeout);return await((n=u.body)===null||n===void 0?void 0:n.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var i,o,l;const u=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(o=(i=this.params)===null||i===void 0?void 0:i.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&a("ok"),u.receive("ok",()=>a("ok")),u.receive("error",()=>a("error")),u.receive("timeout",()=>a("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Ke.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(dt.close,"leave",this._joinRef())};return this.joinPush.destroy(),new Promise(s=>{const n=new on(this,dt.leave,{},e);n.receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,t,s){const n=new AbortController,a=setTimeout(()=>n.abort(),s),i=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:n.signal}));return clearTimeout(a),i}_push(e,t,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new on(this,e,t,s);return this._canPush()?n.send():(n.startTimeout(),this.pushBuffer.push(n)),n}_onMessage(e,t,s){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,s){var n,a;const i=e.toLocaleLowerCase(),{close:o,error:l,leave:u,join:d}=dt;if(s&&[o,l,u,d].indexOf(i)>=0&&s!==this._joinRef())return;let f=this._onMessage(i,t,s);if(t&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(p=>{var v,k,w;return((v=p.filter)===null||v===void 0?void 0:v.event)==="*"||((w=(k=p.filter)===null||k===void 0?void 0:k.event)===null||w===void 0?void 0:w.toLocaleLowerCase())===i}).map(p=>p.callback(f,s)):(a=this.bindings[i])===null||a===void 0||a.filter(p=>{var v,k,w,j,P,x;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in p){const E=p.id,T=(v=p.filter)===null||v===void 0?void 0:v.event;return E&&((k=t.ids)===null||k===void 0?void 0:k.includes(E))&&(T==="*"||(T==null?void 0:T.toLocaleLowerCase())===((w=t.data)===null||w===void 0?void 0:w.type.toLocaleLowerCase()))}else{const E=(P=(j=p==null?void 0:p.filter)===null||j===void 0?void 0:j.event)===null||P===void 0?void 0:P.toLocaleLowerCase();return E==="*"||E===((x=t==null?void 0:t.event)===null||x===void 0?void 0:x.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===i}).map(p=>{if(typeof f=="object"&&"ids"in f){const v=f.data,{schema:k,table:w,commit_timestamp:j,type:P,errors:x}=v;f=Object.assign(Object.assign({},{schema:k,table:w,commit_timestamp:j,eventType:P,new:{},old:{},errors:x}),this._getPayloadRecords(v))}p.callback(f,s)})}_isClosed(){return this.state===Ke.closed}_isJoined(){return this.state===Ke.joined}_isJoining(){return this.state===Ke.joining}_isLeaving(){return this.state===Ke.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,s){const n=e.toLocaleLowerCase(),a={type:n,filter:t,callback:s};return this.bindings[n]?this.bindings[n].push(a):this.bindings[n]=[a],this}_off(e,t){const s=e.toLocaleLowerCase();return this.bindings[s]=this.bindings[s].filter(n=>{var a;return!(((a=n.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===s&&Qn.isEqual(n.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(dt.close,{},e)}_onError(e){this._on(dt.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ke.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=Ra(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=Ra(e.columns,e.old_record)),t}}const Ua=()=>{},Wc=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Vc{constructor(e,t){var s;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers=Rc,this.params={},this.timeout=ro,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Ua,this.ref=0,this.logger=Ua,this.conn=null,this.sendBuffer=[],this.serializer=new Lc,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=a=>{let i;return a?i=a:typeof fetch>"u"?i=(...o)=>ps(async()=>{const{default:l}=await Promise.resolve().then(()=>Ur);return{default:l}},void 0).then(({default:l})=>l(...o)):i=fetch,(...o)=>i(...o)},this.endPoint=`${e}/${Tn.websocket}`,this.httpEndpoint=ao(e),t!=null&&t.transport?this.transport=t.transport:this.transport=null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.headers&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const n=(s=t==null?void 0:t.params)===null||s===void 0?void 0:s.apikey;if(n&&(this.accessTokenValue=n,this.apiKey=n),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:a=>[1e3,2e3,5e3,1e4][a-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(a,i)=>i(JSON.stringify(a)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new so(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t==null?void 0:t.fetch),t!=null&&t.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(t==null?void 0:t.worker)||!1,this.workerUrl=t==null?void 0:t.workerUrl}this.accessToken=(t==null?void 0:t.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=xn),this.transport){typeof window<"u"&&this.transport===window.WebSocket?this.conn=new this.transport(this.endpointURL()):this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection();return}this.conn=new Hc(this.endpointURL(),void 0,{close:()=>{this.conn=null}})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Dc}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(s=>s.teardown()))}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels=this.channels.filter(s=>s._joinRef!==e._joinRef),this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,s){this.logger(e,t,s)}connectionState(){switch(this.conn&&this.conn.readyState){case xr.connecting:return Yt.Connecting;case xr.open:return Yt.Open;case xr.closing:return Yt.Closing;default:return Yt.Closed}}isConnected(){return this.connectionState()===Yt.Open}channel(e,t={config:{}}){const s=`realtime:${e}`,n=this.getChannels().find(a=>a.topic===s);if(n)return n;{const a=new Qn(`realtime:${e}`,t,this);return this.channels.push(a),a}}push(e){const{topic:t,event:s,payload:n,ref:a}=e,i=()=>{this.encode(e,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${t} ${s} (${a})`,n),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(s=>{t&&s.updateJoinPayload({access_token:t,version:this.headers&&this.headers["X-Client-Info"]}),s.joinedOnce&&s._isJoined()&&s._push(dt.access_token,{access_token:t})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close($c,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:s,event:n,payload:a,ref:i}=t;s==="phoenix"&&n==="phx_reply"&&this.heartbeatCallback(t.payload.status=="ok"?"ok":"error"),i&&i===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${a.status||""} ${s} ${n} ${i&&"("+i+")"||""}`,a),Array.from(this.channels).filter(o=>o._isMember(s)).forEach(o=>o._trigger(n,a,i)),this.stateChangeCallbacks.message.forEach(o=>o(t))})}_onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(dt.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const s=e.match(/\?/)?"&":"?",n=new URLSearchParams(t);return`${e}${s}${n}`}_workerObjectUrl(e){let t;if(e)t=e;else{const s=new Blob([Wc],{type:"application/javascript"});t=URL.createObjectURL(s)}return t}}class Hc{constructor(e,t,s){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=xr.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=s.close}}class Zn extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Fe(r){return typeof r=="object"&&r!==null&&"__isStorageError"in r}class Jc extends Zn{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class jn extends Zn{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var Kc=function(r,e,t,s){function n(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(d){try{u(s.next(d))}catch(h){i(h)}}function l(d){try{u(s.throw(d))}catch(h){i(h)}}function u(d){d.done?a(d.value):n(d.value).then(o,l)}u((s=s.apply(r,e||[])).next())})};const io=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>ps(async()=>{const{default:s}=await Promise.resolve().then(()=>Ur);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)},Gc=()=>Kc(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield ps(()=>Promise.resolve().then(()=>Ur),void 0)).Response:Response}),An=r=>{if(Array.isArray(r))return r.map(t=>An(t));if(typeof r=="function"||r!==Object(r))return r;const e={};return Object.entries(r).forEach(([t,s])=>{const n=t.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));e[n]=An(s)}),e};var ur=function(r,e,t,s){function n(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(d){try{u(s.next(d))}catch(h){i(h)}}function l(d){try{u(s.throw(d))}catch(h){i(h)}}function u(d){d.done?a(d.value):n(d.value).then(o,l)}u((s=s.apply(r,e||[])).next())})};const ln=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),Yc=(r,e,t)=>ur(void 0,void 0,void 0,function*(){const s=yield Gc();r instanceof s&&!(t!=null&&t.noResolveJson)?r.json().then(n=>{e(new Jc(ln(n),r.status||500))}).catch(n=>{e(new jn(ln(n),n))}):e(new jn(ln(r),r))}),Qc=(r,e,t,s)=>{const n={method:r,headers:(e==null?void 0:e.headers)||{}};return r==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),s&&(n.body=JSON.stringify(s)),Object.assign(Object.assign({},n),t))};function gs(r,e,t,s,n,a){return ur(this,void 0,void 0,function*(){return new Promise((i,o)=>{r(t,Qc(e,s,n,a)).then(l=>{if(!l.ok)throw l;return s!=null&&s.noResolveJson?l:l.json()}).then(l=>i(l)).catch(l=>Yc(l,o,s))})})}function Ls(r,e,t,s){return ur(this,void 0,void 0,function*(){return gs(r,"GET",e,t,s)})}function Dt(r,e,t,s,n){return ur(this,void 0,void 0,function*(){return gs(r,"POST",e,s,n,t)})}function Zc(r,e,t,s,n){return ur(this,void 0,void 0,function*(){return gs(r,"PUT",e,s,n,t)})}function Xc(r,e,t,s){return ur(this,void 0,void 0,function*(){return gs(r,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),s)})}function oo(r,e,t,s,n){return ur(this,void 0,void 0,function*(){return gs(r,"DELETE",e,s,n,t)})}var et=function(r,e,t,s){function n(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(d){try{u(s.next(d))}catch(h){i(h)}}function l(d){try{u(s.throw(d))}catch(h){i(h)}}function u(d){d.done?a(d.value):n(d.value).then(o,l)}u((s=s.apply(r,e||[])).next())})};const eu={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},za={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class tu{constructor(e,t={},s,n){this.url=e,this.headers=t,this.bucketId=s,this.fetch=io(n)}uploadOrUpdate(e,t,s,n){return et(this,void 0,void 0,function*(){try{let a;const i=Object.assign(Object.assign({},za),n);let o=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(i.upsert)});const l=i.metadata;typeof Blob<"u"&&s instanceof Blob?(a=new FormData,a.append("cacheControl",i.cacheControl),l&&a.append("metadata",this.encodeMetadata(l)),a.append("",s)):typeof FormData<"u"&&s instanceof FormData?(a=s,a.append("cacheControl",i.cacheControl),l&&a.append("metadata",this.encodeMetadata(l))):(a=s,o["cache-control"]=`max-age=${i.cacheControl}`,o["content-type"]=i.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),n!=null&&n.headers&&(o=Object.assign(Object.assign({},o),n.headers));const u=this._removeEmptyFolders(t),d=this._getFinalPath(u),h=yield this.fetch(`${this.url}/object/${d}`,Object.assign({method:e,body:a,headers:o},i!=null&&i.duplex?{duplex:i.duplex}:{})),f=yield h.json();return h.ok?{data:{path:u,id:f.Id,fullPath:f.Key},error:null}:{data:null,error:f}}catch(a){if(Fe(a))return{data:null,error:a};throw a}})}upload(e,t,s){return et(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,s)})}uploadToSignedUrl(e,t,s,n){return et(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(e),i=this._getFinalPath(a),o=new URL(this.url+`/object/upload/sign/${i}`);o.searchParams.set("token",t);try{let l;const u=Object.assign({upsert:za.upsert},n),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&s instanceof Blob?(l=new FormData,l.append("cacheControl",u.cacheControl),l.append("",s)):typeof FormData<"u"&&s instanceof FormData?(l=s,l.append("cacheControl",u.cacheControl)):(l=s,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType);const h=yield this.fetch(o.toString(),{method:"PUT",body:l,headers:d}),f=yield h.json();return h.ok?{data:{path:a,fullPath:f.Key},error:null}:{data:null,error:f}}catch(l){if(Fe(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,t){return et(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const n=Object.assign({},this.headers);t!=null&&t.upsert&&(n["x-upsert"]="true");const a=yield Dt(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:n}),i=new URL(this.url+a.url),o=i.searchParams.get("token");if(!o)throw new Zn("No token returned by API");return{data:{signedUrl:i.toString(),path:e,token:o},error:null}}catch(s){if(Fe(s))return{data:null,error:s};throw s}})}update(e,t,s){return et(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,s)})}move(e,t,s){return et(this,void 0,void 0,function*(){try{return{data:yield Dt(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(Fe(n))return{data:null,error:n};throw n}})}copy(e,t,s){return et(this,void 0,void 0,function*(){try{return{data:{path:(yield Dt(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(Fe(n))return{data:null,error:n};throw n}})}createSignedUrl(e,t,s){return et(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e),a=yield Dt(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:t},s!=null&&s.transform?{transform:s.transform}:{}),{headers:this.headers});const i=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${i}`)},{data:a,error:null}}catch(n){if(Fe(n))return{data:null,error:n};throw n}})}createSignedUrls(e,t,s){return et(this,void 0,void 0,function*(){try{const n=yield Dt(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),a=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return{data:n.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${a}`):null})),error:null}}catch(n){if(Fe(n))return{data:null,error:n};throw n}})}download(e,t){return et(this,void 0,void 0,function*(){const n=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),i=a?`?${a}`:"";try{const o=this._getFinalPath(e);return{data:yield(yield Ls(this.fetch,`${this.url}/${n}/${o}${i}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(Fe(o))return{data:null,error:o};throw o}})}info(e){return et(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const s=yield Ls(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:An(s),error:null}}catch(s){if(Fe(s))return{data:null,error:s};throw s}})}exists(e){return et(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield Xc(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(Fe(s)&&s instanceof jn){const n=s.originalError;if([400,404].includes(n==null?void 0:n.status))return{data:!1,error:s}}throw s}})}getPublicUrl(e,t){const s=this._getFinalPath(e),n=[],a=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";a!==""&&n.push(a);const o=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});l!==""&&n.push(l);let u=n.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${s}${u}`)}}}remove(e){return et(this,void 0,void 0,function*(){try{return{data:yield oo(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(Fe(t))return{data:null,error:t};throw t}})}list(e,t,s){return et(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},eu),t),{prefix:e||""});return{data:yield Dt(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},s),error:null}}catch(n){if(Fe(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const ru="2.7.1",su={"X-Client-Info":`storage-js/${ru}`};var mr=function(r,e,t,s){function n(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(d){try{u(s.next(d))}catch(h){i(h)}}function l(d){try{u(s.throw(d))}catch(h){i(h)}}function u(d){d.done?a(d.value):n(d.value).then(o,l)}u((s=s.apply(r,e||[])).next())})};class nu{constructor(e,t={},s){this.url=e,this.headers=Object.assign(Object.assign({},su),t),this.fetch=io(s)}listBuckets(){return mr(this,void 0,void 0,function*(){try{return{data:yield Ls(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Fe(e))return{data:null,error:e};throw e}})}getBucket(e){return mr(this,void 0,void 0,function*(){try{return{data:yield Ls(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(Fe(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return mr(this,void 0,void 0,function*(){try{return{data:yield Dt(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(Fe(s))return{data:null,error:s};throw s}})}updateBucket(e,t){return mr(this,void 0,void 0,function*(){try{return{data:yield Zc(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(Fe(s))return{data:null,error:s};throw s}})}emptyBucket(e){return mr(this,void 0,void 0,function*(){try{return{data:yield Dt(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(Fe(t))return{data:null,error:t};throw t}})}deleteBucket(e){return mr(this,void 0,void 0,function*(){try{return{data:yield oo(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(Fe(t))return{data:null,error:t};throw t}})}}class au extends nu{constructor(e,t={},s){super(e,t,s)}from(e){return new tu(this.url,this.headers,e,this.fetch)}}const iu="2.50.0";let Hr="";typeof Deno<"u"?Hr="deno":typeof document<"u"?Hr="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Hr="react-native":Hr="node";const ou={"X-Client-Info":`supabase-js-${Hr}/${iu}`},lu={headers:ou},cu={schema:"public"},uu={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},du={};var hu=function(r,e,t,s){function n(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(d){try{u(s.next(d))}catch(h){i(h)}}function l(d){try{u(s.throw(d))}catch(h){i(h)}}function u(d){d.done?a(d.value):n(d.value).then(o,l)}u((s=s.apply(r,e||[])).next())})};const fu=r=>{let e;return r?e=r:typeof fetch>"u"?e=Yi:e=fetch,(...t)=>e(...t)},vu=()=>typeof Headers>"u"?Qi:Headers,pu=(r,e,t)=>{const s=fu(t),n=vu();return(a,i)=>hu(void 0,void 0,void 0,function*(){var o;const l=(o=yield e())!==null&&o!==void 0?o:r;let u=new n(i==null?void 0:i.headers);return u.has("apikey")||u.set("apikey",r),u.has("Authorization")||u.set("Authorization",`Bearer ${l}`),s(a,Object.assign(Object.assign({},i),{headers:u}))})};var gu=function(r,e,t,s){function n(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(d){try{u(s.next(d))}catch(h){i(h)}}function l(d){try{u(s.throw(d))}catch(h){i(h)}}function u(d){d.done?a(d.value):n(d.value).then(o,l)}u((s=s.apply(r,e||[])).next())})};function _u(r){return r.endsWith("/")?r:r+"/"}function mu(r,e){var t,s;const{db:n,auth:a,realtime:i,global:o}=r,{db:l,auth:u,realtime:d,global:h}=e,f={db:Object.assign(Object.assign({},l),n),auth:Object.assign(Object.assign({},u),a),realtime:Object.assign(Object.assign({},d),i),global:Object.assign(Object.assign(Object.assign({},h),o),{headers:Object.assign(Object.assign({},(t=h==null?void 0:h.headers)!==null&&t!==void 0?t:{}),(s=o==null?void 0:o.headers)!==null&&s!==void 0?s:{})}),accessToken:()=>gu(this,void 0,void 0,function*(){return""})};return r.accessToken?f.accessToken=r.accessToken:delete f.accessToken,f}const lo="2.70.0",Sr=30*1e3,Pn=3,cn=Pn*Sr,yu="http://localhost:9999",wu="supabase.auth.token",bu={"X-Client-Info":`gotrue-js/${lo}`},Cn="X-Supabase-Api-Version",co={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},ku=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Su=6e5;class Xn extends Error{constructor(e,t,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=s}}function ue(r){return typeof r=="object"&&r!==null&&"__isAuthError"in r}class Eu extends Xn{constructor(e,t,s){super(e,t,s),this.name="AuthApiError",this.status=t,this.code=s}}function xu(r){return ue(r)&&r.name==="AuthApiError"}class uo extends Xn{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Vt extends Xn{constructor(e,t,s,n){super(e,s,n),this.name=t,this.status=s}}class Rt extends Vt{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Tu(r){return ue(r)&&r.name==="AuthSessionMissingError"}class Ss extends Vt{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Es extends Vt{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class xs extends Vt{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Ou(r){return ue(r)&&r.name==="AuthImplicitGrantRedirectError"}class qa extends Vt{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Mn extends Vt{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function un(r){return ue(r)&&r.name==="AuthRetryableFetchError"}class Na extends Vt{constructor(e,t,s){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=s}}class Yr extends Vt{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Us="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Fa=` 	
\r=`.split(""),ju=(()=>{const r=new Array(128);for(let e=0;e<r.length;e+=1)r[e]=-1;for(let e=0;e<Fa.length;e+=1)r[Fa[e].charCodeAt(0)]=-2;for(let e=0;e<Us.length;e+=1)r[Us[e].charCodeAt(0)]=e;return r})();function Ba(r,e,t){if(r!==null)for(e.queue=e.queue<<8|r,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;t(Us[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;t(Us[s]),e.queuedBits-=6}}function ho(r,e,t){const s=ju[r];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(r)}"`)}}function Wa(r){const e=[],t=i=>{e.push(String.fromCodePoint(i))},s={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},a=i=>{Cu(i,s,t)};for(let i=0;i<r.length;i+=1)ho(r.charCodeAt(i),n,a);return e.join("")}function Au(r,e){if(r<=127){e(r);return}else if(r<=2047){e(192|r>>6),e(128|r&63);return}else if(r<=65535){e(224|r>>12),e(128|r>>6&63),e(128|r&63);return}else if(r<=1114111){e(240|r>>18),e(128|r>>12&63),e(128|r>>6&63),e(128|r&63);return}throw new Error(`Unrecognized Unicode codepoint: ${r.toString(16)}`)}function Pu(r,e){for(let t=0;t<r.length;t+=1){let s=r.charCodeAt(t);if(s>55295&&s<=56319){const n=(s-55296)*1024&65535;s=(r.charCodeAt(t+1)-56320&65535|n)+65536,t+=1}Au(s,e)}}function Cu(r,e,t){if(e.utf8seq===0){if(r<=127){t(r);return}for(let s=1;s<6;s+=1)if((r>>7-s&1)===0){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=r&31;else if(e.utf8seq===3)e.codepoint=r&15;else if(e.utf8seq===4)e.codepoint=r&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(r<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|r&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function Mu(r){const e=[],t={queue:0,queuedBits:0},s=n=>{e.push(n)};for(let n=0;n<r.length;n+=1)ho(r.charCodeAt(n),t,s);return new Uint8Array(e)}function Iu(r){const e=[];return Pu(r,t=>e.push(t)),new Uint8Array(e)}function Ru(r){const e=[],t={queue:0,queuedBits:0},s=n=>{e.push(n)};return r.forEach(n=>Ba(n,t,s)),Ba(null,t,s),e.join("")}function Du(r){return Math.round(Date.now()/1e3)+r}function $u(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){const e=Math.random()*16|0;return(r=="x"?e:e&3|8).toString(16)})}const ut=()=>typeof window<"u"&&typeof document<"u",Kt={tested:!1,writable:!1},Qr=()=>{if(!ut())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Kt.tested)return Kt.writable;const r=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(r,r),globalThis.localStorage.removeItem(r),Kt.tested=!0,Kt.writable=!0}catch{Kt.tested=!0,Kt.writable=!1}return Kt.writable};function Lu(r){const e={},t=new URL(r);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((n,a)=>{e[a]=n})}catch{}return t.searchParams.forEach((s,n)=>{e[n]=s}),e}const fo=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>ps(async()=>{const{default:s}=await Promise.resolve().then(()=>Ur);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)},Uu=r=>typeof r=="object"&&r!==null&&"status"in r&&"ok"in r&&"json"in r&&typeof r.json=="function",vo=async(r,e,t)=>{await r.setItem(e,JSON.stringify(t))},Ts=async(r,e)=>{const t=await r.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Os=async(r,e)=>{await r.removeItem(e)};class Qs{constructor(){this.promise=new Qs.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Qs.promiseConstructor=Promise;function dn(r){const e=r.split(".");if(e.length!==3)throw new Yr("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!ku.test(e[s]))throw new Yr("JWT not in base64url format");return{header:JSON.parse(Wa(e[0])),payload:JSON.parse(Wa(e[1])),signature:Mu(e[2]),raw:{header:e[0],payload:e[1]}}}async function zu(r){return await new Promise(e=>{setTimeout(()=>e(null),r)})}function qu(r,e){return new Promise((s,n)=>{(async()=>{for(let a=0;a<1/0;a++)try{const i=await r(a);if(!e(a,null,i)){s(i);return}}catch(i){if(!e(a,i)){n(i);return}}})()})}function Nu(r){return("0"+r.toString(16)).substr(-2)}function Fu(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=t.length;let n="";for(let a=0;a<56;a++)n+=t.charAt(Math.floor(Math.random()*s));return n}return crypto.getRandomValues(e),Array.from(e,Nu).join("")}async function Bu(r){const t=new TextEncoder().encode(r),s=await crypto.subtle.digest("SHA-256",t),n=new Uint8Array(s);return Array.from(n).map(a=>String.fromCharCode(a)).join("")}async function Wu(r){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),r;const t=await Bu(r);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function yr(r,e,t=!1){const s=Fu();let n=s;t&&(n+="/PASSWORD_RECOVERY"),await vo(r,`${e}-code-verifier`,n);const a=await Wu(s);return[a,s===a?"plain":"s256"]}const Vu=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Hu(r){const e=r.headers.get(Cn);if(!e||!e.match(Vu))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Ju(r){if(!r)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(r<=e)throw new Error("JWT has expired")}function Ku(r){switch(r){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Gu=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function wr(r){if(!Gu.test(r))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}var Yu=function(r,e){var t={};for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&e.indexOf(s)<0&&(t[s]=r[s]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(r);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(r,s[n])&&(t[s[n]]=r[s[n]]);return t};const Gt=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),Qu=[502,503,504];async function Va(r){var e;if(!Uu(r))throw new Mn(Gt(r),0);if(Qu.includes(r.status))throw new Mn(Gt(r),r.status);let t;try{t=await r.json()}catch(a){throw new uo(Gt(a),a)}let s;const n=Hu(r);if(n&&n.getTime()>=co["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?s=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(s=t.error_code),s){if(s==="weak_password")throw new Na(Gt(t),r.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new Rt}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((a,i)=>a&&typeof i=="string",!0))throw new Na(Gt(t),r.status,t.weak_password.reasons);throw new Eu(Gt(t),r.status||500,s)}const Zu=(r,e,t,s)=>{const n={method:r,headers:(e==null?void 0:e.headers)||{}};return r==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),n.body=JSON.stringify(s),Object.assign(Object.assign({},n),t))};async function ve(r,e,t,s){var n;const a=Object.assign({},s==null?void 0:s.headers);a[Cn]||(a[Cn]=co["2024-01-01"].name),s!=null&&s.jwt&&(a.Authorization=`Bearer ${s.jwt}`);const i=(n=s==null?void 0:s.query)!==null&&n!==void 0?n:{};s!=null&&s.redirectTo&&(i.redirect_to=s.redirectTo);const o=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",l=await Xu(r,e,t+o,{headers:a,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(l):{data:Object.assign({},l),error:null}}async function Xu(r,e,t,s,n,a){const i=Zu(e,s,n,a);let o;try{o=await r(t,Object.assign({},i))}catch(l){throw console.error(l),new Mn(Gt(l),0)}if(o.ok||await Va(o),s!=null&&s.noResolveJson)return o;try{return await o.json()}catch(l){await Va(l)}}function xt(r){var e;let t=null;sd(r)&&(t=Object.assign({},r),r.expires_at||(t.expires_at=Du(r.expires_in)));const s=(e=r.user)!==null&&e!==void 0?e:r;return{data:{session:t,user:s},error:null}}function Ha(r){const e=xt(r);return!e.error&&r.weak_password&&typeof r.weak_password=="object"&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.message&&typeof r.weak_password.message=="string"&&r.weak_password.reasons.reduce((t,s)=>t&&typeof s=="string",!0)&&(e.data.weak_password=r.weak_password),e}function $t(r){var e;return{data:{user:(e=r.user)!==null&&e!==void 0?e:r},error:null}}function ed(r){return{data:r,error:null}}function td(r){const{action_link:e,email_otp:t,hashed_token:s,redirect_to:n,verification_type:a}=r,i=Yu(r,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:e,email_otp:t,hashed_token:s,redirect_to:n,verification_type:a},l=Object.assign({},i);return{data:{properties:o,user:l},error:null}}function rd(r){return r}function sd(r){return r.access_token&&r.refresh_token&&r.expires_in}const hn=["global","local","others"];var nd=function(r,e){var t={};for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&e.indexOf(s)<0&&(t[s]=r[s]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(r);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(r,s[n])&&(t[s[n]]=r[s[n]]);return t};class ad{constructor({url:e="",headers:t={},fetch:s}){this.url=e,this.headers=t,this.fetch=fo(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=hn[0]){if(hn.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${hn.join(", ")}`);try{return await ve(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(ue(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,t={}){try{return await ve(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:$t})}catch(s){if(ue(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:t}=e,s=nd(e,["options"]),n=Object.assign(Object.assign({},s),t);return"newEmail"in s&&(n.new_email=s==null?void 0:s.newEmail,delete n.newEmail),await ve(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:td,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(ue(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await ve(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:$t})}catch(t){if(ue(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,s,n,a,i,o,l;try{const u={nextPage:null,lastPage:0,total:0},d=await ve(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&s!==void 0?s:"",per_page:(a=(n=e==null?void 0:e.perPage)===null||n===void 0?void 0:n.toString())!==null&&a!==void 0?a:""},xform:rd});if(d.error)throw d.error;const h=await d.json(),f=(i=d.headers.get("x-total-count"))!==null&&i!==void 0?i:0,p=(l=(o=d.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(v=>{const k=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),w=JSON.parse(v.split(";")[1].split("=")[1]);u[`${w}Page`]=k}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(ue(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){wr(e);try{return await ve(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:$t})}catch(t){if(ue(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){wr(e);try{return await ve(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:$t})}catch(s){if(ue(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,t=!1){wr(e);try{return await ve(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:$t})}catch(s){if(ue(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){wr(e.userId);try{const{data:t,error:s}=await ve(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:t,error:s}}catch(t){if(ue(t))return{data:null,error:t};throw t}}async _deleteFactor(e){wr(e.userId),wr(e.id);try{return{data:await ve(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(ue(t))return{data:null,error:t};throw t}}}const id={getItem:r=>Qr()?globalThis.localStorage.getItem(r):null,setItem:(r,e)=>{Qr()&&globalThis.localStorage.setItem(r,e)},removeItem:r=>{Qr()&&globalThis.localStorage.removeItem(r)}};function Ja(r={}){return{getItem:e=>r[e]||null,setItem:(e,t)=>{r[e]=t},removeItem:e=>{delete r[e]}}}function od(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const br={debug:!!(globalThis&&Qr()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class po extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class ld extends po{}async function cd(r,e,t){br.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",r,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),br.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",r)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(r,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async n=>{if(n){br.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",r,n.name);try{return await t()}finally{br.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",r,n.name)}}else{if(e===0)throw br.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",r),new ld(`Acquiring an exclusive Navigator LockManager lock "${r}" immediately failed`);if(br.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}od();const ud={url:yu,storageKey:wu,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:bu,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Ka(r,e,t){return await t()}class ss{constructor(e){var t,s;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=ss.nextInstanceID,ss.nextInstanceID+=1,this.instanceID>0&&ut()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},ud),e);if(this.logDebugMessages=!!n.debug,typeof n.debug=="function"&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new ad({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=fo(n.fetch),this.lock=n.lock||Ka,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:ut()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=cd:this.lock=Ka,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?n.storage?this.storage=n.storage:Qr()?this.storage=id:(this.memoryStorage={},this.storage=Ja(this.memoryStorage)):(this.memoryStorage={},this.storage=Ja(this.memoryStorage)),ut()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${lo}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=Lu(window.location.href);let s="none";if(this._isImplicitGrantCallback(t)?s="implicit":await this._isPKCECallback(t)&&(s="pkce"),ut()&&this.detectSessionInUrl&&s!=="none"){const{data:n,error:a}=await this._getSessionFromURL(t,s);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),Ou(a)){const l=(e=a.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:i,redirectType:o}=n;return this._debug("#_initialize()","detected session in URL",i,"redirect type",o),await this._saveSession(i),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return ue(t)?{error:t}:{error:new uo("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,s,n;try{const a=await ve(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.captchaToken}},xform:xt}),{data:i,error:o}=a;if(o||!i)return{data:{user:null,session:null},error:o};const l=i.session,u=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(a){if(ue(a))return{data:{user:null,session:null},error:a};throw a}}async signUp(e){var t,s,n;try{let a;if("email"in e){const{email:d,password:h,options:f}=e;let p=null,v=null;this.flowType==="pkce"&&([p,v]=await yr(this.storage,this.storageKey)),a=await ve(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:d,password:h,data:(t=f==null?void 0:f.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:p,code_challenge_method:v},xform:xt})}else if("phone"in e){const{phone:d,password:h,options:f}=e;a=await ve(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:h,data:(s=f==null?void 0:f.data)!==null&&s!==void 0?s:{},channel:(n=f==null?void 0:f.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:xt})}else throw new Es("You must provide either an email or phone number and a password");const{data:i,error:o}=a;if(o||!i)return{data:{user:null,session:null},error:o};const l=i.session,u=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(a){if(ue(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithPassword(e){try{let t;if("email"in e){const{email:a,password:i,options:o}=e;t=await ve(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Ha})}else if("phone"in e){const{phone:a,password:i,options:o}=e;t=await ve(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Ha})}else throw new Es("You must provide either an email or phone number and a password");const{data:s,error:n}=t;return n?{data:{user:null,session:null},error:n}:!s||!s.session||!s.user?{data:{user:null,session:null},error:new Ss}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:n})}catch(t){if(ue(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,s,n,a;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(a=e.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if(t==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,s,n,a,i,o,l,u,d,h,f,p;let v,k;if("message"in e)v=e.message,k=e.signature;else{const{chain:w,wallet:j,statement:P,options:x}=e;let E;if(ut())if(typeof j=="object")E=j;else{const S=window;if("solana"in S&&typeof S.solana=="object"&&("signIn"in S.solana&&typeof S.solana.signIn=="function"||"signMessage"in S.solana&&typeof S.solana.signMessage=="function"))E=S.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof j!="object"||!(x!=null&&x.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");E=j}const T=new URL((t=x==null?void 0:x.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in E&&E.signIn){const S=await E.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},x==null?void 0:x.signInWithSolana),{version:"1",domain:T.host,uri:T.href}),P?{statement:P}:null));let A;if(Array.isArray(S)&&S[0]&&typeof S[0]=="object")A=S[0];else if(S&&typeof S=="object"&&"signedMessage"in S&&"signature"in S)A=S;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in A&&"signature"in A&&(typeof A.signedMessage=="string"||A.signedMessage instanceof Uint8Array)&&A.signature instanceof Uint8Array)v=typeof A.signedMessage=="string"?A.signedMessage:new TextDecoder().decode(A.signedMessage),k=A.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in E)||typeof E.signMessage!="function"||!("publicKey"in E)||typeof E!="object"||!E.publicKey||!("toBase58"in E.publicKey)||typeof E.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");v=[`${T.host} wants you to sign in with your Solana account:`,E.publicKey.toBase58(),...P?["",P,""]:[""],"Version: 1",`URI: ${T.href}`,`Issued At: ${(n=(s=x==null?void 0:x.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((a=x==null?void 0:x.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${x.signInWithSolana.notBefore}`]:[],...!((i=x==null?void 0:x.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${x.signInWithSolana.expirationTime}`]:[],...!((o=x==null?void 0:x.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${x.signInWithSolana.chainId}`]:[],...!((l=x==null?void 0:x.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${x.signInWithSolana.nonce}`]:[],...!((u=x==null?void 0:x.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${x.signInWithSolana.requestId}`]:[],...!((h=(d=x==null?void 0:x.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||h===void 0)&&h.length?["Resources",...x.signInWithSolana.resources.map(A=>`- ${A}`)]:[]].join(`
`);const S=await E.signMessage(new TextEncoder().encode(v),"utf8");if(!S||!(S instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");k=S}}try{const{data:w,error:j}=await ve(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:v,signature:Ru(k)},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(p=e.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:xt});if(j)throw j;return!w||!w.session||!w.user?{data:{user:null,session:null},error:new Ss}:(w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("SIGNED_IN",w.session)),{data:Object.assign({},w),error:j})}catch(w){if(ue(w))return{data:{user:null,session:null},error:w};throw w}}async _exchangeCodeForSession(e){const t=await Ts(this.storage,`${this.storageKey}-code-verifier`),[s,n]=(t??"").split("/");try{const{data:a,error:i}=await ve(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:xt});if(await Os(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return!a||!a.session||!a.user?{data:{user:null,session:null,redirectType:null},error:new Ss}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign(Object.assign({},a),{redirectType:n??null}),error:i})}catch(a){if(ue(a))return{data:{user:null,session:null,redirectType:null},error:a};throw a}}async signInWithIdToken(e){try{const{options:t,provider:s,token:n,access_token:a,nonce:i}=e,o=await ve(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:n,access_token:a,nonce:i,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:xt}),{data:l,error:u}=o;return u?{data:{user:null,session:null},error:u}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new Ss}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:u})}catch(t){if(ue(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,s,n,a,i;try{if("email"in e){const{email:o,options:l}=e;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await yr(this.storage,this.storageKey));const{error:h}=await ve(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(t=l==null?void 0:l.data)!==null&&t!==void 0?t:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:o,options:l}=e,{data:u,error:d}=await ve(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(n=l==null?void 0:l.data)!==null&&n!==void 0?n:{},create_user:(a=l==null?void 0:l.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(i=l==null?void 0:l.channel)!==null&&i!==void 0?i:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:d}}throw new Es("You must provide either an email or phone number.")}catch(o){if(ue(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(e){var t,s;try{let n,a;"options"in e&&(n=(t=e.options)===null||t===void 0?void 0:t.redirectTo,a=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:i,error:o}=await ve(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:n,xform:xt});if(o)throw o;if(!i)throw new Error("An error occurred on token verification.");const l=i.session,u=i.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(n){if(ue(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(e){var t,s,n;try{let a=null,i=null;return this.flowType==="pkce"&&([a,i]=await yr(this.storage,this.storageKey)),await ve(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&s!==void 0?s:void 0}),!((n=e==null?void 0:e.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:i}),headers:this.headers,xform:ed})}catch(a){if(ue(a))return{data:null,error:a};throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:s}=e;if(s)throw s;if(!t)throw new Rt;const{error:n}=await ve(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:n}})}catch(e){if(ue(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:s,type:n,options:a}=e,{error:i}=await ve(this.fetch,"POST",t,{headers:this.headers,body:{email:s,type:n,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},redirectTo:a==null?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:i}}else if("phone"in e){const{phone:s,type:n,options:a}=e,{data:i,error:o}=await ve(this.fetch,"POST",t,{headers:this.headers,body:{phone:s,type:n,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}}});return{data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:o}}throw new Es("You must provide either an email or phone number and a type")}catch(t){if(ue(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await s,await t()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=t();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Ts(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<cn:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.storage.isServer){let i=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,u,d)=>(!i&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),i=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,u,d))})}return{data:{session:e},error:null}}const{session:n,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{session:null},error:a}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await ve(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:$t}):await this._useSession(async t=>{var s,n,a;const{data:i,error:o}=t;if(o)throw o;return!(!((s=i.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Rt}:await ve(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0,xform:$t})})}catch(t){if(ue(t))return Tu(t)&&(await this._removeSession(),await Os(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async s=>{const{data:n,error:a}=s;if(a)throw a;if(!n.session)throw new Rt;const i=n.session;let o=null,l=null;this.flowType==="pkce"&&e.email!=null&&([o,l]=await yr(this.storage,this.storageKey));const{data:u,error:d}=await ve(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:l}),jwt:i.access_token,xform:$t});if(d)throw d;return i.user=u.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(s){if(ue(s))return{data:{user:null},error:s};throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Rt;const t=Date.now()/1e3;let s=t,n=!0,a=null;const{payload:i}=dn(e.access_token);if(i.exp&&(s=i.exp,n=s<=t),n){const{session:o,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};a=o}else{const{data:o,error:l}=await this._getUser(e.access_token);if(l)throw l;a={access_token:e.access_token,refresh_token:e.refresh_token,user:o.user,token_type:"bearer",expires_in:s-t,expires_at:s},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(t){if(ue(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var s;if(!e){const{data:i,error:o}=t;if(o)throw o;e=(s=i.session)!==null&&s!==void 0?s:void 0}if(!(e!=null&&e.refresh_token))throw new Rt;const{session:n,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{user:null,session:null},error:a}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(ue(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!ut())throw new xs("No browser detected.");if(e.error||e.error_description||e.error_code)throw new xs(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new qa("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new xs("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new qa("No code detected.");const{data:P,error:x}=await this._exchangeCodeForSession(e.code);if(x)throw x;const E=new URL(window.location.href);return E.searchParams.delete("code"),window.history.replaceState(window.history.state,"",E.toString()),{data:{session:P.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:n,access_token:a,refresh_token:i,expires_in:o,expires_at:l,token_type:u}=e;if(!a||!o||!i||!u)throw new xs("No session defined in URL");const d=Math.round(Date.now()/1e3),h=parseInt(o);let f=d+h;l&&(f=parseInt(l));const p=f-d;p*1e3<=Sr&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${h}s`);const v=f-h;d-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,f,d):d-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,f,d);const{data:k,error:w}=await this._getUser(a);if(w)throw w;const j={provider_token:s,provider_refresh_token:n,access_token:a,expires_in:h,expires_at:f,refresh_token:i,token_type:u,user:k.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:j,redirectType:e.type},error:null}}catch(s){if(ue(s))return{data:{session:null,redirectType:null},error:s};throw s}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Ts(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var s;const{data:n,error:a}=t;if(a)return{error:a};const i=(s=n.session)===null||s===void 0?void 0:s.access_token;if(i){const{error:o}=await this.admin.signOut(i,e);if(o&&!(xu(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return e!=="others"&&(await this._removeSession(),await Os(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=$u(),s={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async t=>{var s,n;try{const{data:{session:a},error:i}=t;if(i)throw i;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",e,"session",a)}catch(a){await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a),console.error(a)}})}async resetPasswordForEmail(e,t={}){let s=null,n=null;this.flowType==="pkce"&&([s,n]=await yr(this.storage,this.storageKey,!0));try{return await ve(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:n,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(a){if(ue(a))return{data:null,error:a};throw a}}async getUserIdentities(){var e;try{const{data:t,error:s}=await this.getUser();if(s)throw s;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(ue(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:s,error:n}=await this._useSession(async a=>{var i,o,l,u,d;const{data:h,error:f}=a;if(f)throw f;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(i=e.options)===null||i===void 0?void 0:i.redirectTo,scopes:(o=e.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await ve(this.fetch,"GET",p,{headers:this.headers,jwt:(d=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(n)throw n;return ut()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),{data:{provider:e.provider,url:s==null?void 0:s.url},error:null}}catch(s){if(ue(s))return{data:{provider:e.provider,url:null},error:s};throw s}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var s,n;const{data:a,error:i}=t;if(i)throw i;return await ve(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(s=a.session)===null||s===void 0?void 0:s.access_token)!==null&&n!==void 0?n:void 0})})}catch(t){if(ue(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const s=Date.now();return await qu(async n=>(n>0&&await zu(200*Math.pow(2,n-1)),this._debug(t,"refreshing attempt",n),await ve(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:xt})),(n,a)=>{const i=200*Math.pow(2,n);return a&&un(a)&&Date.now()+i-s<Sr})}catch(s){if(this._debug(t,"error",s),ue(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",s),ut()&&!t.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const s=await Ts(this.storage,this.storageKey);if(this._debug(t,"session from storage",s),!this._isValidSession(s)){this._debug(t,"session is not valid"),s!==null&&await this._removeSession();return}const n=((e=s.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<cn;if(this._debug(t,`session has${n?"":" not"} expired with margin of ${cn}s`),n){if(this.autoRefreshToken&&s.refresh_token){const{error:a}=await this._callRefreshToken(s.refresh_token);a&&(console.error(a),un(a)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(t,"error",s),console.error(s);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,s;if(!e)throw new Rt;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new Qs;const{data:a,error:i}=await this._refreshAccessToken(e);if(i)throw i;if(!a.session)throw new Rt;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const o={session:a.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(a){if(this._debug(n,"error",a),ue(a)){const i={session:null,error:a};return un(a)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(i),i}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(a),a}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,t,s=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",t,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:t});const a=[],i=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(e,t)}catch(l){a.push(l)}});if(await Promise.all(i),a.length>0){for(let o=0;o<a.length;o+=1)console.error(a[o]);throw a[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await vo(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await Os(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&ut()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Sr);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:s}}=t;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((s.expires_at*1e3-e)/Sr);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${Sr}ms, refresh threshold is ${Pn} ticks`),n<=Pn&&await this._callRefreshToken(s.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof po)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ut()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,s){const n=[`provider=${encodeURIComponent(t)}`];if(s!=null&&s.redirectTo&&n.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&n.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[a,i]=await yr(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(i)}`});n.push(o.toString())}if(s!=null&&s.queryParams){const a=new URLSearchParams(s.queryParams);n.push(a.toString())}return s!=null&&s.skipBrowserRedirect&&n.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var s;const{data:n,error:a}=t;return a?{data:null,error:a}:await ve(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(ue(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var s,n;const{data:a,error:i}=t;if(i)return{data:null,error:i};const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:u}=await ve(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(s=a==null?void 0:a.session)===null||s===void 0?void 0:s.access_token});return u?{data:null,error:u}:(e.factorType==="totp"&&(!((n=l==null?void 0:l.totp)===null||n===void 0)&&n.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(t){if(ue(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:n,error:a}=t;if(a)return{data:null,error:a};const{data:i,error:o}=await ve(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:o})})}catch(t){if(ue(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:n,error:a}=t;return a?{data:null,error:a}:await ve(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(ue(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const s=(e==null?void 0:e.factors)||[],n=s.filter(i=>i.factor_type==="totp"&&i.status==="verified"),a=s.filter(i=>i.factor_type==="phone"&&i.status==="verified");return{data:{all:s,totp:n,phone:a},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,s;const{data:{session:n},error:a}=e;if(a)return{data:null,error:a};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=dn(n.access_token);let o=null;i.aal&&(o=i.aal);let l=o;((s=(t=n.user.factors)===null||t===void 0?void 0:t.filter(h=>h.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(l="aal2");const d=i.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:d},error:null}}))}async fetchJwk(e,t={keys:[]}){let s=t.keys.find(i=>i.kid===e);if(s||(s=this.jwks.keys.find(i=>i.kid===e),s&&this.jwks_cached_at+Su>Date.now()))return s;const{data:n,error:a}=await ve(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;if(!n.keys||n.keys.length===0)throw new Yr("JWKS is empty");if(this.jwks=n,this.jwks_cached_at=Date.now(),s=n.keys.find(i=>i.kid===e),!s)throw new Yr("No matching signing key found in JWKS");return s}async getClaims(e,t={keys:[]}){try{let s=e;if(!s){const{data:p,error:v}=await this.getSession();if(v||!p.session)return{data:null,error:v};s=p.session.access_token}const{header:n,payload:a,signature:i,raw:{header:o,payload:l}}=dn(s);if(Ju(a.exp),!n.kid||n.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:p}=await this.getUser(s);if(p)throw p;return{data:{claims:a,header:n,signature:i},error:null}}const u=Ku(n.alg),d=await this.fetchJwk(n.kid,t),h=await crypto.subtle.importKey("jwk",d,u,!0,["verify"]);if(!await crypto.subtle.verify(u,h,i,Iu(`${o}.${l}`)))throw new Yr("Invalid JWT signature");return{data:{claims:a,header:n,signature:i},error:null}}catch(s){if(ue(s))return{data:null,error:s};throw s}}}ss.nextInstanceID=0;const dd=ss;class hd extends dd{constructor(e){super(e)}}var fd=function(r,e,t,s){function n(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(d){try{u(s.next(d))}catch(h){i(h)}}function l(d){try{u(s.throw(d))}catch(h){i(h)}}function u(d){d.done?a(d.value):n(d.value).then(o,l)}u((s=s.apply(r,e||[])).next())})};class vd{constructor(e,t,s){var n,a,i;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const o=_u(e),l=new URL(o);this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const u=`sb-${l.hostname.split(".")[0]}-auth-token`,d={db:cu,realtime:du,auth:Object.assign(Object.assign({},uu),{storageKey:u}),global:lu},h=mu(s??{},d);this.storageKey=(n=h.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(a=h.global.headers)!==null&&a!==void 0?a:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(f,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=h.auth)!==null&&i!==void 0?i:{},this.headers,h.global.fetch),this.fetch=pu(t,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new Mc(new URL("rest/v1",l).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),h.accessToken||this._listenForAuthEvents()}get functions(){return new mc(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new au(this.storageUrl.href,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},s={}){return this.rest.rpc(e,t,s)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return fd(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return(t=(e=s.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:n,storageKey:a,flowType:i,lock:o,debug:l},u,d){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new hd({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),u),storageKey:a,autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:n,flowType:i,lock:o,debug:l,fetch:d,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new Vc(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,s)=>{this._handleTokenChanged(t,"CLIENT",s==null?void 0:s.access_token)})}_handleTokenChanged(e,t,s){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==s?this.changedAccessToken=s:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const pd=(r,e,t)=>new vd(r,e,t),gd="https://ibgkltqlgbafpoljizdu.supabase.co",_d="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImliZ2tsdHFsZ2JhZnBvbGppemR1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDkzMjU1NzksImV4cCI6MjA2NDkwMTU3OX0.Awa-Gdd3b4uR_1MnQySyA5s6hfVfyZB6jlVS1Jj_Afk",oe=pd(gd,_d);al();function Ga(r,e){_(e,!c(e))}var md=N('<button class="open-sidebar-icon icon svelte-1hv2e3s">â¡</button> <aside><div class="sidebar-header svelte-1hv2e3s"><img src="https://raw.githubusercontent.com/Ewan-Dev/ewan.is-a.dev/refs/heads/main/frontend/static/loquela.png" class="logo svelte-1hv2e3s" alt="loquela logo"/> <button class="close-sidebar-icon icon svelte-1hv2e3s">X</button></div> <nav class="sidebar-nav svelte-1hv2e3s"><a href="./#/app/home"><span class="material-symbols-rounded svelte-1hv2e3s">home</span> Home</a> <a href="./#/app/music"><span class="material-symbols-rounded svelte-1hv2e3s">music_note</span> Music</a> <a href="./#/app/videos"><span class="material-symbols-rounded svelte-1hv2e3s">movie</span> Videos</a> <a href="./#/app/upload"><span class="material-symbols-rounded svelte-1hv2e3s">upload</span> Upload</a> <a href="./#/app/flashcards"><span class="material-symbols-rounded svelte-1hv2e3s">cards_star</span> Flashcards</a> <a href="./#/app/ai-chat"><span class="material-symbols-rounded svelte-1hv2e3s">chat</span> AI Chat</a></nav></aside>',1);function St(r,e){let t=ye(e,"currentPage",8,""),s=er(!1);var n=md(),a=Oe(n);a.__click=[Ga,s];var i=y(a,2);let o;var l=b(i),u=y(b(l),2);u.__click=[Ga,s];var d=y(l,2),h=b(d);let f;var p=y(h,2);let v;var k=y(p,2);let w;var j=y(k,2);let P;var x=y(j,2);let E;var T=y(x,2);let S;fe((A,M,I,G,ae,V,L)=>{o=st(i,1,"sidebar svelte-1hv2e3s",null,o,A),f=st(h,1,"svelte-1hv2e3s",null,f,M),v=st(p,1,"svelte-1hv2e3s",null,v,I),w=st(k,1,"svelte-1hv2e3s",null,w,G),P=st(j,1,"svelte-1hv2e3s",null,P,ae),E=st(x,1,"svelte-1hv2e3s",null,E,V),S=st(T,1,"svelte-1hv2e3s",null,S,L)},[()=>({show:c(s)}),()=>({selected:t()==="/home"}),()=>({selected:t()==="/music"}),()=>({selected:t()==="/videos"}),()=>({selected:t()==="/upload"}),()=>({selected:t()==="/flashcards"}),()=>({selected:t()==="/ai-chat"})]),U(r,n)}cr(["click"]);var yd=N('<div><span class="material-symbols-rounded svelte-hct3vs"> </span> <p> </p></div>');function wd(r,e){let t=ye(e,"type",8,""),s=ye(e,"message",8,""),n=ye(e,"symbol",8,"");var a=yd(),i=b(a),o=b(i),l=y(i,2),u=b(l);fe(()=>{st(a,1,`media-tag ${t()}`,"svelte-hct3vs"),re(o,n()),re(u,s())}),U(r,a)}var bd=N('<div><img alt="Album cover"/> <span class="svelte-1pu170t"><!></span> <a class="svelte-1pu170t"><b> </b></a> <a class="svelte-1pu170t"> </a></div>');function ea(r,e){Re(e,!1);let t=ye(e,"name",12,null),s=ye(e,"artist",12,null),n=ye(e,"cover",8,null),a=ye(e,"level",8,null);ye(e,"rating",8,null);let i=ye(e,"link",8,null),o=ye(e,"type",8,null);t().length>45&&t(t().slice(0,42)+"..."),s().length>45&&s(s().slice(0,42)+"..."),Jn();var l=bd(),u=b(l),d=y(u,2),h=b(d);wd(h,{type:"level",get message(){return a()}});var f=y(d,2),p=b(f),v=b(p),k=y(f,2),w=b(k);fe(()=>{st(l,1,$s(o()),"svelte-1pu170t"),ze(u,"src",n()),st(u,1,$s(o()),"svelte-1pu170t"),ze(f,"href",i()),re(v,t()),re(w,s())}),U(r,l),De()}var kd=N('<main class="route svelte-1nmp6pz"><!> <section class="main-page svelte-1nmp6pz"><h1 class="page-header">Home</h1> <section class="main-content svelte-1nmp6pz"><h2 class="home-page-main-section-head svelte-1nmp6pz">Recent videos</h2> <div class="media-list svelte-1nmp6pz"></div></section></section></main>');function Sd(r,e){Re(e,!1);let t=er([]);tt(async()=>{const{data:{user:l}}=await oe.auth.getUser();console.log(l);const{data:u,error:d}=await oe.from("profiles").select("recent_videos");_(t,u[0].recent_videos),console.log(c(t))}),Jn();var s=kd(),n=b(s);St(n,{currentPage:"/home"});var a=y(n,2),i=y(b(a),2),o=y(b(i),2);Me(o,5,()=>c(t),Ce,(l,u)=>{{let d=Vs(()=>`#/app/videos/${c(u).id}`);ea(l,{get name(){return c(u).name},get artist(){return c(u).artist},get cover(){return c(u).cover},get level(){return c(u).level},get rating(){return c(u).rating},get link(){return c(d)},type:"video"})}}),U(r,s),De()}const Ed=r=>r;function xd(r,{delay:e=0,duration:t=400,easing:s=Ed}={}){const n=+getComputedStyle(r).opacity;return{delay:e,duration:t,easing:s,css:a=>`opacity: ${a*n}`}}var Td=N('<section role="status"><span> </span> <p> </p></section>');function Pt(r,e){Re(e,!0);let t=ye(e,"type",3,"info"),s=ye(e,"message",3,"Information"),n=ye(e,"width",3,"100%"),a={info:"info",error:"error",success:"check_circle",warn:"warning"},i,o=O(!0);Se(()=>(_(o,!1),s()&&(_(o,!0),clearTimeout(i),i=setTimeout(()=>{_(o,!1)},5e3)),()=>{_(o,!1),clearTimeout(i)}));var l=Bt(),u=Oe(l);{var d=h=>{var f=Td(),p=b(f),v=b(p),k=y(p,2),w=b(k);fe(()=>{Hl(f,`width:${n()??""};`),st(f,1,$s(t()),"svelte-1o9ullj"),st(p,1,`${t()} material-symbols-rounded`,"svelte-1o9ullj"),re(v,a[t()]),st(k,1,$s(t()),"svelte-1o9ullj"),re(w,s())}),rc(3,f,()=>xd,()=>({duration:400})),U(h,f)};le(u,h=>{c(o)&&h(d)})}U(r,l),De()}var _s={};(function r(e,t,s,n){var a=!!(e.Worker&&e.Blob&&e.Promise&&e.OffscreenCanvas&&e.OffscreenCanvasRenderingContext2D&&e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype.transferControlToOffscreen&&e.URL&&e.URL.createObjectURL),i=typeof Path2D=="function"&&typeof DOMMatrix=="function",o=function(){if(!e.OffscreenCanvas)return!1;var m=new OffscreenCanvas(1,1),g=m.getContext("2d");g.fillRect(0,0,1,1);var $=m.transferToImageBitmap();try{g.createPattern($,"no-repeat")}catch{return!1}return!0}();function l(){}function u(m){var g=t.exports.Promise,$=g!==void 0?g:e.Promise;return typeof $=="function"?new $(m):(m(l,l),null)}var d=function(m,g){return{transform:function($){if(m)return $;if(g.has($))return g.get($);var F=new OffscreenCanvas($.width,$.height),H=F.getContext("2d");return H.drawImage($,0,0),g.set($,F),F},clear:function(){g.clear()}}}(o,new Map),h=function(){var m=Math.floor(16.666666666666668),g,$,F={},H=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(g=function(K){var X=Math.random();return F[X]=requestAnimationFrame(function B(ee){H===ee||H+m-1<ee?(H=ee,delete F[X],K()):F[X]=requestAnimationFrame(B)}),X},$=function(K){F[K]&&cancelAnimationFrame(F[K])}):(g=function(K){return setTimeout(K,m)},$=function(K){return clearTimeout(K)}),{frame:g,cancel:$}}(),f=function(){var m,g,$={};function F(H){function K(X,B){H.postMessage({options:X||{},callback:B})}H.init=function(B){var ee=B.transferControlToOffscreen();H.postMessage({canvas:ee},[ee])},H.fire=function(B,ee,de){if(g)return K(B,null),g;var J=Math.random().toString(36).slice(2);return g=u(function(Y){function ie(he){he.data.callback===J&&(delete $[J],H.removeEventListener("message",ie),g=null,d.clear(),de(),Y())}H.addEventListener("message",ie),K(B,J),$[J]=ie.bind(null,{data:{callback:J}})}),g},H.reset=function(){H.postMessage({reset:!0});for(var B in $)$[B](),delete $[B]}}return function(){if(m)return m;if(!s&&a){var H=["var CONFETTI, SIZE = {}, module = {};","("+r.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{m=new Worker(URL.createObjectURL(new Blob([H])))}catch(K){return typeof console!==void 0&&typeof console.warn=="function"&&console.warn("ð Could not load worker",K),null}F(m)}return m}}(),p={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function v(m,g){return g?g(m):m}function k(m){return m!=null}function w(m,g,$){return v(m&&k(m[g])?m[g]:p[g],$)}function j(m){return m<0?0:Math.floor(m)}function P(m,g){return Math.floor(Math.random()*(g-m))+m}function x(m){return parseInt(m,16)}function E(m){return m.map(T)}function T(m){var g=String(m).replace(/[^0-9a-f]/gi,"");return g.length<6&&(g=g[0]+g[0]+g[1]+g[1]+g[2]+g[2]),{r:x(g.substring(0,2)),g:x(g.substring(2,4)),b:x(g.substring(4,6))}}function S(m){var g=w(m,"origin",Object);return g.x=w(g,"x",Number),g.y=w(g,"y",Number),g}function A(m){m.width=document.documentElement.clientWidth,m.height=document.documentElement.clientHeight}function M(m){var g=m.getBoundingClientRect();m.width=g.width,m.height=g.height}function I(m){var g=document.createElement("canvas");return g.style.position="fixed",g.style.top="0px",g.style.left="0px",g.style.pointerEvents="none",g.style.zIndex=m,g}function G(m,g,$,F,H,K,X,B,ee){m.save(),m.translate(g,$),m.rotate(K),m.scale(F,H),m.arc(0,0,1,X,B,ee),m.restore()}function ae(m){var g=m.angle*(Math.PI/180),$=m.spread*(Math.PI/180);return{x:m.x,y:m.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:m.startVelocity*.5+Math.random()*m.startVelocity,angle2D:-g+(.5*$-Math.random()*$),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:m.color,shape:m.shape,tick:0,totalTicks:m.ticks,decay:m.decay,drift:m.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:m.gravity*3,ovalScalar:.6,scalar:m.scalar,flat:m.flat}}function V(m,g){g.x+=Math.cos(g.angle2D)*g.velocity+g.drift,g.y+=Math.sin(g.angle2D)*g.velocity+g.gravity,g.velocity*=g.decay,g.flat?(g.wobble=0,g.wobbleX=g.x+10*g.scalar,g.wobbleY=g.y+10*g.scalar,g.tiltSin=0,g.tiltCos=0,g.random=1):(g.wobble+=g.wobbleSpeed,g.wobbleX=g.x+10*g.scalar*Math.cos(g.wobble),g.wobbleY=g.y+10*g.scalar*Math.sin(g.wobble),g.tiltAngle+=.1,g.tiltSin=Math.sin(g.tiltAngle),g.tiltCos=Math.cos(g.tiltAngle),g.random=Math.random()+2);var $=g.tick++/g.totalTicks,F=g.x+g.random*g.tiltCos,H=g.y+g.random*g.tiltSin,K=g.wobbleX+g.random*g.tiltCos,X=g.wobbleY+g.random*g.tiltSin;if(m.fillStyle="rgba("+g.color.r+", "+g.color.g+", "+g.color.b+", "+(1-$)+")",m.beginPath(),i&&g.shape.type==="path"&&typeof g.shape.path=="string"&&Array.isArray(g.shape.matrix))m.fill(q(g.shape.path,g.shape.matrix,g.x,g.y,Math.abs(K-F)*.1,Math.abs(X-H)*.1,Math.PI/10*g.wobble));else if(g.shape.type==="bitmap"){var B=Math.PI/10*g.wobble,ee=Math.abs(K-F)*.1,de=Math.abs(X-H)*.1,J=g.shape.bitmap.width*g.scalar,Y=g.shape.bitmap.height*g.scalar,ie=new DOMMatrix([Math.cos(B)*ee,Math.sin(B)*ee,-Math.sin(B)*de,Math.cos(B)*de,g.x,g.y]);ie.multiplySelf(new DOMMatrix(g.shape.matrix));var he=m.createPattern(d.transform(g.shape.bitmap),"no-repeat");he.setTransform(ie),m.globalAlpha=1-$,m.fillStyle=he,m.fillRect(g.x-J/2,g.y-Y/2,J,Y),m.globalAlpha=1}else if(g.shape==="circle")m.ellipse?m.ellipse(g.x,g.y,Math.abs(K-F)*g.ovalScalar,Math.abs(X-H)*g.ovalScalar,Math.PI/10*g.wobble,0,2*Math.PI):G(m,g.x,g.y,Math.abs(K-F)*g.ovalScalar,Math.abs(X-H)*g.ovalScalar,Math.PI/10*g.wobble,0,2*Math.PI);else if(g.shape==="star")for(var te=Math.PI/2*3,be=4*g.scalar,Le=8*g.scalar,$e=g.x,Ue=g.y,Be=5,qe=Math.PI/Be;Be--;)$e=g.x+Math.cos(te)*Le,Ue=g.y+Math.sin(te)*Le,m.lineTo($e,Ue),te+=qe,$e=g.x+Math.cos(te)*be,Ue=g.y+Math.sin(te)*be,m.lineTo($e,Ue),te+=qe;else m.moveTo(Math.floor(g.x),Math.floor(g.y)),m.lineTo(Math.floor(g.wobbleX),Math.floor(H)),m.lineTo(Math.floor(K),Math.floor(X)),m.lineTo(Math.floor(F),Math.floor(g.wobbleY));return m.closePath(),m.fill(),g.tick<g.totalTicks}function L(m,g,$,F,H){var K=g.slice(),X=m.getContext("2d"),B,ee,de=u(function(J){function Y(){B=ee=null,X.clearRect(0,0,F.width,F.height),d.clear(),H(),J()}function ie(){s&&!(F.width===n.width&&F.height===n.height)&&(F.width=m.width=n.width,F.height=m.height=n.height),!F.width&&!F.height&&($(m),F.width=m.width,F.height=m.height),X.clearRect(0,0,F.width,F.height),K=K.filter(function(he){return V(X,he)}),K.length?B=h.frame(ie):Y()}B=h.frame(ie),ee=Y});return{addFettis:function(J){return K=K.concat(J),de},canvas:m,promise:de,reset:function(){B&&h.cancel(B),ee&&ee()}}}function C(m,g){var $=!m,F=!!w(g||{},"resize"),H=!1,K=w(g,"disableForReducedMotion",Boolean),X=a&&!!w(g||{},"useWorker"),B=X?f():null,ee=$?A:M,de=m&&B?!!m.__confetti_initialized:!1,J=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,Y;function ie(te,be,Le){for(var $e=w(te,"particleCount",j),Ue=w(te,"angle",Number),Be=w(te,"spread",Number),qe=w(te,"startVelocity",Number),se=w(te,"decay",Number),ce=w(te,"gravity",Number),_e=w(te,"drift",Number),z=w(te,"colors",E),Z=w(te,"ticks",Number),pe=w(te,"shapes"),je=w(te,"scalar"),ke=!!w(te,"flat"),Ie=S(te),Je=$e,Ae=[],Et=m.width*Ie.x,Pe=m.height*Ie.y;Je--;)Ae.push(ae({x:Et,y:Pe,angle:Ue,spread:Be,startVelocity:qe,color:z[Je%z.length],shape:pe[P(0,pe.length)],ticks:Z,decay:se,gravity:ce,drift:_e,scalar:je,flat:ke}));return Y?Y.addFettis(Ae):(Y=L(m,Ae,ee,be,Le),Y.promise)}function he(te){var be=K||w(te,"disableForReducedMotion",Boolean),Le=w(te,"zIndex",Number);if(be&&J)return u(function(qe){qe()});$&&Y?m=Y.canvas:$&&!m&&(m=I(Le),document.body.appendChild(m)),F&&!de&&ee(m);var $e={width:m.width,height:m.height};B&&!de&&B.init(m),de=!0,B&&(m.__confetti_initialized=!0);function Ue(){if(B){var qe={getBoundingClientRect:function(){if(!$)return m.getBoundingClientRect()}};ee(qe),B.postMessage({resize:{width:qe.width,height:qe.height}});return}$e.width=$e.height=null}function Be(){Y=null,F&&(H=!1,e.removeEventListener("resize",Ue)),$&&m&&(document.body.contains(m)&&document.body.removeChild(m),m=null,de=!1)}return F&&!H&&(H=!0,e.addEventListener("resize",Ue,!1)),B?B.fire(te,$e,Be):ie(te,$e,Be)}return he.reset=function(){B&&B.reset(),Y&&Y.reset()},he}var R;function D(){return R||(R=C(null,{useWorker:!0,resize:!0})),R}function q(m,g,$,F,H,K,X){var B=new Path2D(m),ee=new Path2D;ee.addPath(B,new DOMMatrix(g));var de=new Path2D;return de.addPath(ee,new DOMMatrix([Math.cos(X)*H,Math.sin(X)*H,-Math.sin(X)*K,Math.cos(X)*K,$,F])),de}function Q(m){if(!i)throw new Error("path confetti are not supported in this browser");var g,$;typeof m=="string"?g=m:(g=m.path,$=m.matrix);var F=new Path2D(g),H=document.createElement("canvas"),K=H.getContext("2d");if(!$){for(var X=1e3,B=X,ee=X,de=0,J=0,Y,ie,he=0;he<X;he+=2)for(var te=0;te<X;te+=2)K.isPointInPath(F,he,te,"nonzero")&&(B=Math.min(B,he),ee=Math.min(ee,te),de=Math.max(de,he),J=Math.max(J,te));Y=de-B,ie=J-ee;var be=10,Le=Math.min(be/Y,be/ie);$=[Le,0,0,Le,-Math.round(Y/2+B)*Le,-Math.round(ie/2+ee)*Le]}return{type:"path",path:g,matrix:$}}function ne(m){var g,$=1,F="#000000",H='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof m=="string"?g=m:(g=m.text,$="scalar"in m?m.scalar:$,H="fontFamily"in m?m.fontFamily:H,F="color"in m?m.color:F);var K=10*$,X=""+K+"px "+H,B=new OffscreenCanvas(K,K),ee=B.getContext("2d");ee.font=X;var de=ee.measureText(g),J=Math.ceil(de.actualBoundingBoxRight+de.actualBoundingBoxLeft),Y=Math.ceil(de.actualBoundingBoxAscent+de.actualBoundingBoxDescent),ie=2,he=de.actualBoundingBoxLeft+ie,te=de.actualBoundingBoxAscent+ie;J+=ie+ie,Y+=ie+ie,B=new OffscreenCanvas(J,Y),ee=B.getContext("2d"),ee.font=X,ee.fillStyle=F,ee.fillText(g,he,te);var be=1/$;return{type:"bitmap",bitmap:B.transferToImageBitmap(),matrix:[be,0,0,be,-J*be/2,-Y*be/2]}}t.exports=function(){return D().apply(this,arguments)},t.exports.reset=function(){D().reset()},t.exports.create=C,t.exports.shapeFromPath=Q,t.exports.shapeFromText=ne})(function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}}(),_s,!1);const zr=_s.exports;_s.exports.create;var Od=N('<main class="svelte-1lzp8li"><h1>Signup</h1> <form class="svelte-1lzp8li"><label for="email" class="svelte-1lzp8li">Email:</label> <input class="email svelte-1lzp8li" type="email"/> <label for="password" class="svelte-1lzp8li">Password:</label> <input class="password svelte-1lzp8li" type="password"/> <button class="sign-up svelte-1lzp8li" type="submit">Sign up</button> <!></form></main>');function jd(r,e){Re(e,!0);let t="",s="",n="",a=O(W(n.statusError)),i=O(W(n.statusType));async function o(){await l()}async function l(){console.log("Signing up...");let{data:w,error:j}=await oe.auth.signUp({email:t,password:s,options:{emailRedirectTo:"https://ewan.is-a.dev/#/app/login/"}});j&&j.message.includes("Password should contain at least one character of each")?(_(a,""),_(i,""),_(a,"Password must contain capital letters, lowercase letters, numbers and special characters."),_(i,"warn")):j&&j.message?(_(i,""),_(i,"error"),_(a,""),_(a,j.message,!0)):w&&!j&&(_(a,"Signup successful! Try logging in with your details!."),_(i,"success"),console.log("User signed up successfully",w),u())}function u(){zr({particleCount:200,spread:70,origin:{y:.6}})}var d=Od(),h=y(b(d),2),f=y(b(h),2),p=y(f,4),v=y(p,4);{var k=w=>{Pt(w,{get type(){return c(i)},get message(){return c(a)}})};le(v,w=>{c(a)&&c(i)&&w(k)})}Ye("submit",h,w=>{w.preventDefault(),o()}),pt(f,()=>t,w=>t=w),pt(p,()=>s,w=>s=w),U(r,d),De()}var Ad=N('<!> <a class="continue svelte-1x05zx6" href="./#/app/home">Continue here</a>',1),Pd=N('<main class="route svelte-1x05zx6"><section class="main-page"><h1 class="page-header">Login</h1> <section class="main-content"><form class="svelte-1x05zx6"><label for="email" class="svelte-1x05zx6">Email:</label> <input class="email svelte-1x05zx6" type="email"/> <label for="password" class="svelte-1x05zx6">Password:</label> <input class="password svelte-1x05zx6" type="password"/> <button class="log-in svelte-1x05zx6" type="submit">Sign in</button> <!> <!></form></section></section></main>');function Cd(r,e){Re(e,!0);let t=O(""),s=O(""),n="",a=O(""),i=O("");async function o(){let{data:E,error:T}=await oe.auth.signInWithPassword({email:c(t),password:c(s)});T?(T&&T.message.includes("profiles_email_key")&&_(a,""),_(a,T.message,!0)):(_(i,E,!0),console.log("Login successful",n),_(a,""),u(),l(E.user.email))}async function l(E){const{error:T}=await oe.from("profiles").insert({email:E});T&&T.message?console.error(T.message):T||(_(a,""),console.log("User added to profiles table"))}function u(){zr({particleCount:200,spread:70,origin:{y:.6}})}var d=Pd(),h=b(d),f=y(b(h),2),p=b(f),v=y(b(p),2),k=y(v,4),w=y(k,4);{var j=E=>{Pt(E,{type:"error",get message(){return c(a)},width:"100%"})};le(w,E=>{c(a)&&E(j)})}var P=y(w,2);{var x=E=>{var T=Ad(),S=Oe(T);Pt(S,{type:"success",message:"Login successful!",width:"100%"}),U(E,T)};le(P,E=>{!c(a)&&c(i)&&E(x)})}Ye("submit",p,E=>{E.preventDefault(),o()}),pt(v,()=>c(t),E=>_(t,E)),pt(k,()=>c(s),E=>_(s,E)),U(r,d),De()}var Md=N('<!> <a class="continue svelte-6jdv1j" href="./#/app/home">Continue here</a>',1),Id=N('<main class="route svelte-6jdv1j"><section class="main-page"><h1 class="page-header">Login</h1> <section class="main-content"><form class="svelte-6jdv1j"><label for="email" class="svelte-6jdv1j">Email:</label> <input class="email svelte-6jdv1j" type="email"/> <label for="password" class="svelte-6jdv1j">Password:</label> <input class="password svelte-6jdv1j" type="password"/> <button class="log-in svelte-6jdv1j" type="submit">Sign in</button> <!> <!></form></section></section></main>');function Rd(r,e){Re(e,!0);let t=O(""),s=O(""),n="",a=O(""),i=O("");async function o(){let{data:E,error:T}=await oe.auth.signInWithPassword({email:c(t),password:c(s)});T?(T&&T.message.includes("profiles_email_key")&&_(a,""),_(a,T.message,!0)):(_(i,E,!0),console.log("Login successful",n),_(a,""),u(),l(E.user.email))}async function l(E){const{error:T}=await oe.from("profiles").insert({email:E});T&&T.message?console.error(T.message):T||(_(a,""),console.log("User added to profiles table"))}function u(){zr({particleCount:200,spread:70,origin:{y:.6}})}var d=Id(),h=b(d),f=y(b(h),2),p=b(f),v=y(b(p),2),k=y(v,4),w=y(k,4);{var j=E=>{Pt(E,{type:"error",get message(){return c(a)},width:"100%"})};le(w,E=>{c(a)&&E(j)})}var P=y(w,2);{var x=E=>{var T=Md(),S=Oe(T);Pt(S,{type:"success",message:"Login successful!",width:"100%"}),U(E,T)};le(P,E=>{!c(a)&&c(i)&&E(x)})}Ye("submit",p,E=>{E.preventDefault(),o()}),pt(v,()=>c(t),E=>_(t,E)),pt(k,()=>c(s),E=>_(s,E)),U(r,d),De()}var Dd=N("<option> </option>"),$d=N("<option> </option>"),Ld=N('<span><label for="language">Select further detail:</label> <select class="language svelte-1d376ng" required><option>--Select--</option><!></select></span>'),Ud=N('<p class="not-found svelte-1d376ng">:/ Oops! No songs found; try uploading your own or try again later.</p>'),zd=N("<p>Try selecting a language to show media. If no languages show up, come back later as the servers may be down.</p>"),qd=N('<main class="route svelte-1d376ng"><!> <section class="main-page svelte-1d376ng"><h1 class="page-header svelte-1d376ng">Songs</h1> <section class="main-content svelte-1d376ng"><select class="svelte-1d376ng"></select> <!> <section class="media-container svelte-1d376ng"><!> <!> <!></section></section></section></main>');function Nd(r,e){Re(e,!0);let t=O(W([])),s=O(W([])),n=O(""),a=O(""),i=O("");async function o(M){const{data:I,error:G}=await oe.from("media").select("*").eq("language",M).eq("media_type","music");G?console.error("Error fetching songs:",G):(console.log(c(t)),console.log(I),I.forEach(ae=>{c(t).push(ae||[])}),console.log(c(t)))}Se(()=>{console.log(c(t))});async function l(){const{data:M,error:I}=await oe.from("languages").select("*");if(M)return _(s,M,!0),console.log(c(s)),M;if(I)throw I}tt(()=>{l()}),Se(()=>{_(t,[],!0),Array.isArray(c(n))&&c(n).forEach(M=>{console.log(M),o(M)})});let u=O(void 0),d=O(void 0);Se(()=>{var M;_(u,c(s).find(I=>I.short===c(a)),!0),_(d,(M=c(u))==null?void 0:M.sub_options,!0),console.log(c(d))}),Se(()=>{c(a).length===1?_(n,c(a),!0):_(n,c(i),!0)}),Se(()=>{console.log(c(n))});var h=qd(),f=b(h);St(f,{currentPage:"/music"});var p=y(f,2),v=y(b(p),2),k=b(v);Me(k,21,()=>c(s),Ce,(M,I,G,ae)=>{var V=Dd(),L=b(V),C={};fe(()=>{re(L,`${c(I).emoji??""} ${c(I).name??""}`),C!==(C=c(I).short)&&(V.value=(V.__value=c(I).short)??"")}),U(M,V)});var w=y(k,2);{var j=M=>{var I=Ld(),G=y(b(I),2),ae=b(G);ae.value=ae.__value="";var V=y(ae);Me(V,17,()=>c(d),Ce,(L,C)=>{var R=$d(),D=b(R),q={};fe(()=>{re(D,c(C).name),q!==(q=c(C).codes)&&(R.value=(R.__value=c(C).codes)??"")}),U(L,R)}),He(G,()=>c(i),L=>_(i,L)),U(M,I)};le(w,M=>{c(a).length>1&&M(j)})}var P=y(w,2),x=b(P);{var E=M=>{var I=Ud();U(M,I)};le(x,M=>{!c(t)[0]&&c(n)&&M(E)})}var T=y(x,2);{var S=M=>{var I=zd();U(M,I)};le(T,M=>{c(a)||M(S)})}var A=y(T,2);Me(A,17,()=>c(t),Ce,(M,I)=>{{let G=Ar(()=>`#/app/songs/${c(I).id}`);ea(M,{get name(){return c(I).name},get artist(){return c(I).artist},get cover(){return c(I).cover},get level(){return c(I).level},get rating(){return c(I).rating},get link(){return c(G)},type:"song"})}}),He(k,()=>c(a),M=>_(a,M)),U(r,h),De()}var Fd=N('<span class="svelte-1wzg23z"><h1 class="song svelte-1wzg23z"> </h1><h1 class="artist svelte-1wzg23z"> </h1></span>');function go(r,e){let t=ye(e,"song",8,"Loading..."),s=ye(e,"artist",8,"Loading...");var n=Fd(),a=b(n),i=b(a),o=y(a),l=b(o);fe(()=>{re(i,t()),re(l,s())}),U(r,n)}var Bd=N('<i><p class="romanisation svelte-1m7wp3l"> </p></i>'),Wd=N("<option> </option>"),Vd=N(`<span class="flashcard-functions svelte-1m7wp3l"><span class="flashcard-upload svelte-1m7wp3l"><button class="add-to-deck flashcard-btn svelte-1m7wp3l"><span class="material-symbols-rounded svelte-1m7wp3l">library_add</span></button> <select class="svelte-1m7wp3l"></select></span> <button class="info-flashcards-btn flashcard-btn svelte-1m7wp3l"><span class="material-symbols-rounded svelte-1m7wp3l">info</span></button></span> <dialog class="info-flashcards-container svelte-1m7wp3l"><strong class="definition-info-header">Where's my deck?</strong> <p class="definition-info-body svelte-1m7wp3l">This is as you may not yet have a deck for the language you are curretly studying; You can only add words to decks of the same language</p> <button class="close-dialog svelte-1m7wp3l">OK</button></dialog>`,1),Hd=N('<div class="header svelte-1m7wp3l"><h1 class="svelte-1m7wp3l"> </h1> <button class="close-btn svelte-1m7wp3l">X</button></div> <!> <p class="part-of-speech svelte-1m7wp3l"> </p> <p class="svelte-1m7wp3l"> </p> <!> <!>',1),Jd=N('<section class="definition-container svelte-1m7wp3l"><section class="definition svelte-1m7wp3l"><!></section></section>');function _o(r,e){Re(e,!0);let t=ye(e,"word",7),s=ye(e,"language",7),n=O(W({message:"",type:""})),a=O(void 0),i=O(W([])),o=O(W(HTMLObjectElement));W(HTMLObjectElement);let l=O("");tt(async()=>{f()}),Se(async()=>{c(l)?(_(i,await h(c(l)),!0),console.log(c(i))):_(i,[],!0)});async function u(j){const{data:P,error:x}=await oe.from("flashcard_decks").select("content").eq("id",j);return x?(_(n,{type:"error",message:x.message},!0),[]):P[0].content}async function d(j){const P=await u(j);P.push({word:t(),definition:e.definition,partOfSpeech:e.partOfSpeech,romanisation:e.romanisation});const{error:x}=await oe.from("flashcard_decks").update({content:P}).eq("id",j);if(x&&x.message==='invalid input syntax for type bigint: "undefined"')return _(n,{type:"error",message:"You haven't selected a deck. Try making one on 'Flashcards' page"},!0),x;if(x)return _(n,{type:"error",message:gerror.message},!0),x;_(n,{type:"success",message:"Added!"},!0)}async function h(j){s("language");const{data:P,error:x}=await oe.from("flashcard_decks").select("*").eq("author",j);return x?(console.error(x),_(n,{type:"error",message:x.message},!0),x):(console.log(P),P)}async function f(){const{data:j,error:P}=await oe.auth.getSession(),x=j;P?console.error("Error fetching session:",P):x&&_(l,x.session.user.id,!0)}var p=Jd(),v=b(p),k=b(v);{var w=j=>{var P=Hd(),x=Oe(P),E=b(x),T=b(E),S=y(E,2),A=y(x,2);{var M=D=>{var q=Bd(),Q=b(q),ne=b(Q);fe(()=>re(ne,e.romanisation)),U(D,q)};le(A,D=>{e.romanisation&&D(M)})}var I=y(A,2),G=b(I),ae=y(I,2),V=b(ae),L=y(ae,2);{var C=D=>{var q=Vd(),Q=Oe(q),ne=b(Q),m=b(ne),g=y(m,2);Me(g,21,()=>c(i),Ce,(B,ee)=>{var de=Wd(),J=b(de),Y={};fe(()=>{re(J,c(ee).name),Y!==(Y=c(ee).id)&&(de.value=(de.__value=c(ee).id)??"")}),U(B,de)});var $=y(ne,2),F=Ar(()=>c(o).showModal()),H=y(Q,2),K=y(b(H),4),X=Ar(()=>c(o).close());ht(H,B=>_(o,B),()=>c(o)),Ye("click",m,()=>d(c(a))),He(g,()=>c(a),B=>_(a,B)),Ye("click",$,function(...B){var ee;(ee=c(F))==null||ee.apply(this,B)}),Ye("click",K,function(...B){var ee;(ee=c(X))==null||ee.apply(this,B)}),U(D,q)};le(L,D=>{c(i)&&D(C)})}var R=y(L,2);Pt(R,{get type(){return c(n).type},get message(){return c(n).message}}),fe(()=>{re(T,t()),re(G,e.partOfSpeech),re(V,e.definition)}),Ye("click",S,function(...D){var q;(q=t(""))==null||q.apply(this,D)}),U(j,P)};le(k,j=>{t()&&j(w)})}U(r,p),De()}var fn={},vn={},Ya;function Kd(){return Ya||(Ya=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.TARGET_URL_HEADER=void 0,r.withMiddleware=e,r.withProxy=t;function e(...s){return n=>s.reduce((a,i)=>a.then(o=>i(o)),Promise.resolve(n))}r.TARGET_URL_HEADER="x-fal-target-url";function t(s){return typeof window>"u"?n=>Promise.resolve(n):n=>Promise.resolve(Object.assign(Object.assign({},n),{url:s.targetUrl,headers:Object.assign(Object.assign({},n.headers||{}),{[r.TARGET_URL_HEADER]:n.url})}))}}(vn)),vn}var _t={},Qa;function Gd(){if(Qa)return _t;Qa=1;var r=_t&&_t.__awaiter||function(n,a,i,o){function l(u){return u instanceof i?u:new i(function(d){d(u)})}return new(i||(i=Promise))(function(u,d){function h(v){try{p(o.next(v))}catch(k){d(k)}}function f(v){try{p(o.throw(v))}catch(k){d(k)}}function p(v){v.done?u(v.value):l(v.value).then(h,f)}p((o=o.apply(n,a||[])).next())})};Object.defineProperty(_t,"__esModule",{value:!0}),_t.ValidationError=_t.ApiError=void 0,_t.defaultResponseHandler=s;class e extends Error{constructor({message:a,status:i,body:o}){super(a),this.name="ApiError",this.status=i,this.body=o}}_t.ApiError=e;class t extends e{constructor(a){super(a),this.name="ValidationError"}get fieldErrors(){return typeof this.body.detail=="string"?[{loc:["body"],msg:this.body.detail,type:"value_error"}]:this.body.detail||[]}getFieldErrors(a){return this.fieldErrors.filter(i=>i.loc[i.loc.length-1]===a)}}_t.ValidationError=t;function s(n){return r(this,void 0,void 0,function*(){var a;const{status:i,statusText:o}=n,l=(a=n.headers.get("Content-Type"))!==null&&a!==void 0?a:"";if(!n.ok){if(l.includes("application/json")){const u=yield n.json(),d=i===422?t:e;throw new d({message:u.message||o,status:i,body:u})}throw new e({message:`HTTP ${i}: ${o}`,status:i})}return l.includes("application/json")?n.json():l.includes("text/html")?n.text():l.includes("application/octet-stream")?n.arrayBuffer():n.text()})}return _t}var Za;function Yd(){return Za||(Za=1,function(r){var e={};Object.defineProperty(r,"__esModule",{value:!0}),r.credentialsFromEnv=void 0,r.resolveDefaultFetch=n,r.config=u,r.getConfig=d,r.getRestApiUrl=h;const t=Kd(),s=Gd();function n(){if(typeof fetch>"u")throw new Error("Your environment does not support fetch. Please provide your own fetch implementation.");return fetch}function a(){return typeof process<"u"&&e&&(typeof e.FAL_KEY<"u"||typeof e.FAL_KEY_ID<"u"&&typeof e.FAL_KEY_SECRET<"u")}const i=()=>{if(a())return typeof e.FAL_KEY<"u"?e.FAL_KEY:`${e.FAL_KEY_ID}:${e.FAL_KEY_SECRET}`};r.credentialsFromEnv=i;const o={credentials:r.credentialsFromEnv,suppressLocalCredentialsWarning:!1,requestMiddleware:f=>Promise.resolve(f),responseHandler:s.defaultResponseHandler};let l;function u(f){var p;l=Object.assign(Object.assign(Object.assign({},o),f),{fetch:(p=f.fetch)!==null&&p!==void 0?p:n()}),f.proxyUrl&&(l=Object.assign(Object.assign({},l),{requestMiddleware:(0,t.withMiddleware)((0,t.withProxy)({targetUrl:f.proxyUrl}),l.requestMiddleware)}));const{credentials:v,suppressLocalCredentialsWarning:k}=l,w=typeof v=="function"?v():v;typeof window<"u"&&w&&!k&&console.warn("The fal credentials are exposed in the browser's environment. That's not recommended for production use cases.")}function d(){return l||(console.info("Using default configuration for the fal client"),Object.assign(Object.assign({},o),{fetch:n()}))}function h(){return"https://rest.alpha.fal.ai"}}(fn)),fn}Yd();var Qd=N('<img class="throbber svelte-61xipn" src="https://upload.wikimedia.org/wikipedia/commons/7/7a/Ajax_loader_metal_512.gif"/>'),Zd=N('<p class="current-line svelte-61xipn"> </p>'),Xd=N('<!> <!> <span class="svelte-61xipn"><span class="main-subtitles svelte-61xipn"></span> <p class="full-translate svelte-61xipn"> </p> <button class="show-translations-btn svelte-61xipn">Show translations</button></span>',1);function ta(r,e){Re(e,!0);const t=ye(e,"currentLine",3,"Play the video to see live subtitles. Click on an individual word for a definition!"),s=ye(e,"targetLanguage",3,""),n=ye(e,"nativeLanguage",3,"en");let a="",i=O(W(a.term)),o=O(W(a.definition)),l=O(W(a.partOfSpeech)),u=O(W(a.original)),d=O(W(a.translated)),h=O(W(a.romanisation)),f=!0,p=O(W([])),v=O(!0),k=!0;Se(()=>{const V=new Intl.Segmenter("zh",{granularity:"word"});_(p,[...V.segment(t())].map(L=>L.segment),!0),j(t())});async function w(V,L){_(v,!1),console.log("Fetching definition for ",V);try{const C=L.join(" "),D=await(await fetch("/.netlify/functions/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:"Translate this word based of context. Return no tags, no markup, just raw JSON with keys `word` (original), `partOfSpeech`, `romanisation` and `definition` (meaning based off context and also simple, normal person-readable info about conjugation) but ONLY return `romanisation` where it is not necessary. For example non-Latin scripts",word:V,context:C,originalWordLanguageISO6391:s(),translatedWordLanguageISO6391:n()})})).json(),q=JSON.parse(D.reply);console.log(q),_(v,!0),_(i,q.word,!0),_(o,q.definition,!0),_(l,q.partOfSpeech,!0),_(h,q.romanisation,!0)}catch(C){console.error(C)}}async function j(V,L,C){if(k)try{const D=await(await fetch("/.netlify/functions/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:"Translate this sentence and return no tags, no markup, just raw JSON with keys `original` and `translated` }",originalSentence:C,originalSentenceLanguageISO6391:V,translatedSentenceLanguageISO6391:L})})).json(),q=JSON.parse(D.reply);console.log(q),_(u,q.original,!0),_(d,q.translated,!0)}catch(R){console.error(R)}else console.log("Subtitle translations turned off!")}async function P(){const V=document.getElementsByClassName("full-translate"),L=document.getElementsByClassName("show-translations-btn");f=!f,Array.from(V).forEach(C=>{f===!0?(k=!0,C.style.display="block"):(k=!1,C.style.display="none")}),Array.from(L).forEach(C=>{f===!0?C.style.display="none":C.style.display="block"})}var x=Xd(),E=Oe(x);{var T=V=>{var L=Qd();U(V,L)};le(E,V=>{c(v)||V(T)})}var S=y(E,2);_o(S,{get word(){return c(i)},get definition(){return c(o)},get partOfSpeech(){return c(l)},get romanisation(){return c(h)},get language(){return s()}});var A=y(S,2),M=b(A);Me(M,21,()=>c(p),Ce,(V,L)=>{var C=Zd(),R=b(C);fe(()=>re(R,c(L))),Ye("click",C,()=>w(c(L),c(p))),U(V,C)});var I=y(M,2),G=b(I),ae=y(I,2);fe(()=>re(G,c(d))),Ye("click",I,()=>P()),Ye("click",ae,()=>P()),U(r,x),De()}var eh=N('<span class="author-tag svelte-2mqmtf"><span class="material-symbols-rounded svelte-2mqmtf">person</span> <span class="author-text-container svelte-2mqmtf"><p class="svelte-2mqmtf">Uploaded by:</p> <p class="author svelte-2mqmtf"> </p></span></span>');function mo(r,e){Re(e,!0);let t=ye(e,"author",7,"Loading...");t()&&t(t().slice(0,17)+"...");var s=eh(),n=y(b(s),2),a=y(b(n),2),i=b(a);fe(()=>re(i,t())),U(r,s),De()}function th(r,e){if(r instanceof RegExp)return{keys:!1,pattern:r};var t,s,n,a,i=[],o="",l=r.split("/");for(l[0]||l.shift();n=l.shift();)t=n[0],t==="*"?(i.push("wild"),o+="/(.*)"):t===":"?(s=n.indexOf("?",1),a=n.indexOf(".",1),i.push(n.substring(1,~s?s:~a?a:n.length)),o+=~s&&!~a?"(?:/([^/]+?))?":"/([^/]+?)",~a&&(o+=(~s?"?":"")+"\\"+n.substring(a))):o+="/"+n;return{keys:i,pattern:new RegExp("^"+o+"/?$","i")}}function Xa(){const r=window.location.href.indexOf("#/");let e=r>-1?window.location.href.substr(r+1):"/";const t=e.indexOf("?");let s="";return t>-1&&(s=e.substr(t+1),e=e.substr(0,t)),{location:e,querystring:s}}const ra=Hi(null,function(e){e(Xa());const t=()=>{e(Xa())};return window.addEventListener("hashchange",t,!1),function(){window.removeEventListener("hashchange",t,!1)}}),qr=Ki(ra,r=>r.location);Ki(ra,r=>r.querystring);const ei=Ji(void 0);function rh(r){r?window.scrollTo(r.__svelte_spa_router_scrollX,r.__svelte_spa_router_scrollY):window.scrollTo(0,0)}function sh(r,e){Re(e,!1);let t=ye(e,"routes",24,()=>({})),s=ye(e,"prefix",8,""),n=ye(e,"restoreScrollState",8,!1);class a{constructor(S,A){if(!A||typeof A!="function"&&(typeof A!="object"||A._sveltesparouter!==!0))throw Error("Invalid component object");if(!S||typeof S=="string"&&(S.length<1||S.charAt(0)!="/"&&S.charAt(0)!="*")||typeof S=="object"&&!(S instanceof RegExp))throw Error('Invalid value for "path" argument - strings must start with / or *');const{pattern:M,keys:I}=th(S);this.path=S,typeof A=="object"&&A._sveltesparouter===!0?(this.component=A.component,this.conditions=A.conditions||[],this.userData=A.userData,this.props=A.props||{}):(this.component=()=>Promise.resolve(A),this.conditions=[],this.props={}),this._pattern=M,this._keys=I}match(S){if(s()){if(typeof s()=="string")if(S.startsWith(s()))S=S.substr(s().length)||"/";else return null;else if(s()instanceof RegExp){const G=S.match(s());if(G&&G[0])S=S.substr(G[0].length)||"/";else return null}}const A=this._pattern.exec(S);if(A===null)return null;if(this._keys===!1)return A;const M={};let I=0;for(;I<this._keys.length;){try{M[this._keys[I]]=decodeURIComponent(A[I+1]||"")||null}catch{M[this._keys[I]]=null}I++}return M}async checkConditions(S){for(let A=0;A<this.conditions.length;A++)if(!await this.conditions[A](S))return!1;return!0}}const i=[];t()instanceof Map?t().forEach((T,S)=>{i.push(new a(S,T))}):Object.keys(t()).forEach(T=>{i.push(new a(T,t()[T]))});let o=er(null),l=er(null),u=er({});const d=lc();async function h(T,S){await Li(),d(T,S)}let f=null,p=null;n()&&(p=T=>{T.state&&(T.state.__svelte_spa_router_scrollY||T.state.__svelte_spa_router_scrollX)?f=T.state:f=null},window.addEventListener("popstate",p),cc(()=>{rh(f)}));let v=null,k=null;const w=ra.subscribe(async T=>{v=T;let S=0;for(;S<i.length;){const A=i[S].match(T.location);if(!A){S++;continue}const M={route:i[S].path,location:T.location,querystring:T.querystring,userData:i[S].userData,params:A&&typeof A=="object"&&Object.keys(A).length?A:null};if(!await i[S].checkConditions(M)){_(o,null),k=null,h("conditionsFailed",M);return}h("routeLoading",Object.assign({},M));const I=i[S].component;if(k!=I){I.loading?(_(o,I.loading),k=I,_(l,I.loadingParams),_(u,{}),h("routeLoaded",Object.assign({},M,{component:c(o),name:c(o).name,params:c(l)}))):(_(o,null),k=null);const G=await I();if(T!=v)return;_(o,G&&G.default||G),k=I}A&&typeof A=="object"&&Object.keys(A).length?_(l,A):_(l,null),_(u,i[S].props),h("routeLoaded",Object.assign({},M,{component:c(o),name:c(o).name,params:c(l)})).then(()=>{ei.set(c(l))});return}_(o,null),k=null,ei.set(void 0)});ic(()=>{w(),p&&window.removeEventListener("popstate",p)}),xl(()=>zi(n()),()=>{history.scrollRestoration=n()?"manual":"auto"}),Tl(),Jn();var j=Bt(),P=Oe(j);{var x=T=>{var S=Bt(),A=Oe(S);ga(A,()=>c(o),(M,I)=>{I(M,Sa({get params(){return c(l)}},()=>c(u),{$$events:{routeEvent(G){ka.call(this,e,G)}}}))}),U(T,S)},E=T=>{var S=Bt(),A=Oe(S);ga(A,()=>c(o),(M,I)=>{I(M,Sa(()=>c(u),{$$events:{routeEvent(G){ka.call(this,e,G)}}}))}),U(T,S)};le(P,T=>{c(l)?T(x):T(E,!1)})}U(r,j),De()}var nh=Hn(N('<script src="https://www.youtube.com/iframe_api"><\/script><!>',1)),ah=N('<main class="route svelte-bcry69"><!> <section class="main-page svelte-bcry69"><h1 class="page-header svelte-bcry69">Music</h1> <section class="main-content svelte-bcry69"><span class="heading svelte-bcry69"><!> <!></span> <iframe id="player" frameborder="0" allowfullscreen="" class="svelte-bcry69"></iframe> <!></section></section></main>');function ih(r,e){Re(e,!0);const t=()=>$r(qr,"$location",s),[s,n]=Lr();let a=O(W(t().split("/").pop())),i,o=O("Loading..."),l=O("Loading..."),u=O("Loading..."),d=O("https://img.youtube.com/vi/loquela/maxresdefault.jpg"),h=O("Unknown Level"),f=O("No Rating"),p=O(""),v=O(W([])),k=O(void 0),w=O("https://youtu.be/zabswqP6xEM");Se(()=>{const C=t().split("/").pop();C!=c(a)&&_(a,C,!0),j().then(()=>{window.YT?x():window.onYouTubeIframeAPIReady=x})}),tt(()=>{fetchLanguages()});async function j(){const{data:C,error:R}=await oe.from("media").select("*").eq("id",c(a)).single();if(C){const D=C;_(o,D.name,!0),_(l,D.artist,!0),_(u,D.author_username,!0),_(d,D.cover,!0),_(h,D.level,!0),_(f,D.rating,!0),_(p,D.language,!0),_(w,D.embed_link,!0),_(v,D.content.events,!0),console.log(c(v)),console.log(`${c(w)}?enablejsapi=1`);const q={name:c(o),artist:c(l),cover:c(d),level:c(h),rating:c(f),id:c(a)};E(q)}else _(o,"Unknown Song"),_(l,"Unknown Artist"),_(d,"https://img.youtube.com/vi/loquela/maxresdefault.jpg"),_(h,"Unknown Level"),_(f,"No Rating"),_(w,"https://youtu.be/zabswqP6xEM")}function P(C){let R=0;c(v).forEach(D=>{C>D.tStartMs&&C<c(v)[R+1].tStartMs&&D.segs.forEach(q=>{c(k)!==q.utf8&&_(k,q.utf8,!0)}),R++})}function x(){i=new YT.Player("player",{events:{onReady:()=>{setInterval(()=>{const C=i.getCurrentTime(),R=Math.round(C*1e3);P(R)},1)}}})}async function E(C){const{data:R,readError:D}=await oe.from("profiles").select("recent_music").eq("user_id",uid).single();console.log(R.recent_music);const q=R.recent_music;q.includes(C)&&q.pop(C),q.length===10&&q.splice(0,1),q.push(C),console.log(q);const{updateData:Q,updateError:ne}=await oe.from("profiles").update({recent_music:q}).eq("user_id",uid);ne&&console.error(ne),Q&&console.log(Q)}var T=ah();Vn(C=>{var R=nh();y(Oe(R)),U(C,R)});var S=b(T);St(S,{currentPage:"/music"});var A=y(S,2),M=y(b(A),2),I=b(M),G=b(I);go(G,{get song(){return c(o)},get artist(){return c(l)}});var ae=y(G,2);mo(ae,{get author(){return c(u)}});var V=y(I,2),L=y(V,2);ta(L,{get currentLine(){return c(k)},get targetLanguage(){return c(p)}}),fe(()=>{ze(V,"src",`${c(w)}?enablejsapi=1`),ze(V,"title",c(o))}),U(r,T),De(),n()}var oh=N('<option class="svelte-1xupfpx"> </option>'),lh=N('<option class="svelte-1xupfpx"> </option>'),ch=N('<span class="svelte-1xupfpx"><label for="language">* Select further detail:</label> <select class="language svelte-1xupfpx" required><option class="svelte-1xupfpx">--Select--</option><!></select></span>'),uh=N('<option class="svelte-1xupfpx"> </option>'),dh=N('<main class="route  svelte-1xupfpx"><!> <section class="main-page svelte-1xupfpx"><h1 class="page-header svelte-1xupfpx">Upload</h1> <section class="notice svelte-1xupfpx"><h3 class="notice-text svelte-1xupfpx">Notice</h3> <p class="notice-text svelte-1xupfpx">Please ensure video has subtitles enabled by creator!</p></section> <section class="main-content svelte-1xupfpx"><form class="svelte-1xupfpx"><div class="vertical-container svelte-1xupfpx"><span class="svelte-1xupfpx"><label for="media">* Select media type:</label> <select class="media svelte-1xupfpx" required><option class="svelte-1xupfpx">--Pick the medium category--</option><option class="svelte-1xupfpx">ðº YT Video</option><option class="svelte-1xupfpx">ð§ Music</option></select></span> <span class="svelte-1xupfpx"><label for="language">* Select language of content:</label> <select class="language svelte-1xupfpx" required><option class="svelte-1xupfpx">--Select language--</option><!></select></span> <!> <span class="svelte-1xupfpx"><label for="level">* Select level of content:</label> <select class="level svelte-1xupfpx" required><option class="svelte-1xupfpx">--Select a level--</option><option class="svelte-1xupfpx">ð£ A1</option><option class="svelte-1xupfpx">ð¥ A2</option><option class="svelte-1xupfpx">ð¦ B1</option><option class="svelte-1xupfpx">ð¦ B2</option><option class="svelte-1xupfpx">ð¦ C1</option><option class="svelte-1xupfpx">ð¦ C2</option></select></span> <span class="svelte-1xupfpx"><label for="category">* Select category of content:</label> <select class="category svelte-1xupfpx" required><option class="svelte-1xupfpx">--Select category--</option><!></select></span></div> <span class="svelte-1xupfpx"><label for="url">Link to medium:</label> <input class="url svelte-1xupfpx" type="url" placeholder="Enter media URL"/></span> <button type="submit" class="push-btn svelte-1xupfpx"><span class="front-push-btn svelte-1xupfpx">Upload</span></button> <!></form></section></section></main>');function hh(r,e){Re(e,!0);let t=O(W({name:"",type:""})),s="",n="",a=O(""),i=O(""),o="",l="",u=O(W([])),d=O(W([])),h=O(""),f=O(""),p=O(void 0),v=O(void 0);Se(()=>{var se;_(p,c(u).find(ce=>ce.short===c(a)),!0),_(v,(se=c(p))==null?void 0:se.sub_options,!0),console.log(c(v))});async function k(){const{data:se,error:ce}=await oe.from("categories").select("*");_(d,se,!0)}k();function w(){zr({particleCount:600,spread:100,origin:{y:0}})}tt(async()=>{S(),j()});async function j(){const{data:se,error:ce}=await oe.from("languages").select("*");if(se)return _(u,se,!0),console.log(c(u)),se;if(ce)throw ce}async function P(se,ce,_e,z,Z){try{if(await E(ce)){_(t,{type:"warn",name:"This has already been uploaded"},!0);return}se==="video"||se==="music"?(await x(ce,_e,se,z,Z),_(t,{type:"success",name:"Beginning upload..."},!0),w()):_(t,{type:"error",name:"Error in link validation"},!0)}catch(pe){console.error("Upload error:",pe),_(t,{type:"error",name:"Error in upload process"},!0)}}async function x(se,ce,_e,z,Z){const pe=oe.channel("subtitles");await pe.subscribe();const je=await pe.send({type:"broadcast",event:"subtitle-update",payload:{id:1,url:se,lang:ce,type:_e,level:z,author:c(h),author_username:c(f),category:Z}});console.log("Broadcast result:",je)}async function E(se){const{data:ce,error:_e}=await oe.from("media").select("*").eq("video_link",se).single();if(_e){if(_e.details&&_e.details.includes("0 rows"))return!1;console.error("Database error:",_e)}return!!ce}async function T(se,ce,_e,z,Z){try{const pe=await fetch(`https://www.youtube.com/oembed?url=${encodeURIComponent(se)}&format=json`);return console.log(pe),console.log(se),!pe.ok||!se.startsWith("https://www.youtube.com/watch?v=")?(_(t,{type:"error",name:"Invalid URL. Must be in format 'https://www.youtube.com/watch?v='"},!0),!1):(await P(ce,se,_e,z,Z),!0)}catch(pe){return console.error("Validation error:",pe),_(t,{type:"error",name:"Error validating URL"},!0),!1}}async function S(){const{data:se,error:ce}=await oe.auth.getSession(),_e=se;if(ce)console.error("Error fetching session:",ce);else if(_e){_(h,_e.session.user.id,!0);const{data:z,error:Z}=await oe.from("profiles").select("username").eq("user_id",c(h)).single();z&&_(f,z.username,!0),Z&&console.log(Z)}ce&&console.error("Error fetching userID:",ce)}Se(()=>{c(i)?_(i,c(i),!0):_(i,c(a),!0)});var A=dh(),M=b(A);St(M,{currentPage:"/upload"});var I=y(M,2),G=y(b(I),4),ae=b(G),V=b(ae),L=b(V),C=y(b(L),2),R=b(C);R.value=R.__value="";var D=y(R);D.value=D.__value="video";var q=y(D);q.value=q.__value="music";var Q=y(L,2),ne=y(b(Q),2),m=b(ne);m.value=m.__value="";var g=y(m);Me(g,17,()=>c(u),Ce,(se,ce)=>{var _e=oh(),z=b(_e),Z={};fe(()=>{re(z,`${c(ce).emoji??""} ${c(ce).name??""}`),Z!==(Z=c(ce).short)&&(_e.value=(_e.__value=c(ce).short)??"")}),U(se,_e)});var $=y(Q,2);{var F=se=>{var ce=ch(),_e=y(b(ce),2),z=b(_e);z.value=z.__value="";var Z=y(z);Me(Z,17,()=>c(v),Ce,(pe,je)=>{var ke=lh(),Ie=b(ke),Je={};fe(()=>{re(Ie,c(je).name),Je!==(Je=c(je).codes)&&(ke.value=(ke.__value=c(je).codes)??"")}),U(pe,ke)}),He(_e,()=>c(i),pe=>_(i,pe)),U(se,ce)};le($,se=>{c(a).length>1&&se(F)})}var H=y($,2),K=y(b(H),2),X=b(K);X.value=X.__value="";var B=y(X);B.value=B.__value="A1";var ee=y(B);ee.value=ee.__value="A2";var de=y(ee);de.value=de.__value="B1";var J=y(de);J.value=J.__value="B2";var Y=y(J);Y.value=Y.__value="C1";var ie=y(Y);ie.value=ie.__value="C2";var he=y(H,2),te=y(b(he),2),be=b(te);be.value=be.__value="";var Le=y(be);Me(Le,17,()=>c(d),Ce,(se,ce)=>{var _e=uh(),z=b(_e),Z={};fe(()=>{re(z,`${c(ce).emoji??""} ${c(ce).name??""}`),Z!==(Z=c(ce).name)&&(_e.value=(_e.__value=c(ce).name)??"")}),U(se,_e)});var $e=y(V,2),Ue=y(b($e),2),Be=y($e,4);{var qe=se=>{Pt(se,{get type(){return c(t).type},get message(){return c(t).name},width:"17em"})};le(Be,se=>{c(t).name&&se(qe)})}Ye("submit",ae,se=>{se.preventDefault(),T(n,s,c(i),o,l)}),He(C,()=>s,se=>s=se),He(ne,()=>c(a),se=>_(a,se)),He(K,()=>o,se=>o=se),He(te,()=>l,se=>l=se),pt(Ue,()=>n,se=>n=se),U(r,A),De()}var fh=N('<section class="svelte-i5t88f"><span class="text-container svelte-i5t88f"><a class="svelte-i5t88f"><h1 class="name svelte-i5t88f"> </h1></a> <p class="terms svelte-i5t88f"> </p> <p class="author svelte-i5t88f"> </p></span> <span class="language-image-container svelte-i5t88f"><img class="svelte-i5t88f"/></span></section>');function vh(r,e){var t=fh(),s=b(t),n=b(s),a=b(n),i=b(a),o=y(n,2),l=b(o),u=y(o,2),d=b(u),h=y(s,2),f=b(h);fe(()=>{ze(n,"href",`#/app/flashcards/${e.id}`),re(i,e.name),re(l,`Terms: ${e.terms??""}`),re(d,`@${e.author??""}`),ze(f,"src",`https://hatscripts.github.io/circle-flags/flags/${e.country??""}.svg`)}),U(r,t)}var ph=N('<p class="not-found svelte-3pf8ly">:/ Oops! No flashcards found; try uploading your own or try again later.</p>'),gh=N("<option> </option>"),_h=N('<main class="route svelte-3pf8ly"><!> <section class="main-page svelte-3pf8ly"><h1 class="page-header svelte-3pf8ly">Flashcards</h1> <section class="main-content svelte-3pf8ly"><button class="create-flashcard-deck svelte-3pf8ly">+ Create Flashcard Deck</button> <section class="flashcard-decks svelte-3pf8ly"><!> <!></section></section></section></main> <dialog class="svelte-3pf8ly"><div class="dialog-container svelte-3pf8ly"><div><h2 class="svelte-3pf8ly">Create Flashcard Deck</h2> <h1 class="svelte-3pf8ly"> </h1> <form class="svelte-3pf8ly"><span class="svelte-3pf8ly"><label>Deck name:</label> <input class="name svelte-3pf8ly"/></span> <span class="svelte-3pf8ly"><label>Language:</label> <select class="language svelte-3pf8ly"><option>--Select language--</option><!></select></span> <input class="submit-btn svelte-3pf8ly" type="Submit"/></form></div> <button class="close-dialog-button svelte-3pf8ly">Close</button></div></dialog>',1);function mh(r,e){Re(e,!0);let t,s,n,a=O(W([])),i=O(void 0),o=O(""),l=O(W([]));tt(async()=>{h(),u(),t.close()}),Se(async()=>{if(c(i)){const{data:m,error:g}=await oe.from("flashcard_decks").select("*");g&&console.error("Error fetching flashcard decks:",g),_(l,m||[],!0),console.log(c(l))}});async function u(){const{data:m,error:g}=await oe.from("languages").select("*");if(m)return _(a,m,!0),console.log(c(a)),m;if(g)throw g}async function d(m,g,$,F,H){const{error:K}=await oe.from("flashcard_decks").insert({name:m,author:g,author_username:H,language:$,country_code:F,content:[]});console.log(K),location.reload()}async function h(){const{data:m,error:g}=await oe.auth.getSession(),$=m;if(g)console.error("Error fetching session:",g);else if($){_(i,$.session.user.id,!0);const{data:F,error:H}=await oe.from("profiles").select("username").eq("user_id",c(i)).single();F&&_(o,F.username,!0),H&&console.log(H)}}var f=_h(),p=Oe(f),v=b(p);St(v,{currentPage:"/flashcards"});var k=y(v,2),w=y(b(k),2),j=b(w);j.__click=()=>t.showModal();var P=y(j,2),x=b(P);{var E=m=>{var g=ph();U(m,g)};le(x,m=>{c(l)[0]||m(E)})}var T=y(x,2);Me(T,17,()=>c(l),Ce,(m,g)=>{vh(m,{get name(){return c(g).name},get author(){return c(g).author_username},get terms(){return c(g).content.length},get country(){return c(g).country_code},get id(){return c(g).id}})});var S=y(p,2),A=b(S),M=b(A),I=y(b(M),2),G=b(I),ae=y(I,2),V=b(ae),L=y(b(V),2),C=y(V,2),R=y(b(C),2),D=b(R);D.value=D.__value="";var q=y(D);{var Q=m=>{var g=Bt(),$=Oe(g);Me($,17,()=>c(a),Ce,(F,H,K)=>{var X=gh(),B=b(X);X.value=X.__value=K,fe(()=>re(B,`${c(H).emoji??""} ${c(H).name??""}`)),U(F,X)}),U(m,g)};le(q,m=>{c(a)&&m(Q)})}var ne=y(M,2);ne.__click=()=>t.close(),ht(S,m=>t=m,()=>t),fe(()=>re(G,c(a)[n])),Ye("submit",ae,m=>{d(s,c(i),c(a)[n].short,c(a)[n].country_code,c(o))}),pt(L,()=>s,m=>s=m),He(R,()=>n,m=>n=m),U(r,f),De()}cr(["click"]);function yh(r,e){e().forEach(t=>{const s=document.getElementsByClassName(t);s&&Array.from(s).forEach(n=>{n.classList.remove("hidden")})})}function wh(r,e,t,s){e.content[c(t)]&&(c(s).push(e.content[c(t)]),yi(t))}function bh(r,e,t,s,n,a){e.content[c(t)]&&(c(s).push(e.content[c(t)]),yi(t)),c(n)===100&&a()}function kh(r,e,t,s,n){_(e,0),_(t,[],!0),c(s).forEach(a=>{n.content.splice(n.content.indexOf(a),1)}),_(s,[],!0)}var Sh=N('<div class="title-author-container svelte-baker"><h1 class="deck-name-heading svelte-baker"> </h1> <p class="deck-name-author svelte-baker">Uploaded by: <b> </b></p></div>'),Eh=N('<i><p class="romanisation svelte-baker"> </p></i>'),xh=N('<span class="card-count-container svelte-baker"><span class="unsure-count card-count svelte-baker"> </span> <span class="known-count card-count svelte-baker"> </span></span> <div class="flashcard svelte-baker"><h1 class="word svelte-baker"> </h1> <span class="word-details svelte-baker"><!> <p class="part-of-speech svelte-baker"> </p></span> <p class="definition svelte-baker"> </p></div> <span class="buttons svelte-baker"><button class="dont-know flashcard-button svelte-baker"><span class="material-symbols-rounded svelte-baker">do_not_disturb</span>Unsure</button> <button class="flip flashcard-button svelte-baker"><span class="material-symbols-rounded svelte-baker">autorenew</span>Flip</button> <button class="know flashcard-button svelte-baker"><span class="material-symbols-rounded svelte-baker">check_circle</span>Know</button></span>',1),Th=N('<button class="flashcard-continue svelte-baker"><span class="material-symbols-rounded svelte-baker">expand_circle_right</span> Continue with unknown terms</button>'),Oh=N('<p class="svelte-baker">Congratulations! You know all the terms in this deck!</p>'),jh=N('<div class="flashcard svelte-baker"><p class="known-percentage svelte-baker"> </p> <!> <!></div>'),Ah=N('<main class="svelte-baker"><!> <!> <!></main>');function Ph(r,e){Re(e,!0);const t=ye(e,"backContent",19,()=>[]),s=ye(e,"author",3,"");let n=O(0),a=O(W([])),i=O(W([])),o="",l=O(W(o.word)),u=O(W(o.definition)),d=O(W(o.partOfSpeech)),h=O(W(o.romanisation)),f=O(0);Se(()=>{_(f,Math.round(c(i).length/(c(a).length+c(i).length)*100),!0)}),console.log(e.content),tt(()=>{Se(()=>{if(e.content&&Array.isArray(e.content)&&e.content[c(n)]){const S=JSON.parse(e.content[c(n)]);console.log(S),_(l,S.word,!0),_(u,S.definition,!0),_(d,S.partOfSpeech,!0),_(h,S.romanisation,!0),p()}})});function p(){t().forEach(S=>{const A=document.getElementsByClassName(S);A&&Array.from(A).forEach(M=>{M.classList.add("hidden")})})}function v(){zr({particleCount:200,spread:70,origin:{y:0}})}var k=Ah(),w=b(k);{var j=S=>{var A=Sh(),M=b(A),I=b(M),G=y(M,2),ae=y(b(G)),V=b(ae);fe(()=>{re(I,e.deckName),re(V,`@${s()??""}`)}),U(S,A)};le(w,S=>{s()&&e.deckName&&S(j)})}var P=y(w,2);{var x=S=>{var A=xh(),M=Oe(A),I=b(M),G=b(I),ae=y(I,2),V=b(ae),L=y(M,2),C=b(L),R=b(C),D=y(C,2),q=b(D);{var Q=B=>{var ee=Eh(),de=b(ee),J=b(de);fe(()=>re(J,c(h))),U(B,ee)};le(q,B=>{c(h)&&B(Q)})}var ne=y(q,2),m=b(ne),g=y(D,2),$=b(g),F=y(L,2),H=b(F);H.__click=[wh,e,n,a];var K=y(H,2);K.__click=[yh,t];var X=y(K,2);X.__click=[bh,e,n,i,f,v],fe(()=>{re(G,c(a).length),re(V,c(i).length),re(R,c(l)),re(m,c(d)),re($,c(u))}),U(S,A)};le(P,S=>{c(n)!==e.content.length&&S(x)})}var E=y(P,2);{var T=S=>{var A=jh(),M=b(A),I=b(M),G=y(M,2);{var ae=C=>{var R=Th();R.__click=[kh,n,a,i,e],U(C,R)};le(G,C=>{c(f)!==100&&C(ae)})}var V=y(G,2);{var L=C=>{var R=Oh();U(C,R)};le(V,C=>{c(f)===100&&C(L)})}fe(()=>re(I,`Known: ${c(f)??""}%`)),U(S,A)};le(E,S=>{c(n)===e.content.length&&S(T)})}U(r,k),De()}cr(["click"]);var Ch=N("<h3>Oops! Looks like there are no cards in this deck. Try going to a video, song or AI Chat and add some!</h3>"),Mh=N('<main class="route svelte-967ptl"><!> <section class="main-page svelte-967ptl"><h1 class="page-header svelte-967ptl">Flashcards</h1> <section class="main-content svelte-967ptl"><!> <!></section></section></main>');function Ih(r,e){Re(e,!0);const t=()=>$r(qr,"$location",s),[s,n]=Lr();let a=W(t().split("/").pop()),i=O(W([])),o=O(0),l="",u=O(W(l.flashcardDeckName)),d=O(W(l.flashcardDeckAuthor));tt(async()=>{const E=await h(a);E?(_(u,E.name,!0),_(d,E.author_username,!0),_(i,E.content,!0),_(o,c(i).length,!0),console.log(c(o))):console.error("Flashcards not found")});async function h(E){const{data:T,error:S}=await oe.from("flashcard_decks").select("*").eq("id",E).single();if(S){console.error(S);return}return T}var f=Mh(),p=b(f);St(p,{currentPage:"/flashcards"});var v=y(p,2),k=y(b(v),2),w=b(k);{var j=E=>{Ph(E,{get content(){return c(i)},backContent:["romanisation","part-of-speech","definition"],get deckName(){return c(u)},get author(){return c(d)}})};le(w,E=>{c(i)&&c(i).length>0&&E(j)})}var P=y(w,2);{var x=E=>{var T=Ch();U(E,T)};le(P,E=>{!c(i).length>0&&E(x)})}U(r,f),De(),n()}var Rh=N("<option> </option>"),Dh=N("<option> </option>"),$h=N('<span><label for="language">Select further detail:</label> <select class="language svelte-yxunt" required><option>--Select--</option><!></select></span>'),Lh=N("<p>Try selecting a language to show media. If no languages show up, come back later as the servers may be down.</p>"),Uh=N('<h1 class="category-title svelte-yxunt"> </h1> <section class="category-section svelte-yxunt"></section>',1),zh=N('<main class="route svelte-yxunt"><!> <section class="main-page svelte-yxunt"><h1 class="page-header svelte-yxunt">Videos</h1> <section class="main-content svelte-yxunt"><select class="language-select svelte-yxunt"></select> <!> <section class="media-container svelte-yxunt"><!> <!> <section class="categories-section svelte-yxunt"></section></section></section></section></main>');function qh(r,e){Re(e,!0);let t=O(W([])),s=O(W([])),n="",a=O(""),i=O(""),o=O(""),l=O(""),u=O(W({}));async function d(){const{data:L,error:C}=await oe.from("categories").select("*");_(l,L,!0)}tt(()=>{d()}),Se(()=>{console.log(c(l))});async function h(L){const{data:C,error:R}=await oe.from("media").select("*").eq("language",L).eq("media_type","video");R?console.error("Error fetching videos:",R):(console.log(c(t)),console.log(C),C.forEach(D=>{c(t).push(D||[])}),console.log(c(t)),_(u,[],!0),await p(c(t)))}function f(L){const C=c(l).find(R=>R.name===L);return C?C.emoji:"ð·ï¸"}async function p(L){L.forEach(C=>{if(C){let R=C.category;R||(R="Uncategorised"),!c(u)[R]&&R&&(c(u)[R]=[]),c(u)[R].push(C)}console.log(c(u))})}Se(()=>{console.log(c(t))});async function v(){const{data:L,error:C}=await oe.from("languages").select("*");if(L)return _(s,L,!0),console.log(c(s)),L;if(C)throw C}tt(()=>{v()}),Se(()=>{_(t,[],!0),Array.isArray(c(a))&&c(a).forEach(L=>{console.log(L),h(L)})});let k=O(void 0),w=O(void 0);Se(()=>{var L;_(k,c(s).find(C=>C.short===c(i)),!0),_(w,(L=c(k))==null?void 0:L.sub_options,!0),console.log(c(w))}),Se(()=>{c(i).length===1?_(a,c(i),!0):_(a,c(o),!0)});var j=zh(),P=b(j);St(P,{currentPage:"/videos"});var x=y(P,2),E=y(b(x),2),T=b(E);Me(T,21,()=>c(s),Ce,(L,C,R,D)=>{var q=Rh(),Q=b(q),ne={};fe(()=>{re(Q,`${c(C).emoji??""} ${c(C).name??""}`),ne!==(ne=c(C).short)&&(q.value=(q.__value=c(C).short)??"")}),U(L,q)});var S=y(T,2);{var A=L=>{var C=$h(),R=y(b(C),2),D=b(R);D.value=D.__value="";var q=y(D);Me(q,17,()=>c(w),Ce,(Q,ne)=>{var m=Dh(),g=b(m),$={};fe(()=>{re(g,c(ne).name),$!==($=c(ne).codes)&&(m.value=(m.__value=c(ne).codes)??"")}),U(Q,m)}),He(R,()=>c(o),Q=>_(o,Q)),U(L,C)};le(S,L=>{c(i).length>1&&L(A)})}var M=y(S,2),I=b(M);le(I,L=>{c(t)[0]});var G=y(I,2);{var ae=L=>{var C=Lh();U(L,C)};le(G,L=>{c(i)||L(ae)})}var V=y(G,2);Me(V,21,()=>Object.entries(c(u)),Ce,(L,C,R,D)=>{var q=Ar(()=>Co(c(C),2));let Q=()=>c(q)[0],ne=()=>c(q)[1];var m=Uh(),g=Oe(m),$=b(g),F=y(g,2);Me(F,21,ne,Ce,(H,K)=>{{let X=Ar(()=>`#/app/videos/${c(K).id}`);ea(H,{get name(){return c(K).name},get artist(){return c(K).artist},get cover(){return c(K).cover},get level(){return c(K).level},get rating(){return c(K).rating},get link(){return c(X)},type:"video"})}}),fe(H=>re($,`${H??""} ${Q()??""}`),[()=>f(Q())]),U(L,m)}),He(T,()=>c(i),L=>_(i,L)),U(r,j),De()}var Nh=Hn(N('<script src="https://www.youtube.com/iframe_api"><\/script><!>',1)),Fh=N("<p>Oops. Loquelis is struggling to the media - it may be invalid or unavailable.</p>"),Bh=N('<main class="route svelte-1ml0pbe"><!> <section class="main-page svelte-1ml0pbe"><h1 class="page-header svelte-1ml0pbe">Videos</h1> <section class="main-content svelte-1ml0pbe"><span class="heading svelte-1ml0pbe"><!> <!></span> <iframe id="player" frameborder="0" allowfullscreen="" class="svelte-1ml0pbe"></iframe> <!> <!></section></section></main>');function Wh(r,e){Re(e,!0);const t=()=>$r(qr,"$location",s),[s,n]=Lr();let a=O(W(t().split("/").pop())),i,o=O("Loading..."),l=O("Loading..."),u=O("Loading..."),d=O("Loading..."),h=O("https://img.youtube.com/vi/loquela/maxresdefault.jpg"),f=O("Unknown Level"),p=O("No Rating"),v=O(""),k=O(W([])),w=O(void 0),j=O("https://youtu.be/zabswqP6xEM"),P;Se(async()=>{var $,F;const Q=t().split("/").pop();Q!=c(a)&&_(a,Q,!0),x().then(()=>{window.YT?T():window.onYouTubeIframeAPIReady=T});const{data:ne,error:m}=await oe.auth.getSession(),g=ne;m?console.error("Error fetching session:",m):g&&(P=(F=($=g==null?void 0:g.session)==null?void 0:$.user)==null?void 0:F.id)});async function x(){const{data:Q,error:ne}=await oe.from("media").select("*").eq("id",c(a)).single();if(Q){const m=Q;_(o,m.name,!0),_(d,m.artist,!0),_(l,m.author_username,!0),_(u,m.author_username,!0),_(h,m.cover,!0),_(f,m.level,!0),_(p,m.rating,!0),_(v,m.language,!0),_(j,m.embed_link,!0),_(k,m.content.events,!0),console.log(c(k)),console.log(`${c(j)}?enablejsapi=1`);const g={name:c(o),artist:c(d),cover:c(h),level:c(f),rating:c(p),id:c(a)};S(g)}else _(o,"Unknown Video"),_(d,"Unknown Artist"),_(h,"https://img.youtube.com/vi/loquela/maxresdefault.jpg"),_(f,"Unknown Level"),_(p,"No Rating"),_(j,"https://youtu.be/zabswqP6xEM")}function E(Q){let ne=0;c(k).forEach(m=>{Q>m.tStartMs&&Q<c(k)[ne+1].tStartMs&&m.segs.forEach(g=>{c(w)!==g.utf8&&_(w,g.utf8,!0)}),ne++})}function T(){i=new YT.Player("player",{events:{onReady:()=>{setInterval(()=>{const Q=i.getCurrentTime(),ne=Math.round(Q*1e3);E(ne)},1)}}})}async function S(Q){const{data:ne,readError:m}=await oe.from("profiles").select("recent_videos").eq("user_id",P).single();console.log(ne.recent_videos);let $=ne.recent_videos.filter(K=>K.id!==Q.id);$.length===10&&$.splice(0,1),$.push(Q),console.log($);const{updateData:F,updateError:H}=await oe.from("profiles").update({recent_videos:$}).eq("user_id",P);H&&console.error(H),F&&console.log(F)}var A=Bh();Vn(Q=>{var ne=Nh();y(Oe(ne)),U(Q,ne)});var M=b(A);St(M,{currentPage:"/videos"});var I=y(M,2),G=y(b(I),2),ae=b(G),V=b(ae);go(V,{get song(){return c(o)},get artist(){return c(d)}});var L=y(V,2);mo(L,{get author(){return c(l)}});var C=y(ae,2),R=y(C,2);{var D=Q=>{var ne=Fh();U(Q,ne)};le(R,Q=>{c(j)==="https://youtu.be/zabswqP6xEM"&&Q(D)})}var q=y(R,2);ta(q,{get currentLine(){return c(w)},get targetLanguage(){return c(v)}}),fe(()=>{ze(C,"src",`${c(j)}?enablejsapi=1`),ze(C,"title",c(o))}),U(r,A),De(),n()}var Vh=N('<img class="svelte-1afzn3p"/>'),Hh=N('<section class="ai-chat-box svelte-1afzn3p"><div class="pfp-name-occupation-container svelte-1afzn3p"><!> <div class="text svelte-1afzn3p"><a class="svelte-1afzn3p"><h2 class="svelte-1afzn3p"> </h2></a> <p class="occupation svelte-1afzn3p"> </p></div></div> <div class="flag-tags-container svelte-1afzn3p"><img class="lang-flag svelte-1afzn3p"/> <span class="traits svelte-1afzn3p"><p class="trait-tag svelte-1afzn3p"> </p></span></div></section>');function Jh(r,e){var t=Hh(),s=b(t),n=b(s);{var a=j=>{var P=Vh();fe(()=>{ze(P,"src",e.image),ze(P,"alt",e.firstName)}),U(j,P)};le(n,j=>{e.image&&j(a)})}var i=y(n,2),o=b(i),l=b(o),u=b(l),d=y(o,2),h=b(d),f=y(s,2),p=b(f),v=y(p,2),k=b(v),w=b(k);fe(()=>{ze(o,"href",`/#/app/ai-chat/${e.id}`),re(u,e.firstName),re(h,e.occupation),ze(p,"src",`https://hatscripts.github.io/circle-flags/flags/${e.lang}.svg`),ze(p,"alt",e.lang),re(w,e.trait)}),U(r,t)}var Kh=(r,e)=>c(e).showModal(),Gh=N('<p class="not-found svelte-javkzk">:/ Oops! No flashcards found; try uploading your own or try again later.</p>'),Yh=N("<option> </option>"),Qh=N("<option> </option>"),Zh=N('<span><label for="language" class="svelte-javkzk">* Select further detail:</label> <select class="language svelte-javkzk" required><option>--Select--</option><!></select></span>'),Xh=N("<option> </option>"),ef=N("<option> </option>"),tf=(r,e)=>c(e).close(),rf=N('<main class="route svelte-javkzk"><!> <section class="main-page svelte-javkzk"><h1 class="page-header svelte-javkzk">AI Chat</h1> <section class="main-content svelte-javkzk"><button class="create-ai-character svelte-javkzk"><span class="material-symbols-rounded svelte-javkzk">person_add</span>Create AI Character</button> <div class="chats svelte-javkzk"><!> <!></div></section></section></main> <dialog class="svelte-javkzk"><div class="dialog-container svelte-javkzk"><h2 class="dialog-header svelte-javkzk">Create AI Character</h2> <form class="svelte-javkzk"><label class="svelte-javkzk">ðªª Character name:</label> <input class="name svelte-javkzk" required/> <span class="label-input-container svelte-javkzk"><label class="svelte-javkzk">ð¬ Language:</label> <select class="language svelte-javkzk" required><option>--Select language--</option><!></select></span> <!> <span class="label-input-container svelte-javkzk"><label class="svelte-javkzk">ð Occupation:</label> <select class="occupation svelte-javkzk" required><option>--Select occupation--</option><!></select></span> <span class="label-input-container svelte-javkzk"><label class="svelte-javkzk">ð§  Trait:</label> <select class="traits svelte-javkzk" required><option>--Select trait--</option><!></select></span> <!> <input class="submit-btn svelte-javkzk" type="Submit"/></form> <button class="close-dialog-btn svelte-javkzk">Close</button></div></dialog>',1);function sf(r,e){Re(e,!0),ye(e,"occupation",3,"Knight"),ye(e,"image",3,"https://image.pollinations.ai/prompt/Generate%20a%20pixar-style%20image%20of%20a%20knight%20called%20Hansel%20with%20traits%20of%20brave,%20adventurous%20who%20is%20dressed%20in%20traditional%20attire%20of%20German"),ye(e,"firstName",3,"Hansel"),ye(e,"trait",3,"Friendly"),ye(e,"lang",3,"de");let t="",s=O(W(t.characterName)),n=O(W(t.characterTrait)),a=O(W(t.characterOccupation)),i=O(W([])),o=O(W([])),l=O(null),u=O(W([])),d=W([]),h=W([]),f=O(W([])),p=O(W([])),v=O(W([])),k="",w=O(W(k.characterCreateStatus)),j=O(W(k.characterCreateMessage));tt(async()=>{await S(),await A(),x(),E(),P()});async function P(){const{data:z,error:Z}=await oe.from("ai_characters").select("*");z&&_(f,z,!0),Z&&console.error(Z)}function x(){Array.from(c(u)).forEach(z=>{console.log("gabo"),z.type==="occupation"?d.push(z.name):console.error("Error finding occupations")})}function E(){Array.from(c(u)).forEach(z=>{console.log("gabo"),z.type==="trait"?h.push(z.name):console.error("Error finding traits")})}async function T(z,Z,pe,je,ke){_(w,""),_(j,""),console.log(ke);const{error:Ie}=await oe.from("ai_characters").insert([{name:z,trait:Z,occupation:pe,language:je,country:ke,image:`https://image.pollinations.ai/prompt/Generate a pixar-style image of a ${pe} called ${z} with trait of ${Z} who is dressed in traditional attire of ${je}.`}]);Ie||(_(w,"success"),_(j,"Created! Reload the page to see your character!")),Ie&&(_(w,"error"),_(j,"Error adding character"),console.error(Ie))}async function S(){const{data:z,error:Z}=await oe.from("languages").select("*");if(z)return _(o,z,!0),console.log(c(o)),z;if(Z)throw Z}async function A(){const{data:z,error:Z}=await oe.from("character_fields").select("*");if(z)return _(u,z,!0),console.log(c(u)),z;if(Z)throw Z}let M=O(void 0),I=O(void 0),G=O("");Se(()=>{var z,Z;_(M,c(o).find(pe=>pe.short===c(i)),!0),_(I,(z=c(M))==null?void 0:z.sub_options,!0),_(G,(Z=c(M))==null?void 0:Z.country_code,!0),console.log(c(G))}),Se(()=>{c(i).length===1?_(p,c(i),!0):_(p,c(v),!0),console.log(c(p))});var ae=rf(),V=Oe(ae),L=b(V);St(L,{currentPage:"/ai-chat"});var C=y(L,2),R=y(b(C),2),D=b(R);D.__click=[Kh,l];var q=y(D,2),Q=b(q);{var ne=z=>{var Z=Gh();U(z,Z)};le(Q,z=>{c(f)[0]||z(ne)})}var m=y(Q,2);Me(m,17,()=>c(f),Ce,(z,Z)=>{Jh(z,{get id(){return c(Z).id},get image(){return c(Z).image},get firstName(){return c(Z).name},get trait(){return c(Z).trait},get lang(){return c(Z).country},get occupation(){return c(Z).occupation}})});var g=y(V,2),$=b(g),F=y(b($),2),H=y(b(F),2),K=y(H,2),X=y(b(K),2),B=b(X);B.value=B.__value="";var ee=y(B);{var de=z=>{var Z=Bt(),pe=Oe(Z);Me(pe,17,()=>c(o),Ce,(je,ke)=>{var Ie=Yh(),Je=b(Ie),Ae={};fe(()=>{re(Je,`${c(ke).emoji??""} ${c(ke).name??""}`),Ae!==(Ae=c(ke).short)&&(Ie.value=(Ie.__value=c(ke).short)??"")}),U(je,Ie)}),U(z,Z)};le(ee,z=>{c(o)&&z(de)})}var J=y(K,2);{var Y=z=>{var Z=Zh(),pe=y(b(Z),2),je=b(pe);je.value=je.__value="";var ke=y(je);Me(ke,17,()=>c(I),Ce,(Ie,Je)=>{var Ae=Qh(),Et=b(Ae),Pe={};fe(()=>{re(Et,c(Je).name),Pe!==(Pe=c(Je).codes)&&(Ae.value=(Ae.__value=c(Je).codes)??"")}),U(Ie,Ae)}),He(pe,()=>c(v),Ie=>_(v,Ie)),U(z,Z)};le(J,z=>{c(i).length>1&&z(Y)})}var ie=y(J,2),he=y(b(ie),2),te=b(he);te.value=te.__value="";var be=y(te);{var Le=z=>{var Z=Bt(),pe=Oe(Z);Me(pe,17,()=>d,Ce,(je,ke,Ie,Je)=>{var Ae=Xh(),Et=b(Ae),Pe={};fe(()=>{re(Et,c(ke)),Pe!==(Pe=c(ke))&&(Ae.value=(Ae.__value=c(ke))??"")}),U(je,Ae)}),U(z,Z)};le(be,z=>{d&&z(Le)})}var $e=y(ie,2),Ue=y(b($e),2),Be=b(Ue);Be.value=Be.__value="";var qe=y(Be);{var se=z=>{var Z=Bt(),pe=Oe(Z);Me(pe,17,()=>h,Ce,(je,ke,Ie,Je)=>{var Ae=ef(),Et=b(Ae),Pe={};fe(()=>{re(Et,c(ke)),Pe!==(Pe=c(ke))&&(Ae.value=(Ae.__value=c(ke))??"")}),U(je,Ae)}),U(z,Z)};le(qe,z=>{h&&z(se)})}var ce=y($e,2);Pt(ce,{get type(){return c(w)},get message(){return c(j)}});var _e=y(F,2);_e.__click=[tf,l],ht(g,z=>_(l,z),()=>c(l)),Ye("submit",F,z=>{z.preventDefault(),T(c(s),c(n),c(a),c(p),c(G))}),pt(H,()=>c(s),z=>_(s,z)),He(X,()=>c(i),z=>_(i,z)),He(he,()=>c(a),z=>_(a,z)),He(Ue,()=>c(n),z=>_(n,z)),U(r,ae),De()}cr(["click"]);var nf=async(r,e)=>await e(),af=N("<p>Loading...</p>"),of=(r,e,t)=>{c(e).showModal(),t()},lf=(r,e,t,s)=>e(c(t),c(s).content),cf=N('<p class="ai-word svelte-1g4eeoh"> </p>'),uf=N('<div class="message ai-sent svelte-1g4eeoh"></div>'),df=N('<div class="message user-sent svelte-1g4eeoh"> </div>'),hf=N("<!> <!>",1),ff=N('<span class="deck-label svelte-1g4eeoh">Deck: <b> </b></span>'),vf=(r,e,t,s)=>e(c(t),s),pf=N('<div class="chat-container svelte-1g4eeoh"><section class="header-messages-container svelte-1g4eeoh"><span class="chat-header svelte-1g4eeoh"><span class="pfp-name-container svelte-1g4eeoh"><img class="character-header-image svelte-1g4eeoh"/> <h3 class="svelte-1g4eeoh"> </h3> <p> </p> <p class="trait-tag svelte-1g4eeoh"> </p></span> <button class="ai-analysis-btn svelte-1g4eeoh">Get AI analysis of chat</button> <!></span> <button class="test-deck-btn svelte-1g4eeoh">Get tested on a deck</button> <div class="messages-container svelte-1g4eeoh"></div></section> <div class="input-deck-label-container svelte-1g4eeoh"><!> <span class="send-container svelte-1g4eeoh"><input class="send-message-input svelte-1g4eeoh"/> <button class="send-message-btn svelte-1g4eeoh"><span class="material-symbols-rounded">send</span></button></span></div></div>'),gf=N('<span class="sentence-container svelte-1g4eeoh"><span class="corrected_sentence_label_container svelte-1g4eeoh">ð <p class="original_sentence_label svelte-1g4eeoh">Original sentence:</p></span> <p class="original_sentence svelte-1g4eeoh"> </p></span> <span class="sentence-container svelte-1g4eeoh"><span class="corrected_sentence_label_container svelte-1g4eeoh">â <p class="corrected_sentence_label svelte-1g4eeoh">Corrected sentence:</p></span> <p class="corrected_sentence svelte-1g4eeoh"> </p></span>',1),_f=N('<section class="ai-analysis-page svelte-1g4eeoh"><span class="analysis-character-container svelte-1g4eeoh"><img class="analysis-image svelte-1g4eeoh"/> <h1 class="analysis-header svelte-1g4eeoh"> </h1></span> <div class="stats-container svelte-1g4eeoh"><div class="ai-chat-analysis-container svelte-1g4eeoh"><h3 class="ai-chat-analysis-header svelte-1g4eeoh">ð¡ AI Chat Analysis</h3> <p class="ai-chat-analysis svelte-1g4eeoh"> </p></div> <!></div></section>'),mf=N("<option required> </option>"),yf=(r,e)=>c(e).close(),wf=N('<main class="route svelte-1g4eeoh"><!> <section class="main-page svelte-1g4eeoh"><h1 class="page-header svelte-1g4eeoh">AI Chat</h1> <section class="main-content svelte-1g4eeoh"><!> <!> <!></section></section></main> <dialog class="svelte-1g4eeoh"><div class="dialog-container svelte-1g4eeoh"><h2 class="dialog-header svelte-1g4eeoh">Select deck to be tested on:</h2> <form class="svelte-1g4eeoh"><select class="deck-select svelte-1g4eeoh"></select> <span class="deck-buttons-container svelte-1g4eeoh"><input type="Submit" class="submit-deck-btn svelte-1g4eeoh"/> <button class="close-deck-btn svelte-1g4eeoh">Close</button></span></form></div></dialog>',1);function bf(r,e){Re(e,!0);const t=()=>$r(qr,"$location",s),[s,n]=Lr();let a="en",i=W(t().split("/").pop()),o=O(W(Object)),l=O(""),u=O(W([])),d=W([]),h=O(""),f=HTMLObjectElement,p=O(W(f.messagesContainer)),v=O(W(f.dialogBox)),k=O(void 0),w="",j=O(W(w.term)),P=O(W(w.definition)),x=O(W(w.partOfSpeech)),E=O(W(w.romanisation)),T=O(""),S=!0,A=O(!1);tt(async()=>{await M()}),Se(async()=>{const{data:J,error:Y}=await oe.from("ai_characters").select("*").eq("id",i).single();Y&&console.error(Y),J&&_(o,J,!0)});async function M(){const{data:J,error:Y}=await oe.auth.getSession(),ie=J;Y?console.error("Error fetching session:",Y):ie&&_(T,ie.session.user.id,!0),Y&&console.error("Error fetching username:",Y)}async function I(J,Y){let ie="";Y.push({sender:"User",content:J}),console.log(ie);const he=await fetch("/.netlify/functions/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:"You are an AI chatbot roleplaying a character for a language learning app. Keep it chat-like and follow the character trait. Return just your response. No formatting. If a flashcard deck is submitted, relate your answers off that",characterName:c(o).name,characterLanguageISO6391:c(o).language,characterTrait:c(o).trait,characterOccupation:c(o).occupation,latestUserResponse:J,chatHistory:Y.map(be=>({user:be.sender,message:be.content})),flashcardDecks:c(u)[c(k)]})});he.ok?console.log(he):console.error("AI API error:",he.statusText);const te=await he.json();Y.push({sender:"AI",content:te.reply}),console.log("AI Response:",te)}async function G(){_(A,!0);try{const Y=await(await fetch("/.netlify/functions/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:"You are an AI for a language learning app. The user and AI are having a conversation. Return no tags, no markup, just raw JSON with keys `analysis` â A strict critique in English aimed at helping the user improve. Also if the flashcardDeck is truthy then tell the user how well he used the cards in the flashcard deck - and also return `mistakes` â An array of objects. Each mistakes object must include `original_sentence` and `corrected_sentence`",flashcardDeck:c(u),chatLanguageISO6391:c(o).language,chatHistory:d.map(ie=>({user:ie.sender,message:ie.content})),flashcardDecks:c(u)[c(k)]})})).json();_(h,JSON.parse(Y.reply),!0),_(A,!1),console.log(c(h))}catch(J){console.error(J)}}async function ae(){if(!c(u)){const{data:J,error:Y}=await oe.from("flashcards").select("*").eq("author",c(T)).eq("language",c(o).language);Y&&console.error("Error fetching flashcard decks:",Y),J?_(u,J,!0):_(u,[],!0),console.log(c(u))}}function V(){c(v).close()}async function L(J,Y){S=!1,console.log(Y),console.log("Fetching definition for ",J);try{const he=await(await fetch("/.netlify/functions/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:"Translate this word based of context. Return no tags, no markup, just raw JSON with keys `word` (original), `partOfSpeech`, `romanisation` and `definition` (meaning based off context and also simple, normal person-readable info about conjugation) but ONLY return `romanisation` where it is not necessary. For example non-Latin scripts",word:J,context:Y,originalWordLanguageISO6391:c(o).language,translatedWordLanguageISO6391:a})})).json(),te=JSON.parse(he.reply);console.log(te),S=!0,_(j,te.word,!0),_(P,te.definition,!0),_(x,te.partOfSpeech,!0),_(E,te.romanisation,!0)}catch(ie){console.error(ie)}}var C=wf(),R=Oe(C),D=b(R);St(D,{currentPage:"/ai-chat"});var q=y(D,2),Q=y(b(q),2),ne=b(Q);{var m=J=>{var Y=pf(),ie=b(Y),he=b(ie),te=b(he),be=b(te),Le=y(be,2),$e=b(Le),Ue=y(Le,2),Be=b(Ue),qe=y(Ue,2),se=b(qe),ce=y(te,2);ce.__click=[nf,G];var _e=y(ce,2);{var z=Pe=>{var gt=af();U(Pe,gt)};le(_e,Pe=>{c(A)&&Pe(z)})}var Z=y(he,2);Z.__click=[of,v,ae];var pe=y(Z,2);Me(pe,21,()=>d,Ce,(Pe,gt)=>{var ms=hf(),ys=Oe(ms);{var yo=Ht=>{var Nr=uf();Me(Nr,21,()=>c(gt).content.split(" "),Ce,(Zs,sa)=>{var Xs=cf();Xs.__click=[lf,L,sa,gt];var ko=b(Xs);fe(()=>re(ko,c(sa))),U(Zs,Xs)}),U(Ht,Nr)};le(ys,Ht=>{c(gt).sender==="AI"&&Ht(yo)})}var wo=y(ys,2);{var bo=Ht=>{var Nr=df(),Zs=b(Nr);fe(()=>re(Zs,c(gt).content)),U(Ht,Nr)};le(wo,Ht=>{c(gt).sender==="User"&&Ht(bo)})}U(Pe,ms)}),ht(pe,Pe=>_(p,Pe),()=>c(p));var je=y(ie,2),ke=b(je);{var Ie=Pe=>{var gt=ff(),ms=y(b(gt)),ys=b(ms);fe(()=>re(ys,c(u)[c(k)].name)),U(Pe,gt)};le(ke,Pe=>{(c(k)||c(k)===0)&&Pe(Ie)})}var Je=y(ke,2),Ae=b(Je),Et=y(Ae,2);Et.__click=[vf,I,l,d],fe(()=>{ze(be,"src",c(o).image),ze(be,"alt",`Image of charater ${c(o).name}`),re($e,c(o).name),re(Be,c(o).occupation),re(se,c(o).trait)}),pt(Ae,()=>c(l),Pe=>_(l,Pe)),U(J,Y)};le(ne,J=>{c(h)||J(m)})}var g=y(ne,2);_o(g,{get word(){return c(j)},get definition(){return c(P)},get partOfSpeech(){return c(x)},get romanisation(){return c(E)},get language(){return c(o).language}});var $=y(g,2);{var F=J=>{var Y=_f(),ie=b(Y),he=b(ie),te=y(he,2),be=b(te),Le=y(ie,2),$e=b(Le),Ue=y(b($e),2),Be=b(Ue),qe=y($e,2);Me(qe,17,()=>c(h).mistakes,Ce,(se,ce)=>{var _e=gf(),z=Oe(_e),Z=y(b(z),2),pe=b(Z),je=y(z,2),ke=y(b(je),2),Ie=b(ke);fe(()=>{re(pe,c(ce).original_sentence),re(Ie,c(ce).corrected_sentence)}),U(se,_e)}),fe(()=>{ze(he,"src",c(o).image),ze(he,"alt",c(o).name),re(be,c(o).name),re(Be,c(h).analysis)}),U(J,Y)};le($,J=>{c(h)&&J(F)})}var H=y(R,2),K=b(H),X=y(b(K),2),B=b(X);Me(B,21,()=>c(u),Ce,(J,Y,ie)=>{var he=mf(),te=b(he);he.value=he.__value=ie,fe(()=>re(te,c(Y).name)),U(J,he)});var ee=y(B,2),de=y(b(ee),2);de.__click=[yf,v],ht(H,J=>_(v,J),()=>c(v)),Ye("submit",X,J=>{J.preventDefault(),V()}),He(B,()=>c(k),J=>_(k,J)),U(r,C),De(),n()}cr(["click"]);var kf=Hn(N('<script src="https://www.youtube.com/iframe_api" class="svelte-18y4z1i"><\/script><!>',1)),Sf=(r,e)=>c(e).scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),Ef=(r,e)=>c(e).scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),xf=(r,e)=>c(e).scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),Tf=(r,e)=>c(e).scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),Of=N(`<main class="svelte-18y4z1i"><section class="page-1 page svelte-18y4z1i"><div class="media-scroller svelte-18y4z1i"><div class="media-list svelte-18y4z1i"><span class="media-box music-media-box svelte-18y4z1i"><span class="emoji music-emoji svelte-18y4z1i">ð§</span> Music</span> <span class="media-box videos-media-box svelte-18y4z1i"><span class="emoji videos-emoji svelte-18y4z1i">ð¹</span> Videos</span> <span class="media-box flashcards-media-box svelte-18y4z1i"><span class="emoji flashcards-emoji svelte-18y4z1i">ðï¸</span> Flashcards</span> <span class="media-box ai-chats-media-box svelte-18y4z1i"><span class="emoji ai-chats-emoji svelte-18y4z1i">ð¬</span> AI Chats</span> <span class="media-box music-media-box svelte-18y4z1i"><span class="emoji music-emoji svelte-18y4z1i">ð§</span> Music</span> <span class="media-box videos-media-box svelte-18y4z1i"><span class="emoji videos-emoji svelte-18y4z1i">ð¹</span> Videos</span> <span class="media-box flashcards-media-box svelte-18y4z1i"><span class="emoji flashcards-emoji svelte-18y4z1i">ðï¸</span> Flashcards</span> <span class="media-box ai-chats-media-box svelte-18y4z1i"><span class="emoji ai-chats-emoji svelte-18y4z1i">ð¬</span> AI Chats</span></div></div> <section class="hero-1 svelte-18y4z1i"><h1 class="welcome svelte-18y4z1i">Welcome to Loquelis!!!</h1> <p class="welcome-message svelte-18y4z1i">ð¤ Happy to see you!</p></section> <a href="./#/app/signup/" class="get-started-btn shadow svelte-18y4z1i">Let's get started! â</a></section> <section class="page-2 page svelte-18y4z1i"><h1 class="svelte-18y4z1i">Let's get started with a language-learning favourite - Peppa Pig! ð·</h1> <span class="video-info-box info-box svelte-18y4z1i"><p class="icon svelte-18y4z1i">ð¡</p>Click on a word for a definition based off context, part of speech and romanisation.</span> <span class="video-info-box info-box svelte-18y4z1i"><p class="icon svelte-18y4z1i">ð</p>Play the video and watch the live subtitles flow through!</span> <section class="video-container svelte-18y4z1i"><iframe id="player" frameborder="0" allowfullscreen="" class="svelte-18y4z1i"></iframe> <!></section></section> <hr class="svelte-18y4z1i"/> <section class="page-3 page svelte-18y4z1i"><h2 class="svelte-18y4z1i">Learn with user curated/ custom:</h2> <div class="media-container svelte-18y4z1i"><span class="media-box music-media-box svelte-18y4z1i"><span class="emoji music-emoji svelte-18y4z1i">ð§</span> Music</span> <span class="media-box videos-media-box svelte-18y4z1i"><span class="emoji videos-emoji svelte-18y4z1i">ð¹</span> Videos</span> <span class="media-box flashcards-media-box svelte-18y4z1i"><span class="emoji flashcards-emoji svelte-18y4z1i">ðï¸</span> Flashcards</span> <span class="media-box ai-chats-media-box svelte-18y4z1i"><span class="emoji ai-chats-emoji svelte-18y4z1i">ð¬</span> AI Chats</span></div></section> <hr class="svelte-18y4z1i"/> <section class="page-4 page svelte-18y4z1i"><h1 class="media-header svelte-18y4z1i">ð§ Music</h1> <p class="media-p svelte-18y4z1i">Learn through user curated music options and immerse yourself in the culture of the region of your chosen language</p> <div class="media-image-container svelte-18y4z1i"><img src="https://upload.wikimedia.org/wikipedia/en/b/bc/Molchat_Doma_-_Etazhi.png" alt="Molchat Doma music" class="media-img svelte-18y4z1i"/> <img src="https://upload.wikimedia.org/wikipedia/en/4/40/99_Luftballons_single_cover.jpg" alt="99 Luftballons Music" class="media-img svelte-18y4z1i"/> <img src="https://upload.wikimedia.org/wikipedia/en/f/fa/RammsteinRadioSingleCover.jpg" alt="Rammstein Music" class="media-img svelte-18y4z1i"/> <img src="https://upload.wikimedia.org/wikipedia/en/2/20/Fortuna_Wheel.jpg" alt="Rammstein Music" class="media-img svelte-18y4z1i"/></div> <hr class="svelte-18y4z1i"/> <h1 class="media-header svelte-18y4z1i">ð¹ Video</h1> <p class="media-p svelte-18y4z1i">Learn through user curated video options and finally switch from textbooks to shows, documentaries, news and YouTubers</p> <div class="media-image-container svelte-18y4z1i"><img src="https://i.ytimg.com/vi/WYqIlqp2_9c/sddefault.jpg" alt="coca cola documentary in german" class="vid-media-img media-img svelte-18y4z1i"/> <img src="https://i.ytimg.com/vi/_fPXQnfCWqI/sddefault.jpg" class="vid-media-img media-img svelte-18y4z1i" alt="french news"/> <img src="https://i.ytimg.com/vi/ZzfeHWgEVDs/sddefault.jpg" alt="vlog video" class="vid-media-img media-img svelte-18y4z1i"/></div> <hr class="svelte-18y4z1i"/> <h1 class="media-header svelte-18y4z1i">ðï¸ Flashcards</h1> <p class="media-p svelte-18y4z1i">Create your own decks from words saved from songs, videos and AI Chats</p> <div class="media-image-container svelte-18y4z1i"><img src="https://raw.githubusercontent.com/Ewan-Dev/ewan.is-a.dev/refs/heads/main/frontend/static/food-deck.png" class="deck-media-img media-img svelte-18y4z1i" alt="deck"/> <img src="https://raw.githubusercontent.com/Ewan-Dev/ewan.is-a.dev/refs/heads/main/frontend/static/animals-deck.png" alt="deck" class="deck-media-img media-img svelte-18y4z1i"/> <img src="https://raw.githubusercontent.com/Ewan-Dev/ewan.is-a.dev/refs/heads/main/frontend/static/flashcards.png" alt="flashcards" class="deck-media-img media-img svelte-18y4z1i"/></div> <hr class="svelte-18y4z1i"/> <h1 class="media-header svelte-18y4z1i">ð¬ AI Chat</h1> <p class="media-p svelte-18y4z1i">Create your own AI character to practise your language skills and decks with.</p> <div class="media-image-container svelte-18y4z1i"><img src="https://raw.githubusercontent.com/Ewan-Dev/ewan.is-a.dev/refs/heads/main/frontend/static/ai-chat.png" alt="ai chat" class="ai-chat-img media-img svelte-18y4z1i"/></div></section> <hr class="svelte-18y4z1i"/> <section class="page-5 page svelte-18y4z1i"><h1 class="svelte-18y4z1i">Start your journey. <p class="blue svelte-18y4z1i">Today.</p></h1> <div class="sign-up-contact-container svelte-18y4z1i"><a href="./#/app/signup/" class="big-get-started-btn shadow svelte-18y4z1i">Get started! â</a> <a class="big-contact-btn shadow svelte-18y4z1i" href="./#/app/login/"><span class="material-symbols-rounded svelte-18y4z1i">login</span>Sign in</a></div></section></main>`);function jf(r,e){Re(e,!0);const t=()=>$r(qr,"$location",s),[s,n]=Lr(),i={events:[{tStartMs:10791,dDurationMs:1508,segs:[{utf8:"Herr Vogelscheuche"}]},{tStartMs:15535,dDurationMs:4067,segs:[{utf8:"Peppa und Schorsch sind heute zu Besuch bei Oma und Opa Wutz."}]},{tStartMs:23350,dDurationMs:1641,segs:[{utf8:"Hallo Opa Wutz."}]},{tStartMs:25960,dDurationMs:3547,segs:[{utf8:"Huhu Hallo Peppa Hallo Schorsch."}]},{tStartMs:29571,dDurationMs:2317,segs:[{utf8:"Opa was machst du denn da?"}]},{tStartMs:31897,dDurationMs:2158,segs:[{utf8:"Ich pflanze einen Blumengarten."}]},{tStartMs:34072,dDurationMs:1579,segs:[{utf8:"Oh!"}]},{tStartMs:35675,dDurationMs:3720,segs:[{utf8:"Aus diesen Samen wachsen wunderschÃ¶ne Blumen."}]},{tStartMs:40090,dDurationMs:3153,segs:[{utf8:"Ich streue die SamenkÃ¶rner auf den Boden."}]},{tStartMs:44163,dDurationMs:2722,segs:[{utf8:"Dann decke ich sie mit Erde zu."}]},{tStartMs:47211,dDurationMs:1841,segs:[{utf8:"Oh wo sind sie denn?"}]},{tStartMs:49110,dDurationMs:1865,segs:[{utf8:"Die SamenkÃ¶rner sind verschwunden."}]},{tStartMs:50999,dDurationMs:4049,segs:[{utf8:`Wie merkwÃ¼rdig! 
Ich bin sicher dass ich hier Samen verstaut hatte.`}]},{tStartMs:55076,dDurationMs:2456,segs:[{utf8:`Ja Opa.
Wir haben es gesehen.`}]},{tStartMs:57932,dDurationMs:1598,segs:[{utf8:`Ja!
Jetzt sind sie weg.`}]},{tStartMs:60167,dDurationMs:3047,segs:[{utf8:"Na gut dann muss ich eben noch welche nehmen."}]},{tStartMs:63522,dDurationMs:4459,segs:[{utf8:"Wie schon sagte, ich treue die SamenkÃ¶rner einfach auf den Boden."}]},{tStartMs:70334,dDurationMs:3534,segs:[{utf8:"Ein kleiner Vogel pickt die SamenkÃ¶rner von Opa Wutz auf."}]},{tStartMs:73960,dDurationMs:765,segs:[{utf8:"Heyy!"}]},{tStartMs:74776,dDurationMs:1962,segs:[{utf8:"Lass meine SamenkÃ¶rner!"}]},{tStartMs:77137,dDurationMs:2561,segs:[{utf8:"Also da sind meine ganzen Samen hin."}]},{tStartMs:79709,dDurationMs:3240,segs:[{utf8:"Im Bauch von dem kleinen Vogel."}]},{tStartMs:83320,dDurationMs:3741,segs:[{utf8:"Und noch zwei kleine VÃ¶gel picken Opa wird SamenkÃ¶rner auf."}]},{tStartMs:87180,dDurationMs:1319,segs:[{utf8:"Oh Guck!"}]},{tStartMs:88507,dDurationMs:1987,segs:[{utf8:"Ah! Weg da Weg da!"}]},{tStartMs:91405,dDurationMs:1666,segs:[{utf8:"Was ist das fÃ¼r ein LÃ¤rm."}]},{tStartMs:93256,dDurationMs:3800,segs:[{utf8:`Oma Wutz!
Die VÃ¶gel picken meine ganzen Blumensamen weg.`}]},{tStartMs:97138,dDurationMs:2397,segs:[{utf8:"Und jetzt werden die VÃ¶gel weg."}]},{tStartMs:99765,dDurationMs:3239,segs:[{utf8:"Wegjagen hat keinen Zweck! Sie kommen einfach wieder."}]},{tStartMs:103020,dDurationMs:959,segs:[{utf8:"Guck!"}]},{tStartMs:104823,dDurationMs:2133,segs:[{utf8:"Wir brauchen eine Vogelscheuche."}]},{tStartMs:106990,dDurationMs:1964,segs:[{utf8:"Was ist eine Vogelscheuche?"}]},{tStartMs:109017,dDurationMs:3719,segs:[{utf8:"Eine Vogelscheuche ist ein Mann aus Stroh der den VÃ¶geln Angst macht."}]},{tStartMs:112761,dDurationMs:2916,segs:[{utf8:"Das ist eine gute Idee Oma Wutz."}]},{tStartMs:115697,dDurationMs:1305,segs:[{utf8:"Ich baue eine."}]},{tStartMs:117038,dDurationMs:1663,segs:[{utf8:"Kommt alle mit."}]},{tStartMs:119901,dDurationMs:6213,segs:[{utf8:"Wiedersehen kleine VÃ¶gel. Wir bauen eine Vogelscheuche."}]},{tStartMs:126387,dDurationMs:2133,segs:[{utf8:"Das ist Opa Wutz Gartenschuppen."}]},{tStartMs:128928,dDurationMs:4022,segs:[{utf8:"Hier drin gibt es eine Menge Sachen um eine Vogelscheuche zu bauen."}]},{tStartMs:133306,dDurationMs:3583,segs:[{utf8:"Zuerst brauchen wir zwei StÃ¶cke und etwas Kordel."}]},{tStartMs:136913,dDurationMs:2023,segs:[{utf8:"Das besorgen wir."}]},{tStartMs:140720,dDurationMs:4139,segs:[{utf8:"Peppa hat zwei StÃ¼cke gefunden Schorsch hat etwas Kordel gefunden."}]},{tStartMs:144900,dDurationMs:1090,segs:[{utf8:"Gut!"}]},{tStartMs:146042,dDurationMs:3400,segs:[{utf8:"Ich binde die StÃ¶cke zusammen. Das wird der KÃ¶rper."}]},{tStartMs:149529,dDurationMs:3666,segs:[{utf8:"Oma Wutz hat etwas Stroh gefunden und einen alten Sack."}]},{tStartMs:153237,dDurationMs:5544,segs:[{utf8:`GroÃartig!
Ich stecke das Stroh in den Sack. Das wird der Kopf.`}]},{tStartMs:158817,dDurationMs:3276,segs:[{utf8:"Jetzt braucht die Vogelscheuche was zum anziehen."}]},{tStartMs:162146,dDurationMs:2129,segs:[{utf8:"Hier ist eine Tasche mit alten Kleidern."}]},{tStartMs:164334,dDurationMs:5122,segs:[{utf8:`Oh!
Schorsch hat ein Kleid gefunden.`}]},{tStartMs:170717,dDurationMs:6222,segs:[{utf8:`Dumber Schorsch!
Herr Vogelscheuche hat doch kein Kleid an.`}]},{tStartMs:177184,dDurationMs:2503,segs:[{utf8:"Peppa hat einen Mantel gefunden."}]},{tStartMs:179918,dDurationMs:1875,segs:[{utf8:"Sehr gut Peppa!"}]},{tStartMs:183037,dDurationMs:1961,segs:[{utf8:"Schorsch hat einen Hut gefunden."}]},{tStartMs:185023,dDurationMs:1709,segs:[{utf8:"Sehr gut Schorsch."}]},{tStartMs:187126,dDurationMs:2881,segs:[{utf8:"Herr Vogelscheuche braucht ein Gesicht."}]},{tStartMs:190015,dDurationMs:1e3,segs:[{utf8:"Das Stimmt."}]},{tStartMs:191285,dDurationMs:2564,segs:[{utf8:"Willst du mit Schorch ein Gesicht fÃ¼r ihn malen."}]},{tStartMs:193911,dDurationMs:2596,segs:[{utf8:"Ja bitte."}]},{tStartMs:196794,dDurationMs:2467,segs:[{utf8:"Schorsch malt die Augen und die Nase."}]},{tStartMs:199643,dDurationMs:2004,segs:[{utf8:"Peppa malt den Mund."}]},{tStartMs:202331,dDurationMs:1949,segs:[{utf8:"Fantastisch!"}]},{tStartMs:204305,dDurationMs:1352,segs:[{utf8:"Herr Vogelscheuche ist fertig."}]},{tStartMs:205689,dDurationMs:1750,segs:[{utf8:"Hurraa"}]},{tStartMs:208970,dDurationMs:2877,segs:[{utf8:"Die kleinen VÃ¶gel suchen nach Opa Wutz Blumensamen."}]},{tStartMs:211985,dDurationMs:2704,segs:[{utf8:`Guck!
Die kleinen VÃ¶gel sind wieder da.`}]},{tStartMs:214706,dDurationMs:1327,segs:[{utf8:"Keine Sorge Peppa."}]},{tStartMs:216041,dDurationMs:2345,segs:[{utf8:"Die Vogelscheuche wird sie feucht."}]},{tStartMs:223868,dDurationMs:1266,segs:[{utf8:"Es funktioniert!"}]},{tStartMs:225194,dDurationMs:2491,segs:[{utf8:"Die Vogelscheuche hat die VÃ¶gel verscheucht."}]},{tStartMs:227757,dDurationMs:1528,segs:[{utf8:"Hurra!"}]},{tStartMs:229296,dDurationMs:726,segs:[{utf8:" Gut!"}]},{tStartMs:230099,dDurationMs:3049,segs:[{utf8:"Jetzt werden meine Blumensamen nicht mehr gefressen."}]},{tStartMs:234964,dDurationMs:4325,segs:[{utf8:"Oh Opa die kleinen VÃ¶gel sehen sehr traurig aus."}]},{tStartMs:239329,dDurationMs:2435,segs:[{utf8:"Ja sie haben sicher Hunger."}]},{tStartMs:241820,dDurationMs:1730,segs:[{utf8:"DafÃ¼r habe ich das hier."}]},{tStartMs:243594,dDurationMs:1951,segs:[{utf8:"Das ist das Oma?"}]},{tStartMs:245561,dDurationMs:1721,segs:[{utf8:"Eine Futterstation."}]},{tStartMs:247307,dDurationMs:5499,segs:[{utf8:"Opa gibst du mir bitte etwas von den Samen."}]},{tStartMs:254689,dDurationMs:3828,segs:[{utf8:"Kommt ihr VÃ¶gelchen. Essen Zeit."}]},{tStartMs:259175,dDurationMs:2599,segs:[{utf8:"Jetzt haben die VÃ¶gel ihre eigenen Samen."}]},{tStartMs:262604,dDurationMs:2274,segs:[{utf8:"Die kleinen VÃ¶gel sind wieder glÃ¼cklich."}]},{tStartMs:264903,dDurationMs:3639,segs:[{utf8:"Peppa ist froh dass Opas Blumensamen nicht gefressen werden."}]},{tStartMs:268644,dDurationMs:8125,segs:[{utf8:"Aber noch vor ist sie dass die kleinen VÃ¶gel auch etwas zu fressen haben."}]}]}.events;console.log(i);let o=O(void 0),l=O(void 0),u=O(void 0),d=O(void 0);W([]);let h,f=O("Peppa Wutz");Se(()=>{t().split("/").pop()==="welcome"&&(p(),window.YT?v():window.onYouTubeIframeAPIReady=v)});function p(){zr({particleCount:1e3,spread:150,origin:{y:0}})}function v(){h=new YT.Player("player",{events:{onReady:()=>{setInterval(()=>{const R=h.getCurrentTime(),D=Math.round(R*1e3);k(D)},1)}}})}function k(R){let D=0;i.forEach(q=>{R>q.tStartMs&&R<i[D+1].tStartMs&&q.segs.forEach(Q=>{c(f)!==Q.utf8&&(_(f,Q.utf8,!0),console.log(Q.utf8))}),D++})}var w=Of();Vn(R=>{var D=kf();y(Oe(D)),U(R,D)});var j=y(b(w),2),P=y(b(j),6),x=b(P);ze(x,"src","https://www.youtube.com/embed/Q_sqR4aLLu0?enablejsapi=1"),ze(x,"title","peppapig");var E=y(x,2);ta(E,{get currentLine(){return c(f)},targetLanguage:"de"});var T=y(j,4),S=y(b(T),2),A=b(S);A.__click=[Sf,o];var M=y(A,2);M.__click=[Ef,l];var I=y(M,2);I.__click=[xf,u];var G=y(I,2);G.__click=[Tf,d];var ae=y(T,4),V=y(b(ae),6);ht(V,R=>_(l,R),()=>c(l));var L=y(V,8);ht(L,R=>_(u,R),()=>c(u));var C=y(L,10);ht(C,R=>_(d,R),()=>c(d)),ht(ae,R=>_(o,R),()=>c(o)),U(r,w),De(),n()}cr(["click"]);var Af=()=>{window.open("#/app/home")},Pf=N('<head><link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:wght@400" rel="stylesheet"/></head> <main class="svelte-1n46o8q"><dialog class="svelte-1n46o8q"><form class="svelte-1n46o8q"><label class="username-header svelte-1n46o8q">ð¤ Set a username:</label> <span class="input-container svelte-1n46o8q"><p class="at-symbol svelte-1n46o8q">@</p><input placeholder="username" class="username-input svelte-1n46o8q"/></span> <input type="Submit" class="svelte-1n46o8q"/> <button class="close-button-username svelte-1n46o8q">Close</button> <!></form></dialog> <dialog open class="auth-notice svelte-1n46o8q"><h2>Already logged in</h2> <p>You already have a user session saved.</p> <button class="dialog-auth-btn svelte-1n46o8q">Continue anyway</button> <button class="dialog-auth-btn svelte-1n46o8q">Go to user homepage</button></dialog> <!></main>',1);function Cf(r,e){Re(e,!0);const t=()=>$r(qr,"$location",s),[s,n]=Lr(),a={"/app/welcome":jf,"/app/ai-chat/:slug":bf,"/app/ai-chat":sf,"/app/videos/:slug":Wh,"/app/videos":qh,"/app/flashcards/:slug":Ih,"/app/flashcards":mh,"/app/upload":hh,"/app/music/:slug":ih,"/app/music":Nd,"/app/login":Cd,"/app/login/:slug":Rd,"/app/signup":jd,"/app/home":Sd};let i=O(""),o=O(""),l="",u=O(W(l.statusMessage)),d=O(W(l.statusType)),h=O(""),f,p,v=O(W(t()));tt(()=>{f==null||f.close(),_(v,t(),!0)}),Se(()=>{_(v,t(),!0),c(h)&&(c(v)==="/app/login"||c(v)==="/app/signup")?p==null||p.showModal():c(h)&&c(v)==="/"?window.location.replace("/#/app/home"):!c(h)&&c(v)==="/"?window.location.replace("/#/app/welcome"):(c(h)&&(c(v)==="/app/login"||c(v)),p==null||p.close())}),Se(async()=>{console.log(c(v)),await w(),k()});function k(){!c(i)&&c(h)?f==null||f.showModal():f==null||f.close()}async function w(){var ne,m;const{data:D,error:q}=await oe.auth.getSession(),Q=D;if(q)console.error("Error fetching session:",q);else if(Q){_(h,(m=(ne=Q==null?void 0:Q.session)==null?void 0:ne.user)==null?void 0:m.id,!0);const{data:g,error:$}=await oe.from("profiles").select("username").eq("user_id",c(h)).single();g&&(console.log(g),_(i,g.username,!0),console.log("User: ",c(i)))}}async function j(D){if(D){const{error:q}=await oe.from("profiles").update({username:D}).eq("user_id",c(h));q?(console.error(q.message),_(u,""),_(d,""),q.message.includes("duplicate")&&q.message.includes("username")?(_(u,""),_(d,""),_(u,"Account with username already exists"),_(d,"error")):(_(u,""),_(d,""),_(u,q.message,!0),_(d,"error")),q.message==='Column "username" cannot be modified once set'&&(_(u,""),_(d,""),_(u,"Username already set!"),_(d,"warn"))):(_(u,""),_(d,""),_(u,"success"),_(d,"success"),_(i,D,!0))}else _(u,""),_(d,""),_(u,"No username typed"),_(d,"warn")}var P=Pf(),x=y(Oe(P),2),E=b(x),T=b(E),S=y(b(T),2),A=y(b(S)),M=y(S,4),I=Ar(k);M.__click=function(...D){var q;(q=c(I))==null||q.apply(this,D)};var G=y(M,2);{var ae=D=>{Pt(D,{get message(){return c(u)},get type(){return c(d)}})};le(G,D=>{c(u)&&D(ae)})}ht(E,D=>f=D,()=>f);var V=y(E,2),L=y(b(V),4);L.__click=()=>{p==null||p.close()};var C=y(L,2);C.__click=[Af],ht(V,D=>p=D,()=>p);var R=y(V,2);sh(R,{get routes(){return a}}),Ye("submit",T,D=>{D.preventDefault(),j(c(o))}),pt(A,()=>c(o),D=>_(o,D)),U(r,P),De(),n()}cr(["click"]);Ul(Cf,{target:document.getElementById("app")})});export default Mf();
