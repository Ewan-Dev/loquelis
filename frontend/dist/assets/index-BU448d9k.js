var wo=Object.defineProperty;var ea=r=>{throw TypeError(r)};var bo=(r,e,t)=>e in r?wo(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var ko=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports);var Nr=(r,e,t)=>bo(r,typeof e!="symbol"?e+"":e,t),Ys=(r,e,t)=>e.has(r)||ea("Cannot "+t);var be=(r,e,t)=>(Ys(r,e,"read from private field"),t?t.call(r):e.get(r)),Ze=(r,e,t)=>e.has(r)?ea("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),ot=(r,e,t,s)=>(Ys(r,e,"write to private field"),s?s.call(r,t):e.set(r,t),t),Ht=(r,e,t)=>(Ys(r,e,"access private method"),t);var jf=ko(($f,gs)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function t(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(n){if(n.ep)return;n.ep=!0;const a=t(n);fetch(n.href,a)}})();const Za=!1;var Mr=Array.isArray,So=Array.prototype.indexOf,An=Array.from,Os=Object.defineProperty,qt=Object.getOwnPropertyDescriptor,Xa=Object.getOwnPropertyDescriptors,Eo=Object.prototype,xo=Array.prototype,Pn=Object.getPrototypeOf,ta=Object.isExtensible;function wr(r){return typeof r=="function"}const nt=()=>{};function To(r){return r()}function Qr(r){for(var e=0;e<r.length;e++)r[e]()}function Oo(){var r,e,t=new Promise((s,n)=>{r=s,e=n});return{promise:t,resolve:r,reject:e}}function jo(r,e){if(Array.isArray(r))return r;if(!(Symbol.iterator in r))return Array.from(r);const t=[];for(const s of r)if(t.push(s),t.length===e)break;return t}const at=2,Cn=4,Ls=8,rr=16,Pt=32,sr=64,ei=128,ct=256,js=512,Ve=1024,ut=2048,Ct=4096,vt=8192,nr=16384,Us=32768,ls=65536,ra=1<<17,ti=1<<18,cs=1<<19,ri=1<<20,dn=1<<21,Mn=1<<22,Zt=1<<23,wt=Symbol("$state"),si=Symbol("legacy props"),Ao=Symbol(""),In=new class extends Error{constructor(){super(...arguments);Nr(this,"name","StaleReactionError");Nr(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}},Po=11;function Co(){throw new Error("https://svelte.dev/e/await_outside_boundary")}function zs(r){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Mo(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Io(r){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Ro(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Do(r){throw new Error("https://svelte.dev/e/effect_orphan")}function $o(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Lo(r){throw new Error("https://svelte.dev/e/lifecycle_legacy_only")}function Uo(r){throw new Error("https://svelte.dev/e/props_invalid_value")}function zo(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function qo(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function No(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}const qs=1,Ns=2,ni=4,Fo=8,Bo=16,Wo=1,Vo=2,Ho=4,Jo=8,Ko=16,Go=4,Yo=1,Qo=2,We=Symbol(),Zo="http://www.w3.org/1999/xhtml";function Xo(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}let el=!1;function ai(r){return r===this.v}function ii(r,e){return r!=r?e==e:r!==e||r!==null&&typeof r=="object"||typeof r=="function"}function oi(r){return!ii(r,this.v)}let Ir=!1,tl=!1;function rl(){Ir=!0}let xe=null;function As(r){xe=r}function Ie(r,e=!1,t){xe={p:xe,c:null,e:null,s:r,x:null,l:Ir&&!e?{s:null,u:null,$:[]}:null}}function Re(r){var e=xe,t=e.e;if(t!==null){e.e=null;for(var s of t)ki(s)}return xe=e.p,{}}function us(){return!Ir||xe!==null&&xe.l===null}const sl=new WeakMap;function nl(r){var e=pe;if(e===null)return _e.f|=Zt,r;if((e.f&Us)===0){if((e.f&ei)===0)throw!e.parent&&r instanceof Error&&li(r),r;e.b.error(r)}else Rn(r,e)}function Rn(r,e){for(;e!==null;){if((e.f&ei)!==0)try{e.b.error(r);return}catch(t){r=t}e=e.parent}throw r instanceof Error&&li(r),r}function li(r){const e=sl.get(r);e&&(Os(r,"message",{value:e.message}),Os(r,"stack",{value:e.stack}))}let Ut=[],Ps=[];function ci(){var r=Ut;Ut=[],Qr(r)}function al(){var r=Ps;Ps=[],Qr(r)}function il(){return Ut.length>0||Ps.length>0}function ds(r){if(Ut.length===0&&!Hr){var e=Ut;queueMicrotask(()=>{e===Ut&&ci()})}Ut.push(r)}function ol(){Ut.length>0&&ci(),Ps.length>0&&al()}function ll(){const r=pe.b;return r===null&&Co(),r}function hs(r){var e=at|ut,t=_e!==null&&(_e.f&at)!==0?_e:null;return pe===null||t!==null&&(t.f&ct)!==0?e|=ct:pe.f|=cs,{ctx:xe,deps:null,effects:null,equals:ai,f:e,fn:r,reactions:null,rv:0,v:We,wv:0,parent:t??pe,ac:null}}function cl(r,e){let t=pe;t===null&&Mo();var s=t.b,n=void 0,a=Xr(We),i=null,o=!_e;return El(()=>{try{var l=r();i&&Promise.resolve(l).catch(()=>{})}catch(p){l=Promise.reject(p)}var c=()=>l;n=(i==null?void 0:i.then(c,c))??Promise.resolve(l),i=n;var d=Ee,h=s.is_pending();o&&(s.update_pending_count(1),h||d.increment());const f=(p,v=void 0)=>{i=null,h||d.activate(),v?v!==In&&(a.f|=Zt,es(a,v)):((a.f&Zt)!==0&&(a.f^=Zt),es(a,p)),o&&(s.update_pending_count(-1),h||d.decrement()),hi()};if(n.then(f,p=>f(null,p||"unknown")),d)return()=>{queueMicrotask(()=>d.neuter())}}),new Promise(l=>{function c(d){function h(){d===n?l(a):c(n)}d.then(h,h)}c(n)})}function jr(r){const e=hs(r);return ji(e),e}function Dn(r){const e=hs(r);return e.equals=oi,e}function ui(r){var e=r.effects;if(e!==null){r.effects=null;for(var t=0;t<e.length;t+=1)jt(e[t])}}function ul(r){for(var e=r.parent;e!==null;){if((e.f&at)===0)return e;e=e.parent}return null}function $n(r){var e,t=pe;Bt(ul(r));try{ui(r),e=Mi(r)}finally{Bt(t)}return e}function di(r){var e=$n(r);if(r.equals(e)||(r.v=e,r.wv=Pi()),!ir){var t=(zt||(r.f&ct)!==0)&&r.deps!==null?Ct:Ve;Qe(r,t)}}function dl(r,e,t){const s=us()?hs:Dn;if(e.length===0){t(r.map(s));return}var n=Ee,a=pe,i=hl(),o=ll();Promise.all(e.map(l=>cl(l))).then(l=>{n==null||n.activate(),i();try{t([...r.map(s),...l])}catch(c){(a.f&nr)===0&&Rn(c,a)}n==null||n.deactivate(),hi()}).catch(l=>{o.error(l)})}function hl(){var r=pe,e=_e,t=xe,s=Ee;return function(){Bt(r),bt(e),As(t),s==null||s.activate()}}function hi(){Bt(null),bt(null),As(null)}const Qs=new Set;let Ee=null,xs=null,sa=new Set,tr=[],Fs=null,hn=!1,Hr=!1;var ss,xr,$t,ns,as,Yt,Tr,Qt,Lt,Or,is,os,pt,fi,Ts,fn;const $s=class $s{constructor(){Ze(this,pt);Nr(this,"current",new Map);Ze(this,ss,new Map);Ze(this,xr,new Set);Ze(this,$t,0);Ze(this,ns,null);Ze(this,as,!1);Ze(this,Yt,[]);Ze(this,Tr,[]);Ze(this,Qt,[]);Ze(this,Lt,[]);Ze(this,Or,[]);Ze(this,is,[]);Ze(this,os,[]);Nr(this,"skipped_effects",new Set)}process(e){var n;tr=[],xs=null;for(const a of e)Ht(this,pt,fi).call(this,a);if(be(this,Yt).length===0&&be(this,$t)===0){Ht(this,pt,fn).call(this);var t=be(this,Qt),s=be(this,Lt);ot(this,Qt,[]),ot(this,Lt,[]),ot(this,Or,[]),xs=Ee,Ee=null,na(t),na(s),Ee===null?Ee=this:Qs.delete(this),(n=be(this,ns))==null||n.resolve()}else Ht(this,pt,Ts).call(this,be(this,Qt)),Ht(this,pt,Ts).call(this,be(this,Lt)),Ht(this,pt,Ts).call(this,be(this,Or));for(const a of be(this,Yt))er(a);for(const a of be(this,Tr))er(a);ot(this,Yt,[]),ot(this,Tr,[])}capture(e,t){be(this,ss).has(e)||be(this,ss).set(e,t),this.current.set(e,e.v)}activate(){Ee=this}deactivate(){Ee=null,xs=null;for(const e of sa)if(sa.delete(e),e(),Ee!==null)break}neuter(){ot(this,as,!0)}flush(){tr.length>0?vi():Ht(this,pt,fn).call(this),Ee===this&&(be(this,$t)===0&&Qs.delete(this),this.deactivate())}increment(){ot(this,$t,be(this,$t)+1)}decrement(){if(ot(this,$t,be(this,$t)-1),be(this,$t)===0){for(const e of be(this,is))Qe(e,ut),Ar(e);for(const e of be(this,os))Qe(e,Ct),Ar(e);ot(this,Qt,[]),ot(this,Lt,[]),this.flush()}else this.deactivate()}add_callback(e){be(this,xr).add(e)}settled(){return(be(this,ns)??ot(this,ns,Oo())).promise}static ensure(){if(Ee===null){const e=Ee=new $s;Qs.add(Ee),Hr||$s.enqueue(()=>{Ee===e&&e.flush()})}return Ee}static enqueue(e){ds(e)}};ss=new WeakMap,xr=new WeakMap,$t=new WeakMap,ns=new WeakMap,as=new WeakMap,Yt=new WeakMap,Tr=new WeakMap,Qt=new WeakMap,Lt=new WeakMap,Or=new WeakMap,is=new WeakMap,os=new WeakMap,pt=new WeakSet,fi=function(e){var d;e.f^=Ve;for(var t=e.first;t!==null;){var s=t.f,n=(s&(Pt|sr))!==0,a=n&&(s&Ve)!==0,i=a||(s&vt)!==0||this.skipped_effects.has(t);if(!i&&t.fn!==null){if(n)t.f^=Ve;else if((s&Cn)!==0)be(this,Lt).push(t);else if((s&Ve)===0)if((s&Mn)!==0){var o=(d=t.b)!=null&&d.is_pending()?be(this,Tr):be(this,Yt);o.push(t)}else fs(t)&&((t.f&rr)!==0&&be(this,Or).push(t),er(t));var l=t.first;if(l!==null){t=l;continue}}var c=t.parent;for(t=t.next;t===null&&c!==null;)t=c.next,c=c.parent}},Ts=function(e){for(const t of e)((t.f&ut)!==0?be(this,is):be(this,os)).push(t),Qe(t,Ve);e.length=0},fn=function(){if(!be(this,as))for(const e of be(this,xr))e();be(this,xr).clear()};let Zr=$s;function fl(r){var e=Hr;Hr=!0;try{for(var t;;){if(ol(),tr.length===0&&!il()&&(Ee==null||Ee.flush(),tr.length===0))return Fs=null,t;vi()}}finally{Hr=e}}function vi(){var r=Sr;hn=!0;try{var e=0;for(la(!0);tr.length>0;){var t=Zr.ensure();if(e++>1e3){var s,n;vl()}t.process(tr),Nt.clear()}}finally{hn=!1,la(r),Fs=null}}function vl(){try{$o()}catch(r){Rn(r,Fs)}}let xt=null;function na(r){var e=r.length;if(e!==0){for(var t=0;t<e;){var s=r[t++];if((s.f&(nr|vt))===0&&fs(s)&&(xt=[],er(s),s.deps===null&&s.first===null&&s.nodes_start===null&&(s.teardown===null&&s.ac===null?xi(s):s.fn=null),(xt==null?void 0:xt.length)>0)){Nt.clear();for(const n of xt)er(n);xt=[]}}xt=null}}function Ar(r){for(var e=Fs=r;e.parent!==null;){e=e.parent;var t=e.f;if(hn&&e===pe&&(t&rr)!==0)return;if((t&(sr|Pt))!==0){if((t&Ve)===0)return;e.f^=Ve}}tr.push(e)}const Nt=new Map;function Xr(r,e){var t={f:0,v:r,reactions:null,equals:ai,rv:0,wv:0};return t}function j(r,e){const t=Xr(r);return ji(t),t}function kr(r,e=!1,t=!0){var n;const s=Xr(r);return e||(s.equals=oi),Ir&&t&&xe!==null&&xe.l!==null&&((n=xe.l).s??(n.s=[])).push(s),s}function _(r,e,t=!1){_e!==null&&(!yt||(_e.f&ra)!==0)&&us()&&(_e.f&(at|rr|Mn|ra))!==0&&!(Ye!=null&&Ye.includes(r))&&No();let s=t?W(e):e;return es(r,s)}function es(r,e){if(!r.equals(e)){var t=r.v;ir?Nt.set(r,e):Nt.set(r,t),r.v=e;var s=Zr.ensure();s.capture(r,t),(r.f&at)!==0&&((r.f&ut)!==0&&$n(r),Qe(r,(r.f&ct)===0?Ve:Ct)),r.wv=Pi(),gi(r,ut),us()&&pe!==null&&(pe.f&Ve)!==0&&(pe.f&(Pt|sr))===0&&(lt===null?Ol([r]):lt.push(r))}return e}function pi(r,e=1){var t=u(r),s=e===1?t++:t--;return _(r,t),s}function Zs(r){_(r,r.v+1)}function gi(r,e){var t=r.reactions;if(t!==null)for(var s=us(),n=t.length,a=0;a<n;a++){var i=t[a],o=i.f;if(!(!s&&i===pe)){var l=(o&ut)===0;l&&Qe(i,e),(o&at)!==0?gi(i,Ct):l&&((o&rr)!==0&&xt!==null&&xt.push(i),Ar(i))}}}function W(r){if(typeof r!="object"||r===null||wt in r)return r;const e=Pn(r);if(e!==Eo&&e!==xo)return r;var t=new Map,s=Mr(r),n=j(0),a=Xt,i=o=>{if(Xt===a)return o();var l=_e,c=Xt;bt(null),ua(a);var d=o();return bt(l),ua(c),d};return s&&t.set("length",j(r.length)),new Proxy(r,{defineProperty(o,l,c){(!("value"in c)||c.configurable===!1||c.enumerable===!1||c.writable===!1)&&zo();var d=t.get(l);return d===void 0?d=i(()=>{var h=j(c.value);return t.set(l,h),h}):_(d,c.value,!0),!0},deleteProperty(o,l){var c=t.get(l);if(c===void 0){if(l in o){const d=i(()=>j(We));t.set(l,d),Zs(n)}}else _(c,We),Zs(n);return!0},get(o,l,c){var p;if(l===wt)return r;var d=t.get(l),h=l in o;if(d===void 0&&(!h||(p=qt(o,l))!=null&&p.writable)&&(d=i(()=>{var v=W(h?o[l]:We),k=j(v);return k}),t.set(l,d)),d!==void 0){var f=u(d);return f===We?void 0:f}return Reflect.get(o,l,c)},getOwnPropertyDescriptor(o,l){var c=Reflect.getOwnPropertyDescriptor(o,l);if(c&&"value"in c){var d=t.get(l);d&&(c.value=u(d))}else if(c===void 0){var h=t.get(l),f=h==null?void 0:h.v;if(h!==void 0&&f!==We)return{enumerable:!0,configurable:!0,value:f,writable:!0}}return c},has(o,l){var f;if(l===wt)return!0;var c=t.get(l),d=c!==void 0&&c.v!==We||Reflect.has(o,l);if(c!==void 0||pe!==null&&(!d||(f=qt(o,l))!=null&&f.writable)){c===void 0&&(c=i(()=>{var p=d?W(o[l]):We,v=j(p);return v}),t.set(l,c));var h=u(c);if(h===We)return!1}return d},set(o,l,c,d){var O;var h=t.get(l),f=l in o;if(s&&l==="length")for(var p=c;p<h.v;p+=1){var v=t.get(p+"");v!==void 0?_(v,We):p in o&&(v=i(()=>j(We)),t.set(p+"",v))}if(h===void 0)(!f||(O=qt(o,l))!=null&&O.writable)&&(h=i(()=>j(void 0)),_(h,W(c)),t.set(l,h));else{f=h.v!==We;var k=i(()=>W(c));_(h,k)}var m=Reflect.getOwnPropertyDescriptor(o,l);if(m!=null&&m.set&&m.set.call(d,c),!f){if(s&&typeof l=="string"){var T=t.get("length"),I=Number(l);Number.isInteger(I)&&I>=T.v&&_(T,I+1)}Zs(n)}return!0},ownKeys(o){u(n);var l=Reflect.ownKeys(o).filter(h=>{var f=t.get(h);return f===void 0||f.v!==We});for(var[c,d]of t)d.v!==We&&!(c in o)&&l.push(c);return l},setPrototypeOf(){qo()}})}function aa(r){try{if(r!==null&&typeof r=="object"&&wt in r)return r[wt]}catch{}return r}function pl(r,e){return Object.is(aa(r),aa(e))}var ia,_i,mi,yi;function gl(){if(ia===void 0){ia=window,_i=/Firefox/.test(navigator.userAgent);var r=Element.prototype,e=Node.prototype,t=Text.prototype;mi=qt(e,"firstChild").get,yi=qt(e,"nextSibling").get,ta(r)&&(r.__click=void 0,r.__className=void 0,r.__attributes=null,r.__style=void 0,r.__e=void 0),ta(t)&&(t.__t=void 0)}}function ar(r=""){return document.createTextNode(r)}function Cs(r){return mi.call(r)}function Bs(r){return yi.call(r)}function w(r,e){return Cs(r)}function je(r,e){{var t=Cs(r);return t instanceof Comment&&t.data===""?Bs(t):t}}function y(r,e=1,t=!1){let s=r;for(;e--;)s=Bs(s);return s}function _l(r){r.textContent=""}function Ln(){return!1}let oa=!1;function ml(){oa||(oa=!0,document.addEventListener("reset",r=>{Promise.resolve().then(()=>{var e;if(!r.defaultPrevented)for(const t of r.target.elements)(e=t.__on_r)==null||e.call(t)})},{capture:!0}))}function Rr(r){var e=_e,t=pe;bt(null),Bt(null);try{return r()}finally{bt(e),Bt(t)}}function wi(r,e,t,s=t){r.addEventListener(e,()=>Rr(t));const n=r.__on_r;n?r.__on_r=()=>{n(),s(!0)}:r.__on_r=()=>s(!0),ml()}function bi(r){pe===null&&_e===null&&Do(),_e!==null&&(_e.f&ct)!==0&&pe===null&&Ro(),ir&&Io()}function yl(r,e){var t=e.last;t===null?e.last=e.first=r:(t.next=r,r.prev=t,e.last=r)}function kt(r,e,t,s=!0){var n=pe;n!==null&&(n.f&vt)!==0&&(r|=vt);var a={ctx:xe,deps:null,nodes_start:null,nodes_end:null,f:r|ut,first:null,fn:e,last:null,next:null,parent:n,b:n&&n.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(t)try{er(a),a.f|=Us}catch(l){throw jt(a),l}else e!==null&&Ar(a);if(s){var i=a;if(t&&i.deps===null&&i.teardown===null&&i.nodes_start===null&&i.first===i.last&&(i.f&cs)===0&&(i=i.first),i!==null&&(i.parent=n,n!==null&&yl(i,n),_e!==null&&(_e.f&at)!==0&&(r&sr)===0)){var o=_e;(o.effects??(o.effects=[])).push(i)}}return a}function Un(r){const e=kt(Ls,null,!1);return Qe(e,Ve),e.teardown=r,e}function Se(r){bi();var e=pe.f,t=!_e&&(e&Pt)!==0&&(e&Us)===0;if(t){var s=xe;(s.e??(s.e=[])).push(r)}else return ki(r)}function ki(r){return kt(Cn|ri,r,!1)}function wl(r){return bi(),kt(Ls|ri,r,!0)}function bl(r){Zr.ensure();const e=kt(sr|cs,r,!0);return(t={})=>new Promise(s=>{t.outro?Hs(e,()=>{jt(e),s(void 0)}):(jt(e),s(void 0))})}function zn(r){return kt(Cn,r,!1)}function kl(r,e){var t=xe,s={effect:null,ran:!1,deps:r};t.l.$.push(s),s.effect=Ws(()=>{r(),!s.ran&&(s.ran=!0,Mt(e))})}function Sl(){var r=xe;Ws(()=>{for(var e of r.l.$){e.deps();var t=e.effect;(t.f&Ve)!==0&&Qe(t,Ct),fs(t)&&er(t),e.ran=!1}})}function El(r){return kt(Mn|cs,r,!0)}function Ws(r,e=0){return kt(Ls|e,r,!0)}function de(r,e=[],t=[]){dl(e,t,s=>{kt(Ls,()=>r(...s.map(u)),!0)})}function Vs(r,e=0){var t=kt(rr|e,r,!0);return t}function Pr(r,e=!0){return kt(Pt|cs,r,!0,e)}function Si(r){var e=r.teardown;if(e!==null){const t=ir,s=_e;ca(!0),bt(null);try{e.call(null)}finally{ca(t),bt(s)}}}function Ei(r,e=!1){var t=r.first;for(r.first=r.last=null;t!==null;){const n=t.ac;n!==null&&Rr(()=>{n.abort(In)});var s=t.next;(t.f&sr)!==0?t.parent=null:jt(t,e),t=s}}function xl(r){for(var e=r.first;e!==null;){var t=e.next;(e.f&Pt)===0&&jt(e),e=t}}function jt(r,e=!0){var t=!1;(e||(r.f&ti)!==0)&&r.nodes_start!==null&&r.nodes_end!==null&&(Tl(r.nodes_start,r.nodes_end),t=!0),Ei(r,e&&!t),Ms(r,0),Qe(r,nr);var s=r.transitions;if(s!==null)for(const a of s)a.stop();Si(r);var n=r.parent;n!==null&&n.first!==null&&xi(r),r.next=r.prev=r.teardown=r.ctx=r.deps=r.fn=r.nodes_start=r.nodes_end=r.ac=null}function Tl(r,e){for(;r!==null;){var t=r===e?null:Bs(r);r.remove(),r=t}}function xi(r){var e=r.parent,t=r.prev,s=r.next;t!==null&&(t.next=s),s!==null&&(s.prev=t),e!==null&&(e.first===r&&(e.first=s),e.last===r&&(e.last=t))}function Hs(r,e){var t=[];qn(r,t,!0),Ti(t,()=>{jt(r),e&&e()})}function Ti(r,e){var t=r.length;if(t>0){var s=()=>--t||e();for(var n of r)n.out(s)}else e()}function qn(r,e,t){if((r.f&vt)===0){if(r.f^=vt,r.transitions!==null)for(const i of r.transitions)(i.is_global||t)&&e.push(i);for(var s=r.first;s!==null;){var n=s.next,a=(s.f&ls)!==0||(s.f&Pt)!==0;qn(s,e,a?t:!1),s=n}}}function Nn(r){Oi(r,!0)}function Oi(r,e){if((r.f&vt)!==0){r.f^=vt,(r.f&Ve)===0&&(Qe(r,ut),Ar(r));for(var t=r.first;t!==null;){var s=t.next,n=(t.f&ls)!==0||(t.f&Pt)!==0;Oi(t,n?e:!1),t=s}if(r.transitions!==null)for(const a of r.transitions)(a.is_global||e)&&a.in()}}let Sr=!1;function la(r){Sr=r}let ir=!1;function ca(r){ir=r}let _e=null,yt=!1;function bt(r){_e=r}let pe=null;function Bt(r){pe=r}let Ye=null;function ji(r){_e!==null&&(Ye===null?Ye=[r]:Ye.push(r))}let Ge=null,rt=0,lt=null;function Ol(r){lt=r}let Ai=1,ts=0,Xt=ts;function ua(r){Xt=r}let zt=!1;function Pi(){return++Ai}function fs(r){var h;var e=r.f;if((e&ut)!==0)return!0;if((e&Ct)!==0){var t=r.deps,s=(e&ct)!==0;if(t!==null){var n,a,i=(e&js)!==0,o=s&&pe!==null&&!zt,l=t.length;if((i||o)&&(pe===null||(pe.f&nr)===0)){var c=r,d=c.parent;for(n=0;n<l;n++)a=t[n],(i||!((h=a==null?void 0:a.reactions)!=null&&h.includes(c)))&&(a.reactions??(a.reactions=[])).push(c);i&&(c.f^=js),o&&d!==null&&(d.f&ct)===0&&(c.f^=ct)}for(n=0;n<l;n++)if(a=t[n],fs(a)&&di(a),a.wv>r.wv)return!0}(!s||pe!==null&&!zt)&&Qe(r,Ve)}return!1}function Ci(r,e,t=!0){var s=r.reactions;if(s!==null&&!(Ye!=null&&Ye.includes(r)))for(var n=0;n<s.length;n++){var a=s[n];(a.f&at)!==0?Ci(a,e,!1):e===a&&(t?Qe(a,ut):(a.f&Ve)!==0&&Qe(a,Ct),Ar(a))}}function Mi(r){var k;var e=Ge,t=rt,s=lt,n=_e,a=zt,i=Ye,o=xe,l=yt,c=Xt,d=r.f;Ge=null,rt=0,lt=null,zt=(d&ct)!==0&&(yt||!Sr||_e===null),_e=(d&(Pt|sr))===0?r:null,Ye=null,As(r.ctx),yt=!1,Xt=++ts,r.ac!==null&&(Rr(()=>{r.ac.abort(In)}),r.ac=null);try{r.f|=dn;var h=r.fn,f=h(),p=r.deps;if(Ge!==null){var v;if(Ms(r,rt),p!==null&&rt>0)for(p.length=rt+Ge.length,v=0;v<Ge.length;v++)p[rt+v]=Ge[v];else r.deps=p=Ge;if(!zt||(d&at)!==0&&r.reactions!==null)for(v=rt;v<p.length;v++)((k=p[v]).reactions??(k.reactions=[])).push(r)}else p!==null&&rt<p.length&&(Ms(r,rt),p.length=rt);if(us()&&lt!==null&&!yt&&p!==null&&(r.f&(at|Ct|ut))===0)for(v=0;v<lt.length;v++)Ci(lt[v],r);return n!==null&&n!==r&&(ts++,lt!==null&&(s===null?s=lt:s.push(...lt))),(r.f&Zt)!==0&&(r.f^=Zt),f}catch(m){return nl(m)}finally{r.f^=dn,Ge=e,rt=t,lt=s,_e=n,zt=a,Ye=i,As(o),yt=l,Xt=c}}function jl(r,e){let t=e.reactions;if(t!==null){var s=So.call(t,r);if(s!==-1){var n=t.length-1;n===0?t=e.reactions=null:(t[s]=t[n],t.pop())}}t===null&&(e.f&at)!==0&&(Ge===null||!Ge.includes(e))&&(Qe(e,Ct),(e.f&(ct|js))===0&&(e.f^=js),ui(e),Ms(e,0))}function Ms(r,e){var t=r.deps;if(t!==null)for(var s=e;s<t.length;s++)jl(r,t[s])}function er(r){var e=r.f;if((e&nr)===0){Qe(r,Ve);var t=pe,s=Sr;pe=r,Sr=!0;try{(e&rr)!==0?xl(r):Ei(r),Si(r);var n=Mi(r);r.teardown=typeof n=="function"?n:null,r.wv=Ai;var a;Za&&tl&&(r.f&ut)!==0&&r.deps}finally{Sr=s,pe=t}}}async function Ii(){await Promise.resolve(),fl()}function u(r){var e=r.f,t=(e&at)!==0;if(_e!==null&&!yt){var s=pe!==null&&(pe.f&nr)!==0;if(!s&&!(Ye!=null&&Ye.includes(r))){var n=_e.deps;if((_e.f&dn)!==0)r.rv<ts&&(r.rv=ts,Ge===null&&n!==null&&n[rt]===r?rt++:Ge===null?Ge=[r]:(!zt||!Ge.includes(r))&&Ge.push(r));else{(_e.deps??(_e.deps=[])).push(r);var a=r.reactions;a===null?r.reactions=[_e]:a.includes(_e)||a.push(_e)}}}else if(t&&r.deps===null&&r.effects===null){var i=r,o=i.parent;o!==null&&(o.f&ct)===0&&(i.f^=ct)}if(ir){if(Nt.has(r))return Nt.get(r);if(t){i=r;var l=i.v;return((i.f&Ve)===0&&i.reactions!==null||Ri(i))&&(l=$n(i)),Nt.set(i,l),l}}else t&&(i=r,fs(i)&&di(i));if((r.f&Zt)!==0)throw r.v;return r.v}function Ri(r){if(r.v===We)return!0;if(r.deps===null)return!1;for(const e of r.deps)if(Nt.has(e)||(e.f&at)!==0&&Ri(e))return!0;return!1}function Mt(r){var e=yt;try{return yt=!0,r()}finally{yt=e}}const Al=-7169;function Qe(r,e){r.f=r.f&Al|e}function Di(r){if(!(typeof r!="object"||!r||r instanceof EventTarget)){if(wt in r)vn(r);else if(!Array.isArray(r))for(let e in r){const t=r[e];typeof t=="object"&&t&&wt in t&&vn(t)}}}function vn(r,e=new Set){if(typeof r=="object"&&r!==null&&!(r instanceof EventTarget)&&!e.has(r)){e.add(r),r instanceof Date&&r.getTime();for(let s in r)try{vn(r[s],e)}catch{}const t=Pn(r);if(t!==Object.prototype&&t!==Array.prototype&&t!==Map.prototype&&t!==Set.prototype&&t!==Date.prototype){const s=Xa(t);for(let n in s){const a=s[n].get;if(a)try{a.call(r)}catch{}}}}}const Pl=["touchstart","touchmove"];function Cl(r){return Pl.includes(r)}const $i=new Set,pn=new Set;function Ml(r,e,t,s={}){function n(a){if(s.capture||Wr.call(e,a),!a.cancelBubble)return Rr(()=>t==null?void 0:t.call(this,a))}return r.startsWith("pointer")||r.startsWith("touch")||r==="wheel"?ds(()=>{e.addEventListener(r,n,s)}):e.addEventListener(r,n,s),n}function et(r,e,t,s,n){var a={capture:s,passive:n},i=Ml(r,e,t,a);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&Un(()=>{e.removeEventListener(r,i,a)})}function or(r){for(var e=0;e<r.length;e++)$i.add(r[e]);for(var t of pn)t(r)}let da=null;function Wr(r){var I;var e=this,t=e.ownerDocument,s=r.type,n=((I=r.composedPath)==null?void 0:I.call(r))||[],a=n[0]||r.target;da=r;var i=0,o=da===r&&r.__root;if(o){var l=n.indexOf(o);if(l!==-1&&(e===document||e===window)){r.__root=e;return}var c=n.indexOf(e);if(c===-1)return;l<=c&&(i=l)}if(a=n[i]||r.target,a!==e){Os(r,"currentTarget",{configurable:!0,get(){return a||t}});var d=_e,h=pe;bt(null),Bt(null);try{for(var f,p=[];a!==null;){var v=a.assignedSlot||a.parentNode||a.host||null;try{var k=a["__"+s];if(k!=null&&(!a.disabled||r.target===a))if(Mr(k)){var[m,...T]=k;m.apply(a,[r,...T])}else k.call(a,r)}catch(O){f?p.push(O):f=O}if(r.cancelBubble||v===e||v===null)break;a=v}if(f){for(let O of p)queueMicrotask(()=>{throw O});throw f}}finally{r.__root=e,delete r.currentTarget,bt(d),Bt(h)}}}function Fn(r){var e;e=document.head.appendChild(ar());try{Vs(()=>r(e),ti)}finally{}}function Il(r){var e=document.createElement("template");return e.innerHTML=r.replaceAll("<!>","<!---->"),e.content}function gn(r,e){var t=pe;t.nodes_start===null&&(t.nodes_start=r,t.nodes_end=e)}function N(r,e){var t=(e&Yo)!==0,s=(e&Qo)!==0,n,a=!r.startsWith("<!>");return()=>{n===void 0&&(n=Il(a?r:"<!>"+r),t||(n=Cs(n)));var i=s||_i?document.importNode(n,!0):n.cloneNode(!0);if(t){var o=Cs(i),l=i.lastChild;gn(o,l)}else gn(i,i);return i}}function Bn(r){return()=>Rl(r())}function Rl(r){const e=r.nodeType===Po,t=r.tagName==="SCRIPT"?[r]:r.querySelectorAll("script"),s=pe;for(const a of t){const i=document.createElement("script");for(var n of a.attributes)i.setAttribute(n.name,n.value);i.textContent=a.textContent,(e?r.firstChild===a:r===a)&&(s.nodes_start=i),(e?r.lastChild===a:r===a)&&(s.nodes_end=i),a.replaceWith(i)}return r}function Ft(){var r=document.createDocumentFragment(),e=document.createComment(""),t=ar();return r.append(e,t),gn(e,t),r}function L(r,e){r!==null&&r.before(e)}let _n=!0;function te(r,e){var t=e==null?"":typeof e=="object"?e+"":e;t!==(r.__t??(r.__t=r.nodeValue))&&(r.__t=t,r.nodeValue=t+"")}function Dl(r,e){return $l(r,e)}const cr=new Map;function $l(r,{target:e,anchor:t,props:s={},events:n,context:a,intro:i=!0}){gl();var o=new Set,l=h=>{for(var f=0;f<h.length;f++){var p=h[f];if(!o.has(p)){o.add(p);var v=Cl(p);e.addEventListener(p,Wr,{passive:v});var k=cr.get(p);k===void 0?(document.addEventListener(p,Wr,{passive:v}),cr.set(p,1)):cr.set(p,k+1)}}};l(An($i)),pn.add(l);var c=void 0,d=bl(()=>{var h=t??e.appendChild(ar());return Pr(()=>{if(a){Ie({});var f=xe;f.c=a}n&&(s.$$events=n),_n=i,c=r(h,s)||{},_n=!0,a&&Re()}),()=>{var v;for(var f of o){e.removeEventListener(f,Wr);var p=cr.get(f);--p===0?(document.removeEventListener(f,Wr),cr.delete(f)):cr.set(f,p)}pn.delete(l),h!==t&&((v=h.parentNode)==null||v.removeChild(h))}});return Ll.set(c,d),c}let Ll=new WeakMap;function ce(r,e,t=!1){var s=r,n=null,a=null,i=We,o=t?ls:0,l=!1;const c=(p,v=!0)=>{l=!0,f(v,p)};var d=null;function h(){d!==null&&(d.lastChild.remove(),s.before(d),d=null);var p=i?n:a,v=i?a:n;p&&Nn(p),v&&Hs(v,()=>{i?a=null:n=null})}const f=(p,v)=>{if(i!==(i=p)){var k=Ln(),m=s;if(k&&(d=document.createDocumentFragment(),d.append(m=ar())),i?n??(n=v&&Pr(()=>v(m))):a??(a=v&&Pr(()=>v(m))),k){var T=Ee,I=i?n:a,O=i?a:n;I&&T.skipped_effects.delete(I),O&&T.skipped_effects.add(O),T.add_callback(h)}else h()}};Vs(()=>{l=!1,e(c),l||f(null,null)},o)}function Ce(r,e){return e}function Ul(r,e,t){for(var s=r.items,n=[],a=e.length,i=0;i<a;i++)qn(e[i].e,n,!0);var o=a>0&&n.length===0&&t!==null;if(o){var l=t.parentNode;_l(l),l.append(t),s.clear(),mt(r,e[0].prev,e[a-1].next)}Ti(n,()=>{for(var c=0;c<a;c++){var d=e[c];o||(s.delete(d.k),mt(r,d.prev,d.next)),jt(d.e,!o)}})}function Me(r,e,t,s,n,a=null){var i=r,o={flags:e,items:new Map,first:null},l=(e&ni)!==0;if(l){var c=r;i=c.appendChild(ar())}var d=null,h=!1,f=new Map,p=Dn(()=>{var T=t();return Mr(T)?T:T==null?[]:An(T)}),v,k;function m(){zl(k,v,o,f,i,n,e,s,t),a!==null&&(v.length===0?d?Nn(d):d=Pr(()=>a(i)):d!==null&&Hs(d,()=>{d=null}))}Vs(()=>{k??(k=pe),v=u(p);var T=v.length;if(!(h&&T===0)){h=T===0;var I,O,E,x;if(Ln()){var S=new Set,A=Ee;for(O=0;O<T;O+=1){E=v[O],x=s(E,O);var C=o.items.get(x)??f.get(x);C?(e&(qs|Ns))!==0&&Li(C,E,O,e):(I=Ui(null,o,null,null,E,x,O,n,e,t,!0),f.set(x,I)),S.add(x)}for(const[M,K]of o.items)S.has(M)||A.skipped_effects.add(K.e);A.add_callback(m)}else m();u(p)}})}function zl(r,e,t,s,n,a,i,o,l){var me,b,g,z;var c=(i&Fo)!==0,d=(i&(qs|Ns))!==0,h=e.length,f=t.items,p=t.first,v=p,k,m=null,T,I=[],O=[],E,x,S,A;if(c)for(A=0;A<h;A+=1)E=e[A],x=o(E,A),S=f.get(x),S!==void 0&&((me=S.a)==null||me.measure(),(T??(T=new Set)).add(S));for(A=0;A<h;A+=1){if(E=e[A],x=o(E,A),S=f.get(x),S===void 0){var C=s.get(x);if(C!==void 0){s.delete(x),f.set(x,C);var M=m?m.next:v;mt(t,m,C),mt(t,C,M),Xs(C,M,n),m=C}else{var K=v?v.e.nodes_start:n;m=Ui(K,t,m,m===null?t.first:m.next,E,x,A,a,i,l)}f.set(x,m),I=[],O=[],v=m.next;continue}if(d&&Li(S,E,A,i),(S.e.f&vt)!==0&&(Nn(S.e),c&&((b=S.a)==null||b.unfix(),(T??(T=new Set)).delete(S))),S!==v){if(k!==void 0&&k.has(S)){if(I.length<O.length){var G=O[0],F;m=G.prev;var P=I[0],$=I[I.length-1];for(F=0;F<I.length;F+=1)Xs(I[F],G,n);for(F=0;F<O.length;F+=1)k.delete(O[F]);mt(t,P.prev,$.next),mt(t,m,P),mt(t,$,G),v=G,m=$,A-=1,I=[],O=[]}else k.delete(S),Xs(S,v,n),mt(t,S.prev,S.next),mt(t,S,m===null?t.first:m.next),mt(t,m,S),m=S;continue}for(I=[],O=[];v!==null&&v.k!==x;)(v.e.f&vt)===0&&(k??(k=new Set)).add(v),O.push(v),v=v.next;if(v===null)continue;S=v}I.push(S),m=S,v=S.next}if(v!==null||k!==void 0){for(var D=k===void 0?[]:An(k);v!==null;)(v.e.f&vt)===0&&D.push(v),v=v.next;var R=D.length;if(R>0){var Z=(i&ni)!==0&&h===0?n:null;if(c){for(A=0;A<R;A+=1)(g=D[A].a)==null||g.measure();for(A=0;A<R;A+=1)(z=D[A].a)==null||z.fix()}Ul(t,D,Z)}}c&&ds(()=>{var q;if(T!==void 0)for(S of T)(q=S.a)==null||q.apply()}),r.first=t.first&&t.first.e,r.last=m&&m.e;for(var re of s.values())jt(re.e);s.clear()}function Li(r,e,t,s){(s&qs)!==0&&es(r.v,e),(s&Ns)!==0?es(r.i,t):r.i=t}function Ui(r,e,t,s,n,a,i,o,l,c,d){var h=(l&qs)!==0,f=(l&Bo)===0,p=h?f?kr(n,!1,!1):Xr(n):n,v=(l&Ns)===0?i:Xr(i),k={i:v,v:p,k:a,a:null,e:null,prev:t,next:s};try{if(r===null){var m=document.createDocumentFragment();m.append(r=ar())}return k.e=Pr(()=>o(r,p,v,c),el),k.e.prev=t&&t.e,k.e.next=s&&s.e,t===null?d||(e.first=k):(t.next=k,t.e.next=k.e),s!==null&&(s.prev=k,s.e.prev=k.e),k}finally{}}function Xs(r,e,t){for(var s=r.next?r.next.e.nodes_start:t,n=e?e.e.nodes_start:t,a=r.e.nodes_start;a!==null&&a!==s;){var i=Bs(a);n.before(a),a=i}}function mt(r,e,t){e===null?r.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function ha(r,e,t){var s=r,n,a,i=null,o=null;function l(){a&&(Hs(a),a=null),i&&(i.lastChild.remove(),s.before(i),i=null),a=o,o=null}Vs(()=>{if(n!==(n=e())){var c=Ln();if(n){var d=s;c&&(i=document.createDocumentFragment(),i.append(d=ar()),a&&Ee.skipped_effects.add(a)),o=Pr(()=>t(d,n))}c?Ee.add_callback(l):l()}},ls)}function zi(r){var e,t,s="";if(typeof r=="string"||typeof r=="number")s+=r;else if(typeof r=="object")if(Array.isArray(r)){var n=r.length;for(e=0;e<n;e++)r[e]&&(t=zi(r[e]))&&(s&&(s+=" "),s+=t)}else for(t in r)r[t]&&(s&&(s+=" "),s+=t);return s}function ql(){for(var r,e,t=0,s="",n=arguments.length;t<n;t++)(r=arguments[t])&&(e=zi(r))&&(s&&(s+=" "),s+=e);return s}function Is(r){return typeof r=="object"?ql(r):r??""}const fa=[...` 	
\r\fÂ \v\uFEFF`];function Nl(r,e,t){var s=r==null?"":""+r;if(e&&(s=s?s+" "+e:e),t){for(var n in t)if(t[n])s=s?s+" "+n:n;else if(s.length)for(var a=n.length,i=0;(i=s.indexOf(n,i))>=0;){var o=i+a;(i===0||fa.includes(s[i-1]))&&(o===s.length||fa.includes(s[o]))?s=(i===0?"":s.substring(0,i))+s.substring(o+1):i=o}}return s===""?null:s}function Fl(r,e){return r==null?null:String(r)}function st(r,e,t,s,n,a){var i=r.__className;if(i!==t||i===void 0){var o=Nl(t,s,a);o==null?r.removeAttribute("class"):r.className=o,r.__className=t}else if(a&&n!==a)for(var l in a){var c=!!a[l];(n==null||c!==!!n[l])&&r.classList.toggle(l,c)}return a}function Bl(r,e,t,s){var n=r.__style;if(n!==e){var a=Fl(e);a==null?r.removeAttribute("style"):r.style.cssText=a,r.__style=e}return s}function qi(r,e,t=!1){if(r.multiple){if(e==null)return;if(!Mr(e))return Xo();for(var s of r.options)s.selected=e.includes(Jr(s));return}for(s of r.options){var n=Jr(s);if(pl(n,e)){s.selected=!0;return}}(!t||e!==void 0)&&(r.selectedIndex=-1)}function Wl(r){var e=new MutationObserver(()=>{qi(r,r.__value)});e.observe(r,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Un(()=>{e.disconnect()})}function He(r,e,t=e){var s=!0;wi(r,"change",n=>{var a=n?"[selected]":":checked",i;if(r.multiple)i=[].map.call(r.querySelectorAll(a),Jr);else{var o=r.querySelector(a)??r.querySelector("option:not([disabled])");i=o&&Jr(o)}t(i)}),zn(()=>{var n=e();if(qi(r,n,s),s&&n===void 0){var a=r.querySelector(":checked");a!==null&&(n=Jr(a),t(n))}r.__value=n,s=!1}),Wl(r)}function Jr(r){return"__value"in r?r.__value:r.value}const Vl=Symbol("is custom element"),Hl=Symbol("is html");function Ue(r,e,t,s){var n=Jl(r);n[e]!==(n[e]=t)&&(e==="loading"&&(r[Ao]=t),t==null?r.removeAttribute(e):typeof t!="string"&&Kl(r).includes(e)?r[e]=t:r.setAttribute(e,t))}function Jl(r){return r.__attributes??(r.__attributes={[Vl]:r.nodeName.includes("-"),[Hl]:r.namespaceURI===Zo})}var va=new Map;function Kl(r){var e=r.getAttribute("is")||r.nodeName,t=va.get(e);if(t)return t;va.set(e,t=[]);for(var s,n=r,a=Element.prototype;a!==n;){s=Xa(n);for(var i in s)s[i].set&&t.push(i);n=Pn(n)}return t}const Gl=()=>performance.now(),Ot={tick:r=>requestAnimationFrame(r),now:()=>Gl(),tasks:new Set};function Ni(){const r=Ot.now();Ot.tasks.forEach(e=>{e.c(r)||(Ot.tasks.delete(e),e.f())}),Ot.tasks.size!==0&&Ot.tick(Ni)}function Yl(r){let e;return Ot.tasks.size===0&&Ot.tick(Ni),{promise:new Promise(t=>{Ot.tasks.add(e={c:r,f:t})}),abort(){Ot.tasks.delete(e)}}}function _s(r,e){Rr(()=>{r.dispatchEvent(new CustomEvent(e))})}function Ql(r){if(r==="float")return"cssFloat";if(r==="offset")return"cssOffset";if(r.startsWith("--"))return r;const e=r.split("-");return e.length===1?e[0]:e[0]+e.slice(1).map(t=>t[0].toUpperCase()+t.slice(1)).join("")}function pa(r){const e={},t=r.split(";");for(const s of t){const[n,a]=s.split(":");if(!n||a===void 0)break;const i=Ql(n.trim());e[i]=a.trim()}return e}const Zl=r=>r;function Xl(r,e,t,s){var n=(r&Go)!==0,a="both",i,o=e.inert,l=e.style.overflow,c,d;function h(){return Rr(()=>i??(i=t()(e,(s==null?void 0:s())??{},{direction:a})))}var f={is_global:n,in(){e.inert=o,_s(e,"introstart"),c=mn(e,h(),d,1,()=>{_s(e,"introend"),c==null||c.abort(),c=i=void 0,e.style.overflow=l})},out(m){e.inert=!0,_s(e,"outrostart"),d=mn(e,h(),c,0,()=>{_s(e,"outroend"),m==null||m()})},stop:()=>{c==null||c.abort(),d==null||d.abort()}},p=pe;if((p.transitions??(p.transitions=[])).push(f),_n){var v=n;if(!v){for(var k=p.parent;k&&(k.f&ls)!==0;)for(;(k=k.parent)&&(k.f&rr)===0;);v=!k||(k.f&Us)!==0}v&&zn(()=>{Mt(()=>f.in())})}}function mn(r,e,t,s,n){var a=s===1;if(wr(e)){var i,o=!1;return ds(()=>{if(!o){var m=e({direction:a?"in":"out"});i=mn(r,m,t,s,n)}}),{abort:()=>{o=!0,i==null||i.abort()},deactivate:()=>i.deactivate(),reset:()=>i.reset(),t:()=>i.t()}}if(t==null||t.deactivate(),!(e!=null&&e.duration))return n(),{abort:nt,deactivate:nt,reset:nt,t:()=>s};const{delay:l=0,css:c,tick:d,easing:h=Zl}=e;var f=[];if(a&&t===void 0&&(d&&d(0,1),c)){var p=pa(c(0,1));f.push(p,p)}var v=()=>1-s,k=r.animate(f,{duration:l,fill:"forwards"});return k.onfinish=()=>{k.cancel();var m=(t==null?void 0:t.t())??1-s;t==null||t.abort();var T=s-m,I=e.duration*Math.abs(T),O=[];if(I>0){var E=!1;if(c)for(var x=Math.ceil(I/16.666666666666668),S=0;S<=x;S+=1){var A=m+T*h(S/x),C=pa(c(A,1-A));O.push(C),E||(E=C.overflow==="hidden")}E&&(r.style.overflow="hidden"),v=()=>{var M=k.currentTime;return m+T*h(M/I)},d&&Yl(()=>{if(k.playState!=="running")return!1;var M=v();return d(M,1-M),!0})}k=r.animate(O,{duration:I,fill:"forwards"}),k.onfinish=()=>{v=()=>s,d==null||d(s,1-s),n()}},{abort:()=>{k&&(k.cancel(),k.effect=null,k.onfinish=nt)},deactivate:()=>{n=nt},reset:()=>{s===0&&(d==null||d(1,0))},t:()=>v()}}function gt(r,e,t=e){var s=new WeakSet;wi(r,"input",async n=>{var a=n?r.defaultValue:r.value;if(a=en(r)?tn(a):a,t(a),Ee!==null&&s.add(Ee),await Ii(),a!==(a=e())){var i=r.selectionStart,o=r.selectionEnd;r.value=a??"",o!==null&&(r.selectionStart=i,r.selectionEnd=Math.min(o,r.value.length))}}),Mt(e)==null&&r.value&&(t(en(r)?tn(r.value):r.value),Ee!==null&&s.add(Ee)),Ws(()=>{var n=e();if(r===document.activeElement){var a=xs??Ee;if(s.has(a))return}en(r)&&n===tn(r.value)||r.type==="date"&&!n&&!r.value||n!==r.value&&(r.value=n??"")})}function en(r){var e=r.type;return e==="number"||e==="range"}function tn(r){return r===""?null:+r}function ga(r,e){return r===e||(r==null?void 0:r[wt])===e}function ft(r={},e,t,s){return zn(()=>{var n,a;return Ws(()=>{n=a,a=[],Mt(()=>{r!==t(...a)&&(e(r,...a),n&&ga(t(...n),r)&&e(null,...n))})}),()=>{ds(()=>{a&&ga(t(...a),r)&&e(null,...a)})}}),r}function Wn(r=!1){const e=xe,t=e.l.u;if(!t)return;let s=()=>Di(e.s);if(r){let n=0,a={};const i=hs(()=>{let o=!1;const l=e.s;for(const c in l)l[c]!==a[c]&&(a[c]=l[c],o=!0);return o&&n++,n});s=()=>u(i)}t.b.length&&wl(()=>{_a(e,s),Qr(t.b)}),Se(()=>{const n=Mt(()=>t.m.map(To));return()=>{for(const a of n)typeof a=="function"&&a()}}),t.a.length&&Se(()=>{_a(e,s),Qr(t.a)})}function _a(r,e){if(r.l.s)for(const t of r.l.s)u(t);e()}function ma(r,e){var a;var t=(a=r.$$events)==null?void 0:a[e.type],s=Mr(t)?t.slice():t==null?[]:[t];for(var n of s)n.call(this,e)}function Vn(r,e,t){if(r==null)return e(void 0),t&&t(void 0),nt;const s=Mt(()=>r.subscribe(e,t));return s.unsubscribe?()=>s.unsubscribe():s}const ur=[];function Fi(r,e){return{subscribe:Bi(r,e).subscribe}}function Bi(r,e=nt){let t=null;const s=new Set;function n(o){if(ii(r,o)&&(r=o,t)){const l=!ur.length;for(const c of s)c[1](),ur.push(c,r);if(l){for(let c=0;c<ur.length;c+=2)ur[c][0](ur[c+1]);ur.length=0}}}function a(o){n(o(r))}function i(o,l=nt){const c=[o,l];return s.add(c),s.size===1&&(t=e(n,a)||nt),o(r),()=>{s.delete(c),s.size===0&&t&&(t(),t=null)}}return{set:n,update:a,subscribe:i}}function Wi(r,e,t){const s=!Array.isArray(r),n=s?[r]:r;if(!n.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const a=e.length<2;return Fi(t,(i,o)=>{let l=!1;const c=[];let d=0,h=nt;const f=()=>{if(d)return;h();const v=e(s?c[0]:c,i,o);a?i(v):h=typeof v=="function"?v:nt},p=n.map((v,k)=>Vn(v,m=>{c[k]=m,d&=~(1<<k),l&&f()},()=>{d|=1<<k}));return l=!0,f(),function(){Qr(p),h(),l=!1}})}function ec(r){let e;return Vn(r,t=>e=t)(),e}let ms=!1,yn=Symbol();function Dr(r,e,t){const s=t[e]??(t[e]={store:null,source:kr(void 0),unsubscribe:nt});if(s.store!==r&&!(yn in t))if(s.unsubscribe(),s.store=r??null,r==null)s.source.v=void 0,s.unsubscribe=nt;else{var n=!0;s.unsubscribe=Vn(r,a=>{n?s.source.v=a:_(s.source,a)}),n=!1}return r&&yn in t?ec(r):u(s.source)}function $r(){const r={};function e(){Un(()=>{for(var t in r)r[t].unsubscribe();Os(r,yn,{enumerable:!1,value:!0})})}return[r,e]}function tc(r){var e=ms;try{return ms=!1,[r(),ms]}finally{ms=e}}const rc={get(r,e){let t=r.props.length;for(;t--;){let s=r.props[t];if(wr(s)&&(s=s()),typeof s=="object"&&s!==null&&e in s)return s[e]}},set(r,e,t){let s=r.props.length;for(;s--;){let n=r.props[s];wr(n)&&(n=n());const a=qt(n,e);if(a&&a.set)return a.set(t),!0}return!1},getOwnPropertyDescriptor(r,e){let t=r.props.length;for(;t--;){let s=r.props[t];if(wr(s)&&(s=s()),typeof s=="object"&&s!==null&&e in s){const n=qt(s,e);return n&&!n.configurable&&(n.configurable=!0),n}}},has(r,e){if(e===wt||e===si)return!1;for(let t of r.props)if(wr(t)&&(t=t()),t!=null&&e in t)return!0;return!1},ownKeys(r){const e=[];for(let t of r.props)if(wr(t)&&(t=t()),!!t){for(const s in t)e.includes(s)||e.push(s);for(const s of Object.getOwnPropertySymbols(t))e.includes(s)||e.push(s)}return e}};function ya(...r){return new Proxy({props:r},rc)}function ye(r,e,t,s){var O;var n=!Ir||(t&Vo)!==0,a=(t&Jo)!==0,i=(t&Ko)!==0,o=s,l=!0,c=()=>(l&&(l=!1,o=i?Mt(s):s),o),d;if(a){var h=wt in r||si in r;d=((O=qt(r,e))==null?void 0:O.set)??(h&&e in r?E=>r[e]=E:void 0)}var f,p=!1;a?[f,p]=tc(()=>r[e]):f=r[e],f===void 0&&s!==void 0&&(f=c(),d&&(n&&Uo(),d(f)));var v;if(n?v=()=>{var E=r[e];return E===void 0?c():(l=!0,E)}:v=()=>{var E=r[e];return E!==void 0&&(o=void 0),E===void 0?o:E},n&&(t&Ho)===0)return v;if(d){var k=r.$$legacy;return function(E,x){return arguments.length>0?((!n||!x||k||p)&&d(x?v():E),E):v()}}var m=!1,T=((t&Wo)!==0?hs:Dn)(()=>(m=!1,v()));a&&u(T);var I=pe;return function(E,x){if(arguments.length>0){const S=x?u(T):n&&a?W(E):E;return _(T,S),m=!0,o!==void 0&&(o=S),E}return ir&&m||(I.f&nr)!==0?T.v:u(T)}}function tt(r){xe===null&&zs(),Ir&&xe.l!==null?Vi(xe).m.push(r):Se(()=>{const e=Mt(r);if(typeof e=="function")return e})}function sc(r){xe===null&&zs(),tt(()=>()=>Mt(r))}function nc(r,e,{bubbles:t=!1,cancelable:s=!1}={}){return new CustomEvent(r,{detail:e,bubbles:t,cancelable:s})}function ac(){const r=xe;return r===null&&zs(),(e,t,s)=>{var a;const n=(a=r.s.$$events)==null?void 0:a[e];if(n){const i=Mr(n)?n.slice():[n],o=nc(e,t,s);for(const l of i)l.call(r.x,o);return!o.defaultPrevented}return!0}}function ic(r){xe===null&&zs(),xe.l===null&&Lo(),Vi(xe).a.push(r)}function Vi(r){var e=r.l;return e.u??(e.u={a:[],b:[],m:[]})}const oc="5";var Qa;typeof window<"u"&&((Qa=window.__svelte??(window.__svelte={})).v??(Qa.v=new Set)).add(oc);const lc="modulepreload",cc=function(r){return"/"+r},wa={},vs=function(e,t,s){let n=Promise.resolve();if(t&&t.length>0){let i=function(c){return Promise.all(c.map(d=>Promise.resolve(d).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));n=i(t.map(c=>{if(c=cc(c),c in wa)return;wa[c]=!0;const d=c.endsWith(".css"),h=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${h}`))return;const f=document.createElement("link");if(f.rel=d?"stylesheet":lc,d||(f.as="script"),f.crossOrigin="",f.href=c,l&&f.setAttribute("nonce",l),document.head.appendChild(f),d)return new Promise((p,v)=>{f.addEventListener("load",p),f.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${c}`)))})}))}function a(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return n.then(i=>{for(const o of i||[])o.status==="rejected"&&a(o.reason);return e().catch(a)})},uc=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>vs(async()=>{const{default:s}=await Promise.resolve().then(()=>Lr);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)};class Hn extends Error{constructor(e,t="FunctionsError",s){super(e),this.name=t,this.context=s}}class dc extends Hn{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class hc extends Hn{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class fc extends Hn{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var wn;(function(r){r.Any="any",r.ApNortheast1="ap-northeast-1",r.ApNortheast2="ap-northeast-2",r.ApSouth1="ap-south-1",r.ApSoutheast1="ap-southeast-1",r.ApSoutheast2="ap-southeast-2",r.CaCentral1="ca-central-1",r.EuCentral1="eu-central-1",r.EuWest1="eu-west-1",r.EuWest2="eu-west-2",r.EuWest3="eu-west-3",r.SaEast1="sa-east-1",r.UsEast1="us-east-1",r.UsWest1="us-west-1",r.UsWest2="us-west-2"})(wn||(wn={}));var vc=function(r,e,t,s){function n(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(d){try{c(s.next(d))}catch(h){i(h)}}function l(d){try{c(s.throw(d))}catch(h){i(h)}}function c(d){d.done?a(d.value):n(d.value).then(o,l)}c((s=s.apply(r,e||[])).next())})};class pc{constructor(e,{headers:t={},customFetch:s,region:n=wn.Any}={}){this.url=e,this.headers=t,this.region=n,this.fetch=uc(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var s;return vc(this,void 0,void 0,function*(){try{const{headers:n,method:a,body:i}=t;let o={},{region:l}=t;l||(l=this.region),l&&l!=="any"&&(o["x-region"]=l);let c;i&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&(typeof Blob<"u"&&i instanceof Blob||i instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",c=i):typeof i=="string"?(o["Content-Type"]="text/plain",c=i):typeof FormData<"u"&&i instanceof FormData?c=i:(o["Content-Type"]="application/json",c=JSON.stringify(i)));const d=yield this.fetch(`${this.url}/${e}`,{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),n),body:c}).catch(v=>{throw new dc(v)}),h=d.headers.get("x-relay-error");if(h&&h==="true")throw new hc(d);if(!d.ok)throw new fc(d);let f=((s=d.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),p;return f==="application/json"?p=yield d.json():f==="application/octet-stream"?p=yield d.blob():f==="text/event-stream"?p=d:f==="multipart/form-data"?p=yield d.formData():p=yield d.text(),{data:p,error:null}}catch(n){return{data:null,error:n}}})}}function gc(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function _c(r){if(Object.prototype.hasOwnProperty.call(r,"__esModule"))return r;var e=r.default;if(typeof e=="function"){var t=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(r).forEach(function(s){var n=Object.getOwnPropertyDescriptor(r,s);Object.defineProperty(t,s,n.get?n:{enumerable:!0,get:function(){return r[s]}})}),t}var Ne={},dr={},hr={},fr={},vr={},pr={},mc=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Cr=mc();const yc=Cr.fetch,Hi=Cr.fetch.bind(Cr),Ji=Cr.Headers,wc=Cr.Request,bc=Cr.Response,Lr=Object.freeze(Object.defineProperty({__proto__:null,Headers:Ji,Request:wc,Response:bc,default:Hi,fetch:yc},Symbol.toStringTag,{value:"Module"})),kc=_c(Lr);var ys={},ba;function Ki(){if(ba)return ys;ba=1,Object.defineProperty(ys,"__esModule",{value:!0});class r extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return ys.default=r,ys}var ka;function Gi(){if(ka)return pr;ka=1;var r=pr&&pr.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(pr,"__esModule",{value:!0});const e=r(kc),t=r(Ki());class s{constructor(a){this.shouldThrowOnError=!1,this.method=a.method,this.url=a.url,this.headers=a.headers,this.schema=a.schema,this.body=a.body,this.shouldThrowOnError=a.shouldThrowOnError,this.signal=a.signal,this.isMaybeSingle=a.isMaybeSingle,a.fetch?this.fetch=a.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(a,i){return this.headers=Object.assign({},this.headers),this.headers[a]=i,this}then(a,i){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const o=this.fetch;let l=o(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var d,h,f;let p=null,v=null,k=null,m=c.status,T=c.statusText;if(c.ok){if(this.method!=="HEAD"){const x=await c.text();x===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?v=x:v=JSON.parse(x))}const O=(d=this.headers.Prefer)===null||d===void 0?void 0:d.match(/count=(exact|planned|estimated)/),E=(h=c.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");O&&E&&E.length>1&&(k=parseInt(E[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(v)&&(v.length>1?(p={code:"PGRST116",details:`Results contain ${v.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},v=null,k=null,m=406,T="Not Acceptable"):v.length===1?v=v[0]:v=null)}else{const O=await c.text();try{p=JSON.parse(O),Array.isArray(p)&&c.status===404&&(v=[],p=null,m=200,T="OK")}catch{c.status===404&&O===""?(m=204,T="No Content"):p={message:O}}if(p&&this.isMaybeSingle&&(!((f=p==null?void 0:p.details)===null||f===void 0)&&f.includes("0 rows"))&&(p=null,m=200,T="OK"),p&&this.shouldThrowOnError)throw new t.default(p)}return{error:p,data:v,count:k,status:m,statusText:T}});return this.shouldThrowOnError||(l=l.catch(c=>{var d,h,f;return{error:{message:`${(d=c==null?void 0:c.name)!==null&&d!==void 0?d:"FetchError"}: ${c==null?void 0:c.message}`,details:`${(h=c==null?void 0:c.stack)!==null&&h!==void 0?h:""}`,hint:"",code:`${(f=c==null?void 0:c.code)!==null&&f!==void 0?f:""}`},data:null,count:null,status:0,statusText:""}})),l.then(a,i)}returns(){return this}overrideTypes(){return this}}return pr.default=s,pr}var Sa;function Yi(){if(Sa)return vr;Sa=1;var r=vr&&vr.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(vr,"__esModule",{value:!0});const e=r(Gi());class t extends e.default{select(n){let a=!1;const i=(n??"*").split("").map(o=>/\s/.test(o)&&!a?"":(o==='"'&&(a=!a),o)).join("");return this.url.searchParams.set("select",i),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(n,{ascending:a=!0,nullsFirst:i,foreignTable:o,referencedTable:l=o}={}){const c=l?`${l}.order`:"order",d=this.url.searchParams.get(c);return this.url.searchParams.set(c,`${d?`${d},`:""}${n}.${a?"asc":"desc"}${i===void 0?"":i?".nullsfirst":".nullslast"}`),this}limit(n,{foreignTable:a,referencedTable:i=a}={}){const o=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(o,`${n}`),this}range(n,a,{foreignTable:i,referencedTable:o=i}={}){const l=typeof o>"u"?"offset":`${o}.offset`,c=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(l,`${n}`),this.url.searchParams.set(c,`${a-n+1}`),this}abortSignal(n){return this.signal=n,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:n=!1,verbose:a=!1,settings:i=!1,buffers:o=!1,wal:l=!1,format:c="text"}={}){var d;const h=[n?"analyze":null,a?"verbose":null,i?"settings":null,o?"buffers":null,l?"wal":null].filter(Boolean).join("|"),f=(d=this.headers.Accept)!==null&&d!==void 0?d:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${c}; for="${f}"; options=${h};`,c==="json"?this:this}rollback(){var n;return((n=this.headers.Prefer)!==null&&n!==void 0?n:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return vr.default=t,vr}var Ea;function Jn(){if(Ea)return fr;Ea=1;var r=fr&&fr.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(fr,"__esModule",{value:!0});const e=r(Yi());class t extends e.default{eq(n,a){return this.url.searchParams.append(n,`eq.${a}`),this}neq(n,a){return this.url.searchParams.append(n,`neq.${a}`),this}gt(n,a){return this.url.searchParams.append(n,`gt.${a}`),this}gte(n,a){return this.url.searchParams.append(n,`gte.${a}`),this}lt(n,a){return this.url.searchParams.append(n,`lt.${a}`),this}lte(n,a){return this.url.searchParams.append(n,`lte.${a}`),this}like(n,a){return this.url.searchParams.append(n,`like.${a}`),this}likeAllOf(n,a){return this.url.searchParams.append(n,`like(all).{${a.join(",")}}`),this}likeAnyOf(n,a){return this.url.searchParams.append(n,`like(any).{${a.join(",")}}`),this}ilike(n,a){return this.url.searchParams.append(n,`ilike.${a}`),this}ilikeAllOf(n,a){return this.url.searchParams.append(n,`ilike(all).{${a.join(",")}}`),this}ilikeAnyOf(n,a){return this.url.searchParams.append(n,`ilike(any).{${a.join(",")}}`),this}is(n,a){return this.url.searchParams.append(n,`is.${a}`),this}in(n,a){const i=Array.from(new Set(a)).map(o=>typeof o=="string"&&new RegExp("[,()]").test(o)?`"${o}"`:`${o}`).join(",");return this.url.searchParams.append(n,`in.(${i})`),this}contains(n,a){return typeof a=="string"?this.url.searchParams.append(n,`cs.${a}`):Array.isArray(a)?this.url.searchParams.append(n,`cs.{${a.join(",")}}`):this.url.searchParams.append(n,`cs.${JSON.stringify(a)}`),this}containedBy(n,a){return typeof a=="string"?this.url.searchParams.append(n,`cd.${a}`):Array.isArray(a)?this.url.searchParams.append(n,`cd.{${a.join(",")}}`):this.url.searchParams.append(n,`cd.${JSON.stringify(a)}`),this}rangeGt(n,a){return this.url.searchParams.append(n,`sr.${a}`),this}rangeGte(n,a){return this.url.searchParams.append(n,`nxl.${a}`),this}rangeLt(n,a){return this.url.searchParams.append(n,`sl.${a}`),this}rangeLte(n,a){return this.url.searchParams.append(n,`nxr.${a}`),this}rangeAdjacent(n,a){return this.url.searchParams.append(n,`adj.${a}`),this}overlaps(n,a){return typeof a=="string"?this.url.searchParams.append(n,`ov.${a}`):this.url.searchParams.append(n,`ov.{${a.join(",")}}`),this}textSearch(n,a,{config:i,type:o}={}){let l="";o==="plain"?l="pl":o==="phrase"?l="ph":o==="websearch"&&(l="w");const c=i===void 0?"":`(${i})`;return this.url.searchParams.append(n,`${l}fts${c}.${a}`),this}match(n){return Object.entries(n).forEach(([a,i])=>{this.url.searchParams.append(a,`eq.${i}`)}),this}not(n,a,i){return this.url.searchParams.append(n,`not.${a}.${i}`),this}or(n,{foreignTable:a,referencedTable:i=a}={}){const o=i?`${i}.or`:"or";return this.url.searchParams.append(o,`(${n})`),this}filter(n,a,i){return this.url.searchParams.append(n,`${a}.${i}`),this}}return fr.default=t,fr}var xa;function Qi(){if(xa)return hr;xa=1;var r=hr&&hr.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(hr,"__esModule",{value:!0});const e=r(Jn());class t{constructor(n,{headers:a={},schema:i,fetch:o}){this.url=n,this.headers=a,this.schema=i,this.fetch=o}select(n,{head:a=!1,count:i}={}){const o=a?"HEAD":"GET";let l=!1;const c=(n??"*").split("").map(d=>/\s/.test(d)&&!l?"":(d==='"'&&(l=!l),d)).join("");return this.url.searchParams.set("select",c),i&&(this.headers.Prefer=`count=${i}`),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(n,{count:a,defaultToNull:i=!0}={}){const o="POST",l=[];if(this.headers.Prefer&&l.push(this.headers.Prefer),a&&l.push(`count=${a}`),i||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(n)){const c=n.reduce((d,h)=>d.concat(Object.keys(h)),[]);if(c.length>0){const d=[...new Set(c)].map(h=>`"${h}"`);this.url.searchParams.set("columns",d.join(","))}}return new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}upsert(n,{onConflict:a,ignoreDuplicates:i=!1,count:o,defaultToNull:l=!0}={}){const c="POST",d=[`resolution=${i?"ignore":"merge"}-duplicates`];if(a!==void 0&&this.url.searchParams.set("on_conflict",a),this.headers.Prefer&&d.push(this.headers.Prefer),o&&d.push(`count=${o}`),l||d.push("missing=default"),this.headers.Prefer=d.join(","),Array.isArray(n)){const h=n.reduce((f,p)=>f.concat(Object.keys(p)),[]);if(h.length>0){const f=[...new Set(h)].map(p=>`"${p}"`);this.url.searchParams.set("columns",f.join(","))}}return new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}update(n,{count:a}={}){const i="PATCH",o=[];return this.headers.Prefer&&o.push(this.headers.Prefer),a&&o.push(`count=${a}`),this.headers.Prefer=o.join(","),new e.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}delete({count:n}={}){const a="DELETE",i=[];return n&&i.push(`count=${n}`),this.headers.Prefer&&i.unshift(this.headers.Prefer),this.headers.Prefer=i.join(","),new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return hr.default=t,hr}var Fr={},Br={},Ta;function Sc(){return Ta||(Ta=1,Object.defineProperty(Br,"__esModule",{value:!0}),Br.version=void 0,Br.version="0.0.0-automated"),Br}var Oa;function Ec(){if(Oa)return Fr;Oa=1,Object.defineProperty(Fr,"__esModule",{value:!0}),Fr.DEFAULT_HEADERS=void 0;const r=Sc();return Fr.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${r.version}`},Fr}var ja;function xc(){if(ja)return dr;ja=1;var r=dr&&dr.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(dr,"__esModule",{value:!0});const e=r(Qi()),t=r(Jn()),s=Ec();class n{constructor(i,{headers:o={},schema:l,fetch:c}={}){this.url=i,this.headers=Object.assign(Object.assign({},s.DEFAULT_HEADERS),o),this.schemaName=l,this.fetch=c}from(i){const o=new URL(`${this.url}/${i}`);return new e.default(o,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(i){return new n(this.url,{headers:this.headers,schema:i,fetch:this.fetch})}rpc(i,o={},{head:l=!1,get:c=!1,count:d}={}){let h;const f=new URL(`${this.url}/rpc/${i}`);let p;l||c?(h=l?"HEAD":"GET",Object.entries(o).filter(([k,m])=>m!==void 0).map(([k,m])=>[k,Array.isArray(m)?`{${m.join(",")}}`:`${m}`]).forEach(([k,m])=>{f.searchParams.append(k,m)})):(h="POST",p=o);const v=Object.assign({},this.headers);return d&&(v.Prefer=`count=${d}`),new t.default({method:h,url:f,headers:v,schema:this.schemaName,body:p,fetch:this.fetch,allowEmpty:!1})}}return dr.default=n,dr}var Aa;function Tc(){if(Aa)return Ne;Aa=1;var r=Ne&&Ne.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(Ne,"__esModule",{value:!0}),Ne.PostgrestError=Ne.PostgrestBuilder=Ne.PostgrestTransformBuilder=Ne.PostgrestFilterBuilder=Ne.PostgrestQueryBuilder=Ne.PostgrestClient=void 0;const e=r(xc());Ne.PostgrestClient=e.default;const t=r(Qi());Ne.PostgrestQueryBuilder=t.default;const s=r(Jn());Ne.PostgrestFilterBuilder=s.default;const n=r(Yi());Ne.PostgrestTransformBuilder=n.default;const a=r(Gi());Ne.PostgrestBuilder=a.default;const i=r(Ki());return Ne.PostgrestError=i.default,Ne.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:s.default,PostgrestTransformBuilder:n.default,PostgrestBuilder:a.default,PostgrestError:i.default},Ne}var Oc=Tc();const jc=gc(Oc),{PostgrestClient:Ac,PostgrestQueryBuilder:Cf,PostgrestFilterBuilder:Mf,PostgrestTransformBuilder:If,PostgrestBuilder:Rf,PostgrestError:Df}=jc;let bn;typeof window>"u"?bn=require("ws"):bn=window.WebSocket;const Pc="2.11.10",Cc={"X-Client-Info":`realtime-js/${Pc}`},Mc="1.0.0",Zi=1e4,Ic=1e3;var Er;(function(r){r[r.connecting=0]="connecting",r[r.open=1]="open",r[r.closing=2]="closing",r[r.closed=3]="closed"})(Er||(Er={}));var Ke;(function(r){r.closed="closed",r.errored="errored",r.joined="joined",r.joining="joining",r.leaving="leaving"})(Ke||(Ke={}));var ht;(function(r){r.close="phx_close",r.error="phx_error",r.join="phx_join",r.reply="phx_reply",r.leave="phx_leave",r.access_token="access_token"})(ht||(ht={}));var kn;(function(r){r.websocket="websocket"})(kn||(kn={}));var Gt;(function(r){r.Connecting="connecting",r.Open="open",r.Closing="closing",r.Closed="closed"})(Gt||(Gt={}));class Rc{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,t,s)}_decodeBroadcast(e,t,s){const n=t.getUint8(1),a=t.getUint8(2);let i=this.HEADER_LENGTH+2;const o=s.decode(e.slice(i,i+n));i=i+n;const l=s.decode(e.slice(i,i+a));i=i+a;const c=JSON.parse(s.decode(e.slice(i,e.byteLength)));return{ref:null,topic:o,event:l,payload:c}}}class Xi{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Te;(function(r){r.abstime="abstime",r.bool="bool",r.date="date",r.daterange="daterange",r.float4="float4",r.float8="float8",r.int2="int2",r.int4="int4",r.int4range="int4range",r.int8="int8",r.int8range="int8range",r.json="json",r.jsonb="jsonb",r.money="money",r.numeric="numeric",r.oid="oid",r.reltime="reltime",r.text="text",r.time="time",r.timestamp="timestamp",r.timestamptz="timestamptz",r.timetz="timetz",r.tsrange="tsrange",r.tstzrange="tstzrange"})(Te||(Te={}));const Pa=(r,e,t={})=>{var s;const n=(s=t.skipTypes)!==null&&s!==void 0?s:[];return Object.keys(e).reduce((a,i)=>(a[i]=Dc(i,r,e,n),a),{})},Dc=(r,e,t,s)=>{const n=e.find(o=>o.name===r),a=n==null?void 0:n.type,i=t[r];return a&&!s.includes(a)?eo(a,i):Sn(i)},eo=(r,e)=>{if(r.charAt(0)==="_"){const t=r.slice(1,r.length);return zc(e,t)}switch(r){case Te.bool:return $c(e);case Te.float4:case Te.float8:case Te.int2:case Te.int4:case Te.int8:case Te.numeric:case Te.oid:return Lc(e);case Te.json:case Te.jsonb:return Uc(e);case Te.timestamp:return qc(e);case Te.abstime:case Te.date:case Te.daterange:case Te.int4range:case Te.int8range:case Te.money:case Te.reltime:case Te.text:case Te.time:case Te.timestamptz:case Te.timetz:case Te.tsrange:case Te.tstzrange:return Sn(e);default:return Sn(e)}},Sn=r=>r,$c=r=>{switch(r){case"t":return!0;case"f":return!1;default:return r}},Lc=r=>{if(typeof r=="string"){const e=parseFloat(r);if(!Number.isNaN(e))return e}return r},Uc=r=>{if(typeof r=="string")try{return JSON.parse(r)}catch(e){return console.log(`JSON parse error: ${e}`),r}return r},zc=(r,e)=>{if(typeof r!="string")return r;const t=r.length-1,s=r[t];if(r[0]==="{"&&s==="}"){let a;const i=r.slice(1,t);try{a=JSON.parse("["+i+"]")}catch{a=i?i.split(","):[]}return a.map(o=>eo(e,o))}return r},qc=r=>typeof r=="string"?r.replace(" ","T"):r,to=r=>{let e=r;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class rn{constructor(e,t,s={},n=Zi){this.channel=e,this.event=t,this.payload=s,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var s;return this._hasReceived(e)&&t((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Ca;(function(r){r.SYNC="sync",r.JOIN="join",r.LEAVE="leave"})(Ca||(Ca={}));class Kr{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},n=>{const{onJoin:a,onLeave:i,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Kr.syncState(this.state,n,a,i),this.pendingDiffs.forEach(l=>{this.state=Kr.syncDiff(this.state,l,a,i)}),this.pendingDiffs=[],o()}),this.channel._on(s.diff,{},n=>{const{onJoin:a,onLeave:i,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=Kr.syncDiff(this.state,n,a,i),o())}),this.onJoin((n,a,i)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:a,newPresences:i})}),this.onLeave((n,a,i)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:a,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,s,n){const a=this.cloneDeep(e),i=this.transformState(t),o={},l={};return this.map(a,(c,d)=>{i[c]||(l[c]=d)}),this.map(i,(c,d)=>{const h=a[c];if(h){const f=d.map(m=>m.presence_ref),p=h.map(m=>m.presence_ref),v=d.filter(m=>p.indexOf(m.presence_ref)<0),k=h.filter(m=>f.indexOf(m.presence_ref)<0);v.length>0&&(o[c]=v),k.length>0&&(l[c]=k)}else o[c]=d}),this.syncDiff(a,{joins:o,leaves:l},s,n)}static syncDiff(e,t,s,n){const{joins:a,leaves:i}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return s||(s=()=>{}),n||(n=()=>{}),this.map(a,(o,l)=>{var c;const d=(c=e[o])!==null&&c!==void 0?c:[];if(e[o]=this.cloneDeep(l),d.length>0){const h=e[o].map(p=>p.presence_ref),f=d.filter(p=>h.indexOf(p.presence_ref)<0);e[o].unshift(...f)}s(o,d,l)}),this.map(i,(o,l)=>{let c=e[o];if(!c)return;const d=l.map(h=>h.presence_ref);c=c.filter(h=>d.indexOf(h.presence_ref)<0),e[o]=c,n(o,c,l),c.length===0&&delete e[o]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(s=>t(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,s)=>{const n=e[s];return"metas"in n?t[s]=n.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):t[s]=n,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Ma;(function(r){r.ALL="*",r.INSERT="INSERT",r.UPDATE="UPDATE",r.DELETE="DELETE"})(Ma||(Ma={}));var Ia;(function(r){r.BROADCAST="broadcast",r.PRESENCE="presence",r.POSTGRES_CHANGES="postgres_changes",r.SYSTEM="system"})(Ia||(Ia={}));var Tt;(function(r){r.SUBSCRIBED="SUBSCRIBED",r.TIMED_OUT="TIMED_OUT",r.CLOSED="CLOSED",r.CHANNEL_ERROR="CHANNEL_ERROR"})(Tt||(Tt={}));class Kn{constructor(e,t={config:{}},s){this.topic=e,this.params=t,this.socket=s,this.bindings={},this.state=Ke.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new rn(this,ht.join,this.params,this.timeout),this.rejoinTimer=new Xi(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ke.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(n=>n.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ke.closed,this.socket._remove(this)}),this._onError(n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=Ke.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ke.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ht.reply,{},(n,a)=>{this._trigger(this._replyEventName(a),n)}),this.presence=new Kr(this),this.broadcastEndpointURL=to(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var s,n;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:a,presence:i,private:o}}=this.params;this._onError(d=>e==null?void 0:e(Tt.CHANNEL_ERROR,d)),this._onClose(()=>e==null?void 0:e(Tt.CLOSED));const l={},c={broadcast:a,presence:i,postgres_changes:(n=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(d=>d.filter))!==null&&n!==void 0?n:[],private:o};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:d})=>{var h;if(this.socket.setAuth(),d===void 0){e==null||e(Tt.SUBSCRIBED);return}else{const f=this.bindings.postgres_changes,p=(h=f==null?void 0:f.length)!==null&&h!==void 0?h:0,v=[];for(let k=0;k<p;k++){const m=f[k],{filter:{event:T,schema:I,table:O,filter:E}}=m,x=d&&d[k];if(x&&x.event===T&&x.schema===I&&x.table===O&&x.filter===E)v.push(Object.assign(Object.assign({},m),{id:x.id}));else{this.unsubscribe(),this.state=Ke.errored,e==null||e(Tt.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=v,e&&e(Tt.SUBSCRIBED);return}}).receive("error",d=>{this.state=Ke.errored,e==null||e(Tt.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(d).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Tt.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,s){return this._on(e,t,s)}async send(e,t={}){var s,n;if(!this._canPush()&&e.type==="broadcast"){const{event:a,payload:i}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:i,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(s=t.timeout)!==null&&s!==void 0?s:this.timeout);return await((n=c.body)===null||n===void 0?void 0:n.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var i,o,l;const c=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(o=(i=this.params)===null||i===void 0?void 0:i.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&a("ok"),c.receive("ok",()=>a("ok")),c.receive("error",()=>a("error")),c.receive("timeout",()=>a("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Ke.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ht.close,"leave",this._joinRef())};return this.joinPush.destroy(),new Promise(s=>{const n=new rn(this,ht.leave,{},e);n.receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,t,s){const n=new AbortController,a=setTimeout(()=>n.abort(),s),i=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:n.signal}));return clearTimeout(a),i}_push(e,t,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new rn(this,e,t,s);return this._canPush()?n.send():(n.startTimeout(),this.pushBuffer.push(n)),n}_onMessage(e,t,s){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,s){var n,a;const i=e.toLocaleLowerCase(),{close:o,error:l,leave:c,join:d}=ht;if(s&&[o,l,c,d].indexOf(i)>=0&&s!==this._joinRef())return;let f=this._onMessage(i,t,s);if(t&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(p=>{var v,k,m;return((v=p.filter)===null||v===void 0?void 0:v.event)==="*"||((m=(k=p.filter)===null||k===void 0?void 0:k.event)===null||m===void 0?void 0:m.toLocaleLowerCase())===i}).map(p=>p.callback(f,s)):(a=this.bindings[i])===null||a===void 0||a.filter(p=>{var v,k,m,T,I,O;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in p){const E=p.id,x=(v=p.filter)===null||v===void 0?void 0:v.event;return E&&((k=t.ids)===null||k===void 0?void 0:k.includes(E))&&(x==="*"||(x==null?void 0:x.toLocaleLowerCase())===((m=t.data)===null||m===void 0?void 0:m.type.toLocaleLowerCase()))}else{const E=(I=(T=p==null?void 0:p.filter)===null||T===void 0?void 0:T.event)===null||I===void 0?void 0:I.toLocaleLowerCase();return E==="*"||E===((O=t==null?void 0:t.event)===null||O===void 0?void 0:O.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===i}).map(p=>{if(typeof f=="object"&&"ids"in f){const v=f.data,{schema:k,table:m,commit_timestamp:T,type:I,errors:O}=v;f=Object.assign(Object.assign({},{schema:k,table:m,commit_timestamp:T,eventType:I,new:{},old:{},errors:O}),this._getPayloadRecords(v))}p.callback(f,s)})}_isClosed(){return this.state===Ke.closed}_isJoined(){return this.state===Ke.joined}_isJoining(){return this.state===Ke.joining}_isLeaving(){return this.state===Ke.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,s){const n=e.toLocaleLowerCase(),a={type:n,filter:t,callback:s};return this.bindings[n]?this.bindings[n].push(a):this.bindings[n]=[a],this}_off(e,t){const s=e.toLocaleLowerCase();return this.bindings[s]=this.bindings[s].filter(n=>{var a;return!(((a=n.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===s&&Kn.isEqual(n.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(ht.close,{},e)}_onError(e){this._on(ht.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ke.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=Pa(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=Pa(e.columns,e.old_record)),t}}const Ra=()=>{},Nc=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Fc{constructor(e,t){var s;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers=Cc,this.params={},this.timeout=Zi,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Ra,this.ref=0,this.logger=Ra,this.conn=null,this.sendBuffer=[],this.serializer=new Rc,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=a=>{let i;return a?i=a:typeof fetch>"u"?i=(...o)=>vs(async()=>{const{default:l}=await Promise.resolve().then(()=>Lr);return{default:l}},void 0).then(({default:l})=>l(...o)):i=fetch,(...o)=>i(...o)},this.endPoint=`${e}/${kn.websocket}`,this.httpEndpoint=to(e),t!=null&&t.transport?this.transport=t.transport:this.transport=null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.headers&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const n=(s=t==null?void 0:t.params)===null||s===void 0?void 0:s.apikey;if(n&&(this.accessTokenValue=n,this.apiKey=n),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:a=>[1e3,2e3,5e3,1e4][a-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(a,i)=>i(JSON.stringify(a)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Xi(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t==null?void 0:t.fetch),t!=null&&t.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(t==null?void 0:t.worker)||!1,this.workerUrl=t==null?void 0:t.workerUrl}this.accessToken=(t==null?void 0:t.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=bn),this.transport){typeof window<"u"&&this.transport===window.WebSocket?this.conn=new this.transport(this.endpointURL()):this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection();return}this.conn=new Bc(this.endpointURL(),void 0,{close:()=>{this.conn=null}})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Mc}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(s=>s.teardown()))}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels=this.channels.filter(s=>s._joinRef!==e._joinRef),this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,s){this.logger(e,t,s)}connectionState(){switch(this.conn&&this.conn.readyState){case Er.connecting:return Gt.Connecting;case Er.open:return Gt.Open;case Er.closing:return Gt.Closing;default:return Gt.Closed}}isConnected(){return this.connectionState()===Gt.Open}channel(e,t={config:{}}){const s=`realtime:${e}`,n=this.getChannels().find(a=>a.topic===s);if(n)return n;{const a=new Kn(`realtime:${e}`,t,this);return this.channels.push(a),a}}push(e){const{topic:t,event:s,payload:n,ref:a}=e,i=()=>{this.encode(e,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${t} ${s} (${a})`,n),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(s=>{t&&s.updateJoinPayload({access_token:t,version:this.headers&&this.headers["X-Client-Info"]}),s.joinedOnce&&s._isJoined()&&s._push(ht.access_token,{access_token:t})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close(Ic,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:s,event:n,payload:a,ref:i}=t;s==="phoenix"&&n==="phx_reply"&&this.heartbeatCallback(t.payload.status=="ok"?"ok":"error"),i&&i===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${a.status||""} ${s} ${n} ${i&&"("+i+")"||""}`,a),Array.from(this.channels).filter(o=>o._isMember(s)).forEach(o=>o._trigger(n,a,i)),this.stateChangeCallbacks.message.forEach(o=>o(t))})}_onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(ht.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const s=e.match(/\?/)?"&":"?",n=new URLSearchParams(t);return`${e}${s}${n}`}_workerObjectUrl(e){let t;if(e)t=e;else{const s=new Blob([Nc],{type:"application/javascript"});t=URL.createObjectURL(s)}return t}}class Bc{constructor(e,t,s){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=Er.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=s.close}}class Gn extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Fe(r){return typeof r=="object"&&r!==null&&"__isStorageError"in r}class Wc extends Gn{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class En extends Gn{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var Vc=function(r,e,t,s){function n(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(d){try{c(s.next(d))}catch(h){i(h)}}function l(d){try{c(s.throw(d))}catch(h){i(h)}}function c(d){d.done?a(d.value):n(d.value).then(o,l)}c((s=s.apply(r,e||[])).next())})};const ro=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>vs(async()=>{const{default:s}=await Promise.resolve().then(()=>Lr);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)},Hc=()=>Vc(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield vs(()=>Promise.resolve().then(()=>Lr),void 0)).Response:Response}),xn=r=>{if(Array.isArray(r))return r.map(t=>xn(t));if(typeof r=="function"||r!==Object(r))return r;const e={};return Object.entries(r).forEach(([t,s])=>{const n=t.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));e[n]=xn(s)}),e};var lr=function(r,e,t,s){function n(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(d){try{c(s.next(d))}catch(h){i(h)}}function l(d){try{c(s.throw(d))}catch(h){i(h)}}function c(d){d.done?a(d.value):n(d.value).then(o,l)}c((s=s.apply(r,e||[])).next())})};const sn=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),Jc=(r,e,t)=>lr(void 0,void 0,void 0,function*(){const s=yield Hc();r instanceof s&&!(t!=null&&t.noResolveJson)?r.json().then(n=>{e(new Wc(sn(n),r.status||500))}).catch(n=>{e(new En(sn(n),n))}):e(new En(sn(r),r))}),Kc=(r,e,t,s)=>{const n={method:r,headers:(e==null?void 0:e.headers)||{}};return r==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),s&&(n.body=JSON.stringify(s)),Object.assign(Object.assign({},n),t))};function ps(r,e,t,s,n,a){return lr(this,void 0,void 0,function*(){return new Promise((i,o)=>{r(t,Kc(e,s,n,a)).then(l=>{if(!l.ok)throw l;return s!=null&&s.noResolveJson?l:l.json()}).then(l=>i(l)).catch(l=>Jc(l,o,s))})})}function Rs(r,e,t,s){return lr(this,void 0,void 0,function*(){return ps(r,"GET",e,t,s)})}function Rt(r,e,t,s,n){return lr(this,void 0,void 0,function*(){return ps(r,"POST",e,s,n,t)})}function Gc(r,e,t,s,n){return lr(this,void 0,void 0,function*(){return ps(r,"PUT",e,s,n,t)})}function Yc(r,e,t,s){return lr(this,void 0,void 0,function*(){return ps(r,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),s)})}function so(r,e,t,s,n){return lr(this,void 0,void 0,function*(){return ps(r,"DELETE",e,s,n,t)})}var Xe=function(r,e,t,s){function n(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(d){try{c(s.next(d))}catch(h){i(h)}}function l(d){try{c(s.throw(d))}catch(h){i(h)}}function c(d){d.done?a(d.value):n(d.value).then(o,l)}c((s=s.apply(r,e||[])).next())})};const Qc={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Da={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Zc{constructor(e,t={},s,n){this.url=e,this.headers=t,this.bucketId=s,this.fetch=ro(n)}uploadOrUpdate(e,t,s,n){return Xe(this,void 0,void 0,function*(){try{let a;const i=Object.assign(Object.assign({},Da),n);let o=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(i.upsert)});const l=i.metadata;typeof Blob<"u"&&s instanceof Blob?(a=new FormData,a.append("cacheControl",i.cacheControl),l&&a.append("metadata",this.encodeMetadata(l)),a.append("",s)):typeof FormData<"u"&&s instanceof FormData?(a=s,a.append("cacheControl",i.cacheControl),l&&a.append("metadata",this.encodeMetadata(l))):(a=s,o["cache-control"]=`max-age=${i.cacheControl}`,o["content-type"]=i.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),n!=null&&n.headers&&(o=Object.assign(Object.assign({},o),n.headers));const c=this._removeEmptyFolders(t),d=this._getFinalPath(c),h=yield this.fetch(`${this.url}/object/${d}`,Object.assign({method:e,body:a,headers:o},i!=null&&i.duplex?{duplex:i.duplex}:{})),f=yield h.json();return h.ok?{data:{path:c,id:f.Id,fullPath:f.Key},error:null}:{data:null,error:f}}catch(a){if(Fe(a))return{data:null,error:a};throw a}})}upload(e,t,s){return Xe(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,s)})}uploadToSignedUrl(e,t,s,n){return Xe(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(e),i=this._getFinalPath(a),o=new URL(this.url+`/object/upload/sign/${i}`);o.searchParams.set("token",t);try{let l;const c=Object.assign({upsert:Da.upsert},n),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&s instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",s)):typeof FormData<"u"&&s instanceof FormData?(l=s,l.append("cacheControl",c.cacheControl)):(l=s,d["cache-control"]=`max-age=${c.cacheControl}`,d["content-type"]=c.contentType);const h=yield this.fetch(o.toString(),{method:"PUT",body:l,headers:d}),f=yield h.json();return h.ok?{data:{path:a,fullPath:f.Key},error:null}:{data:null,error:f}}catch(l){if(Fe(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,t){return Xe(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const n=Object.assign({},this.headers);t!=null&&t.upsert&&(n["x-upsert"]="true");const a=yield Rt(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:n}),i=new URL(this.url+a.url),o=i.searchParams.get("token");if(!o)throw new Gn("No token returned by API");return{data:{signedUrl:i.toString(),path:e,token:o},error:null}}catch(s){if(Fe(s))return{data:null,error:s};throw s}})}update(e,t,s){return Xe(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,s)})}move(e,t,s){return Xe(this,void 0,void 0,function*(){try{return{data:yield Rt(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(Fe(n))return{data:null,error:n};throw n}})}copy(e,t,s){return Xe(this,void 0,void 0,function*(){try{return{data:{path:(yield Rt(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(Fe(n))return{data:null,error:n};throw n}})}createSignedUrl(e,t,s){return Xe(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e),a=yield Rt(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:t},s!=null&&s.transform?{transform:s.transform}:{}),{headers:this.headers});const i=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${i}`)},{data:a,error:null}}catch(n){if(Fe(n))return{data:null,error:n};throw n}})}createSignedUrls(e,t,s){return Xe(this,void 0,void 0,function*(){try{const n=yield Rt(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),a=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return{data:n.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${a}`):null})),error:null}}catch(n){if(Fe(n))return{data:null,error:n};throw n}})}download(e,t){return Xe(this,void 0,void 0,function*(){const n=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),i=a?`?${a}`:"";try{const o=this._getFinalPath(e);return{data:yield(yield Rs(this.fetch,`${this.url}/${n}/${o}${i}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(Fe(o))return{data:null,error:o};throw o}})}info(e){return Xe(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const s=yield Rs(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:xn(s),error:null}}catch(s){if(Fe(s))return{data:null,error:s};throw s}})}exists(e){return Xe(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield Yc(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(Fe(s)&&s instanceof En){const n=s.originalError;if([400,404].includes(n==null?void 0:n.status))return{data:!1,error:s}}throw s}})}getPublicUrl(e,t){const s=this._getFinalPath(e),n=[],a=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";a!==""&&n.push(a);const o=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});l!==""&&n.push(l);let c=n.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${s}${c}`)}}}remove(e){return Xe(this,void 0,void 0,function*(){try{return{data:yield so(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(Fe(t))return{data:null,error:t};throw t}})}list(e,t,s){return Xe(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},Qc),t),{prefix:e||""});return{data:yield Rt(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},s),error:null}}catch(n){if(Fe(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const Xc="2.7.1",eu={"X-Client-Info":`storage-js/${Xc}`};var gr=function(r,e,t,s){function n(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(d){try{c(s.next(d))}catch(h){i(h)}}function l(d){try{c(s.throw(d))}catch(h){i(h)}}function c(d){d.done?a(d.value):n(d.value).then(o,l)}c((s=s.apply(r,e||[])).next())})};class tu{constructor(e,t={},s){this.url=e,this.headers=Object.assign(Object.assign({},eu),t),this.fetch=ro(s)}listBuckets(){return gr(this,void 0,void 0,function*(){try{return{data:yield Rs(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Fe(e))return{data:null,error:e};throw e}})}getBucket(e){return gr(this,void 0,void 0,function*(){try{return{data:yield Rs(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(Fe(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return gr(this,void 0,void 0,function*(){try{return{data:yield Rt(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(Fe(s))return{data:null,error:s};throw s}})}updateBucket(e,t){return gr(this,void 0,void 0,function*(){try{return{data:yield Gc(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(Fe(s))return{data:null,error:s};throw s}})}emptyBucket(e){return gr(this,void 0,void 0,function*(){try{return{data:yield Rt(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(Fe(t))return{data:null,error:t};throw t}})}deleteBucket(e){return gr(this,void 0,void 0,function*(){try{return{data:yield so(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(Fe(t))return{data:null,error:t};throw t}})}}class ru extends tu{constructor(e,t={},s){super(e,t,s)}from(e){return new Zc(this.url,this.headers,e,this.fetch)}}const su="2.50.0";let Vr="";typeof Deno<"u"?Vr="deno":typeof document<"u"?Vr="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Vr="react-native":Vr="node";const nu={"X-Client-Info":`supabase-js-${Vr}/${su}`},au={headers:nu},iu={schema:"public"},ou={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},lu={};var cu=function(r,e,t,s){function n(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(d){try{c(s.next(d))}catch(h){i(h)}}function l(d){try{c(s.throw(d))}catch(h){i(h)}}function c(d){d.done?a(d.value):n(d.value).then(o,l)}c((s=s.apply(r,e||[])).next())})};const uu=r=>{let e;return r?e=r:typeof fetch>"u"?e=Hi:e=fetch,(...t)=>e(...t)},du=()=>typeof Headers>"u"?Ji:Headers,hu=(r,e,t)=>{const s=uu(t),n=du();return(a,i)=>cu(void 0,void 0,void 0,function*(){var o;const l=(o=yield e())!==null&&o!==void 0?o:r;let c=new n(i==null?void 0:i.headers);return c.has("apikey")||c.set("apikey",r),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),s(a,Object.assign(Object.assign({},i),{headers:c}))})};var fu=function(r,e,t,s){function n(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(d){try{c(s.next(d))}catch(h){i(h)}}function l(d){try{c(s.throw(d))}catch(h){i(h)}}function c(d){d.done?a(d.value):n(d.value).then(o,l)}c((s=s.apply(r,e||[])).next())})};function vu(r){return r.endsWith("/")?r:r+"/"}function pu(r,e){var t,s;const{db:n,auth:a,realtime:i,global:o}=r,{db:l,auth:c,realtime:d,global:h}=e,f={db:Object.assign(Object.assign({},l),n),auth:Object.assign(Object.assign({},c),a),realtime:Object.assign(Object.assign({},d),i),global:Object.assign(Object.assign(Object.assign({},h),o),{headers:Object.assign(Object.assign({},(t=h==null?void 0:h.headers)!==null&&t!==void 0?t:{}),(s=o==null?void 0:o.headers)!==null&&s!==void 0?s:{})}),accessToken:()=>fu(this,void 0,void 0,function*(){return""})};return r.accessToken?f.accessToken=r.accessToken:delete f.accessToken,f}const no="2.70.0",br=30*1e3,Tn=3,nn=Tn*br,gu="http://localhost:9999",_u="supabase.auth.token",mu={"X-Client-Info":`gotrue-js/${no}`},On="X-Supabase-Api-Version",ao={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},yu=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,wu=6e5;class Yn extends Error{constructor(e,t,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=s}}function le(r){return typeof r=="object"&&r!==null&&"__isAuthError"in r}class bu extends Yn{constructor(e,t,s){super(e,t,s),this.name="AuthApiError",this.status=t,this.code=s}}function ku(r){return le(r)&&r.name==="AuthApiError"}class io extends Yn{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Wt extends Yn{constructor(e,t,s,n){super(e,s,n),this.name=t,this.status=s}}class It extends Wt{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Su(r){return le(r)&&r.name==="AuthSessionMissingError"}class ws extends Wt{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class bs extends Wt{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class ks extends Wt{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Eu(r){return le(r)&&r.name==="AuthImplicitGrantRedirectError"}class $a extends Wt{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class jn extends Wt{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function an(r){return le(r)&&r.name==="AuthRetryableFetchError"}class La extends Wt{constructor(e,t,s){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=s}}class Gr extends Wt{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ds="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Ua=` 	
\r=`.split(""),xu=(()=>{const r=new Array(128);for(let e=0;e<r.length;e+=1)r[e]=-1;for(let e=0;e<Ua.length;e+=1)r[Ua[e].charCodeAt(0)]=-2;for(let e=0;e<Ds.length;e+=1)r[Ds[e].charCodeAt(0)]=e;return r})();function za(r,e,t){if(r!==null)for(e.queue=e.queue<<8|r,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;t(Ds[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;t(Ds[s]),e.queuedBits-=6}}function oo(r,e,t){const s=xu[r];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(r)}"`)}}function qa(r){const e=[],t=i=>{e.push(String.fromCodePoint(i))},s={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},a=i=>{ju(i,s,t)};for(let i=0;i<r.length;i+=1)oo(r.charCodeAt(i),n,a);return e.join("")}function Tu(r,e){if(r<=127){e(r);return}else if(r<=2047){e(192|r>>6),e(128|r&63);return}else if(r<=65535){e(224|r>>12),e(128|r>>6&63),e(128|r&63);return}else if(r<=1114111){e(240|r>>18),e(128|r>>12&63),e(128|r>>6&63),e(128|r&63);return}throw new Error(`Unrecognized Unicode codepoint: ${r.toString(16)}`)}function Ou(r,e){for(let t=0;t<r.length;t+=1){let s=r.charCodeAt(t);if(s>55295&&s<=56319){const n=(s-55296)*1024&65535;s=(r.charCodeAt(t+1)-56320&65535|n)+65536,t+=1}Tu(s,e)}}function ju(r,e,t){if(e.utf8seq===0){if(r<=127){t(r);return}for(let s=1;s<6;s+=1)if((r>>7-s&1)===0){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=r&31;else if(e.utf8seq===3)e.codepoint=r&15;else if(e.utf8seq===4)e.codepoint=r&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(r<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|r&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function Au(r){const e=[],t={queue:0,queuedBits:0},s=n=>{e.push(n)};for(let n=0;n<r.length;n+=1)oo(r.charCodeAt(n),t,s);return new Uint8Array(e)}function Pu(r){const e=[];return Ou(r,t=>e.push(t)),new Uint8Array(e)}function Cu(r){const e=[],t={queue:0,queuedBits:0},s=n=>{e.push(n)};return r.forEach(n=>za(n,t,s)),za(null,t,s),e.join("")}function Mu(r){return Math.round(Date.now()/1e3)+r}function Iu(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){const e=Math.random()*16|0;return(r=="x"?e:e&3|8).toString(16)})}const dt=()=>typeof window<"u"&&typeof document<"u",Jt={tested:!1,writable:!1},Yr=()=>{if(!dt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Jt.tested)return Jt.writable;const r=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(r,r),globalThis.localStorage.removeItem(r),Jt.tested=!0,Jt.writable=!0}catch{Jt.tested=!0,Jt.writable=!1}return Jt.writable};function Ru(r){const e={},t=new URL(r);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((n,a)=>{e[a]=n})}catch{}return t.searchParams.forEach((s,n)=>{e[n]=s}),e}const lo=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>vs(async()=>{const{default:s}=await Promise.resolve().then(()=>Lr);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)},Du=r=>typeof r=="object"&&r!==null&&"status"in r&&"ok"in r&&"json"in r&&typeof r.json=="function",co=async(r,e,t)=>{await r.setItem(e,JSON.stringify(t))},Ss=async(r,e)=>{const t=await r.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Es=async(r,e)=>{await r.removeItem(e)};class Js{constructor(){this.promise=new Js.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Js.promiseConstructor=Promise;function on(r){const e=r.split(".");if(e.length!==3)throw new Gr("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!yu.test(e[s]))throw new Gr("JWT not in base64url format");return{header:JSON.parse(qa(e[0])),payload:JSON.parse(qa(e[1])),signature:Au(e[2]),raw:{header:e[0],payload:e[1]}}}async function $u(r){return await new Promise(e=>{setTimeout(()=>e(null),r)})}function Lu(r,e){return new Promise((s,n)=>{(async()=>{for(let a=0;a<1/0;a++)try{const i=await r(a);if(!e(a,null,i)){s(i);return}}catch(i){if(!e(a,i)){n(i);return}}})()})}function Uu(r){return("0"+r.toString(16)).substr(-2)}function zu(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=t.length;let n="";for(let a=0;a<56;a++)n+=t.charAt(Math.floor(Math.random()*s));return n}return crypto.getRandomValues(e),Array.from(e,Uu).join("")}async function qu(r){const t=new TextEncoder().encode(r),s=await crypto.subtle.digest("SHA-256",t),n=new Uint8Array(s);return Array.from(n).map(a=>String.fromCharCode(a)).join("")}async function Nu(r){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),r;const t=await qu(r);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function _r(r,e,t=!1){const s=zu();let n=s;t&&(n+="/PASSWORD_RECOVERY"),await co(r,`${e}-code-verifier`,n);const a=await Nu(s);return[a,s===a?"plain":"s256"]}const Fu=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Bu(r){const e=r.headers.get(On);if(!e||!e.match(Fu))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Wu(r){if(!r)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(r<=e)throw new Error("JWT has expired")}function Vu(r){switch(r){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Hu=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function mr(r){if(!Hu.test(r))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}var Ju=function(r,e){var t={};for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&e.indexOf(s)<0&&(t[s]=r[s]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(r);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(r,s[n])&&(t[s[n]]=r[s[n]]);return t};const Kt=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),Ku=[502,503,504];async function Na(r){var e;if(!Du(r))throw new jn(Kt(r),0);if(Ku.includes(r.status))throw new jn(Kt(r),r.status);let t;try{t=await r.json()}catch(a){throw new io(Kt(a),a)}let s;const n=Bu(r);if(n&&n.getTime()>=ao["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?s=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(s=t.error_code),s){if(s==="weak_password")throw new La(Kt(t),r.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new It}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((a,i)=>a&&typeof i=="string",!0))throw new La(Kt(t),r.status,t.weak_password.reasons);throw new bu(Kt(t),r.status||500,s)}const Gu=(r,e,t,s)=>{const n={method:r,headers:(e==null?void 0:e.headers)||{}};return r==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),n.body=JSON.stringify(s),Object.assign(Object.assign({},n),t))};async function fe(r,e,t,s){var n;const a=Object.assign({},s==null?void 0:s.headers);a[On]||(a[On]=ao["2024-01-01"].name),s!=null&&s.jwt&&(a.Authorization=`Bearer ${s.jwt}`);const i=(n=s==null?void 0:s.query)!==null&&n!==void 0?n:{};s!=null&&s.redirectTo&&(i.redirect_to=s.redirectTo);const o=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",l=await Yu(r,e,t+o,{headers:a,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(l):{data:Object.assign({},l),error:null}}async function Yu(r,e,t,s,n,a){const i=Gu(e,s,n,a);let o;try{o=await r(t,Object.assign({},i))}catch(l){throw console.error(l),new jn(Kt(l),0)}if(o.ok||await Na(o),s!=null&&s.noResolveJson)return o;try{return await o.json()}catch(l){await Na(l)}}function Et(r){var e;let t=null;ed(r)&&(t=Object.assign({},r),r.expires_at||(t.expires_at=Mu(r.expires_in)));const s=(e=r.user)!==null&&e!==void 0?e:r;return{data:{session:t,user:s},error:null}}function Fa(r){const e=Et(r);return!e.error&&r.weak_password&&typeof r.weak_password=="object"&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.message&&typeof r.weak_password.message=="string"&&r.weak_password.reasons.reduce((t,s)=>t&&typeof s=="string",!0)&&(e.data.weak_password=r.weak_password),e}function Dt(r){var e;return{data:{user:(e=r.user)!==null&&e!==void 0?e:r},error:null}}function Qu(r){return{data:r,error:null}}function Zu(r){const{action_link:e,email_otp:t,hashed_token:s,redirect_to:n,verification_type:a}=r,i=Ju(r,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:e,email_otp:t,hashed_token:s,redirect_to:n,verification_type:a},l=Object.assign({},i);return{data:{properties:o,user:l},error:null}}function Xu(r){return r}function ed(r){return r.access_token&&r.refresh_token&&r.expires_in}const ln=["global","local","others"];var td=function(r,e){var t={};for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&e.indexOf(s)<0&&(t[s]=r[s]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(r);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(r,s[n])&&(t[s[n]]=r[s[n]]);return t};class rd{constructor({url:e="",headers:t={},fetch:s}){this.url=e,this.headers=t,this.fetch=lo(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=ln[0]){if(ln.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${ln.join(", ")}`);try{return await fe(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(le(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,t={}){try{return await fe(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Dt})}catch(s){if(le(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:t}=e,s=td(e,["options"]),n=Object.assign(Object.assign({},s),t);return"newEmail"in s&&(n.new_email=s==null?void 0:s.newEmail,delete n.newEmail),await fe(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:Zu,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(le(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await fe(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Dt})}catch(t){if(le(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,s,n,a,i,o,l;try{const c={nextPage:null,lastPage:0,total:0},d=await fe(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&s!==void 0?s:"",per_page:(a=(n=e==null?void 0:e.perPage)===null||n===void 0?void 0:n.toString())!==null&&a!==void 0?a:""},xform:Xu});if(d.error)throw d.error;const h=await d.json(),f=(i=d.headers.get("x-total-count"))!==null&&i!==void 0?i:0,p=(l=(o=d.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(v=>{const k=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),m=JSON.parse(v.split(";")[1].split("=")[1]);c[`${m}Page`]=k}),c.total=parseInt(f)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(le(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){mr(e);try{return await fe(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Dt})}catch(t){if(le(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){mr(e);try{return await fe(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Dt})}catch(s){if(le(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,t=!1){mr(e);try{return await fe(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Dt})}catch(s){if(le(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){mr(e.userId);try{const{data:t,error:s}=await fe(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:t,error:s}}catch(t){if(le(t))return{data:null,error:t};throw t}}async _deleteFactor(e){mr(e.userId),mr(e.id);try{return{data:await fe(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(le(t))return{data:null,error:t};throw t}}}const sd={getItem:r=>Yr()?globalThis.localStorage.getItem(r):null,setItem:(r,e)=>{Yr()&&globalThis.localStorage.setItem(r,e)},removeItem:r=>{Yr()&&globalThis.localStorage.removeItem(r)}};function Ba(r={}){return{getItem:e=>r[e]||null,setItem:(e,t)=>{r[e]=t},removeItem:e=>{delete r[e]}}}function nd(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const yr={debug:!!(globalThis&&Yr()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class uo extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class ad extends uo{}async function id(r,e,t){yr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",r,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),yr.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",r)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(r,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async n=>{if(n){yr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",r,n.name);try{return await t()}finally{yr.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",r,n.name)}}else{if(e===0)throw yr.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",r),new ad(`Acquiring an exclusive Navigator LockManager lock "${r}" immediately failed`);if(yr.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}nd();const od={url:gu,storageKey:_u,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:mu,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Wa(r,e,t){return await t()}class rs{constructor(e){var t,s;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=rs.nextInstanceID,rs.nextInstanceID+=1,this.instanceID>0&&dt()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},od),e);if(this.logDebugMessages=!!n.debug,typeof n.debug=="function"&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new rd({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=lo(n.fetch),this.lock=n.lock||Wa,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:dt()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=id:this.lock=Wa,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?n.storage?this.storage=n.storage:Yr()?this.storage=sd:(this.memoryStorage={},this.storage=Ba(this.memoryStorage)):(this.memoryStorage={},this.storage=Ba(this.memoryStorage)),dt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${no}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=Ru(window.location.href);let s="none";if(this._isImplicitGrantCallback(t)?s="implicit":await this._isPKCECallback(t)&&(s="pkce"),dt()&&this.detectSessionInUrl&&s!=="none"){const{data:n,error:a}=await this._getSessionFromURL(t,s);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),Eu(a)){const l=(e=a.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:i,redirectType:o}=n;return this._debug("#_initialize()","detected session in URL",i,"redirect type",o),await this._saveSession(i),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return le(t)?{error:t}:{error:new io("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,s,n;try{const a=await fe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.captchaToken}},xform:Et}),{data:i,error:o}=a;if(o||!i)return{data:{user:null,session:null},error:o};const l=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(a){if(le(a))return{data:{user:null,session:null},error:a};throw a}}async signUp(e){var t,s,n;try{let a;if("email"in e){const{email:d,password:h,options:f}=e;let p=null,v=null;this.flowType==="pkce"&&([p,v]=await _r(this.storage,this.storageKey)),a=await fe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:d,password:h,data:(t=f==null?void 0:f.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:p,code_challenge_method:v},xform:Et})}else if("phone"in e){const{phone:d,password:h,options:f}=e;a=await fe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:h,data:(s=f==null?void 0:f.data)!==null&&s!==void 0?s:{},channel:(n=f==null?void 0:f.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:Et})}else throw new bs("You must provide either an email or phone number and a password");const{data:i,error:o}=a;if(o||!i)return{data:{user:null,session:null},error:o};const l=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(a){if(le(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithPassword(e){try{let t;if("email"in e){const{email:a,password:i,options:o}=e;t=await fe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Fa})}else if("phone"in e){const{phone:a,password:i,options:o}=e;t=await fe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Fa})}else throw new bs("You must provide either an email or phone number and a password");const{data:s,error:n}=t;return n?{data:{user:null,session:null},error:n}:!s||!s.session||!s.user?{data:{user:null,session:null},error:new ws}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:n})}catch(t){if(le(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,s,n,a;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(a=e.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if(t==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,s,n,a,i,o,l,c,d,h,f,p;let v,k;if("message"in e)v=e.message,k=e.signature;else{const{chain:m,wallet:T,statement:I,options:O}=e;let E;if(dt())if(typeof T=="object")E=T;else{const S=window;if("solana"in S&&typeof S.solana=="object"&&("signIn"in S.solana&&typeof S.solana.signIn=="function"||"signMessage"in S.solana&&typeof S.solana.signMessage=="function"))E=S.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof T!="object"||!(O!=null&&O.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");E=T}const x=new URL((t=O==null?void 0:O.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in E&&E.signIn){const S=await E.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},O==null?void 0:O.signInWithSolana),{version:"1",domain:x.host,uri:x.href}),I?{statement:I}:null));let A;if(Array.isArray(S)&&S[0]&&typeof S[0]=="object")A=S[0];else if(S&&typeof S=="object"&&"signedMessage"in S&&"signature"in S)A=S;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in A&&"signature"in A&&(typeof A.signedMessage=="string"||A.signedMessage instanceof Uint8Array)&&A.signature instanceof Uint8Array)v=typeof A.signedMessage=="string"?A.signedMessage:new TextDecoder().decode(A.signedMessage),k=A.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in E)||typeof E.signMessage!="function"||!("publicKey"in E)||typeof E!="object"||!E.publicKey||!("toBase58"in E.publicKey)||typeof E.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");v=[`${x.host} wants you to sign in with your Solana account:`,E.publicKey.toBase58(),...I?["",I,""]:[""],"Version: 1",`URI: ${x.href}`,`Issued At: ${(n=(s=O==null?void 0:O.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((a=O==null?void 0:O.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${O.signInWithSolana.notBefore}`]:[],...!((i=O==null?void 0:O.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${O.signInWithSolana.expirationTime}`]:[],...!((o=O==null?void 0:O.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${O.signInWithSolana.chainId}`]:[],...!((l=O==null?void 0:O.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${O.signInWithSolana.nonce}`]:[],...!((c=O==null?void 0:O.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${O.signInWithSolana.requestId}`]:[],...!((h=(d=O==null?void 0:O.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||h===void 0)&&h.length?["Resources",...O.signInWithSolana.resources.map(A=>`- ${A}`)]:[]].join(`
`);const S=await E.signMessage(new TextEncoder().encode(v),"utf8");if(!S||!(S instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");k=S}}try{const{data:m,error:T}=await fe(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:v,signature:Cu(k)},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(p=e.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:Et});if(T)throw T;return!m||!m.session||!m.user?{data:{user:null,session:null},error:new ws}:(m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),{data:Object.assign({},m),error:T})}catch(m){if(le(m))return{data:{user:null,session:null},error:m};throw m}}async _exchangeCodeForSession(e){const t=await Ss(this.storage,`${this.storageKey}-code-verifier`),[s,n]=(t??"").split("/");try{const{data:a,error:i}=await fe(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:Et});if(await Es(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return!a||!a.session||!a.user?{data:{user:null,session:null,redirectType:null},error:new ws}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign(Object.assign({},a),{redirectType:n??null}),error:i})}catch(a){if(le(a))return{data:{user:null,session:null,redirectType:null},error:a};throw a}}async signInWithIdToken(e){try{const{options:t,provider:s,token:n,access_token:a,nonce:i}=e,o=await fe(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:n,access_token:a,nonce:i,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:Et}),{data:l,error:c}=o;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new ws}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(t){if(le(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,s,n,a,i;try{if("email"in e){const{email:o,options:l}=e;let c=null,d=null;this.flowType==="pkce"&&([c,d]=await _r(this.storage,this.storageKey));const{error:h}=await fe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(t=l==null?void 0:l.data)!==null&&t!==void 0?t:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:d},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:o,options:l}=e,{data:c,error:d}=await fe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(n=l==null?void 0:l.data)!==null&&n!==void 0?n:{},create_user:(a=l==null?void 0:l.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(i=l==null?void 0:l.channel)!==null&&i!==void 0?i:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:d}}throw new bs("You must provide either an email or phone number.")}catch(o){if(le(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(e){var t,s;try{let n,a;"options"in e&&(n=(t=e.options)===null||t===void 0?void 0:t.redirectTo,a=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:i,error:o}=await fe(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:n,xform:Et});if(o)throw o;if(!i)throw new Error("An error occurred on token verification.");const l=i.session,c=i.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(n){if(le(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(e){var t,s,n;try{let a=null,i=null;return this.flowType==="pkce"&&([a,i]=await _r(this.storage,this.storageKey)),await fe(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&s!==void 0?s:void 0}),!((n=e==null?void 0:e.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:i}),headers:this.headers,xform:Qu})}catch(a){if(le(a))return{data:null,error:a};throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:s}=e;if(s)throw s;if(!t)throw new It;const{error:n}=await fe(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:n}})}catch(e){if(le(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:s,type:n,options:a}=e,{error:i}=await fe(this.fetch,"POST",t,{headers:this.headers,body:{email:s,type:n,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},redirectTo:a==null?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:i}}else if("phone"in e){const{phone:s,type:n,options:a}=e,{data:i,error:o}=await fe(this.fetch,"POST",t,{headers:this.headers,body:{phone:s,type:n,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}}});return{data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:o}}throw new bs("You must provide either an email or phone number and a type")}catch(t){if(le(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await s,await t()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=t();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Ss(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<nn:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.storage.isServer){let i=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,c,d)=>(!i&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),i=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,d))})}return{data:{session:e},error:null}}const{session:n,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{session:null},error:a}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await fe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Dt}):await this._useSession(async t=>{var s,n,a;const{data:i,error:o}=t;if(o)throw o;return!(!((s=i.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new It}:await fe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0,xform:Dt})})}catch(t){if(le(t))return Su(t)&&(await this._removeSession(),await Es(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async s=>{const{data:n,error:a}=s;if(a)throw a;if(!n.session)throw new It;const i=n.session;let o=null,l=null;this.flowType==="pkce"&&e.email!=null&&([o,l]=await _r(this.storage,this.storageKey));const{data:c,error:d}=await fe(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:l}),jwt:i.access_token,xform:Dt});if(d)throw d;return i.user=c.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(s){if(le(s))return{data:{user:null},error:s};throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new It;const t=Date.now()/1e3;let s=t,n=!0,a=null;const{payload:i}=on(e.access_token);if(i.exp&&(s=i.exp,n=s<=t),n){const{session:o,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};a=o}else{const{data:o,error:l}=await this._getUser(e.access_token);if(l)throw l;a={access_token:e.access_token,refresh_token:e.refresh_token,user:o.user,token_type:"bearer",expires_in:s-t,expires_at:s},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(t){if(le(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var s;if(!e){const{data:i,error:o}=t;if(o)throw o;e=(s=i.session)!==null&&s!==void 0?s:void 0}if(!(e!=null&&e.refresh_token))throw new It;const{session:n,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{user:null,session:null},error:a}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(le(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!dt())throw new ks("No browser detected.");if(e.error||e.error_description||e.error_code)throw new ks(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new $a("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ks("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new $a("No code detected.");const{data:I,error:O}=await this._exchangeCodeForSession(e.code);if(O)throw O;const E=new URL(window.location.href);return E.searchParams.delete("code"),window.history.replaceState(window.history.state,"",E.toString()),{data:{session:I.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:n,access_token:a,refresh_token:i,expires_in:o,expires_at:l,token_type:c}=e;if(!a||!o||!i||!c)throw new ks("No session defined in URL");const d=Math.round(Date.now()/1e3),h=parseInt(o);let f=d+h;l&&(f=parseInt(l));const p=f-d;p*1e3<=br&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${h}s`);const v=f-h;d-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,f,d):d-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,f,d);const{data:k,error:m}=await this._getUser(a);if(m)throw m;const T={provider_token:s,provider_refresh_token:n,access_token:a,expires_in:h,expires_at:f,refresh_token:i,token_type:c,user:k.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:T,redirectType:e.type},error:null}}catch(s){if(le(s))return{data:{session:null,redirectType:null},error:s};throw s}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Ss(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var s;const{data:n,error:a}=t;if(a)return{error:a};const i=(s=n.session)===null||s===void 0?void 0:s.access_token;if(i){const{error:o}=await this.admin.signOut(i,e);if(o&&!(ku(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return e!=="others"&&(await this._removeSession(),await Es(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=Iu(),s={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async t=>{var s,n;try{const{data:{session:a},error:i}=t;if(i)throw i;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",e,"session",a)}catch(a){await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a),console.error(a)}})}async resetPasswordForEmail(e,t={}){let s=null,n=null;this.flowType==="pkce"&&([s,n]=await _r(this.storage,this.storageKey,!0));try{return await fe(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:n,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(a){if(le(a))return{data:null,error:a};throw a}}async getUserIdentities(){var e;try{const{data:t,error:s}=await this.getUser();if(s)throw s;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(le(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:s,error:n}=await this._useSession(async a=>{var i,o,l,c,d;const{data:h,error:f}=a;if(f)throw f;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(i=e.options)===null||i===void 0?void 0:i.redirectTo,scopes:(o=e.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await fe(this.fetch,"GET",p,{headers:this.headers,jwt:(d=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&d!==void 0?d:void 0})});if(n)throw n;return dt()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),{data:{provider:e.provider,url:s==null?void 0:s.url},error:null}}catch(s){if(le(s))return{data:{provider:e.provider,url:null},error:s};throw s}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var s,n;const{data:a,error:i}=t;if(i)throw i;return await fe(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(s=a.session)===null||s===void 0?void 0:s.access_token)!==null&&n!==void 0?n:void 0})})}catch(t){if(le(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const s=Date.now();return await Lu(async n=>(n>0&&await $u(200*Math.pow(2,n-1)),this._debug(t,"refreshing attempt",n),await fe(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Et})),(n,a)=>{const i=200*Math.pow(2,n);return a&&an(a)&&Date.now()+i-s<br})}catch(s){if(this._debug(t,"error",s),le(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",s),dt()&&!t.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const s=await Ss(this.storage,this.storageKey);if(this._debug(t,"session from storage",s),!this._isValidSession(s)){this._debug(t,"session is not valid"),s!==null&&await this._removeSession();return}const n=((e=s.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<nn;if(this._debug(t,`session has${n?"":" not"} expired with margin of ${nn}s`),n){if(this.autoRefreshToken&&s.refresh_token){const{error:a}=await this._callRefreshToken(s.refresh_token);a&&(console.error(a),an(a)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(t,"error",s),console.error(s);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,s;if(!e)throw new It;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new Js;const{data:a,error:i}=await this._refreshAccessToken(e);if(i)throw i;if(!a.session)throw new It;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const o={session:a.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(a){if(this._debug(n,"error",a),le(a)){const i={session:null,error:a};return an(a)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(i),i}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(a),a}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,t,s=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",t,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:t});const a=[],i=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(e,t)}catch(l){a.push(l)}});if(await Promise.all(i),a.length>0){for(let o=0;o<a.length;o+=1)console.error(a[o]);throw a[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await co(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await Es(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&dt()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),br);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:s}}=t;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((s.expires_at*1e3-e)/br);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${br}ms, refresh threshold is ${Tn} ticks`),n<=Tn&&await this._callRefreshToken(s.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof uo)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!dt()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,s){const n=[`provider=${encodeURIComponent(t)}`];if(s!=null&&s.redirectTo&&n.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&n.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[a,i]=await _r(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(i)}`});n.push(o.toString())}if(s!=null&&s.queryParams){const a=new URLSearchParams(s.queryParams);n.push(a.toString())}return s!=null&&s.skipBrowserRedirect&&n.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var s;const{data:n,error:a}=t;return a?{data:null,error:a}:await fe(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(le(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var s,n;const{data:a,error:i}=t;if(i)return{data:null,error:i};const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:c}=await fe(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(s=a==null?void 0:a.session)===null||s===void 0?void 0:s.access_token});return c?{data:null,error:c}:(e.factorType==="totp"&&(!((n=l==null?void 0:l.totp)===null||n===void 0)&&n.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(t){if(le(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:n,error:a}=t;if(a)return{data:null,error:a};const{data:i,error:o}=await fe(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:o})})}catch(t){if(le(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:n,error:a}=t;return a?{data:null,error:a}:await fe(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(le(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const s=(e==null?void 0:e.factors)||[],n=s.filter(i=>i.factor_type==="totp"&&i.status==="verified"),a=s.filter(i=>i.factor_type==="phone"&&i.status==="verified");return{data:{all:s,totp:n,phone:a},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,s;const{data:{session:n},error:a}=e;if(a)return{data:null,error:a};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=on(n.access_token);let o=null;i.aal&&(o=i.aal);let l=o;((s=(t=n.user.factors)===null||t===void 0?void 0:t.filter(h=>h.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(l="aal2");const d=i.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:d},error:null}}))}async fetchJwk(e,t={keys:[]}){let s=t.keys.find(i=>i.kid===e);if(s||(s=this.jwks.keys.find(i=>i.kid===e),s&&this.jwks_cached_at+wu>Date.now()))return s;const{data:n,error:a}=await fe(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;if(!n.keys||n.keys.length===0)throw new Gr("JWKS is empty");if(this.jwks=n,this.jwks_cached_at=Date.now(),s=n.keys.find(i=>i.kid===e),!s)throw new Gr("No matching signing key found in JWKS");return s}async getClaims(e,t={keys:[]}){try{let s=e;if(!s){const{data:p,error:v}=await this.getSession();if(v||!p.session)return{data:null,error:v};s=p.session.access_token}const{header:n,payload:a,signature:i,raw:{header:o,payload:l}}=on(s);if(Wu(a.exp),!n.kid||n.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:p}=await this.getUser(s);if(p)throw p;return{data:{claims:a,header:n,signature:i},error:null}}const c=Vu(n.alg),d=await this.fetchJwk(n.kid,t),h=await crypto.subtle.importKey("jwk",d,c,!0,["verify"]);if(!await crypto.subtle.verify(c,h,i,Pu(`${o}.${l}`)))throw new Gr("Invalid JWT signature");return{data:{claims:a,header:n,signature:i},error:null}}catch(s){if(le(s))return{data:null,error:s};throw s}}}rs.nextInstanceID=0;const ld=rs;class cd extends ld{constructor(e){super(e)}}var ud=function(r,e,t,s){function n(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(d){try{c(s.next(d))}catch(h){i(h)}}function l(d){try{c(s.throw(d))}catch(h){i(h)}}function c(d){d.done?a(d.value):n(d.value).then(o,l)}c((s=s.apply(r,e||[])).next())})};class dd{constructor(e,t,s){var n,a,i;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const o=vu(e),l=new URL(o);this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,d={db:iu,realtime:lu,auth:Object.assign(Object.assign({},ou),{storageKey:c}),global:au},h=pu(s??{},d);this.storageKey=(n=h.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(a=h.global.headers)!==null&&a!==void 0?a:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(f,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=h.auth)!==null&&i!==void 0?i:{},this.headers,h.global.fetch),this.fetch=hu(t,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new Ac(new URL("rest/v1",l).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),h.accessToken||this._listenForAuthEvents()}get functions(){return new pc(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new ru(this.storageUrl.href,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},s={}){return this.rest.rpc(e,t,s)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return ud(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return(t=(e=s.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:n,storageKey:a,flowType:i,lock:o,debug:l},c,d){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new cd({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),c),storageKey:a,autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:n,flowType:i,lock:o,debug:l,fetch:d,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new Fc(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,s)=>{this._handleTokenChanged(t,"CLIENT",s==null?void 0:s.access_token)})}_handleTokenChanged(e,t,s){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==s?this.changedAccessToken=s:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const hd=(r,e,t)=>new dd(r,e,t),fd="https://ibgkltqlgbafpoljizdu.supabase.co",vd="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImliZ2tsdHFsZ2JhZnBvbGppemR1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDkzMjU1NzksImV4cCI6MjA2NDkwMTU3OX0.Awa-Gdd3b4uR_1MnQySyA5s6hfVfyZB6jlVS1Jj_Afk",he=hd(fd,vd);rl();function Va(r,e){_(e,!u(e))}var pd=N('<button class="open-sidebar-icon icon svelte-1hv2e3s">â¡</button> <aside><div class="sidebar-header svelte-1hv2e3s"><img src="https://raw.githubusercontent.com/Ewan-Dev/ewan.is-a.dev/refs/heads/main/frontend/static/loquela.png" class="logo svelte-1hv2e3s" alt="loquela logo"/> <button class="close-sidebar-icon icon svelte-1hv2e3s">X</button></div> <nav class="sidebar-nav svelte-1hv2e3s"><a href="./#/app/home"><span class="material-symbols-rounded svelte-1hv2e3s">home</span> Home</a> <a href="./#/app/music"><span class="material-symbols-rounded svelte-1hv2e3s">music_note</span> Music</a> <a href="./#/app/videos"><span class="material-symbols-rounded svelte-1hv2e3s">movie</span> Videos</a> <a href="./#/app/upload"><span class="material-symbols-rounded svelte-1hv2e3s">upload</span> Upload</a> <a href="./#/app/flashcards"><span class="material-symbols-rounded svelte-1hv2e3s">cards_star</span> Flashcards</a> <a href="./#/app/ai-chat"><span class="material-symbols-rounded svelte-1hv2e3s">chat</span> AI Chat</a></nav></aside>',1);function St(r,e){let t=ye(e,"currentPage",8,""),s=kr(!1);var n=pd(),a=je(n);a.__click=[Va,s];var i=y(a,2);let o;var l=w(i),c=y(w(l),2);c.__click=[Va,s];var d=y(l,2),h=w(d);let f;var p=y(h,2);let v;var k=y(p,2);let m;var T=y(k,2);let I;var O=y(T,2);let E;var x=y(O,2);let S;de((A,C,M,K,G,F,P)=>{o=st(i,1,"sidebar svelte-1hv2e3s",null,o,A),f=st(h,1,"svelte-1hv2e3s",null,f,C),v=st(p,1,"svelte-1hv2e3s",null,v,M),m=st(k,1,"svelte-1hv2e3s",null,m,K),I=st(T,1,"svelte-1hv2e3s",null,I,G),E=st(O,1,"svelte-1hv2e3s",null,E,F),S=st(x,1,"svelte-1hv2e3s",null,S,P)},[()=>({show:u(s)}),()=>({selected:t()==="/home"}),()=>({selected:t()==="/music"}),()=>({selected:t()==="/videos"}),()=>({selected:t()==="/upload"}),()=>({selected:t()==="/flashcards"}),()=>({selected:t()==="/ai-chat"})]),L(r,n)}or(["click"]);var gd=N('<main class="route svelte-1nmp6pz"><!> <section class="main-page"><h1 class="page-header">Home</h1> <section class="main-content"><h1>ð Hello, welcome back.</h1></section></section></main>');function _d(r,e){Ie(e,!1),tt(async()=>{const{data:{user:n}}=await he.auth.getUser();console.log(n)}),Wn();var t=gd(),s=w(t);St(s,{currentPage:"/home"}),L(r,t),Re()}const md=r=>r;function yd(r,{delay:e=0,duration:t=400,easing:s=md}={}){const n=+getComputedStyle(r).opacity;return{delay:e,duration:t,easing:s,css:a=>`opacity: ${a*n}`}}var wd=N('<section role="status"><span> </span> <p> </p></section>');function At(r,e){Ie(e,!0);let t=ye(e,"type",3,"info"),s=ye(e,"message",3,"Information"),n=ye(e,"width",3,"100%"),a={info:"info",error:"error",success:"check_circle",warn:"warning"},i,o=j(!0);Se(()=>(_(o,!1),s()&&(_(o,!0),clearTimeout(i),i=setTimeout(()=>{_(o,!1)},5e3)),()=>{_(o,!1),clearTimeout(i)}));var l=Ft(),c=je(l);{var d=h=>{var f=wd(),p=w(f),v=w(p),k=y(p,2),m=w(k);de(()=>{Bl(f,`width:${n()??""};`),st(f,1,Is(t()),"svelte-1o9ullj"),st(p,1,`${t()} material-symbols-rounded`,"svelte-1o9ullj"),te(v,a[t()]),st(k,1,Is(t()),"svelte-1o9ullj"),te(m,s())}),Xl(3,f,()=>yd,()=>({duration:400})),L(h,f)};ce(c,h=>{u(o)&&h(d)})}L(r,l),Re()}var gs={};(function r(e,t,s,n){var a=!!(e.Worker&&e.Blob&&e.Promise&&e.OffscreenCanvas&&e.OffscreenCanvasRenderingContext2D&&e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype.transferControlToOffscreen&&e.URL&&e.URL.createObjectURL),i=typeof Path2D=="function"&&typeof DOMMatrix=="function",o=function(){if(!e.OffscreenCanvas)return!1;var b=new OffscreenCanvas(1,1),g=b.getContext("2d");g.fillRect(0,0,1,1);var z=b.transferToImageBitmap();try{g.createPattern(z,"no-repeat")}catch{return!1}return!0}();function l(){}function c(b){var g=t.exports.Promise,z=g!==void 0?g:e.Promise;return typeof z=="function"?new z(b):(b(l,l),null)}var d=function(b,g){return{transform:function(z){if(b)return z;if(g.has(z))return g.get(z);var q=new OffscreenCanvas(z.width,z.height),B=q.getContext("2d");return B.drawImage(z,0,0),g.set(z,q),q},clear:function(){g.clear()}}}(o,new Map),h=function(){var b=Math.floor(16.666666666666668),g,z,q={},B=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(g=function(H){var X=Math.random();return q[X]=requestAnimationFrame(function J(ie){B===ie||B+b-1<ie?(B=ie,delete q[X],H()):q[X]=requestAnimationFrame(J)}),X},z=function(H){q[H]&&cancelAnimationFrame(q[H])}):(g=function(H){return setTimeout(H,b)},z=function(H){return clearTimeout(H)}),{frame:g,cancel:z}}(),f=function(){var b,g,z={};function q(B){function H(X,J){B.postMessage({options:X||{},callback:J})}B.init=function(J){var ie=J.transferControlToOffscreen();B.postMessage({canvas:ie},[ie])},B.fire=function(J,ie,V){if(g)return H(J,null),g;var Y=Math.random().toString(36).slice(2);return g=c(function(ae){function se(ue){ue.data.callback===Y&&(delete z[Y],B.removeEventListener("message",se),g=null,d.clear(),V(),ae())}B.addEventListener("message",se),H(J,Y),z[Y]=se.bind(null,{data:{callback:Y}})}),g},B.reset=function(){B.postMessage({reset:!0});for(var J in z)z[J](),delete z[J]}}return function(){if(b)return b;if(!s&&a){var B=["var CONFETTI, SIZE = {}, module = {};","("+r.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{b=new Worker(URL.createObjectURL(new Blob([B])))}catch(H){return typeof console!==void 0&&typeof console.warn=="function"&&console.warn("ð Could not load worker",H),null}q(b)}return b}}(),p={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function v(b,g){return g?g(b):b}function k(b){return b!=null}function m(b,g,z){return v(b&&k(b[g])?b[g]:p[g],z)}function T(b){return b<0?0:Math.floor(b)}function I(b,g){return Math.floor(Math.random()*(g-b))+b}function O(b){return parseInt(b,16)}function E(b){return b.map(x)}function x(b){var g=String(b).replace(/[^0-9a-f]/gi,"");return g.length<6&&(g=g[0]+g[0]+g[1]+g[1]+g[2]+g[2]),{r:O(g.substring(0,2)),g:O(g.substring(2,4)),b:O(g.substring(4,6))}}function S(b){var g=m(b,"origin",Object);return g.x=m(g,"x",Number),g.y=m(g,"y",Number),g}function A(b){b.width=document.documentElement.clientWidth,b.height=document.documentElement.clientHeight}function C(b){var g=b.getBoundingClientRect();b.width=g.width,b.height=g.height}function M(b){var g=document.createElement("canvas");return g.style.position="fixed",g.style.top="0px",g.style.left="0px",g.style.pointerEvents="none",g.style.zIndex=b,g}function K(b,g,z,q,B,H,X,J,ie){b.save(),b.translate(g,z),b.rotate(H),b.scale(q,B),b.arc(0,0,1,X,J,ie),b.restore()}function G(b){var g=b.angle*(Math.PI/180),z=b.spread*(Math.PI/180);return{x:b.x,y:b.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:b.startVelocity*.5+Math.random()*b.startVelocity,angle2D:-g+(.5*z-Math.random()*z),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:b.color,shape:b.shape,tick:0,totalTicks:b.ticks,decay:b.decay,drift:b.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:b.gravity*3,ovalScalar:.6,scalar:b.scalar,flat:b.flat}}function F(b,g){g.x+=Math.cos(g.angle2D)*g.velocity+g.drift,g.y+=Math.sin(g.angle2D)*g.velocity+g.gravity,g.velocity*=g.decay,g.flat?(g.wobble=0,g.wobbleX=g.x+10*g.scalar,g.wobbleY=g.y+10*g.scalar,g.tiltSin=0,g.tiltCos=0,g.random=1):(g.wobble+=g.wobbleSpeed,g.wobbleX=g.x+10*g.scalar*Math.cos(g.wobble),g.wobbleY=g.y+10*g.scalar*Math.sin(g.wobble),g.tiltAngle+=.1,g.tiltSin=Math.sin(g.tiltAngle),g.tiltCos=Math.cos(g.tiltAngle),g.random=Math.random()+2);var z=g.tick++/g.totalTicks,q=g.x+g.random*g.tiltCos,B=g.y+g.random*g.tiltSin,H=g.wobbleX+g.random*g.tiltCos,X=g.wobbleY+g.random*g.tiltSin;if(b.fillStyle="rgba("+g.color.r+", "+g.color.g+", "+g.color.b+", "+(1-z)+")",b.beginPath(),i&&g.shape.type==="path"&&typeof g.shape.path=="string"&&Array.isArray(g.shape.matrix))b.fill(Z(g.shape.path,g.shape.matrix,g.x,g.y,Math.abs(H-q)*.1,Math.abs(X-B)*.1,Math.PI/10*g.wobble));else if(g.shape.type==="bitmap"){var J=Math.PI/10*g.wobble,ie=Math.abs(H-q)*.1,V=Math.abs(X-B)*.1,Y=g.shape.bitmap.width*g.scalar,ae=g.shape.bitmap.height*g.scalar,se=new DOMMatrix([Math.cos(J)*ie,Math.sin(J)*ie,-Math.sin(J)*V,Math.cos(J)*V,g.x,g.y]);se.multiplySelf(new DOMMatrix(g.shape.matrix));var ue=b.createPattern(d.transform(g.shape.bitmap),"no-repeat");ue.setTransform(se),b.globalAlpha=1-z,b.fillStyle=ue,b.fillRect(g.x-Y/2,g.y-ae/2,Y,ae),b.globalAlpha=1}else if(g.shape==="circle")b.ellipse?b.ellipse(g.x,g.y,Math.abs(H-q)*g.ovalScalar,Math.abs(X-B)*g.ovalScalar,Math.PI/10*g.wobble,0,2*Math.PI):K(b,g.x,g.y,Math.abs(H-q)*g.ovalScalar,Math.abs(X-B)*g.ovalScalar,Math.PI/10*g.wobble,0,2*Math.PI);else if(g.shape==="star")for(var ne=Math.PI/2*3,Oe=4*g.scalar,Le=8*g.scalar,De=g.x,ze=g.y,Be=5,qe=Math.PI/Be;Be--;)De=g.x+Math.cos(ne)*Le,ze=g.y+Math.sin(ne)*Le,b.lineTo(De,ze),ne+=qe,De=g.x+Math.cos(ne)*Oe,ze=g.y+Math.sin(ne)*Oe,b.lineTo(De,ze),ne+=qe;else b.moveTo(Math.floor(g.x),Math.floor(g.y)),b.lineTo(Math.floor(g.wobbleX),Math.floor(B)),b.lineTo(Math.floor(H),Math.floor(X)),b.lineTo(Math.floor(q),Math.floor(g.wobbleY));return b.closePath(),b.fill(),g.tick<g.totalTicks}function P(b,g,z,q,B){var H=g.slice(),X=b.getContext("2d"),J,ie,V=c(function(Y){function ae(){J=ie=null,X.clearRect(0,0,q.width,q.height),d.clear(),B(),Y()}function se(){s&&!(q.width===n.width&&q.height===n.height)&&(q.width=b.width=n.width,q.height=b.height=n.height),!q.width&&!q.height&&(z(b),q.width=b.width,q.height=b.height),X.clearRect(0,0,q.width,q.height),H=H.filter(function(ue){return F(X,ue)}),H.length?J=h.frame(se):ae()}J=h.frame(se),ie=ae});return{addFettis:function(Y){return H=H.concat(Y),V},canvas:b,promise:V,reset:function(){J&&h.cancel(J),ie&&ie()}}}function $(b,g){var z=!b,q=!!m(g||{},"resize"),B=!1,H=m(g,"disableForReducedMotion",Boolean),X=a&&!!m(g||{},"useWorker"),J=X?f():null,ie=z?A:C,V=b&&J?!!b.__confetti_initialized:!1,Y=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,ae;function se(ne,Oe,Le){for(var De=m(ne,"particleCount",T),ze=m(ne,"angle",Number),Be=m(ne,"spread",Number),qe=m(ne,"startVelocity",Number),ee=m(ne,"decay",Number),oe=m(ne,"gravity",Number),ve=m(ne,"drift",Number),U=m(ne,"colors",E),Q=m(ne,"ticks",Number),ge=m(ne,"shapes"),Ae=m(ne,"scalar"),ke=!!m(ne,"flat"),$e=S(ne),Pe=De,we=[],it=b.width*$e.x,Je=b.height*$e.y;Pe--;)we.push(G({x:it,y:Je,angle:ze,spread:Be,startVelocity:qe,color:U[Pe%U.length],shape:ge[I(0,ge.length)],ticks:Q,decay:ee,gravity:oe,drift:ve,scalar:Ae,flat:ke}));return ae?ae.addFettis(we):(ae=P(b,we,ie,Oe,Le),ae.promise)}function ue(ne){var Oe=H||m(ne,"disableForReducedMotion",Boolean),Le=m(ne,"zIndex",Number);if(Oe&&Y)return c(function(qe){qe()});z&&ae?b=ae.canvas:z&&!b&&(b=M(Le),document.body.appendChild(b)),q&&!V&&ie(b);var De={width:b.width,height:b.height};J&&!V&&J.init(b),V=!0,J&&(b.__confetti_initialized=!0);function ze(){if(J){var qe={getBoundingClientRect:function(){if(!z)return b.getBoundingClientRect()}};ie(qe),J.postMessage({resize:{width:qe.width,height:qe.height}});return}De.width=De.height=null}function Be(){ae=null,q&&(B=!1,e.removeEventListener("resize",ze)),z&&b&&(document.body.contains(b)&&document.body.removeChild(b),b=null,V=!1)}return q&&!B&&(B=!0,e.addEventListener("resize",ze,!1)),J?J.fire(ne,De,Be):se(ne,De,Be)}return ue.reset=function(){J&&J.reset(),ae&&ae.reset()},ue}var D;function R(){return D||(D=$(null,{useWorker:!0,resize:!0})),D}function Z(b,g,z,q,B,H,X){var J=new Path2D(b),ie=new Path2D;ie.addPath(J,new DOMMatrix(g));var V=new Path2D;return V.addPath(ie,new DOMMatrix([Math.cos(X)*B,Math.sin(X)*B,-Math.sin(X)*H,Math.cos(X)*H,z,q])),V}function re(b){if(!i)throw new Error("path confetti are not supported in this browser");var g,z;typeof b=="string"?g=b:(g=b.path,z=b.matrix);var q=new Path2D(g),B=document.createElement("canvas"),H=B.getContext("2d");if(!z){for(var X=1e3,J=X,ie=X,V=0,Y=0,ae,se,ue=0;ue<X;ue+=2)for(var ne=0;ne<X;ne+=2)H.isPointInPath(q,ue,ne,"nonzero")&&(J=Math.min(J,ue),ie=Math.min(ie,ne),V=Math.max(V,ue),Y=Math.max(Y,ne));ae=V-J,se=Y-ie;var Oe=10,Le=Math.min(Oe/ae,Oe/se);z=[Le,0,0,Le,-Math.round(ae/2+J)*Le,-Math.round(se/2+ie)*Le]}return{type:"path",path:g,matrix:z}}function me(b){var g,z=1,q="#000000",B='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof b=="string"?g=b:(g=b.text,z="scalar"in b?b.scalar:z,B="fontFamily"in b?b.fontFamily:B,q="color"in b?b.color:q);var H=10*z,X=""+H+"px "+B,J=new OffscreenCanvas(H,H),ie=J.getContext("2d");ie.font=X;var V=ie.measureText(g),Y=Math.ceil(V.actualBoundingBoxRight+V.actualBoundingBoxLeft),ae=Math.ceil(V.actualBoundingBoxAscent+V.actualBoundingBoxDescent),se=2,ue=V.actualBoundingBoxLeft+se,ne=V.actualBoundingBoxAscent+se;Y+=se+se,ae+=se+se,J=new OffscreenCanvas(Y,ae),ie=J.getContext("2d"),ie.font=X,ie.fillStyle=q,ie.fillText(g,ue,ne);var Oe=1/z;return{type:"bitmap",bitmap:J.transferToImageBitmap(),matrix:[Oe,0,0,Oe,-Y*Oe/2,-ae*Oe/2]}}t.exports=function(){return R().apply(this,arguments)},t.exports.reset=function(){R().reset()},t.exports.create=$,t.exports.shapeFromPath=re,t.exports.shapeFromText=me})(function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}}(),gs,!1);const Ur=gs.exports;gs.exports.create;var bd=N('<main class="svelte-1lzp8li"><h1>Signup</h1> <form class="svelte-1lzp8li"><label for="email" class="svelte-1lzp8li">Email:</label> <input class="email svelte-1lzp8li" type="email"/> <label for="password" class="svelte-1lzp8li">Password:</label> <input class="password svelte-1lzp8li" type="password"/> <button class="sign-up" type="submit">Sign up</button> <!></form></main>');function kd(r,e){Ie(e,!0);let t="",s="",n="",a=j(W(n.statusError)),i=j(W(n.statusType));async function o(){await l()}async function l(){console.log("Signing up...");let{data:m,error:T}=await he.auth.signUp({email:t,password:s,options:{emailRedirectTo:"https://ewan.is-a.dev/#/app/login/"}});T&&T.message.includes("Password should contain at least one character of each")?(_(a,""),_(i,""),_(a,"Password must contain capital letters, lowercase letters, numbers and special characters."),_(i,"warn")):T&&T.message?(_(i,""),_(i,"error"),_(a,""),_(a,T.message,!0)):m&&!T&&(_(a,"Signup successful! Check your email to confirm."),_(i,"success"),console.log("User signed up successfully",m),c())}function c(){Ur({particleCount:200,spread:70,origin:{y:.6}})}var d=bd(),h=y(w(d),2),f=y(w(h),2),p=y(f,4),v=y(p,4);{var k=m=>{At(m,{get type(){return u(i)},get message(){return u(a)}})};ce(v,m=>{u(a)&&u(i)&&m(k)})}et("submit",h,m=>{m.preventDefault(),o()}),gt(f,()=>t,m=>t=m),gt(p,()=>s,m=>s=m),L(r,d),Re()}var Sd=N('<!> <p>Continue <a href="./#/app/home">here</a></p>',1),Ed=N('<main class="route svelte-1x05zx6"><section class="main-page"><h1 class="page-header">Login</h1> <section class="main-content"><form class="svelte-1x05zx6"><label for="email" class="svelte-1x05zx6">Email:</label> <input class="email svelte-1x05zx6" type="email"/> <label for="password" class="svelte-1x05zx6">Password:</label> <input class="password svelte-1x05zx6" type="password"/> <button class="log-in svelte-1x05zx6" type="submit">Sign in</button> <!> <!></form></section></section></main>');function xd(r,e){Ie(e,!0);let t=j(""),s=j(""),n="",a=j(""),i=j("");async function o(){let{data:E,error:x}=await he.auth.signInWithPassword({email:u(t),password:u(s)});x?(x&&x.message.includes("profiles_email_key")&&_(a,""),_(a,x.message,!0)):(_(i,E,!0),console.log("Login successful",n),_(a,""),c(),l(E.user.email))}async function l(E){const{error:x}=await he.from("profiles").insert({email:E});x&&x.message?console.error(x.message):x||(_(a,""),console.log("User added to profiles table"))}function c(){Ur({particleCount:200,spread:70,origin:{y:.6}})}var d=Ed(),h=w(d),f=y(w(h),2),p=w(f),v=y(w(p),2),k=y(v,4),m=y(k,4);{var T=E=>{At(E,{type:"error",get message(){return u(a)}})};ce(m,E=>{u(a)&&E(T)})}var I=y(m,2);{var O=E=>{var x=Sd(),S=je(x);At(S,{type:"success",message:"Login successful!",width:"15em"}),L(E,x)};ce(I,E=>{!u(a)&&u(i)&&E(O)})}et("submit",p,E=>{E.preventDefault(),o()}),gt(v,()=>u(t),E=>_(t,E)),gt(k,()=>u(s),E=>_(s,E)),L(r,d),Re()}var Td=N('<!> <p>Continue <a href="./#/app/home">here</a></p>',1),Od=N('<main class="route svelte-6jdv1j"><section class="main-page"><h1 class="page-header">Login</h1> <section class="main-content"><form class="svelte-6jdv1j"><label for="email" class="svelte-6jdv1j">Email:</label> <input class="email svelte-6jdv1j" type="email"/> <label for="password" class="svelte-6jdv1j">Password:</label> <input class="password svelte-6jdv1j" type="password"/> <button class="log-in svelte-6jdv1j" type="submit">Sign in</button> <!> <!></form></section></section></main>');function jd(r,e){Ie(e,!0);let t=j(""),s=j(""),n="",a=j(""),i=j("");async function o(){let{data:E,error:x}=await he.auth.signInWithPassword({email:u(t),password:u(s)});x?(x&&x.message.includes("profiles_email_key")&&_(a,""),_(a,x.message,!0)):(_(i,E,!0),console.log("Login successful",n),_(a,""),c(),l(E.user.email))}async function l(E){const{error:x}=await he.from("profiles").insert({email:E});x&&x.message?console.error(x.message):x||(_(a,""),console.log("User added to profiles table"))}function c(){Ur({particleCount:200,spread:70,origin:{y:.6}})}var d=Od(),h=w(d),f=y(w(h),2),p=w(f),v=y(w(p),2),k=y(v,4),m=y(k,4);{var T=E=>{At(E,{type:"error",get message(){return u(a)}})};ce(m,E=>{u(a)&&E(T)})}var I=y(m,2);{var O=E=>{var x=Td(),S=je(x);At(S,{type:"success",message:"Login successful!",width:"15em"}),L(E,x)};ce(I,E=>{!u(a)&&u(i)&&E(O)})}et("submit",p,E=>{E.preventDefault(),o()}),gt(v,()=>u(t),E=>_(t,E)),gt(k,()=>u(s),E=>_(s,E)),L(r,d),Re()}var Ad=N('<div><span class="material-symbols-rounded svelte-hct3vs"> </span> <p> </p></div>');function Pd(r,e){let t=ye(e,"type",8,""),s=ye(e,"message",8,""),n=ye(e,"symbol",8,"");var a=Ad(),i=w(a),o=w(i),l=y(i,2),c=w(l);de(()=>{st(a,1,`media-tag ${t()}`,"svelte-hct3vs"),te(o,n()),te(c,s())}),L(r,a)}var Cd=N('<div><img alt="Album cover"/> <span class="svelte-1pu170t"><!></span> <a class="svelte-1pu170t"><b> </b></a> <a class="svelte-1pu170t"> </a></div>');function ho(r,e){Ie(e,!1);let t=ye(e,"name",12,null),s=ye(e,"artist",12,null),n=ye(e,"cover",8,null),a=ye(e,"level",8,null);ye(e,"rating",8,null);let i=ye(e,"link",8,null),o=ye(e,"type",8,null);t().length>45&&t(t().slice(0,42)+"..."),s().length>45&&s(s().slice(0,42)+"..."),Wn();var l=Cd(),c=w(l),d=y(c,2),h=w(d);Pd(h,{type:"level",get message(){return a()}});var f=y(d,2),p=w(f),v=w(p),k=y(f,2),m=w(k);de(()=>{st(l,1,Is(o()),"svelte-1pu170t"),Ue(c,"src",n()),st(c,1,Is(o()),"svelte-1pu170t"),Ue(f,"href",i()),te(v,t()),te(m,s())}),L(r,l),Re()}var Md=N("<option> </option>"),Id=N("<option> </option>"),Rd=N('<span><label for="language">Select further detail:</label> <select class="language svelte-1d376ng" required><option>--Select--</option><!></select></span>'),Dd=N('<p class="not-found svelte-1d376ng">:/ Oops! No songs found; try uploading your own or try again later.</p>'),$d=N("<p>Try selecting a language to show media. If no languages show up, come back later as the servers may be down.</p>"),Ld=N('<main class="route svelte-1d376ng"><!> <section class="main-page"><h1 class="page-header">Songs</h1> <section class="main-content svelte-1d376ng"><select class="svelte-1d376ng"></select> <!> <section class="media-container svelte-1d376ng"><!> <!> <!></section></section></section></main>');function Ud(r,e){Ie(e,!0);let t=j(W([])),s=j(W([])),n=j(""),a=j(""),i=j("");async function o(C){const{data:M,error:K}=await he.from("media").select("*").eq("language",C).eq("media_type","music");K?console.error("Error fetching songs:",K):(console.log(u(t)),console.log(M),M.forEach(G=>{u(t).push(G||[])}),console.log(u(t)))}Se(()=>{console.log(u(t))});async function l(){const{data:C,error:M}=await he.from("languages").select("*");if(C)return _(s,C,!0),console.log(u(s)),C;if(M)throw M}tt(()=>{l()}),Se(()=>{_(t,[],!0),Array.isArray(u(n))&&u(n).forEach(C=>{console.log(C),o(C)})});let c=j(void 0),d=j(void 0);Se(()=>{var C;_(c,u(s).find(M=>M.short===u(a)),!0),_(d,(C=u(c))==null?void 0:C.sub_options,!0),console.log(u(d))}),Se(()=>{u(a).length===1?_(n,u(a),!0):_(n,u(i),!0)}),Se(()=>{console.log(u(n))});var h=Ld(),f=w(h);St(f,{currentPage:"/music"});var p=y(f,2),v=y(w(p),2),k=w(v);Me(k,21,()=>u(s),Ce,(C,M,K,G)=>{var F=Md(),P=w(F),$={};de(()=>{te(P,`${u(M).emoji??""} ${u(M).name??""}`),$!==($=u(M).short)&&(F.value=(F.__value=u(M).short)??"")}),L(C,F)});var m=y(k,2);{var T=C=>{var M=Rd(),K=y(w(M),2),G=w(K);G.value=G.__value="";var F=y(G);Me(F,17,()=>u(d),Ce,(P,$)=>{var D=Id(),R=w(D),Z={};de(()=>{te(R,u($).name),Z!==(Z=u($).codes)&&(D.value=(D.__value=u($).codes)??"")}),L(P,D)}),He(K,()=>u(i),P=>_(i,P)),L(C,M)};ce(m,C=>{u(a).length>1&&C(T)})}var I=y(m,2),O=w(I);{var E=C=>{var M=Dd();L(C,M)};ce(O,C=>{!u(t)[0]&&u(n)&&C(E)})}var x=y(O,2);{var S=C=>{var M=$d();L(C,M)};ce(x,C=>{u(a)||C(S)})}var A=y(x,2);Me(A,17,()=>u(t),Ce,(C,M)=>{{let K=jr(()=>`#/app/songs/${u(M).id}`);ho(C,{get name(){return u(M).name},get artist(){return u(M).artist},get cover(){return u(M).cover},get level(){return u(M).level},get rating(){return u(M).rating},get link(){return u(K)},type:"song"})}}),He(k,()=>u(a),C=>_(a,C)),L(r,h),Re()}var zd=N('<span class="svelte-1wzg23z"><h1 class="song svelte-1wzg23z"> </h1><h1 class="artist svelte-1wzg23z"> </h1></span>');function fo(r,e){let t=ye(e,"song",8,"Loading..."),s=ye(e,"artist",8,"Loading...");var n=zd(),a=w(n),i=w(a),o=y(a),l=w(o);de(()=>{te(i,t()),te(l,s())}),L(r,n)}var qd=N('<i><p class="romanisation svelte-1m7wp3l"> </p></i>'),Nd=N("<option> </option>"),Fd=N(`<span class="flashcard-functions svelte-1m7wp3l"><span class="flashcard-upload svelte-1m7wp3l"><button class="add-to-deck flashcard-btn svelte-1m7wp3l"><span class="material-symbols-rounded svelte-1m7wp3l">library_add</span></button> <select class="svelte-1m7wp3l"></select></span> <button class="info-flashcards-btn flashcard-btn svelte-1m7wp3l"><span class="material-symbols-rounded svelte-1m7wp3l">info</span></button></span> <dialog class="info-flashcards-container svelte-1m7wp3l"><strong class="definition-info-header">Where's my deck?</strong> <p class="definition-info-body svelte-1m7wp3l">This is as you may not yet have a deck for the language you are curretly studying; You can only add words to decks of the same language</p> <button class="close-dialog svelte-1m7wp3l">OK</button></dialog>`,1),Bd=N('<section class="definition svelte-1m7wp3l"><h1 class="svelte-1m7wp3l"> </h1> <!> <p class="part-of-speech svelte-1m7wp3l"> </p> <p class="svelte-1m7wp3l"> </p> <!> <!></section>'),Wd=N('<section class="definition-container svelte-1m7wp3l"><!></section>');function vo(r,e){Ie(e,!0);let t=ye(e,"language",7),s=j(W({message:"",type:""})),n=j(void 0),a=j(W([])),i=j(W(HTMLObjectElement)),o=j("");tt(async()=>{h()}),Se(async()=>{u(o)?(_(a,await d(u(o)),!0),console.log(u(a))):_(a,[],!0)});async function l(k){const{data:m,error:T}=await he.from("flashcard_decks").select("content").eq("id",k);return T?(_(s,{type:"error",message:T.message},!0),[]):m[0].content}async function c(k){const m=await l(k);m.push({word:e.word,definition:e.definition,partOfSpeech:e.partOfSpeech,romanisation:e.romanisation});const{error:T}=await he.from("flashcard_decks").update({content:m}).eq("id",k);if(T&&T.message==='invalid input syntax for type bigint: "undefined"')return _(s,{type:"error",message:"You haven't selected a deck. Try making one on 'Flashcards' page"},!0),T;if(T)return _(s,{type:"error",message:gerror.message},!0),T;_(s,{type:"success",message:"Added!"},!0)}async function d(k){t("language");const{data:m,error:T}=await he.from("flashcard_decks").select("*").eq("author",k);return T?(console.error(T),_(s,{type:"error",message:T.message},!0),T):(console.log(m),m)}async function h(){const{data:k,error:m}=await he.auth.getSession(),T=k;m?console.error("Error fetching session:",m):T&&_(o,T.session.user.id,!0)}var f=Wd(),p=w(f);{var v=k=>{var m=Bd(),T=w(m),I=w(T),O=y(T,2);{var E=F=>{var P=qd(),$=w(P),D=w($);de(()=>te(D,e.romanisation)),L(F,P)};ce(O,F=>{e.romanisation&&F(E)})}var x=y(O,2),S=w(x),A=y(x,2),C=w(A),M=y(A,2);{var K=F=>{var P=Fd(),$=je(P),D=w($),R=w(D),Z=y(R,2);Me(Z,21,()=>u(a),Ce,(q,B)=>{var H=Nd(),X=w(H),J={};de(()=>{te(X,u(B).name),J!==(J=u(B).id)&&(H.value=(H.__value=u(B).id)??"")}),L(q,H)});var re=y(D,2),me=jr(()=>u(i).showModal()),b=y($,2),g=y(w(b),4),z=jr(()=>u(i).close());ft(b,q=>_(i,q),()=>u(i)),et("click",R,()=>c(u(n))),He(Z,()=>u(n),q=>_(n,q)),et("click",re,function(...q){var B;(B=u(me))==null||B.apply(this,q)}),et("click",g,function(...q){var B;(B=u(z))==null||B.apply(this,q)}),L(F,P)};ce(M,F=>{u(a)&&F(K)})}var G=y(M,2);At(G,{get type(){return u(s).type},get message(){return u(s).message}}),de(()=>{te(I,e.word),te(S,e.partOfSpeech),te(C,e.definition)}),L(k,m)};ce(p,k=>{e.word&&k(v)})}L(r,f),Re()}var cn={},un={},Ha;function Vd(){return Ha||(Ha=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.TARGET_URL_HEADER=void 0,r.withMiddleware=e,r.withProxy=t;function e(...s){return n=>s.reduce((a,i)=>a.then(o=>i(o)),Promise.resolve(n))}r.TARGET_URL_HEADER="x-fal-target-url";function t(s){return typeof window>"u"?n=>Promise.resolve(n):n=>Promise.resolve(Object.assign(Object.assign({},n),{url:s.targetUrl,headers:Object.assign(Object.assign({},n.headers||{}),{[r.TARGET_URL_HEADER]:n.url})}))}}(un)),un}var _t={},Ja;function Hd(){if(Ja)return _t;Ja=1;var r=_t&&_t.__awaiter||function(n,a,i,o){function l(c){return c instanceof i?c:new i(function(d){d(c)})}return new(i||(i=Promise))(function(c,d){function h(v){try{p(o.next(v))}catch(k){d(k)}}function f(v){try{p(o.throw(v))}catch(k){d(k)}}function p(v){v.done?c(v.value):l(v.value).then(h,f)}p((o=o.apply(n,a||[])).next())})};Object.defineProperty(_t,"__esModule",{value:!0}),_t.ValidationError=_t.ApiError=void 0,_t.defaultResponseHandler=s;class e extends Error{constructor({message:a,status:i,body:o}){super(a),this.name="ApiError",this.status=i,this.body=o}}_t.ApiError=e;class t extends e{constructor(a){super(a),this.name="ValidationError"}get fieldErrors(){return typeof this.body.detail=="string"?[{loc:["body"],msg:this.body.detail,type:"value_error"}]:this.body.detail||[]}getFieldErrors(a){return this.fieldErrors.filter(i=>i.loc[i.loc.length-1]===a)}}_t.ValidationError=t;function s(n){return r(this,void 0,void 0,function*(){var a;const{status:i,statusText:o}=n,l=(a=n.headers.get("Content-Type"))!==null&&a!==void 0?a:"";if(!n.ok){if(l.includes("application/json")){const c=yield n.json(),d=i===422?t:e;throw new d({message:c.message||o,status:i,body:c})}throw new e({message:`HTTP ${i}: ${o}`,status:i})}return l.includes("application/json")?n.json():l.includes("text/html")?n.text():l.includes("application/octet-stream")?n.arrayBuffer():n.text()})}return _t}var Ka;function Jd(){return Ka||(Ka=1,function(r){var e={};Object.defineProperty(r,"__esModule",{value:!0}),r.credentialsFromEnv=void 0,r.resolveDefaultFetch=n,r.config=c,r.getConfig=d,r.getRestApiUrl=h;const t=Vd(),s=Hd();function n(){if(typeof fetch>"u")throw new Error("Your environment does not support fetch. Please provide your own fetch implementation.");return fetch}function a(){return typeof process<"u"&&e&&(typeof e.FAL_KEY<"u"||typeof e.FAL_KEY_ID<"u"&&typeof e.FAL_KEY_SECRET<"u")}const i=()=>{if(a())return typeof e.FAL_KEY<"u"?e.FAL_KEY:`${e.FAL_KEY_ID}:${e.FAL_KEY_SECRET}`};r.credentialsFromEnv=i;const o={credentials:r.credentialsFromEnv,suppressLocalCredentialsWarning:!1,requestMiddleware:f=>Promise.resolve(f),responseHandler:s.defaultResponseHandler};let l;function c(f){var p;l=Object.assign(Object.assign(Object.assign({},o),f),{fetch:(p=f.fetch)!==null&&p!==void 0?p:n()}),f.proxyUrl&&(l=Object.assign(Object.assign({},l),{requestMiddleware:(0,t.withMiddleware)((0,t.withProxy)({targetUrl:f.proxyUrl}),l.requestMiddleware)}));const{credentials:v,suppressLocalCredentialsWarning:k}=l,m=typeof v=="function"?v():v;typeof window<"u"&&m&&!k&&console.warn("The fal credentials are exposed in the browser's environment. That's not recommended for production use cases.")}function d(){return l||(console.info("Using default configuration for the fal client"),Object.assign(Object.assign({},o),{fetch:n()}))}function h(){return"https://rest.alpha.fal.ai"}}(cn)),cn}Jd();var Kd=N('<img class="throbber svelte-61xipn" src="https://upload.wikimedia.org/wikipedia/commons/7/7a/Ajax_loader_metal_512.gif"/>'),Gd=N('<p class="current-line svelte-61xipn"> </p>'),Yd=N('<!> <!> <span class="svelte-61xipn"><span class="main-subtitles svelte-61xipn"></span> <p class="full-translate svelte-61xipn"> </p> <button class="show-translations-btn svelte-61xipn">Show translations</button></span>',1);function Qn(r,e){Ie(e,!0);const t=ye(e,"currentLine",3,"Play the video to see live subtitles. Click on an individual word for a definition!"),s=ye(e,"targetLanguage",3,""),n=ye(e,"nativeLanguage",3,"en");let a="",i=j(W(a.term)),o=j(W(a.definition)),l=j(W(a.partOfSpeech)),c=j(W(a.original)),d=j(W(a.translated)),h=j(W(a.romanisation)),f=!0,p=j(W([])),v=j(!0);Se(()=>{const G=new Intl.Segmenter("zh",{granularity:"word"});_(p,[...G.segment(t())].map(F=>F.segment),!0),m(t())});async function k(G,F){_(v,!1),console.log("Fetching definition for ",G);try{const P=F.join(" "),D=await(await fetch("/.netlify/functions/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:"Translate this word based of context. Return no tags, no markup, just raw JSON with keys `word` (original), `partOfSpeech`, `romanisation` and `definition` (meaning based off context and also simple, normal person-readable info about conjugation) but ONLY return `romanisation` where it is not necessary. For example non-Latin scripts",word:G,context:P,originalWordLanguageISO6391:s(),translatedWordLanguageISO6391:n()})})).json(),R=JSON.parse(D.reply);console.log(R),_(v,!0),_(i,R.word,!0),_(o,R.definition,!0),_(l,R.partOfSpeech,!0),_(h,R.romanisation,!0)}catch(P){console.error(P)}}async function m(G,F,P){try{const D=await(await fetch("/.netlify/functions/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:"Translate this sentence and return no tags, no markup, just raw JSON with keys `original` and `translated` }",originalSentence:P,originalSentenceLanguageISO6391:G,translatedSentenceLanguageISO6391:F})})).json(),R=JSON.parse(D.reply);console.log(R),_(c,R.original,!0),_(d,R.translated,!0)}catch($){console.error($)}}async function T(){const G=document.getElementsByClassName("full-translate"),F=document.getElementsByClassName("show-translations-btn");f=!f,Array.from(G).forEach(P=>{f===!0?P.style.display="block":P.style.display="none"}),Array.from(F).forEach(P=>{f===!0?P.style.display="none":P.style.display="block"})}var I=Yd(),O=je(I);{var E=G=>{var F=Kd();L(G,F)};ce(O,G=>{u(v)||G(E)})}var x=y(O,2);vo(x,{get word(){return u(i)},get definition(){return u(o)},get partOfSpeech(){return u(l)},get romanisation(){return u(h)},get language(){return s()}});var S=y(x,2),A=w(S);Me(A,21,()=>u(p),Ce,(G,F)=>{var P=Gd(),$=w(P);de(()=>te($,u(F))),et("click",P,()=>k(u(F),u(p))),L(G,P)});var C=y(A,2),M=w(C),K=y(C,2);de(()=>te(M,u(d))),et("click",C,()=>T()),et("click",K,()=>T()),L(r,I),Re()}var Qd=N('<span class="author-tag svelte-2mqmtf"><span class="material-symbols-rounded svelte-2mqmtf">person</span> <span class="author-text-container svelte-2mqmtf"><p class="svelte-2mqmtf">Uploaded by:</p> <p class="author svelte-2mqmtf"> </p></span></span>');function po(r,e){Ie(e,!0);let t=ye(e,"author",7,"Loading...");t()&&t(t().slice(0,17)+"...");var s=Qd(),n=y(w(s),2),a=y(w(n),2),i=w(a);de(()=>te(i,t())),L(r,s),Re()}function Zd(r,e){if(r instanceof RegExp)return{keys:!1,pattern:r};var t,s,n,a,i=[],o="",l=r.split("/");for(l[0]||l.shift();n=l.shift();)t=n[0],t==="*"?(i.push("wild"),o+="/(.*)"):t===":"?(s=n.indexOf("?",1),a=n.indexOf(".",1),i.push(n.substring(1,~s?s:~a?a:n.length)),o+=~s&&!~a?"(?:/([^/]+?))?":"/([^/]+?)",~a&&(o+=(~s?"?":"")+"\\"+n.substring(a))):o+="/"+n;return{keys:i,pattern:new RegExp("^"+o+"/?$","i")}}function Ga(){const r=window.location.href.indexOf("#/");let e=r>-1?window.location.href.substr(r+1):"/";const t=e.indexOf("?");let s="";return t>-1&&(s=e.substr(t+1),e=e.substr(0,t)),{location:e,querystring:s}}const Zn=Fi(null,function(e){e(Ga());const t=()=>{e(Ga())};return window.addEventListener("hashchange",t,!1),function(){window.removeEventListener("hashchange",t,!1)}}),zr=Wi(Zn,r=>r.location);Wi(Zn,r=>r.querystring);const Ya=Bi(void 0);function Xd(r){r?window.scrollTo(r.__svelte_spa_router_scrollX,r.__svelte_spa_router_scrollY):window.scrollTo(0,0)}function eh(r,e){Ie(e,!1);let t=ye(e,"routes",24,()=>({})),s=ye(e,"prefix",8,""),n=ye(e,"restoreScrollState",8,!1);class a{constructor(S,A){if(!A||typeof A!="function"&&(typeof A!="object"||A._sveltesparouter!==!0))throw Error("Invalid component object");if(!S||typeof S=="string"&&(S.length<1||S.charAt(0)!="/"&&S.charAt(0)!="*")||typeof S=="object"&&!(S instanceof RegExp))throw Error('Invalid value for "path" argument - strings must start with / or *');const{pattern:C,keys:M}=Zd(S);this.path=S,typeof A=="object"&&A._sveltesparouter===!0?(this.component=A.component,this.conditions=A.conditions||[],this.userData=A.userData,this.props=A.props||{}):(this.component=()=>Promise.resolve(A),this.conditions=[],this.props={}),this._pattern=C,this._keys=M}match(S){if(s()){if(typeof s()=="string")if(S.startsWith(s()))S=S.substr(s().length)||"/";else return null;else if(s()instanceof RegExp){const K=S.match(s());if(K&&K[0])S=S.substr(K[0].length)||"/";else return null}}const A=this._pattern.exec(S);if(A===null)return null;if(this._keys===!1)return A;const C={};let M=0;for(;M<this._keys.length;){try{C[this._keys[M]]=decodeURIComponent(A[M+1]||"")||null}catch{C[this._keys[M]]=null}M++}return C}async checkConditions(S){for(let A=0;A<this.conditions.length;A++)if(!await this.conditions[A](S))return!1;return!0}}const i=[];t()instanceof Map?t().forEach((x,S)=>{i.push(new a(S,x))}):Object.keys(t()).forEach(x=>{i.push(new a(x,t()[x]))});let o=kr(null),l=kr(null),c=kr({});const d=ac();async function h(x,S){await Ii(),d(x,S)}let f=null,p=null;n()&&(p=x=>{x.state&&(x.state.__svelte_spa_router_scrollY||x.state.__svelte_spa_router_scrollX)?f=x.state:f=null},window.addEventListener("popstate",p),ic(()=>{Xd(f)}));let v=null,k=null;const m=Zn.subscribe(async x=>{v=x;let S=0;for(;S<i.length;){const A=i[S].match(x.location);if(!A){S++;continue}const C={route:i[S].path,location:x.location,querystring:x.querystring,userData:i[S].userData,params:A&&typeof A=="object"&&Object.keys(A).length?A:null};if(!await i[S].checkConditions(C)){_(o,null),k=null,h("conditionsFailed",C);return}h("routeLoading",Object.assign({},C));const M=i[S].component;if(k!=M){M.loading?(_(o,M.loading),k=M,_(l,M.loadingParams),_(c,{}),h("routeLoaded",Object.assign({},C,{component:u(o),name:u(o).name,params:u(l)}))):(_(o,null),k=null);const K=await M();if(x!=v)return;_(o,K&&K.default||K),k=M}A&&typeof A=="object"&&Object.keys(A).length?_(l,A):_(l,null),_(c,i[S].props),h("routeLoaded",Object.assign({},C,{component:u(o),name:u(o).name,params:u(l)})).then(()=>{Ya.set(u(l))});return}_(o,null),k=null,Ya.set(void 0)});sc(()=>{m(),p&&window.removeEventListener("popstate",p)}),kl(()=>Di(n()),()=>{history.scrollRestoration=n()?"manual":"auto"}),Sl(),Wn();var T=Ft(),I=je(T);{var O=x=>{var S=Ft(),A=je(S);ha(A,()=>u(o),(C,M)=>{M(C,ya({get params(){return u(l)}},()=>u(c),{$$events:{routeEvent(K){ma.call(this,e,K)}}}))}),L(x,S)},E=x=>{var S=Ft(),A=je(S);ha(A,()=>u(o),(C,M)=>{M(C,ya(()=>u(c),{$$events:{routeEvent(K){ma.call(this,e,K)}}}))}),L(x,S)};ce(I,x=>{u(l)?x(O):x(E,!1)})}L(r,T),Re()}var th=Bn(N('<script src="https://www.youtube.com/iframe_api"><\/script><!>',1)),rh=N('<main class="route svelte-bcry69"><!> <section class="main-page svelte-bcry69"><h1 class="page-header svelte-bcry69">Music</h1> <section class="main-content svelte-bcry69"><span class="heading svelte-bcry69"><!> <!></span> <iframe id="player" frameborder="0" allowfullscreen="" class="svelte-bcry69"></iframe> <!></section></section></main>');function sh(r,e){Ie(e,!0);const t=()=>Dr(zr,"$location",s),[s,n]=$r();let a=j(W(t().split("/").pop())),i,o=j("Loading..."),l=j("Loading..."),c=j("Loading..."),d=j("https://img.youtube.com/vi/loquela/maxresdefault.jpg"),h=j("Unknown Level"),f=j("No Rating"),p=j(""),v=j(W([])),k=j(void 0),m=j("https://youtu.be/zabswqP6xEM");Se(()=>{const P=t().split("/").pop();P!=u(a)&&_(a,P,!0),T().then(()=>{window.YT?O():window.onYouTubeIframeAPIReady=O})}),tt(()=>{fetchLanguages()});async function T(){const{data:P,error:$}=await he.from("media").select("*").eq("id",u(a)).single();if(P){const D=P;_(o,D.name,!0),_(l,D.artist,!0),_(c,D.author_username,!0),_(d,D.cover,!0),_(h,D.level,!0),_(f,D.rating,!0),_(p,D.language,!0),_(m,D.embed_link,!0),_(v,D.content.events,!0),console.log(u(v)),console.log(`${u(m)}?enablejsapi=1`)}else _(o,"Unknown Song"),_(l,"Unknown Artist"),_(d,"https://img.youtube.com/vi/loquela/maxresdefault.jpg"),_(h,"Unknown Level"),_(f,"No Rating"),_(m,"https://youtu.be/zabswqP6xEM")}function I(P){let $=0;u(v).forEach(D=>{P>D.tStartMs&&P<u(v)[$+1].tStartMs&&D.segs.forEach(R=>{u(k)!==R.utf8&&_(k,R.utf8,!0)}),$++})}function O(){i=new YT.Player("player",{events:{onReady:()=>{setInterval(()=>{const P=i.getCurrentTime(),$=Math.round(P*1e3);I($)},1)}}})}var E=rh();Fn(P=>{var $=th();y(je($)),L(P,$)});var x=w(E);St(x,{currentPage:"/music"});var S=y(x,2),A=y(w(S),2),C=w(A),M=w(C);fo(M,{get song(){return u(o)},get artist(){return u(l)}});var K=y(M,2);po(K,{get author(){return u(c)}});var G=y(C,2),F=y(G,2);Qn(F,{get currentLine(){return u(k)},get targetLanguage(){return u(p)}}),de(()=>{Ue(G,"src",`${u(m)}?enablejsapi=1`),Ue(G,"title",u(o))}),L(r,E),Re(),n()}var nh=N('<option class="svelte-1xupfpx"> </option>'),ah=N('<option class="svelte-1xupfpx"> </option>'),ih=N('<span class="svelte-1xupfpx"><label for="language">* Select further detail:</label> <select class="language svelte-1xupfpx" required><option class="svelte-1xupfpx">--Select--</option><!></select></span>'),oh=N('<option class="svelte-1xupfpx"> </option>'),lh=N('<main class="route  svelte-1xupfpx"><!> <section class="main-page"><h1 class="page-header">Upload</h1> <section class="notice svelte-1xupfpx"><h3 class="notice-text svelte-1xupfpx">Notice</h3> <p class="notice-text svelte-1xupfpx">Please ensure video has subtitles enabled by creator!</p></section> <section class="main-content svelte-1xupfpx"><form class="svelte-1xupfpx"><div class="vertical-container svelte-1xupfpx"><span class="svelte-1xupfpx"><label for="media">* Select media type:</label> <select class="media svelte-1xupfpx" required><option class="svelte-1xupfpx">--Pick the medium category--</option><option class="svelte-1xupfpx">ðº YT Video</option><option class="svelte-1xupfpx">ð§ Music</option></select></span> <span class="svelte-1xupfpx"><label for="language">* Select language of content:</label> <select class="language svelte-1xupfpx" required><option class="svelte-1xupfpx">--Select language--</option><!></select></span> <!> <span class="svelte-1xupfpx"><label for="level">* Select level of content:</label> <select class="level svelte-1xupfpx" required><option class="svelte-1xupfpx">--Select a level--</option><option class="svelte-1xupfpx">ð£ A1</option><option class="svelte-1xupfpx">ð¥ A2</option><option class="svelte-1xupfpx">ð¦ B1</option><option class="svelte-1xupfpx">ð¦ B2</option><option class="svelte-1xupfpx">ð¦ C1</option><option class="svelte-1xupfpx">ð¦ C2</option></select></span> <span class="svelte-1xupfpx"><label for="category">* Select category of content:</label> <select class="category svelte-1xupfpx" required><option class="svelte-1xupfpx">--Select category--</option><!></select></span></div> <span class="svelte-1xupfpx"><label for="url">Link to medium:</label> <input class="url svelte-1xupfpx" type="url" placeholder="Enter media URL"/></span> <button type="submit" class="push-btn svelte-1xupfpx"><span class="front-push-btn svelte-1xupfpx">Upload</span></button> <!></form></section></section></main>');function ch(r,e){Ie(e,!0);let t=j(W({name:"",type:""})),s="",n="",a=j(""),i=j(""),o="",l="",c=j(W([])),d=j(W([])),h=j(""),f=j(""),p=j(void 0),v=j(void 0);Se(()=>{var ee;_(p,u(c).find(oe=>oe.short===u(a)),!0),_(v,(ee=u(p))==null?void 0:ee.sub_options,!0),console.log(u(v))});async function k(){const{data:ee,error:oe}=await he.from("categories").select("*");_(d,ee,!0)}k();function m(){Ur({particleCount:600,spread:100,origin:{y:0}})}tt(async()=>{S(),T()});async function T(){const{data:ee,error:oe}=await he.from("languages").select("*");if(ee)return _(c,ee,!0),console.log(u(c)),ee;if(oe)throw oe}async function I(ee,oe,ve,U,Q){try{if(await E(oe)){_(t,{type:"warn",name:"This has already been uploaded"},!0);return}ee==="video"||ee==="music"?(await O(oe,ve,ee,U,Q),_(t,{type:"success",name:"Beginning upload..."},!0),m()):_(t,{type:"error",name:"Error in link validation"},!0)}catch(ge){console.error("Upload error:",ge),_(t,{type:"error",name:"Error in upload process"},!0)}}async function O(ee,oe,ve,U,Q){const ge=he.channel("subtitles");await ge.subscribe();const Ae=await ge.send({type:"broadcast",event:"subtitle-update",payload:{id:1,url:ee,lang:oe,type:ve,level:U,author:u(h),author_username:u(f),category:Q}});console.log("Broadcast result:",Ae)}async function E(ee){const{data:oe,error:ve}=await he.from("media").select("*").eq("video_link",ee).single();if(ve){if(ve.details&&ve.details.includes("0 rows"))return!1;console.error("Database error:",ve)}return!!oe}async function x(ee,oe,ve,U,Q){try{const ge=await fetch(`https://www.youtube.com/oembed?url=${encodeURIComponent(ee)}&format=json`);return console.log(ge),console.log(ee),!ge.ok||!ee.startsWith("https://www.youtube.com/watch?v=")?(_(t,{type:"error",name:"Invalid URL. Must be in format 'https://www.youtube.com/watch?v='"},!0),!1):(await I(oe,ee,ve,U,Q),!0)}catch(ge){return console.error("Validation error:",ge),_(t,{type:"error",name:"Error validating URL"},!0),!1}}async function S(){const{data:ee,error:oe}=await he.auth.getSession(),ve=ee;if(oe)console.error("Error fetching session:",oe);else if(ve){_(h,ve.session.user.id,!0);const{data:U,error:Q}=await he.from("profiles").select("username").eq("user_id",u(h)).single();U&&_(f,U.username,!0),Q&&console.log(Q)}oe&&console.error("Error fetching userID:",oe)}Se(()=>{u(i)?_(i,u(i),!0):_(i,u(a),!0)});var A=lh(),C=w(A);St(C,{currentPage:"/upload"});var M=y(C,2),K=y(w(M),4),G=w(K),F=w(G),P=w(F),$=y(w(P),2),D=w($);D.value=D.__value="";var R=y(D);R.value=R.__value="video";var Z=y(R);Z.value=Z.__value="music";var re=y(P,2),me=y(w(re),2),b=w(me);b.value=b.__value="";var g=y(b);Me(g,17,()=>u(c),Ce,(ee,oe)=>{var ve=nh(),U=w(ve),Q={};de(()=>{te(U,`${u(oe).emoji??""} ${u(oe).name??""}`),Q!==(Q=u(oe).short)&&(ve.value=(ve.__value=u(oe).short)??"")}),L(ee,ve)});var z=y(re,2);{var q=ee=>{var oe=ih(),ve=y(w(oe),2),U=w(ve);U.value=U.__value="";var Q=y(U);Me(Q,17,()=>u(v),Ce,(ge,Ae)=>{var ke=ah(),$e=w(ke),Pe={};de(()=>{te($e,u(Ae).name),Pe!==(Pe=u(Ae).codes)&&(ke.value=(ke.__value=u(Ae).codes)??"")}),L(ge,ke)}),He(ve,()=>u(i),ge=>_(i,ge)),L(ee,oe)};ce(z,ee=>{u(a).length>1&&ee(q)})}var B=y(z,2),H=y(w(B),2),X=w(H);X.value=X.__value="";var J=y(X);J.value=J.__value="A1";var ie=y(J);ie.value=ie.__value="A2";var V=y(ie);V.value=V.__value="B1";var Y=y(V);Y.value=Y.__value="B2";var ae=y(Y);ae.value=ae.__value="C1";var se=y(ae);se.value=se.__value="C2";var ue=y(B,2),ne=y(w(ue),2),Oe=w(ne);Oe.value=Oe.__value="";var Le=y(Oe);Me(Le,17,()=>u(d),Ce,(ee,oe)=>{var ve=oh(),U=w(ve),Q={};de(()=>{te(U,`${u(oe).emoji??""} ${u(oe).name??""}`),Q!==(Q=u(oe).name)&&(ve.value=(ve.__value=u(oe).name)??"")}),L(ee,ve)});var De=y(F,2),ze=y(w(De),2),Be=y(De,4);{var qe=ee=>{At(ee,{get type(){return u(t).type},get message(){return u(t).name},width:"17em"})};ce(Be,ee=>{u(t).name&&ee(qe)})}et("submit",G,ee=>{ee.preventDefault(),x(n,s,u(i),o,l)}),He($,()=>s,ee=>s=ee),He(me,()=>u(a),ee=>_(a,ee)),He(H,()=>o,ee=>o=ee),He(ne,()=>l,ee=>l=ee),gt(ze,()=>n,ee=>n=ee),L(r,A),Re()}var uh=N('<section class="svelte-i5t88f"><span class="text-container svelte-i5t88f"><a class="svelte-i5t88f"><h1 class="name svelte-i5t88f"> </h1></a> <p class="terms svelte-i5t88f"> </p> <p class="author svelte-i5t88f"> </p></span> <span class="language-image-container svelte-i5t88f"><img class="svelte-i5t88f"/></span></section>');function dh(r,e){var t=uh(),s=w(t),n=w(s),a=w(n),i=w(a),o=y(n,2),l=w(o),c=y(o,2),d=w(c),h=y(s,2),f=w(h);de(()=>{Ue(n,"href",`#/app/flashcards/${e.id}`),te(i,e.name),te(l,`Terms: ${e.terms??""}`),te(d,`@${e.author??""}`),Ue(f,"src",`https://hatscripts.github.io/circle-flags/flags/${e.country??""}.svg`)}),L(r,t)}var hh=N('<p class="not-found svelte-3pf8ly">:/ Oops! No flashcards found; try uploading your own or try again later.</p>'),fh=N("<option> </option>"),vh=N('<main class="route svelte-3pf8ly"><!> <section class="main-page"><h1 class="page-header svelte-3pf8ly">Flashcards</h1> <section class="main-content svelte-3pf8ly"><button class="create-flashcard-deck svelte-3pf8ly">+ Create Flashcard Deck</button> <section class="flashcard-decks svelte-3pf8ly"><!> <!></section></section></section></main> <dialog class="svelte-3pf8ly"><div class="dialog-container svelte-3pf8ly"><div><h2 class="svelte-3pf8ly">Create Flashcard Deck</h2> <h1 class="svelte-3pf8ly"> </h1> <form class="svelte-3pf8ly"><span class="svelte-3pf8ly"><label>Deck name:</label> <input class="name svelte-3pf8ly"/></span> <span class="svelte-3pf8ly"><label>Language:</label> <select class="language svelte-3pf8ly"><option>--Select language--</option><!></select></span> <input class="submit-btn svelte-3pf8ly" type="Submit"/></form></div> <button class="close-dialog-button svelte-3pf8ly">Close</button></div></dialog>',1);function ph(r,e){Ie(e,!0);let t,s,n,a=j(W([])),i=j(void 0),o=j(""),l=j(W([]));tt(async()=>{h(),c(),t.close()}),Se(async()=>{if(u(i)){const{data:b,error:g}=await he.from("flashcard_decks").select("*");g&&console.error("Error fetching flashcard decks:",g),_(l,b||[],!0),console.log(u(l))}});async function c(){const{data:b,error:g}=await he.from("languages").select("*");if(b)return _(a,b,!0),console.log(u(a)),b;if(g)throw g}async function d(b,g,z,q,B){const{error:H}=await he.from("flashcard_decks").insert({name:b,author:g,author_username:B,language:z,country_code:q,content:[]});console.log(H),location.reload()}async function h(){const{data:b,error:g}=await he.auth.getSession(),z=b;if(g)console.error("Error fetching session:",g);else if(z){_(i,z.session.user.id,!0);const{data:q,error:B}=await he.from("profiles").select("username").eq("user_id",u(i)).single();q&&_(o,q.username,!0),B&&console.log(B)}}var f=vh(),p=je(f),v=w(p);St(v,{currentPage:"/flashcards"});var k=y(v,2),m=y(w(k),2),T=w(m);T.__click=()=>t.showModal();var I=y(T,2),O=w(I);{var E=b=>{var g=hh();L(b,g)};ce(O,b=>{u(l)[0]||b(E)})}var x=y(O,2);Me(x,17,()=>u(l),Ce,(b,g)=>{dh(b,{get name(){return u(g).name},get author(){return u(g).author_username},get terms(){return u(g).content.length},get country(){return u(g).country_code},get id(){return u(g).id}})});var S=y(p,2),A=w(S),C=w(A),M=y(w(C),2),K=w(M),G=y(M,2),F=w(G),P=y(w(F),2),$=y(F,2),D=y(w($),2),R=w(D);R.value=R.__value="";var Z=y(R);{var re=b=>{var g=Ft(),z=je(g);Me(z,17,()=>u(a),Ce,(q,B,H)=>{var X=fh(),J=w(X);X.value=X.__value=H,de(()=>te(J,`${u(B).emoji??""} ${u(B).name??""}`)),L(q,X)}),L(b,g)};ce(Z,b=>{u(a)&&b(re)})}var me=y(C,2);me.__click=()=>t.close(),ft(S,b=>t=b,()=>t),de(()=>te(K,u(a)[n])),et("submit",G,b=>{d(s,u(i),u(a)[n].short,u(a)[n].country_code,u(o))}),gt(P,()=>s,b=>s=b),He(D,()=>n,b=>n=b),L(r,f),Re()}or(["click"]);function gh(r,e){e().forEach(t=>{const s=document.getElementsByClassName(t);s&&Array.from(s).forEach(n=>{n.classList.remove("hidden")})})}function _h(r,e,t,s){e.content[u(t)]&&(u(s).push(e.content[u(t)]),pi(t))}function mh(r,e,t,s,n,a){e.content[u(t)]&&(u(s).push(e.content[u(t)]),pi(t)),u(n)===100&&a()}function yh(r,e,t,s,n){_(e,0),_(t,[],!0),u(s).forEach(a=>{n.content.splice(n.content.indexOf(a),1)}),_(s,[],!0)}var wh=N('<div class="title-author-container svelte-baker"><h1 class="deck-name-heading svelte-baker"> </h1> <p class="deck-name-author svelte-baker">Uploaded by: <b> </b></p></div>'),bh=N('<i><p class="romanisation svelte-baker"> </p></i>'),kh=N('<span class="card-count-container svelte-baker"><span class="unsure-count card-count svelte-baker"> </span> <span class="known-count card-count svelte-baker"> </span></span> <div class="flashcard svelte-baker"><h1 class="word svelte-baker"> </h1> <span class="word-details svelte-baker"><!> <p class="part-of-speech svelte-baker"> </p></span> <p class="definition svelte-baker"> </p></div> <span class="buttons svelte-baker"><button class="dont-know flashcard-button svelte-baker"><span class="material-symbols-rounded svelte-baker">do_not_disturb</span>Unsure</button> <button class="flip flashcard-button svelte-baker"><span class="material-symbols-rounded svelte-baker">autorenew</span>Flip</button> <button class="know flashcard-button svelte-baker"><span class="material-symbols-rounded svelte-baker">check_circle</span>Know</button></span>',1),Sh=N('<button class="flashcard-continue svelte-baker"><span class="material-symbols-rounded svelte-baker">expand_circle_right</span> Continue with unknown terms</button>'),Eh=N('<p class="svelte-baker">Congratulations! You know all the terms in this deck!</p>'),xh=N('<div class="flashcard svelte-baker"><p class="known-percentage svelte-baker"> </p> <!> <!></div>'),Th=N('<main class="svelte-baker"><!> <!> <!></main>');function Oh(r,e){Ie(e,!0);const t=ye(e,"backContent",19,()=>[]),s=ye(e,"author",3,"");let n=j(0),a=j(W([])),i=j(W([])),o="",l=j(W(o.word)),c=j(W(o.definition)),d=j(W(o.partOfSpeech)),h=j(W(o.romanisation)),f=j(0);Se(()=>{_(f,Math.round(u(i).length/(u(a).length+u(i).length)*100),!0)}),console.log(e.content),tt(()=>{Se(()=>{if(e.content&&Array.isArray(e.content)&&e.content[u(n)]){const S=JSON.parse(e.content[u(n)]);console.log(S),_(l,S.word,!0),_(c,S.definition,!0),_(d,S.partOfSpeech,!0),_(h,S.romanisation,!0),p()}})});function p(){t().forEach(S=>{const A=document.getElementsByClassName(S);A&&Array.from(A).forEach(C=>{C.classList.add("hidden")})})}function v(){Ur({particleCount:200,spread:70,origin:{y:0}})}var k=Th(),m=w(k);{var T=S=>{var A=wh(),C=w(A),M=w(C),K=y(C,2),G=y(w(K)),F=w(G);de(()=>{te(M,e.deckName),te(F,`@${s()??""}`)}),L(S,A)};ce(m,S=>{s()&&e.deckName&&S(T)})}var I=y(m,2);{var O=S=>{var A=kh(),C=je(A),M=w(C),K=w(M),G=y(M,2),F=w(G),P=y(C,2),$=w(P),D=w($),R=y($,2),Z=w(R);{var re=J=>{var ie=bh(),V=w(ie),Y=w(V);de(()=>te(Y,u(h))),L(J,ie)};ce(Z,J=>{u(h)&&J(re)})}var me=y(Z,2),b=w(me),g=y(R,2),z=w(g),q=y(P,2),B=w(q);B.__click=[_h,e,n,a];var H=y(B,2);H.__click=[gh,t];var X=y(H,2);X.__click=[mh,e,n,i,f,v],de(()=>{te(K,u(a).length),te(F,u(i).length),te(D,u(l)),te(b,u(d)),te(z,u(c))}),L(S,A)};ce(I,S=>{u(n)!==e.content.length&&S(O)})}var E=y(I,2);{var x=S=>{var A=xh(),C=w(A),M=w(C),K=y(C,2);{var G=$=>{var D=Sh();D.__click=[yh,n,a,i,e],L($,D)};ce(K,$=>{u(f)!==100&&$(G)})}var F=y(K,2);{var P=$=>{var D=Eh();L($,D)};ce(F,$=>{u(f)===100&&$(P)})}de(()=>te(M,`Known: ${u(f)??""}%`)),L(S,A)};ce(E,S=>{u(n)===e.content.length&&S(x)})}L(r,k),Re()}or(["click"]);var jh=N("<h3>Oops! Looks like there are no cards in this deck. Try going to a video, song or AI Chat and add some!</h3>"),Ah=N('<main class="route svelte-967ptl"><!> <section class="main-page"><h1 class="page-header">Flashcards</h1> <section class="main-content svelte-967ptl"><!> <!></section></section></main>');function Ph(r,e){Ie(e,!0);const t=()=>Dr(zr,"$location",s),[s,n]=$r();let a=W(t().split("/").pop()),i=j(W([])),o=j(0),l="",c=j(W(l.flashcardDeckName)),d=j(W(l.flashcardDeckAuthor));tt(async()=>{const E=await h(a);E?(_(c,E.name,!0),_(d,E.author_username,!0),_(i,E.content,!0),_(o,u(i).length,!0),console.log(u(o))):console.error("Flashcards not found")});async function h(E){const{data:x,error:S}=await he.from("flashcard_decks").select("*").eq("id",E).single();if(S){console.error(S);return}return x}var f=Ah(),p=w(f);St(p,{currentPage:"/flashcards"});var v=y(p,2),k=y(w(v),2),m=w(k);{var T=E=>{Oh(E,{get content(){return u(i)},backContent:["part-of-speech","definition"],get deckName(){return u(c)},get author(){return u(d)}})};ce(m,E=>{u(i)&&u(i).length>0&&E(T)})}var I=y(m,2);{var O=E=>{var x=jh();L(E,x)};ce(I,E=>{!u(i).length>0&&E(O)})}L(r,f),Re(),n()}var Ch=N("<option> </option>"),Mh=N("<option> </option>"),Ih=N('<span><label for="language">Select further detail:</label> <select class="language svelte-yxunt" required><option>--Select--</option><!></select></span>'),Rh=N("<p>Try selecting a language to show media. If no languages show up, come back later as the servers may be down.</p>"),Dh=N('<h1 class="category-title svelte-yxunt"> </h1> <section class="category-section svelte-yxunt"></section>',1),$h=N('<main class="route svelte-yxunt"><!> <section class="main-page"><h1 class="page-header">Videos</h1> <section class="main-content svelte-yxunt"><select class="language-select svelte-yxunt"></select> <!> <section class="media-container svelte-yxunt"><!> <!> <section class="categories-section svelte-yxunt"></section></section></section></section></main>');function Lh(r,e){Ie(e,!0);let t=j(W([])),s=j(W([])),n="",a=j(""),i=j(""),o=j(""),l=j(""),c=j(W({}));async function d(){const{data:P,error:$}=await he.from("categories").select("*");_(l,P,!0)}tt(()=>{d()}),Se(()=>{console.log(u(l))});async function h(P){const{data:$,error:D}=await he.from("media").select("*").eq("language",P).eq("media_type","video");D?console.error("Error fetching videos:",D):(console.log(u(t)),console.log($),$.forEach(R=>{u(t).push(R||[])}),console.log(u(t)),_(c,[],!0),await p(u(t)))}function f(P){const $=u(l).find(D=>D.name===P);return $?$.emoji:"ð·ï¸"}async function p(P){P.forEach($=>{if($){let D=$.category;D||(D="Uncategorised"),!u(c)[D]&&D&&(u(c)[D]=[]),u(c)[D].push($)}console.log(u(c))})}Se(()=>{console.log(u(t))});async function v(){const{data:P,error:$}=await he.from("languages").select("*");if(P)return _(s,P,!0),console.log(u(s)),P;if($)throw $}tt(()=>{v()}),Se(()=>{_(t,[],!0),Array.isArray(u(a))&&u(a).forEach(P=>{console.log(P),h(P)})});let k=j(void 0),m=j(void 0);Se(()=>{var P;_(k,u(s).find($=>$.short===u(i)),!0),_(m,(P=u(k))==null?void 0:P.sub_options,!0),console.log(u(m))}),Se(()=>{u(i).length===1?_(a,u(i),!0):_(a,u(o),!0)});var T=$h(),I=w(T);St(I,{currentPage:"/videos"});var O=y(I,2),E=y(w(O),2),x=w(E);Me(x,21,()=>u(s),Ce,(P,$,D,R)=>{var Z=Ch(),re=w(Z),me={};de(()=>{te(re,`${u($).emoji??""} ${u($).name??""}`),me!==(me=u($).short)&&(Z.value=(Z.__value=u($).short)??"")}),L(P,Z)});var S=y(x,2);{var A=P=>{var $=Ih(),D=y(w($),2),R=w(D);R.value=R.__value="";var Z=y(R);Me(Z,17,()=>u(m),Ce,(re,me)=>{var b=Mh(),g=w(b),z={};de(()=>{te(g,u(me).name),z!==(z=u(me).codes)&&(b.value=(b.__value=u(me).codes)??"")}),L(re,b)}),He(D,()=>u(o),re=>_(o,re)),L(P,$)};ce(S,P=>{u(i).length>1&&P(A)})}var C=y(S,2),M=w(C);ce(M,P=>{u(t)[0]});var K=y(M,2);{var G=P=>{var $=Rh();L(P,$)};ce(K,P=>{u(i)||P(G)})}var F=y(K,2);Me(F,21,()=>Object.entries(u(c)),Ce,(P,$,D,R)=>{var Z=jr(()=>jo(u($),2));let re=()=>u(Z)[0],me=()=>u(Z)[1];var b=Dh(),g=je(b),z=w(g),q=y(g,2);Me(q,21,me,Ce,(B,H)=>{{let X=jr(()=>`#/app/videos/${u(H).id}`);ho(B,{get name(){return u(H).name},get artist(){return u(H).artist},get cover(){return u(H).cover},get level(){return u(H).level},get rating(){return u(H).rating},get link(){return u(X)},type:"video"})}}),de(B=>te(z,`${B??""} ${re()??""}`),[()=>f(re())]),L(P,b)}),He(x,()=>u(i),P=>_(i,P)),L(r,T),Re()}var Uh=Bn(N('<script src="https://www.youtube.com/iframe_api"><\/script><!>',1)),zh=N("<p>Oops. Loquelis is struggling to the media - it may be invalid or unavailable.</p>"),qh=N('<main class="route svelte-1ml0pbe"><!> <section class="main-page svelte-1ml0pbe"><h1 class="page-header svelte-1ml0pbe">Videos</h1> <section class="main-content svelte-1ml0pbe"><span class="heading svelte-1ml0pbe"><!> <!></span> <iframe id="player" frameborder="0" allowfullscreen="" class="svelte-1ml0pbe"></iframe> <!> <!></section></section></main>');function Nh(r,e){Ie(e,!0);const t=()=>Dr(zr,"$location",s),[s,n]=$r();let a=j(W(t().split("/").pop())),i,o=j("Loading..."),l=j("Loading..."),c=j("Loading..."),d=j("Loading..."),h=j("https://img.youtube.com/vi/loquela/maxresdefault.jpg"),f=j("Unknown Level"),p=j("No Rating"),v=j(""),k=j(W([])),m=j(void 0),T=j("https://youtu.be/zabswqP6xEM");Se(()=>{const R=t().split("/").pop();R!=u(a)&&_(a,R,!0),I().then(()=>{window.YT?E():window.onYouTubeIframeAPIReady=E})});async function I(){const{data:R,error:Z}=await he.from("media").select("*").eq("id",u(a)).single();if(R){const re=R;_(o,re.name,!0),_(d,re.artist,!0),_(l,re.author_username,!0),_(c,re.author_username,!0),_(h,re.cover,!0),_(f,re.level,!0),_(p,re.rating,!0),_(v,re.language,!0),_(T,re.embed_link,!0),_(k,re.content.events,!0),console.log(u(k)),console.log(`${u(T)}?enablejsapi=1`)}else _(o,"Unknown Video"),_(d,"Unknown Artist"),_(h,"https://img.youtube.com/vi/loquela/maxresdefault.jpg"),_(f,"Unknown Level"),_(p,"No Rating"),_(T,"https://youtu.be/zabswqP6xEM")}function O(R){let Z=0;u(k).forEach(re=>{R>re.tStartMs&&R<u(k)[Z+1].tStartMs&&re.segs.forEach(me=>{u(m)!==me.utf8&&_(m,me.utf8,!0)}),Z++})}function E(){i=new YT.Player("player",{events:{onReady:()=>{setInterval(()=>{const R=i.getCurrentTime(),Z=Math.round(R*1e3);O(Z)},1)}}})}var x=qh();Fn(R=>{var Z=Uh();y(je(Z)),L(R,Z)});var S=w(x);St(S,{currentPage:"/videos"});var A=y(S,2),C=y(w(A),2),M=w(C),K=w(M);fo(K,{get song(){return u(o)},get artist(){return u(d)}});var G=y(K,2);po(G,{get author(){return u(l)}});var F=y(M,2),P=y(F,2);{var $=R=>{var Z=zh();L(R,Z)};ce(P,R=>{u(T)==="https://youtu.be/zabswqP6xEM"&&R($)})}var D=y(P,2);Qn(D,{get currentLine(){return u(m)},get targetLanguage(){return u(v)}}),de(()=>{Ue(F,"src",`${u(T)}?enablejsapi=1`),Ue(F,"title",u(o))}),L(r,x),Re(),n()}var Fh=N('<img class="svelte-1afzn3p"/>'),Bh=N('<section class="ai-chat-box svelte-1afzn3p"><div class="pfp-name-occupation-container svelte-1afzn3p"><!> <div class="text svelte-1afzn3p"><a class="svelte-1afzn3p"><h2 class="svelte-1afzn3p"> </h2></a> <p class="occupation svelte-1afzn3p"> </p></div></div> <div class="flag-tags-container svelte-1afzn3p"><img class="lang-flag svelte-1afzn3p"/> <span class="traits svelte-1afzn3p"><p class="trait-tag svelte-1afzn3p"> </p></span></div></section>');function Wh(r,e){var t=Bh(),s=w(t),n=w(s);{var a=T=>{var I=Fh();de(()=>{Ue(I,"src",e.image),Ue(I,"alt",e.firstName)}),L(T,I)};ce(n,T=>{e.image&&T(a)})}var i=y(n,2),o=w(i),l=w(o),c=w(l),d=y(o,2),h=w(d),f=y(s,2),p=w(f),v=y(p,2),k=w(v),m=w(k);de(()=>{Ue(o,"href",`/#/app/ai-chat/${e.id}`),te(c,e.firstName),te(h,e.occupation),Ue(p,"src",`https://hatscripts.github.io/circle-flags/flags/${e.lang}.svg`),Ue(p,"alt",e.lang),te(m,e.trait)}),L(r,t)}var Vh=(r,e)=>u(e).showModal(),Hh=N('<p class="not-found svelte-javkzk">:/ Oops! No flashcards found; try uploading your own or try again later.</p>'),Jh=N("<option> </option>"),Kh=N("<option> </option>"),Gh=N('<span><label for="language" class="svelte-javkzk">* Select further detail:</label> <select class="language svelte-javkzk" required><option>--Select--</option><!></select></span>'),Yh=N("<option> </option>"),Qh=N("<option> </option>"),Zh=(r,e)=>u(e).close(),Xh=N('<main class="route svelte-javkzk"><!> <section class="main-page"><h1 class="page-header">AI Chat</h1> <section class="main-content svelte-javkzk"><button class="create-ai-character svelte-javkzk"><span class="material-symbols-rounded svelte-javkzk">person_add</span>Create AI Character</button> <div class="chats svelte-javkzk"><!> <!></div></section></section></main> <dialog class="svelte-javkzk"><div class="dialog-container svelte-javkzk"><h2 class="dialog-header svelte-javkzk">Create AI Character</h2> <form class="svelte-javkzk"><label class="svelte-javkzk">ðªª Character name:</label> <input class="name svelte-javkzk" required/> <span class="label-input-container svelte-javkzk"><label class="svelte-javkzk">ð¬ Language:</label> <select class="language svelte-javkzk" required><option>--Select language--</option><!></select></span> <!> <span class="label-input-container svelte-javkzk"><label class="svelte-javkzk">ð Occupation:</label> <select class="occupation svelte-javkzk" required><option>--Select occupation--</option><!></select></span> <span class="label-input-container svelte-javkzk"><label class="svelte-javkzk">ð§  Trait:</label> <select class="traits svelte-javkzk" required><option>--Select trait--</option><!></select></span> <!> <input class="submit-btn svelte-javkzk" type="Submit"/></form> <button class="close-dialog-btn svelte-javkzk">Close</button></div></dialog>',1);function ef(r,e){Ie(e,!0),ye(e,"occupation",3,"Knight"),ye(e,"image",3,"https://image.pollinations.ai/prompt/Generate%20a%20pixar-style%20image%20of%20a%20knight%20called%20Hansel%20with%20traits%20of%20brave,%20adventurous%20who%20is%20dressed%20in%20traditional%20attire%20of%20German"),ye(e,"firstName",3,"Hansel"),ye(e,"trait",3,"Friendly"),ye(e,"lang",3,"de");let t="",s=j(W(t.characterName)),n=j(W(t.characterTrait)),a=j(W(t.characterOccupation)),i=j(W([])),o=j(W([])),l=j(null),c=j(W([])),d=W([]),h=W([]),f=j(W([])),p=j(W([])),v=j(W([])),k="",m=j(W(k.characterCreateStatus)),T=j(W(k.characterCreateMessage));tt(async()=>{await S(),await A(),O(),E(),I()});async function I(){const{data:U,error:Q}=await he.from("ai_characters").select("*").limit(20);U&&_(f,U,!0),Q&&console.error(Q)}function O(){Array.from(u(c)).forEach(U=>{console.log("gabo"),U.type==="occupation"?d.push(U.name):console.error("Error finding occupations")})}function E(){Array.from(u(c)).forEach(U=>{console.log("gabo"),U.type==="trait"?h.push(U.name):console.error("Error finding traits")})}async function x(U,Q,ge,Ae,ke){_(m,""),_(T,""),console.log(ke);const{error:$e}=await he.from("ai_characters").insert([{name:U,trait:Q,occupation:ge,language:Ae,country:ke,image:`https://image.pollinations.ai/prompt/Generate a pixar-style image of a ${ge} called ${U} with trait of ${Q} who is dressed in traditional attire of ${Ae}.`}]);$e||(_(m,"success"),_(T,"Created! Reload the page to see your character!")),$e&&(_(m,"error"),_(T,"Error adding character"),console.error($e))}async function S(){const{data:U,error:Q}=await he.from("languages").select("*");if(U)return _(o,U,!0),console.log(u(o)),U;if(Q)throw Q}async function A(){const{data:U,error:Q}=await he.from("character_fields").select("*");if(U)return _(c,U,!0),console.log(u(c)),U;if(Q)throw Q}let C=j(void 0),M=j(void 0),K=j("");Se(()=>{var U,Q;_(C,u(o).find(ge=>ge.short===u(i)),!0),_(M,(U=u(C))==null?void 0:U.sub_options,!0),_(K,(Q=u(C))==null?void 0:Q.country_code,!0),console.log(u(K))}),Se(()=>{u(i).length===1?_(p,u(i),!0):_(p,u(v),!0),console.log(u(p))});var G=Xh(),F=je(G),P=w(F);St(P,{currentPage:"/ai-chat"});var $=y(P,2),D=y(w($),2),R=w(D);R.__click=[Vh,l];var Z=y(R,2),re=w(Z);{var me=U=>{var Q=Hh();L(U,Q)};ce(re,U=>{u(f)[0]||U(me)})}var b=y(re,2);Me(b,17,()=>u(f),Ce,(U,Q)=>{Wh(U,{get id(){return u(Q).id},get image(){return u(Q).image},get firstName(){return u(Q).name},get trait(){return u(Q).trait},get lang(){return u(Q).country},get occupation(){return u(Q).occupation}})});var g=y(F,2),z=w(g),q=y(w(z),2),B=y(w(q),2),H=y(B,2),X=y(w(H),2),J=w(X);J.value=J.__value="";var ie=y(J);{var V=U=>{var Q=Ft(),ge=je(Q);Me(ge,17,()=>u(o),Ce,(Ae,ke)=>{var $e=Jh(),Pe=w($e),we={};de(()=>{te(Pe,`${u(ke).emoji??""} ${u(ke).name??""}`),we!==(we=u(ke).short)&&($e.value=($e.__value=u(ke).short)??"")}),L(Ae,$e)}),L(U,Q)};ce(ie,U=>{u(o)&&U(V)})}var Y=y(H,2);{var ae=U=>{var Q=Gh(),ge=y(w(Q),2),Ae=w(ge);Ae.value=Ae.__value="";var ke=y(Ae);Me(ke,17,()=>u(M),Ce,($e,Pe)=>{var we=Kh(),it=w(we),Je={};de(()=>{te(it,u(Pe).name),Je!==(Je=u(Pe).codes)&&(we.value=(we.__value=u(Pe).codes)??"")}),L($e,we)}),He(ge,()=>u(v),$e=>_(v,$e)),L(U,Q)};ce(Y,U=>{u(i).length>1&&U(ae)})}var se=y(Y,2),ue=y(w(se),2),ne=w(ue);ne.value=ne.__value="";var Oe=y(ne);{var Le=U=>{var Q=Ft(),ge=je(Q);Me(ge,17,()=>d,Ce,(Ae,ke,$e,Pe)=>{var we=Yh(),it=w(we),Je={};de(()=>{te(it,u(ke)),Je!==(Je=u(ke))&&(we.value=(we.__value=u(ke))??"")}),L(Ae,we)}),L(U,Q)};ce(Oe,U=>{d&&U(Le)})}var De=y(se,2),ze=y(w(De),2),Be=w(ze);Be.value=Be.__value="";var qe=y(Be);{var ee=U=>{var Q=Ft(),ge=je(Q);Me(ge,17,()=>h,Ce,(Ae,ke,$e,Pe)=>{var we=Qh(),it=w(we),Je={};de(()=>{te(it,u(ke)),Je!==(Je=u(ke))&&(we.value=(we.__value=u(ke))??"")}),L(Ae,we)}),L(U,Q)};ce(qe,U=>{h&&U(ee)})}var oe=y(De,2);At(oe,{get type(){return u(m)},get message(){return u(T)}});var ve=y(q,2);ve.__click=[Zh,l],ft(g,U=>_(l,U),()=>u(l)),et("submit",q,U=>{U.preventDefault(),x(u(s),u(n),u(a),u(p),u(K))}),gt(B,()=>u(s),U=>_(s,U)),He(X,()=>u(i),U=>_(i,U)),He(ue,()=>u(a),U=>_(a,U)),He(ze,()=>u(n),U=>_(n,U)),L(r,G),Re()}or(["click"]);var tf=async(r,e)=>await e(),rf=(r,e,t)=>{u(e).showModal(),t()},sf=(r,e,t,s)=>e(u(t),u(s).content),nf=N('<p class="ai-word svelte-1g4eeoh"> </p>'),af=N('<div class="message ai-sent svelte-1g4eeoh"></div>'),of=N('<div class="message user-sent svelte-1g4eeoh"> </div>'),lf=N("<!> <!>",1),cf=N('<span class="deck-label svelte-1g4eeoh">Deck: <b> </b></span>'),uf=(r,e,t,s)=>e(u(t),s),df=N('<div class="chat-container svelte-1g4eeoh"><section class="header-messages-container svelte-1g4eeoh"><span class="chat-header svelte-1g4eeoh"><span class="pfp-name-container svelte-1g4eeoh"><img class="character-header-image svelte-1g4eeoh"/> <h3 class="svelte-1g4eeoh"> </h3> <p> </p> <p class="trait-tag svelte-1g4eeoh"> </p></span> <button class="ai-analysis-btn svelte-1g4eeoh">Get AI analysis of chat</button></span> <button class="test-deck-btn svelte-1g4eeoh">Get tested on a deck</button> <div class="messages-container svelte-1g4eeoh"></div></section> <div class="input-deck-label-container svelte-1g4eeoh"><!> <span class="send-container svelte-1g4eeoh"><input class="send-message-input svelte-1g4eeoh"/> <button class="send-message-btn svelte-1g4eeoh"><span class="material-symbols-rounded">send</span></button></span></div></div>'),hf=N('<span class="sentence-container svelte-1g4eeoh"><span class="corrected_sentence_label_container svelte-1g4eeoh">ð <p class="original_sentence_label svelte-1g4eeoh">Original sentence:</p></span> <p class="original_sentence svelte-1g4eeoh"> </p></span> <span class="sentence-container svelte-1g4eeoh"><span class="corrected_sentence_label_container svelte-1g4eeoh">â <p class="corrected_sentence_label svelte-1g4eeoh">Corrected sentence:</p></span> <p class="corrected_sentence svelte-1g4eeoh"> </p></span>',1),ff=N('<span class="analysis-character-container svelte-1g4eeoh"><img class="analysis-image svelte-1g4eeoh"/> <h1 class="analysis-header svelte-1g4eeoh"> </h1></span> <div class="stats-container svelte-1g4eeoh"><div class="ai-chat-analysis-container svelte-1g4eeoh"><h3 class="ai-chat-analysis-header svelte-1g4eeoh">ð¡ AI Chat Analysis</h3> <p class="ai-chat-analysis svelte-1g4eeoh"> </p></div> <!></div>',1),vf=N("<option required> </option>"),pf=(r,e)=>u(e).close(),gf=N('<main class="route svelte-1g4eeoh"><!> <section class="main-page svelte-1g4eeoh"><h1 class="page-header">AI Chat</h1> <section class="main-content svelte-1g4eeoh"><!> <!> <!></section></section></main> <dialog class="svelte-1g4eeoh"><div class="dialog-container svelte-1g4eeoh"><h2 class="dialog-header svelte-1g4eeoh">Select deck to be tested on:</h2> <form class="svelte-1g4eeoh"><select class="deck-select svelte-1g4eeoh"></select> <span class="deck-buttons-container svelte-1g4eeoh"><input type="Submit" class="submit-deck-btn svelte-1g4eeoh"/> <button class="close-deck-btn svelte-1g4eeoh">Close</button></span></form></div></dialog>',1);function _f(r,e){Ie(e,!0);const t=()=>Dr(zr,"$location",s),[s,n]=$r();let a="en",i=W(t().split("/").pop()),o=j(W(Object)),l=j(""),c=j(W([])),d=W([]),h=j(""),f=HTMLObjectElement,p=j(W(f.messagesContainer)),v=j(W(f.dialogBox)),k=j(void 0),m="",T=j(W(m.term)),I=j(W(m.definition)),O=j(W(m.partOfSpeech)),E=j(W(m.romanisation)),x=j(""),S=!0;tt(async()=>{await A()}),Se(async()=>{const{data:V,error:Y}=await he.from("ai_characters").select("*").eq("id",i).single();Y&&console.error(Y),V&&_(o,V,!0)});async function A(){const{data:V,error:Y}=await he.auth.getSession(),ae=V;Y?console.error("Error fetching session:",Y):ae&&_(x,ae.session.user.id,!0),Y&&console.error("Error fetching username:",Y)}async function C(V,Y){let ae="";Y.push({sender:"User",content:V}),console.log(ae);const se=await fetch("/.netlify/functions/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:"You are an AI chatbot roleplaying a character for a language learning app. Keep it chat-like and follow the character trait. Return just your response. No formatting. If a flashcard deck is submitted, relate your answers off that",characterName:u(o).name,characterLanguageISO6391:u(o).language,characterTrait:u(o).trait,characterOccupation:u(o).occupation,latestUserResponse:V,chatHistory:Y.map(ne=>({user:ne.sender,message:ne.content})),flashcardDecks:u(c)[u(k)]})});se.ok?console.log(se):console.error("AI API error:",se.statusText);const ue=await se.json();Y.push({sender:"AI",content:ue.reply}),console.log("AI Response:",ue)}async function M(){const V=`
    You are an AI for a language learning app. The user and AI are having a conversation in ${u(o).language}. The user's messages are marked with "User :". Your task is to return a pure JSON object as your response will be directly parsed into JSON and use no markdown annotates and the response has two fields:

    1. "analysis" â A strict critique in English aimed at helping the user improve. Also if flashcards deck is valid it means teh user wants to use or see all those deck words. So take that into your anaylisis account - pw well did they respond or did they use any flashcard words?
    2. "mistakes" â An array of objects. Each object must include:

    {
    "original_sentence": <user sentence>,
    "corrected_sentence": <correct version, even if its the same as original if no issues found>
    }

    â ï¸ Include **every single sentence** spoken by the user â even if it's 100% correct â so we can evaluate all usage. Do not skip or omit any. Assume all are full sentences. Do not return markdown, just raw JSON.

    Here is the deck content:
    ${u(c)[u(k)]}
    Conversation:
    ${d.map(ue=>`SENT BY ${ue.sender}: ${ue.content}`)}`,Y=encodeURIComponent(V);console.log(V);const se=await(await fetch(`https://text.pollinations.ai/prompt/${Y}`)).json();_(h,se,!0),console.log(u(h))}async function K(){if(!u(c)){const{data:V,error:Y}=await he.from("flashcards").select("*").eq("author",u(x)).eq("language",u(o).language);Y&&console.error("Error fetching flashcard decks:",Y),V?_(c,V,!0):_(c,[],!0),console.log(u(c))}}function G(){u(v).close()}async function F(V,Y){S=!1,console.log(Y),console.log("Fetching definition for ",V);try{const se=await(await fetch("/.netlify/functions/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:"Translate this word based of context. Return no tags, no markup, just raw JSON with keys `word` (original), `partOfSpeech`, `romanisation` and `definition` (meaning based off context and also simple, normal person-readable info about conjugation) but ONLY return `romanisation` where it is not necessary. For example non-Latin scripts",word:V,context:Y,originalWordLanguageISO6391:u(o).language,translatedWordLanguageISO6391:a})})).json(),ue=JSON.parse(se.reply);console.log(ue),S=!0,_(T,ue.word,!0),_(I,ue.definition,!0),_(O,ue.partOfSpeech,!0),_(E,ue.romanisation,!0)}catch(ae){console.error(ae)}}var P=gf(),$=je(P),D=w($);St(D,{currentPage:"/ai-chat"});var R=y(D,2),Z=y(w(R),2),re=w(Z);{var me=V=>{var Y=df(),ae=w(Y),se=w(ae),ue=w(se),ne=w(ue),Oe=y(ne,2),Le=w(Oe),De=y(Oe,2),ze=w(De),Be=y(De,2),qe=w(Be),ee=y(ue,2);ee.__click=[tf,M];var oe=y(se,2);oe.__click=[rf,v,K];var ve=y(oe,2);Me(ve,21,()=>d,Ce,(Pe,we)=>{var it=lf(),Je=je(it);{var go=Vt=>{var qr=af();Me(qr,21,()=>u(we).content.split(" "),Ce,(Ks,Xn)=>{var Gs=nf();Gs.__click=[sf,F,Xn,we];var yo=w(Gs);de(()=>te(yo,u(Xn))),L(Ks,Gs)}),L(Vt,qr)};ce(Je,Vt=>{u(we).sender==="AI"&&Vt(go)})}var _o=y(Je,2);{var mo=Vt=>{var qr=of(),Ks=w(qr);de(()=>te(Ks,u(we).content)),L(Vt,qr)};ce(_o,Vt=>{u(we).sender==="User"&&Vt(mo)})}L(Pe,it)}),ft(ve,Pe=>_(p,Pe),()=>u(p));var U=y(ae,2),Q=w(U);{var ge=Pe=>{var we=cf(),it=y(w(we)),Je=w(it);de(()=>te(Je,u(c)[u(k)].name)),L(Pe,we)};ce(Q,Pe=>{(u(k)||u(k)===0)&&Pe(ge)})}var Ae=y(Q,2),ke=w(Ae),$e=y(ke,2);$e.__click=[uf,C,l,d],de(()=>{Ue(ne,"src",u(o).image),Ue(ne,"alt",`Image of charater ${u(o).name}`),te(Le,u(o).name),te(ze,u(o).occupation),te(qe,u(o).trait)}),gt(ke,()=>u(l),Pe=>_(l,Pe)),L(V,Y)};ce(re,V=>{u(h)||V(me)})}var b=y(re,2);vo(b,{get word(){return u(T)},get definition(){return u(I)},get partOfSpeech(){return u(O)},get romanisation(){return u(E)},get language(){return u(o).language}});var g=y(b,2);{var z=V=>{var Y=ff(),ae=je(Y),se=w(ae),ue=y(se,2),ne=w(ue),Oe=y(ae,2),Le=w(Oe),De=y(w(Le),2),ze=w(De),Be=y(Le,2);Me(Be,17,()=>u(h).mistakes,Ce,(qe,ee)=>{var oe=hf(),ve=je(oe),U=y(w(ve),2),Q=w(U),ge=y(ve,2),Ae=y(w(ge),2),ke=w(Ae);de(()=>{te(Q,u(ee).original_sentence),te(ke,u(ee).corrected_sentence)}),L(qe,oe)}),de(()=>{Ue(se,"src",u(o).image),Ue(se,"alt",u(o).name),te(ne,u(o).name),te(ze,u(h).analysis)}),L(V,Y)};ce(g,V=>{u(h)&&V(z)})}var q=y($,2),B=w(q),H=y(w(B),2),X=w(H);Me(X,21,()=>u(c),Ce,(V,Y,ae)=>{var se=vf(),ue=w(se);se.value=se.__value=ae,de(()=>te(ue,u(Y).name)),L(V,se)});var J=y(X,2),ie=y(w(J),2);ie.__click=[pf,v],ft(q,V=>_(v,V),()=>u(v)),et("submit",H,V=>{V.preventDefault(),G()}),He(X,()=>u(k),V=>_(k,V)),L(r,P),Re(),n()}or(["click"]);var mf=Bn(N('<script src="https://www.youtube.com/iframe_api" class="svelte-18y4z1i"><\/script><!>',1)),yf=(r,e)=>u(e).scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),wf=(r,e)=>u(e).scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),bf=(r,e)=>u(e).scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),kf=(r,e)=>u(e).scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),Sf=N(`<main class="svelte-18y4z1i"><section class="page-1 page svelte-18y4z1i"><div class="media-scroller svelte-18y4z1i"><div class="media-list svelte-18y4z1i"><span class="media-box music-media-box svelte-18y4z1i"><span class="emoji music-emoji svelte-18y4z1i">ð§</span> Music</span> <span class="media-box videos-media-box svelte-18y4z1i"><span class="emoji videos-emoji svelte-18y4z1i">ð¹</span> Videos</span> <span class="media-box flashcards-media-box svelte-18y4z1i"><span class="emoji flashcards-emoji svelte-18y4z1i">ðï¸</span> Flashcards</span> <span class="media-box ai-chats-media-box svelte-18y4z1i"><span class="emoji ai-chats-emoji svelte-18y4z1i">ð¬</span> AI Chats</span> <span class="media-box music-media-box svelte-18y4z1i"><span class="emoji music-emoji svelte-18y4z1i">ð§</span> Music</span> <span class="media-box videos-media-box svelte-18y4z1i"><span class="emoji videos-emoji svelte-18y4z1i">ð¹</span> Videos</span> <span class="media-box flashcards-media-box svelte-18y4z1i"><span class="emoji flashcards-emoji svelte-18y4z1i">ðï¸</span> Flashcards</span> <span class="media-box ai-chats-media-box svelte-18y4z1i"><span class="emoji ai-chats-emoji svelte-18y4z1i">ð¬</span> AI Chats</span></div></div> <section class="hero-1 svelte-18y4z1i"><h1 class="welcome svelte-18y4z1i">Welcome to Loquelis!!!</h1> <p class="welcome-message svelte-18y4z1i">ð¤ Happy to see you!</p></section> <button class="get-started-btn svelte-18y4z1i"><a href="./#/app/signup/" class="svelte-18y4z1i">Let's get started! â</a></button></section> <section class="page-2 page svelte-18y4z1i"><h1 class="svelte-18y4z1i">Let's get started with a language-learning favourite - Peppa Pig! ð·</h1> <span class="video-info-box info-box svelte-18y4z1i"><p class="icon svelte-18y4z1i">ð¡</p>Click on a word for a definition based off context, part of speech and romanisation.</span> <span class="video-info-box info-box svelte-18y4z1i"><p class="icon svelte-18y4z1i">ð</p>Play the video and watch the live subtitles flow through!</span> <section class="video-container svelte-18y4z1i"><iframe id="player" frameborder="0" allowfullscreen="" class="svelte-18y4z1i"></iframe> <!></section></section> <hr class="svelte-18y4z1i"/> <section class="page-3 page svelte-18y4z1i"><h2 class="svelte-18y4z1i">Learn with user curated/ custom:</h2> <div class="media-container svelte-18y4z1i"><span class="media-box music-media-box svelte-18y4z1i"><span class="emoji music-emoji svelte-18y4z1i">ð§</span> Music</span> <span class="media-box videos-media-box svelte-18y4z1i"><span class="emoji videos-emoji svelte-18y4z1i">ð¹</span> Videos</span> <span class="media-box flashcards-media-box svelte-18y4z1i"><span class="emoji flashcards-emoji svelte-18y4z1i">ðï¸</span> Flashcards</span> <span class="media-box ai-chats-media-box svelte-18y4z1i"><span class="emoji ai-chats-emoji svelte-18y4z1i">ð¬</span> AI Chats</span></div></section> <hr class="svelte-18y4z1i"/> <section class="page-4 page svelte-18y4z1i"><h1 class="media-header svelte-18y4z1i">ð§ Music</h1> <p class="media-p svelte-18y4z1i">Learn through user curated music options and immerse yourself in the culture of the region of your chosen language</p> <div class="media-image-container svelte-18y4z1i"><img src="https://upload.wikimedia.org/wikipedia/en/b/bc/Molchat_Doma_-_Etazhi.png" alt="Molchat Doma music" class="media-img svelte-18y4z1i"/> <img src="https://upload.wikimedia.org/wikipedia/en/4/40/99_Luftballons_single_cover.jpg" alt="99 Luftballons Music" class="media-img svelte-18y4z1i"/> <img src="https://upload.wikimedia.org/wikipedia/en/f/fa/RammsteinRadioSingleCover.jpg" alt="Rammstein Music" class="media-img svelte-18y4z1i"/> <img src="https://upload.wikimedia.org/wikipedia/en/2/20/Fortuna_Wheel.jpg" alt="Rammstein Music" class="media-img svelte-18y4z1i"/></div> <hr class="svelte-18y4z1i"/> <h1 class="media-header svelte-18y4z1i">ð¹ Video</h1> <p class="media-p svelte-18y4z1i">Learn through user curated video options and finally switch from textbooks to shows, documentaries, news and YouTubers</p> <div class="media-image-container svelte-18y4z1i"><img src="https://i.ytimg.com/vi/WYqIlqp2_9c/sddefault.jpg" alt="coca cola documentary in german" class="vid-media-img media-img svelte-18y4z1i"/> <img src="https://i.ytimg.com/vi/_fPXQnfCWqI/sddefault.jpg" class="vid-media-img media-img svelte-18y4z1i" alt="french news"/> <img src="https://i.ytimg.com/vi/ZzfeHWgEVDs/sddefault.jpg" alt="vlog video" class="vid-media-img media-img svelte-18y4z1i"/></div> <hr class="svelte-18y4z1i"/> <h1 class="media-header svelte-18y4z1i">ðï¸ Flashcards</h1> <p class="media-p svelte-18y4z1i">Create your own decks from words saved from songs, videos and AI Chats</p> <div class="media-image-container svelte-18y4z1i"><img src="https://raw.githubusercontent.com/Ewan-Dev/ewan.is-a.dev/refs/heads/main/frontend/static/food-deck.png" class="deck-media-img media-img svelte-18y4z1i" alt="deck"/> <img src="https://raw.githubusercontent.com/Ewan-Dev/ewan.is-a.dev/refs/heads/main/frontend/static/animals-deck.png" alt="deck" class="deck-media-img media-img svelte-18y4z1i"/> <img src="https://raw.githubusercontent.com/Ewan-Dev/ewan.is-a.dev/refs/heads/main/frontend/static/flashcards.png" alt="flashcards" class="deck-media-img media-img svelte-18y4z1i"/></div> <hr class="svelte-18y4z1i"/> <h1 class="media-header svelte-18y4z1i">ð¬ AI Chat</h1> <p class="media-p svelte-18y4z1i">Create your own AI character to practise your language skills and decks with.</p> <div class="media-image-container svelte-18y4z1i"><img src="https://raw.githubusercontent.com/Ewan-Dev/ewan.is-a.dev/refs/heads/main/frontend/static/ai-chat.png" alt="ai chat" class="ai-chat-img media-img svelte-18y4z1i"/></div></section> <hr class="svelte-18y4z1i"/> <section class="page-5 page svelte-18y4z1i"><h1 class="svelte-18y4z1i">Start your journey. <p class="blue svelte-18y4z1i">Today.</p></h1> <div class="sign-up-contact-container svelte-18y4z1i"><button class="big-get-started-btn svelte-18y4z1i"><a href="./#/app/signup/" class="svelte-18y4z1i">Get started! â</a></button> <button class="big-contact-btn svelte-18y4z1i"><span class="material-symbols-rounded svelte-18y4z1i">login</span><a href="./#/app/login/" class="contact-p svelte-18y4z1i">Sign in</a></button></div></section></main>`);function Ef(r,e){Ie(e,!0);const t=()=>Dr(zr,"$location",s),[s,n]=$r(),i={events:[{tStartMs:10791,dDurationMs:1508,segs:[{utf8:"Herr Vogelscheuche"}]},{tStartMs:15535,dDurationMs:4067,segs:[{utf8:"Peppa und Schorsch sind heute zu Besuch bei Oma und Opa Wutz."}]},{tStartMs:23350,dDurationMs:1641,segs:[{utf8:"Hallo Opa Wutz."}]},{tStartMs:25960,dDurationMs:3547,segs:[{utf8:"Huhu Hallo Peppa Hallo Schorsch."}]},{tStartMs:29571,dDurationMs:2317,segs:[{utf8:"Opa was machst du denn da?"}]},{tStartMs:31897,dDurationMs:2158,segs:[{utf8:"Ich pflanze einen Blumengarten."}]},{tStartMs:34072,dDurationMs:1579,segs:[{utf8:"Oh!"}]},{tStartMs:35675,dDurationMs:3720,segs:[{utf8:"Aus diesen Samen wachsen wunderschÃ¶ne Blumen."}]},{tStartMs:40090,dDurationMs:3153,segs:[{utf8:"Ich streue die SamenkÃ¶rner auf den Boden."}]},{tStartMs:44163,dDurationMs:2722,segs:[{utf8:"Dann decke ich sie mit Erde zu."}]},{tStartMs:47211,dDurationMs:1841,segs:[{utf8:"Oh wo sind sie denn?"}]},{tStartMs:49110,dDurationMs:1865,segs:[{utf8:"Die SamenkÃ¶rner sind verschwunden."}]},{tStartMs:50999,dDurationMs:4049,segs:[{utf8:`Wie merkwÃ¼rdig! 
Ich bin sicher dass ich hier Samen verstaut hatte.`}]},{tStartMs:55076,dDurationMs:2456,segs:[{utf8:`Ja Opa.
Wir haben es gesehen.`}]},{tStartMs:57932,dDurationMs:1598,segs:[{utf8:`Ja!
Jetzt sind sie weg.`}]},{tStartMs:60167,dDurationMs:3047,segs:[{utf8:"Na gut dann muss ich eben noch welche nehmen."}]},{tStartMs:63522,dDurationMs:4459,segs:[{utf8:"Wie schon sagte, ich treue die SamenkÃ¶rner einfach auf den Boden."}]},{tStartMs:70334,dDurationMs:3534,segs:[{utf8:"Ein kleiner Vogel pickt die SamenkÃ¶rner von Opa Wutz auf."}]},{tStartMs:73960,dDurationMs:765,segs:[{utf8:"Heyy!"}]},{tStartMs:74776,dDurationMs:1962,segs:[{utf8:"Lass meine SamenkÃ¶rner!"}]},{tStartMs:77137,dDurationMs:2561,segs:[{utf8:"Also da sind meine ganzen Samen hin."}]},{tStartMs:79709,dDurationMs:3240,segs:[{utf8:"Im Bauch von dem kleinen Vogel."}]},{tStartMs:83320,dDurationMs:3741,segs:[{utf8:"Und noch zwei kleine VÃ¶gel picken Opa wird SamenkÃ¶rner auf."}]},{tStartMs:87180,dDurationMs:1319,segs:[{utf8:"Oh Guck!"}]},{tStartMs:88507,dDurationMs:1987,segs:[{utf8:"Ah! Weg da Weg da!"}]},{tStartMs:91405,dDurationMs:1666,segs:[{utf8:"Was ist das fÃ¼r ein LÃ¤rm."}]},{tStartMs:93256,dDurationMs:3800,segs:[{utf8:`Oma Wutz!
Die VÃ¶gel picken meine ganzen Blumensamen weg.`}]},{tStartMs:97138,dDurationMs:2397,segs:[{utf8:"Und jetzt werden die VÃ¶gel weg."}]},{tStartMs:99765,dDurationMs:3239,segs:[{utf8:"Wegjagen hat keinen Zweck! Sie kommen einfach wieder."}]},{tStartMs:103020,dDurationMs:959,segs:[{utf8:"Guck!"}]},{tStartMs:104823,dDurationMs:2133,segs:[{utf8:"Wir brauchen eine Vogelscheuche."}]},{tStartMs:106990,dDurationMs:1964,segs:[{utf8:"Was ist eine Vogelscheuche?"}]},{tStartMs:109017,dDurationMs:3719,segs:[{utf8:"Eine Vogelscheuche ist ein Mann aus Stroh der den VÃ¶geln Angst macht."}]},{tStartMs:112761,dDurationMs:2916,segs:[{utf8:"Das ist eine gute Idee Oma Wutz."}]},{tStartMs:115697,dDurationMs:1305,segs:[{utf8:"Ich baue eine."}]},{tStartMs:117038,dDurationMs:1663,segs:[{utf8:"Kommt alle mit."}]},{tStartMs:119901,dDurationMs:6213,segs:[{utf8:"Wiedersehen kleine VÃ¶gel. Wir bauen eine Vogelscheuche."}]},{tStartMs:126387,dDurationMs:2133,segs:[{utf8:"Das ist Opa Wutz Gartenschuppen."}]},{tStartMs:128928,dDurationMs:4022,segs:[{utf8:"Hier drin gibt es eine Menge Sachen um eine Vogelscheuche zu bauen."}]},{tStartMs:133306,dDurationMs:3583,segs:[{utf8:"Zuerst brauchen wir zwei StÃ¶cke und etwas Kordel."}]},{tStartMs:136913,dDurationMs:2023,segs:[{utf8:"Das besorgen wir."}]},{tStartMs:140720,dDurationMs:4139,segs:[{utf8:"Peppa hat zwei StÃ¼cke gefunden Schorsch hat etwas Kordel gefunden."}]},{tStartMs:144900,dDurationMs:1090,segs:[{utf8:"Gut!"}]},{tStartMs:146042,dDurationMs:3400,segs:[{utf8:"Ich binde die StÃ¶cke zusammen. Das wird der KÃ¶rper."}]},{tStartMs:149529,dDurationMs:3666,segs:[{utf8:"Oma Wutz hat etwas Stroh gefunden und einen alten Sack."}]},{tStartMs:153237,dDurationMs:5544,segs:[{utf8:`GroÃartig!
Ich stecke das Stroh in den Sack. Das wird der Kopf.`}]},{tStartMs:158817,dDurationMs:3276,segs:[{utf8:"Jetzt braucht die Vogelscheuche was zum anziehen."}]},{tStartMs:162146,dDurationMs:2129,segs:[{utf8:"Hier ist eine Tasche mit alten Kleidern."}]},{tStartMs:164334,dDurationMs:5122,segs:[{utf8:`Oh!
Schorsch hat ein Kleid gefunden.`}]},{tStartMs:170717,dDurationMs:6222,segs:[{utf8:`Dumber Schorsch!
Herr Vogelscheuche hat doch kein Kleid an.`}]},{tStartMs:177184,dDurationMs:2503,segs:[{utf8:"Peppa hat einen Mantel gefunden."}]},{tStartMs:179918,dDurationMs:1875,segs:[{utf8:"Sehr gut Peppa!"}]},{tStartMs:183037,dDurationMs:1961,segs:[{utf8:"Schorsch hat einen Hut gefunden."}]},{tStartMs:185023,dDurationMs:1709,segs:[{utf8:"Sehr gut Schorsch."}]},{tStartMs:187126,dDurationMs:2881,segs:[{utf8:"Herr Vogelscheuche braucht ein Gesicht."}]},{tStartMs:190015,dDurationMs:1e3,segs:[{utf8:"Das Stimmt."}]},{tStartMs:191285,dDurationMs:2564,segs:[{utf8:"Willst du mit Schorch ein Gesicht fÃ¼r ihn malen."}]},{tStartMs:193911,dDurationMs:2596,segs:[{utf8:"Ja bitte."}]},{tStartMs:196794,dDurationMs:2467,segs:[{utf8:"Schorsch malt die Augen und die Nase."}]},{tStartMs:199643,dDurationMs:2004,segs:[{utf8:"Peppa malt den Mund."}]},{tStartMs:202331,dDurationMs:1949,segs:[{utf8:"Fantastisch!"}]},{tStartMs:204305,dDurationMs:1352,segs:[{utf8:"Herr Vogelscheuche ist fertig."}]},{tStartMs:205689,dDurationMs:1750,segs:[{utf8:"Hurraa"}]},{tStartMs:208970,dDurationMs:2877,segs:[{utf8:"Die kleinen VÃ¶gel suchen nach Opa Wutz Blumensamen."}]},{tStartMs:211985,dDurationMs:2704,segs:[{utf8:`Guck!
Die kleinen VÃ¶gel sind wieder da.`}]},{tStartMs:214706,dDurationMs:1327,segs:[{utf8:"Keine Sorge Peppa."}]},{tStartMs:216041,dDurationMs:2345,segs:[{utf8:"Die Vogelscheuche wird sie feucht."}]},{tStartMs:223868,dDurationMs:1266,segs:[{utf8:"Es funktioniert!"}]},{tStartMs:225194,dDurationMs:2491,segs:[{utf8:"Die Vogelscheuche hat die VÃ¶gel verscheucht."}]},{tStartMs:227757,dDurationMs:1528,segs:[{utf8:"Hurra!"}]},{tStartMs:229296,dDurationMs:726,segs:[{utf8:" Gut!"}]},{tStartMs:230099,dDurationMs:3049,segs:[{utf8:"Jetzt werden meine Blumensamen nicht mehr gefressen."}]},{tStartMs:234964,dDurationMs:4325,segs:[{utf8:"Oh Opa die kleinen VÃ¶gel sehen sehr traurig aus."}]},{tStartMs:239329,dDurationMs:2435,segs:[{utf8:"Ja sie haben sicher Hunger."}]},{tStartMs:241820,dDurationMs:1730,segs:[{utf8:"DafÃ¼r habe ich das hier."}]},{tStartMs:243594,dDurationMs:1951,segs:[{utf8:"Das ist das Oma?"}]},{tStartMs:245561,dDurationMs:1721,segs:[{utf8:"Eine Futterstation."}]},{tStartMs:247307,dDurationMs:5499,segs:[{utf8:"Opa gibst du mir bitte etwas von den Samen."}]},{tStartMs:254689,dDurationMs:3828,segs:[{utf8:"Kommt ihr VÃ¶gelchen. Essen Zeit."}]},{tStartMs:259175,dDurationMs:2599,segs:[{utf8:"Jetzt haben die VÃ¶gel ihre eigenen Samen."}]},{tStartMs:262604,dDurationMs:2274,segs:[{utf8:"Die kleinen VÃ¶gel sind wieder glÃ¼cklich."}]},{tStartMs:264903,dDurationMs:3639,segs:[{utf8:"Peppa ist froh dass Opas Blumensamen nicht gefressen werden."}]},{tStartMs:268644,dDurationMs:8125,segs:[{utf8:"Aber noch vor ist sie dass die kleinen VÃ¶gel auch etwas zu fressen haben."}]}]}.events;console.log(i);let o=j(void 0),l=j(void 0),c=j(void 0),d=j(void 0);W([]);let h,f=j("Peppa Wutz");Se(()=>{t().split("/").pop()==="welcome"&&(p(),window.YT?v():window.onYouTubeIframeAPIReady=v)});function p(){Ur({particleCount:1e3,spread:150,origin:{y:0}})}function v(){h=new YT.Player("player",{events:{onReady:()=>{setInterval(()=>{const D=h.getCurrentTime(),R=Math.round(D*1e3);k(R)},1)}}})}function k(D){let R=0;i.forEach(Z=>{D>Z.tStartMs&&D<i[R+1].tStartMs&&Z.segs.forEach(re=>{u(f)!==re.utf8&&(_(f,re.utf8,!0),console.log(re.utf8))}),R++})}var m=Sf();Fn(D=>{var R=mf();y(je(R)),L(D,R)});var T=y(w(m),2),I=y(w(T),6),O=w(I);Ue(O,"src","https://www.youtube.com/embed/Q_sqR4aLLu0?enablejsapi=1"),Ue(O,"title","peppapig");var E=y(O,2);Qn(E,{get currentLine(){return u(f)},targetLanguage:"de"});var x=y(T,4),S=y(w(x),2),A=w(S);A.__click=[yf,o];var C=y(A,2);C.__click=[wf,l];var M=y(C,2);M.__click=[bf,c];var K=y(M,2);K.__click=[kf,d];var G=y(x,4),F=y(w(G),6);ft(F,D=>_(l,D),()=>u(l));var P=y(F,8);ft(P,D=>_(c,D),()=>u(c));var $=y(P,10);ft($,D=>_(d,D),()=>u(d)),ft(G,D=>_(o,D),()=>u(o)),L(r,m),Re(),n()}or(["click"]);var xf=()=>{window.open("#/app/home")},Tf=N('<head><link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:wght@400" rel="stylesheet"/></head> <main class="svelte-1n46o8q"><dialog class="svelte-1n46o8q"><form class="svelte-1n46o8q"><label class="username-header svelte-1n46o8q">ð¤ Set a username:</label> <span class="input-container svelte-1n46o8q"><p class="at-symbol svelte-1n46o8q">@</p><input placeholder="username" class="username-input svelte-1n46o8q"/></span> <input type="Submit" class="svelte-1n46o8q"/> <button class="close-button-username svelte-1n46o8q">Close</button> <!></form></dialog> <dialog open class="auth-notice svelte-1n46o8q"><h2>Already logged in</h2> <p>You already have a user session saved.</p> <button class="dialog-auth-btn svelte-1n46o8q">Continue anyway</button> <button class="dialog-auth-btn svelte-1n46o8q">Go to user homepage</button></dialog> <!></main>',1);function Of(r,e){Ie(e,!0);const t=()=>Dr(zr,"$location",s),[s,n]=$r(),a={"/app/welcome":Ef,"/app/ai-chat/:slug":_f,"/app/ai-chat":ef,"/app/videos/:slug":Nh,"/app/videos":Lh,"/app/flashcards/:slug":Ph,"/app/flashcards":ph,"/app/upload":ch,"/app/music/:slug":sh,"/app/music":Ud,"/app/login":xd,"/app/login/:slug":jd,"/app/signup":kd,"/app/home":_d};let i=j(""),o=j(""),l="",c=j(W(l.statusMessage)),d=j(W(l.statusType)),h=j(""),f,p,v=j(W(t()));tt(()=>{f==null||f.close(),_(v,t(),!0)}),Se(()=>{_(v,t(),!0),u(h)&&(u(v)==="/app/login"||u(v)==="/app/signup")?p==null||p.showModal():u(h)&&u(v)==="/"?window.location.replace("/#/app/home"):!u(h)&&u(v)==="/"?window.location.replace("/#/app/welcome"):(u(h)&&(u(v)==="/app/login"||u(v)),p==null||p.close())}),Se(async()=>{console.log(u(v)),await m(),k()});function k(){!u(i)&&u(h)?f==null||f.showModal():f==null||f.close()}async function m(){var me,b;const{data:R,error:Z}=await he.auth.getSession(),re=R;if(Z)console.error("Error fetching session:",Z);else if(re){_(h,(b=(me=re==null?void 0:re.session)==null?void 0:me.user)==null?void 0:b.id,!0);const{data:g,error:z}=await he.from("profiles").select("username").eq("user_id",u(h)).single();g&&(console.log(g),_(i,g.username,!0),console.log("User: ",u(i)))}}async function T(R){if(R){const{error:Z}=await he.from("profiles").update({username:R}).eq("user_id",u(h));Z?(console.error(Z.message),_(c,""),_(d,""),Z.message.includes("duplicate")&&Z.message.includes("username")?(_(c,""),_(d,""),_(c,"Account with username already exists"),_(d,"error")):(_(c,""),_(d,""),_(c,Z.message,!0),_(d,"error")),Z.message==='Column "username" cannot be modified once set'&&(_(c,""),_(d,""),_(c,"Username already set!"),_(d,"warn"))):(_(c,""),_(d,""),_(c,"success"),_(d,"success"),_(i,R,!0))}else _(c,""),_(d,""),_(c,"No username typed"),_(d,"warn")}var I=Tf(),O=y(je(I),2),E=w(O),x=w(E),S=y(w(x),2),A=y(w(S)),C=y(S,4),M=jr(k);C.__click=function(...R){var Z;(Z=u(M))==null||Z.apply(this,R)};var K=y(C,2);{var G=R=>{At(R,{get message(){return u(c)},get type(){return u(d)}})};ce(K,R=>{u(c)&&R(G)})}ft(E,R=>f=R,()=>f);var F=y(E,2),P=y(w(F),4);P.__click=()=>{p==null||p.close()};var $=y(P,2);$.__click=[xf],ft(F,R=>p=R,()=>p);var D=y(F,2);eh(D,{get routes(){return a}}),et("submit",x,R=>{R.preventDefault(),T(u(o))}),gt(A,()=>u(o),R=>_(o,R)),L(r,I),Re(),n()}or(["click"]);Dl(Of,{target:document.getElementById("app")})});export default jf();
